(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[635],{62254:function(e,t,n){"use strict";var a=n(26314);t.Z=void 0;var i=a(n(80984)),o=n(57437);t.Z=(0,i.default)((0,o.jsx)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M8 20H4v-4h4zm0-6H4v-4h4zm0-6H4V4h4zm6 12h-4v-4h4zm0-6h-4v-4h4zm0-6h-4V4h4zm6 12h-4v-4h4zm0-6h-4v-4h4zm0-6h-4V4h4z"}),"GridOn")},65897:function(e,t,n){"use strict";n.d(t,{E:function(){return MySection},c:function(){return MySectionContainer}});var a=n(57437),i=n(39227);function MySection(e){let{children:t,sx:n}=e;return(0,a.jsx)(i.Z,{sx:{...n},style:{scrollSnapAlign:"center",border:"0px solid yellow"},children:t})}function MySectionContainer(e){let{children:t,height:n}=e;return(0,a.jsx)(i.Z,{sx:{height:{height:n},scrollSnapType:"y mandatory",overflow:"auto",border:"0px solid red"},children:t})}n(2265)},20626:function(e,t,n){"use strict";n.d(t,{$Y:function(){return MyScatter2D},Mz:function(){return ShowLabels},T3:function(){return MyScatter}});var a=n(57437),i=n(81797),o=n(39227),s=n(14172),c=n(88444),d=n(85269),u=n(68448),h=n(2265),x=n(41125),j=n(16573),Z=n(24235),A=n(33343),k=n(50039),D=n(86812),F=n(87586),_=n(561),V=n(79857),R=n(96350),I=n(53146);function MyScatter(e){let t,{omic:n,scatterData:s,mdataCol:c,PCA:d}=e,[V,U]=(0,h.useState)(!1),{OMIC2NAME:H}=(0,R.S)(),q=(0,h.useRef)(),N=(0,i.tc)().mdataType[c].type;return"categorical"==N&&(t="category"),"numeric"==N&&(t="number"),(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(o.Z,{sx:{},children:(0,a.jsx)(I.LA,{scatterRef:q,name:"PCA-1D-".concat(H[n])})}),(0,a.jsxs)(x.G,{width:600,height:550,ref:q,margin:{top:20,right:20,bottom:20,left:20},children:[(0,a.jsx)(j.q,{}),(0,a.jsx)(Z.K,{type:t,dataKey:"mdataValue",name:c,allowDuplicatedCategory:!1,style:{fontFamily:"Calibri"},children:(0,a.jsx)(A._,{value:c,offset:-10,position:"insideBottom",style:{fontFamily:"Calibri"}})}),(0,a.jsx)(k.B,{type:"number",dataKey:"projection",name:"PCA ".concat(d),style:{fontFamily:"Calibri"},children:(0,a.jsx)(A._,{value:"PCA ".concat(d),offset:20,position:"insideLeft",angle:-90,style:{fontFamily:"Calibri"}})}),(0,a.jsx)(D.u,{cursor:{strokeDasharray:"3 3"},content:(0,a.jsx)(CustomTooltip,{})}),(0,a.jsx)(F.b,{data:s,fill:u.s[0],children:V&&(0,a.jsx)(_.e,{dataKey:"element",position:"right",style:{fontFamily:"Calibri"}})})]}),(0,a.jsx)(ShowLabels,{showLabels:V,setShowLabels:U})]})}function MyScatter2D(e){let{omic:t,scatterData:n,selectedPlot2D:i}=e,{OMIC2NAME:s}=(0,R.S)(),c=(0,h.useRef)(),[d,U]=(0,h.useState)(!1);return(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(o.Z,{children:(0,a.jsx)(I.LA,{scatterRef:c,name:"PCA-2D-".concat(s[t])})}),(0,a.jsxs)(x.G,{ref:c,width:600,height:550,margin:{top:20,right:20,bottom:20,left:20},children:[(0,a.jsx)(j.q,{}),(0,a.jsx)(Z.K,{type:"number",dataKey:"x",name:"PCA ".concat(i.x),style:{fontFamily:"Calibri"},children:(0,a.jsx)(A._,{value:"PCA ".concat(i.x),offset:-10,position:"insideBottom",style:{fontFamily:"Calibri"}})}),(0,a.jsx)(k.B,{type:"number",dataKey:"y",name:"PCA ".concat(i.y),style:{fontFamily:"Calibri"},children:(0,a.jsx)(A._,{value:"PCA ".concat(i.y),offset:20,position:"insideLeft",angle:-90,style:{fontFamily:"Calibri"}})}),(0,a.jsx)(D.u,{cursor:{strokeDasharray:"3 3"},content:(0,a.jsx)(CustomTooltip,{})}),Object.keys(n).length>1&&(0,a.jsx)(V.D,{verticalAlign:"top"}),Object.keys(n).map((e,t)=>(0,a.jsx)(F.b,{data:n[e],fill:u.s[t%u.s.length],name:e,children:d&&(0,a.jsx)(_.e,{dataKey:"element",position:"top",style:{fontFamily:"Calibri"}})},e))]}),(0,a.jsx)(o.Z,{sx:{mt:1},children:(0,a.jsx)(ShowLabels,{showLabels:d,setShowLabels:U})})]})}let ShowLabels=e=>{let{showLabels:t,setShowLabels:n}=e;return(0,a.jsx)(o.Z,{sx:{mt:0,display:"flex",justifyContent:"center"},children:(0,a.jsxs)(o.Z,{sx:{width:100,textAlign:"center",position:"relative",left:30,border:"0px solid red"},children:[(0,a.jsx)(s.Z,{component:"legend",sx:{pt:0},children:"Show Labels"}),(0,a.jsx)(c.Z,{sx:{position:"relative",top:-10,border:"0px solid red"},checked:t,onChange:e=>{n(e=>!e)},inputProps:{"aria-label":"controlled"}})]})})},CustomTooltip=e=>{let{active:t,payload:n}=e;return t&&n&&n.length?(0,a.jsxs)(o.Z,{className:"custom-tooltip",sx:{backgroundColor:"rgba(5,5,5,0.8)",color:"rgba(250,250,250,0.8)",border:"1px solid rgba(50, 50, 50, 0.8)",padding:1,borderRadius:1},children:[(0,a.jsx)(d.Z,{variant:"h8",sx:{display:"block"},children:"".concat(n[0].payload.element)}),(0,a.jsx)(d.Z,{variant:"h9",sx:{display:"block"},children:"".concat(n[0].name,": ").concat("string"==typeof n[0].value?n[0].value:n[0].value.toFixed(3))}),(0,a.jsx)(d.Z,{variant:"h9",sx:{display:"block"},children:"".concat(n[1].name,": ").concat(n[1].value.toFixed(3))})]}):null}},81635:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return PCA}});var a=n(57437),i=n(39227),o=n(2265),s=n(96350),c=n(81797),d=n(14132),u=n(73117),h=n(85269),x=n(47042),j=n(46776),Z=n(38939),A=n(23503),k=n(75897),D=n(53514),F=n(77370),_=n(80470),V=n(57842),R=n(62254),I=n(55183),U=n(29818);let H="rgba(200,200,200,0.5)",useStyles=e=>({cell:{transition:"background-color 0.3s, border-color 0.3s",border:"1px solid ".concat(H),cursor:"1D"==e?"pointer":"",padding:.5,fontSize:15,textAlign:"center",userSelect:"none","&:hover":{border:"1D"==e?"1px solid rgba(50,50,50,1)":"1px solid ".concat(H)}},selectedCell:{border:"1D"==e?"1px solid rgba(50,50,50,1)":"1px solid ".concat(H),"&:hover":{border:"1D"==e?"1px solid rgba(50,50,50,1)":"1px solid ".concat(H)}}}),q={textAlign:"center",padding:.5,border:"1px solid ".concat(H),borderRight:"1px solid rgba(10,10,10,1)",fontSize:15,whiteSpace:"nowrap",userSelect:"none"},calculateBackgroundColor=e=>({backgroundColor:e<.1?"rgba(".concat(2550*e,",").concat(200+550*e,",").concat(2550*e,", 0.5)"):"rgba(255,255,255,0.5)"}),calculateBackgroundColorExpVar=e=>({backgroundColor:"rgba(".concat(255,",").concat(255-255*e/100,",").concat(255-255*e/100,", 0.8)")});function TablePvalues(e){let{omic:t,data:n,rowNames:c,colNames:d,expVar:u,setSelectedPlot:h,scatterMode:x}=e,{OMIC2NAME:N}=(0,s.S)(),$=(0,U.a0)().EDA.PCA[t].displayOpts.selectedCell,[W,Y]=(0,o.useState)($),J=(0,U.mX)(),ee=useStyles(x),handleCellClick=(e,n)=>{"2D"!=x&&(Y({rowIndex:e,colIndex:n}),h({mdataCol:c[e],PCA:d[n]}),J({omic:t,type:"set-selected-plot-cell",rowIndex:e,colIndex:n,mdataCol:c[e],PCA:d[n]}),console.log("Plot scatter: PCA ".concat(d[n]," vs ").concat(c[e])))},et=(0,o.useMemo)(()=>{let e=[];e.push(["PCA / Cond.",...d]),e.push(["%Variance",...u]);let t=n.map((e,t)=>[c[t],...e]);return[...e,...t]},[d,u,n,c]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{sx:{height:0,width:50,zIndex:5e3,display:"flex",paddingLeft:.5},children:(0,a.jsx)(j.Z,{"aria-label":"download",size:"small",sx:{opacity:.5,position:"relative",top:-21},children:(0,a.jsx)(I.CSVLink,{data:et,filename:"PCA_Anova_pvalues/".concat(N[t],".csv"),separator:",",children:(0,a.jsx)(R.Z,{})})})}),(0,a.jsxs)(Z.ZP,{container:!0,children:[(0,a.jsx)(Z.ZP,{item:!0,xs:2,children:(0,a.jsx)(A.Z,{sx:{margin:"auto"},children:(0,a.jsxs)(k.Z,{children:[(0,a.jsx)(D.Z,{children:(0,a.jsx)(F.Z,{children:(0,a.jsx)(_.Z,{sx:{padding:0,textAlign:"center"},children:"PCA / Cond."})})}),(0,a.jsxs)(V.Z,{children:[(0,a.jsx)(F.Z,{children:(0,a.jsx)(_.Z,{sx:{padding:0,border:0},children:(0,a.jsx)(i.Z,{sx:{...q,borderBottom:"1px solid rgba(10,10,10,1)"},children:"%Variance"})})},"expVar"),c.map((e,t)=>(0,a.jsx)(F.Z,{children:(0,a.jsx)(_.Z,{sx:{padding:0,border:0},children:(0,a.jsxs)(i.Z,{sx:q,children:["p-value [ ",(0,a.jsx)("strong",{children:e})," ]"]})})},t))]})]})})}),(0,a.jsx)(Z.ZP,{item:!0,xs:10,children:(0,a.jsx)(A.Z,{sx:{margin:"auto"},children:(0,a.jsxs)(k.Z,{children:[(0,a.jsx)(D.Z,{children:(0,a.jsx)(F.Z,{children:n[0].map((e,t)=>(0,a.jsx)(_.Z,{sx:{padding:0,textAlign:"center",width:50,userSelect:"none"},children:t+1},t))})}),(0,a.jsxs)(V.Z,{children:[(0,a.jsx)(F.Z,{children:u.map((e,t)=>(0,a.jsx)(_.Z,{sx:{padding:0,border:0},children:(0,a.jsx)(i.Z,{sx:{padding:.5,border:"1px solid ".concat(H),borderBottom:"1px solid rgba(10,10,10,1)",fontSize:15,textAlign:"center",backgroundColor:calculateBackgroundColorExpVar(e),userSelect:"none"},children:e})},t))},"expVar"),n.map((e,t)=>(0,a.jsx)(F.Z,{children:e.map((e,n)=>(0,a.jsx)(_.Z,{sx:{padding:0,border:0},onClick:()=>handleCellClick(t,n),children:(0,a.jsx)(i.Z,{sx:W&&W.rowIndex===t&&W.colIndex===n?{...ee.cell,...ee.selectedCell,...calculateBackgroundColor(e)}:{...ee.cell,...calculateBackgroundColor(e)},children:e<.001?e.toExponential(3):e.toFixed(3)})},n))},t))]})]})})})]})]})}var N=n(20626),$=n(67248),W=n(32428),Y=n(95841),J=n(33457),ee=n(92069),et=n(52481);function TableLoadings(e){let{omic:t,selectedLoadings:n,selectedPCA:d}=e,{OMIC2NAME:u}=(0,s.S)(),h=(0,U.mX)(),{displayOpts:x}=(0,U.a0)().EDA.PCA[t],[Z,A]=(0,o.useState)(""),[k,D]=(0,o.useState)(x.filterCol),F=(0,c.tc)().user["".concat(t,"2i")],{filteredFeatures:_,columns:V}=(0,o.useMemo)(()=>{console.log("calculating filteredFeatures");let e={},t=[{accessorKey:"ID",header:"ID",size:60},{accessorKey:"mdataValue",header:"",size:10},...d.map((e,t)=>({accessorKey:"PCA".concat(t),header:"Loadings PCA".concat(e)}))];if(F.columns.includes(k)){e=(e=F.column(k)).values.map((t,a)=>void 0==n[e.index[a]]?null:{ID:e.index[a],mdataValue:t,...n[e.index[a]].reduce((e,t,n)=>({...e,["PCA".concat(n)]:t}),{PCA0:n[e.index[a]][0]})}).filter(e=>null!=e);let a=RegExp("");try{a=new RegExp(Z)}catch(e){a=RegExp("")}e=e.filter(e=>null!=e.mdataValue&&a.test(e.mdataValue)),t[1].header=k,t[1].size=100}else e=Object.keys(n).map((e,t)=>({ID:e,mdataValue:"",...n[e].reduce((e,t,n)=>({...e,["PCA".concat(n)]:t}),{PCA0:n[e][0]})}));return{filteredFeatures:e,columns:t}},[n,Z,k,F,d]);return(0,a.jsxs)(i.Z,{sx:{width:"95%",margin:"auto"},children:[(0,a.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,a.jsx)(i.Z,{sx:{mt:3,ml:0},children:(0,a.jsx)(j.Z,{"aria-label":"download",size:"small",onClick:e=>downloadTable(u[t],_,V),sx:{opacity:.5},variant:"danger",children:(0,a.jsx)(et.Z,{})})}),(0,a.jsx)(i.Z,{sx:{width:"40%",pt:0,pb:0,ml:3},children:(0,a.jsx)(W.$S,{options:[{label:"All features",value:"All features"},...F.columns.map(e=>({label:e,value:e}))],onChange:e=>{D(e.value),h({type:"set-filter-col",value:e.value,omic:t})},value:{label:k,value:k}})}),F.columns.includes(k)&&(0,a.jsx)(Y.Z,{children:(0,a.jsx)(i.Z,{sx:{mt:3,ml:3},children:(0,a.jsx)($.Z,{id:"standard-name",placeholder:"Filter text",value:Z,onChange:e=>{A(e.target.value)}})})})]}),(0,a.jsx)(i.Z,{sx:{mt:0,border:"0px solid red"},children:(0,a.jsx)(FilterTable,{data:_,columns:V})})]})}let downloadTable=(e,t,n)=>{let a=(0,ee.iL)({useKeysAsHeaders:!0,filename:"PCA_Loading_Table-".concat(e)}),i=t.map(e=>{let t={};return n.map(n=>{""!=n.header&&(t[n.header]=e[n.accessorKey])}),t}),o=(0,ee.gB)(a)(i);(0,ee.LR)(a)(o)};function FilterTable(e){let{columns:t,data:n}=e,i=(0,o.useRef)(null),[s,c]=(0,o.useState)(!0),[d,u]=(0,o.useState)([]);(0,o.useEffect)(()=>{c(!1)},[]),(0,o.useEffect)(()=>{try{var e,t;null===(t=i.current)||void 0===t||null===(e=t.scrollToIndex)||void 0===e||e.call(t,0)}catch(e){console.error(e)}},[d]);let h=(0,J.X0)({columns:t,data:n,defaultDisplayColumn:{enableResizing:!0},layoutMode:"grid",enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnResizing:!0,enableColumnVirtualization:!0,enableGlobalFilterModes:!1,enablePagination:!1,enableColumnPinning:!1,enableRowNumbers:!1,enableColumnFilters:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"510px"}},onSortingChange:u,state:{isLoading:s,sorting:d},rowVirtualizerInstanceRef:i,rowVirtualizerOptions:{overscan:5},columnVirtualizerOptions:{overscan:2}});return(0,a.jsx)(Y.Z,{children:(0,a.jsx)("div",{style:{opacity:.9,width:"100%",margin:"auto"},children:(0,a.jsx)(J.P2,{table:h})})})}var PCA_SelectorPCA2D=function(e){let{pvColNames:t,pvRowNames:n,selectedPlot2D:o,setSelectedPlot2D:s,omic:d}=e,u=(0,U.mX)(),{mdataType:h}=(0,c.tc)();return(0,a.jsxs)(i.Z,{sx:{height:75,display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)(i.Z,{sx:{width:"25%"},children:(0,a.jsx)(W.$S,{options:t.map(e=>({label:"PCA ".concat(e),value:e})),onChange:e=>{s(t=>({...t,x:e.value})),u({type:"set-selected-plot-2d",option:"x",value:e.value,omic:d})},value:{label:"PCA ".concat(o.x),value:o.x},label:"X axis"})}),(0,a.jsx)(i.Z,{sx:{width:"25%"},children:(0,a.jsx)(W.$S,{options:t.map(e=>({label:"PCA ".concat(e),value:e})),onChange:e=>{s(t=>({...t,y:e.value})),u({type:"set-selected-plot-2d",option:"y",value:e.value,omic:d})},value:{label:"PCA ".concat(o.y),value:o.y},label:"Y axis"})}),(0,a.jsx)(i.Z,{sx:{width:"40%"},children:(0,a.jsx)(W.$S,{options:[{label:"No color",value:"No color"},...n.filter(e=>"categorical"==h[e].type).map(e=>({label:e,value:e}))],onChange:e=>{s(t=>({...t,g:e.value})),u({type:"set-selected-plot-2d",option:"g",value:e.value,omic:d})},value:{label:o.g,value:o.g},label:"Color by"})})]})},en=n(35843),er=n(22079),ea=n(91797),ei=n(52151),eo=n(91928),el=n(33533),es=n(80565),ec=n(37682),ed=n(666);let eu=(0,en.ZP)(er.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function HelpSectionBottom(){let[e,t]=o.useState(!1),handleClose=()=>{t(!1)};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(j.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,a.jsx)(ed.Z,{fontSize:"inherit"})}),(0,a.jsxs)(eu,{onClose:handleClose,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",sx:{zIndex:1e5},children:[(0,a.jsx)(ea.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Principal Component Analysis (PCA)"}),(0,a.jsx)(j.Z,{"aria-label":"close",onClick:handleClose,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,a.jsx)(el.default,{})}),(0,a.jsxs)(ei.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,a.jsx)(h.Z,{gutterBottom:!0,children:"This section allows users to explore and interpret the principal components of your omic data, helping to reveal patterns and reduce data dimensionality. The PCA section is organized by omic type, and users can navigate between different omics using the Omic Selector button at the top. Each omic subsection includes the following components:"}),(0,a.jsx)(i.Z,{sx:{pl:3},children:(0,a.jsxs)(es.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",border:"0px solid red"},children:[(0,a.jsx)("strong",{children:"Statistical Summary Table"}),(0,a.jsxs)(es.Z,{sx:{listStyleType:"disc",listStyle:"outside"},children:[(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Principal Components"}),": The first row of the table displays the percentage of variability explained by each of the first ten principal components. This helps users understand how much of the total data variance is captured by each component."]}),(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Regression p-values"}),": For each variable in your Experimental Metadata table, a row is included that shows the regression p-value between that variable and each principal component. These values indicate the strength of the relationship between the principal components and your experimental conditions, helping to identify significant associations."]})]})]}),(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",border:"0px solid red"},children:[(0,a.jsx)("strong",{children:"Visualization Panes"}),(0,a.jsxs)(es.Z,{sx:{listStyleType:"disc",listStyle:"outside"},children:[(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Left Pane: Sample Projection Scatter Plot"}),(0,a.jsxs)(es.Z,{sx:{listStyleType:"disc",listStyle:"none"},children:[(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"2D View"}),": This scatter plot shows the sample projections on two selected principal components. Users can choose which components to display on the X and Y axes. The points on the plot can be color-coded based on different grouping criteria, such as experimental conditions or metadata categories."]}),(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"1D View"}),": Here, the Y axis represents a single principal component, while the X axis shows the group to which each sample belongs. This view allows users to easily compare the distribution of samples across different groups within a single principal component."]})]})]}),(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Right Pane: Principal Component Loadings"}),(0,a.jsx)(es.Z,{sx:{listStyleType:"disc",listStyle:"none"},children:(0,a.jsx)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:"This pane displays the loadings of each biomolecule on the selected principal components. The loadings indicate the contribution of each biomolecule to the principal components, helping to identify which variables are most influential in driving the observed patterns."})})]})]})]})]})})]}),(0,a.jsx)(eo.Z,{})]})]})}function PCAOmic(e){let{omic:t}=e,n=(0,o.useRef)(null),{API_URL:j}=(0,s.S)(),Z=(0,U.mX)(),A=(0,U.a0)().EDA.PCA[t].status,[k,D]=(0,o.useState)(A),F=(0,U.a0)().EDA.PCA[t].data,[_,V]=(0,o.useState)(F),{projections:R,loadings:I,explained_variance:H,anova:q}=_,{mdata:$}=(0,c.tc)().user,{mdataType:W}=(0,c.tc)(),{jobID:Y}=(0,c.tc)(),{displayOpts:J}=(0,U.a0)().EDA.PCA[t],[ee,et]=(0,o.useState)(J.scatterMode),[en,er]=(0,o.useState)(J.selectedPlot),[ea,ei]=(0,o.useState)(J.selectedPlot2D),eo=(0,o.useCallback)(async()=>{console.log("Fetching data");let e=await fetch("".concat(j,"/get_eda_pca/").concat(Y,"/").concat(t)),{resStatus:a,dataPCA:i}=await e.json();console.log(a),"waiting"!=a.status&&(console.log("Status changed: ".concat(JSON.stringify(a))),V(i),D(a),Z({type:"set-eda-pca-data",data:i,omic:t}),Z({type:"set-eda-pca-status",status:a,omic:t}),clearInterval(n.current))},[j,Y,t,Z,n]);(0,o.useEffect)(()=>{if("waiting"==k.status)return console.log("Get data from server"),n.current=setInterval(eo,2e3),()=>clearInterval(n.current)},[n,eo,k.status]);let{pvTable:el,pvRowNames:es,pvColNames:ec,pvExpVar:ed}=(0,o.useMemo)(()=>getMainData(q,H,$,k),[q,H,$,k]),eu=(0,o.useMemo)(()=>getScatterData(R,$,W,en,ea,k,ee),[R,$,W,en,ea,k,ee]),ep=(0,o.useMemo)(()=>getSelectedLoadings(I,en,ea,k,ee),[I,en,ea,k,ee]);return(0,a.jsx)(i.Z,{children:"ok"==k.status?(0,a.jsxs)(i.Z,{sx:{padding:.2,transition:"all 1s ease"},children:[(0,a.jsx)(i.Z,{sx:{margin:"auto",pt:3,width:"90%"},children:(0,a.jsx)(TablePvalues,{omic:t,data:el,rowNames:es,colNames:ec,expVar:ed,setSelectedPlot:er,scatterMode:ee})}),(0,a.jsx)(i.Z,{sx:{height:0,mt:5},children:(0,a.jsx)(HelpSectionBottom,{})}),(0,a.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"space-evenly",alignItems:"center"},children:[(0,a.jsx)(i.Z,{sx:{width:"45%",mt:4,overflowX:"auto"},children:(0,a.jsxs)(i.Z,{sx:{width:600,margin:"auto"},children:[(0,a.jsx)(i.Z,{sx:{textAlign:"center",mt:2},children:(0,a.jsx)(i.Z,{sx:{mb:2},children:(0,a.jsxs)(d.Z,{color:"primary",value:ee,exclusive:!0,onChange:(e,n)=>{et(e.target.value),Z({type:"set-scatter-mode",mode:e.target.value,omic:t})},"aria-label":"Platform",children:[(0,a.jsx)(u.Z,{value:"1D",children:"1D"}),(0,a.jsx)(u.Z,{value:"2D",children:"2D"})]})})}),(0,a.jsx)(i.Z,{sx:{textAlign:"center"},children:"1D"==ee?(0,a.jsx)(i.Z,{sx:{height:75,pt:3},children:(0,a.jsx)(h.Z,{variant:"body1",children:"Select a p-value cell to plot PCA"})}):(0,a.jsx)(PCA_SelectorPCA2D,{pvColNames:ec,pvRowNames:es,selectedPlot2D:ea,setSelectedPlot2D:ei,omic:t})}),eu&&(0,a.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center"},children:"1D"==ee?(0,a.jsx)(N.T3,{omic:t,scatterData:eu,mdataCol:en.mdataCol,PCA:en.PCA}):(0,a.jsx)(N.$Y,{omic:t,scatterData:eu,selectedPlot2D:ea})})]})}),(0,a.jsx)(i.Z,{sx:{width:"45%"},children:ep&&(0,a.jsx)(i.Z,{sx:{marginTop:5,textAlign:"center"},children:(0,a.jsx)(TableLoadings,{omic:t,selectedLoadings:ep,selectedPCA:"1D"==ee?[en.PCA]:[ea.x,ea.y]})})})]})]}):(0,a.jsx)(i.Z,{sx:{textAlign:"center",pt:15,height:"30vh"},children:(0,a.jsx)(x.Z,{size:100,thickness:2})})})}let getMainData=(e,t,n,a)=>{let i,o,s,c,d;if("ok"==a.status){i=n.columns.map(t=>Object.keys(e).map(n=>[t,parseInt(n),e[n][t]]));for(let e=0;e<i.length;e++)i[e].sort((e,t)=>e[1]-t[1]);s=(i=i.filter(e=>!e.map(e=>0==Object.keys(e[2]).length).every(e=>e))).map(e=>e[0][0]),c=i[0].map(e=>e[1]),o=i.map(e=>e.map(e=>e[2].pvalue)),d=Object.keys(t).map(e=>(100*t[e].Explained_Variance).toFixed(1))}return{pvTable:o,pvRowNames:s,pvColNames:c,pvExpVar:d}},getScatterData=(e,t,n,a,i,o,s)=>{let c=null;if("ok"==o.status&&"1D"==s&&a){let i=t.column(a.mdataCol);c=Object.keys(e).map(t=>({element:t,projection:e[t][a.PCA],mdataValue:i.values[i.index.indexOf(t)]})),"categorical"==n[a.mdataCol].type&&c.sort((e,t)=>n[a.mdataCol].levels.indexOf(e.mdataValue)-n[a.mdataCol].levels.indexOf(t.mdataValue))}else"ok"==o.status&&"2D"==s&&i&&(Object.keys(n).includes(i.g)?(c={},n[i.g].levels.map(t=>{c[t]=[],n[i.g].level2id[t].map(n=>{Object.keys(e).includes(n)&&c[t].push({element:n,x:e[n][i.x],y:e[n][i.y]})})})):c={[i.g]:Object.keys(e).map(t=>({element:t,x:e[t][i.x],y:e[t][i.y]}))});return c},getSelectedLoadings=(e,t,n,a,i)=>{let o=null;return"ok"==a.status&&"1D"==i&&t?(o={},Object.keys(e).map(n=>{o[n]=[parseFloat(e[n][t.PCA].toFixed(5))]})):"ok"==a.status&&"2D"==i&&(o={},Object.keys(e).map(t=>{o[t]=[parseFloat(e[t][n.x].toFixed(5)),parseFloat(e[t][n.y].toFixed(5))]})),o};n(65897);var ep=n(36661);let eh=(0,en.ZP)(er.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function HelpSection(){let[e,t]=o.useState(!1),handleClose=()=>{t(!1)};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(j.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,a.jsx)(ed.Z,{fontSize:"inherit"})}),(0,a.jsxs)(eh,{onClose:handleClose,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",sx:{zIndex:1e4},children:[(0,a.jsx)(ea.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Principal Component Analysis (PCA)"}),(0,a.jsx)(j.Z,{"aria-label":"close",onClick:handleClose,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,a.jsx)(el.default,{})}),(0,a.jsxs)(ei.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,a.jsxs)(h.Z,{gutterBottom:!0,children:["This section allows users to explore and interpret the principal components of your omic data, helping to reveal patterns and reduce data dimensionality. The PCA section is organized by omic type, and users can navigate between different omics using the Omic Selector button at the top. Each omic subsection includes a ",(0,a.jsx)("strong",{children:"Statistical Summary Table"}),":"]}),(0,a.jsx)(i.Z,{sx:{pl:3},children:(0,a.jsxs)(es.Z,{sx:{listStyleType:"disc",listStyle:"outside"},children:[(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Principal Components"}),": The first row of the table displays the percentage of variability explained by each of the first ten principal components. This helps users understand how much of the total data variance is captured by each component."]}),(0,a.jsxs)(ec.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Regression p-values"}),": For each variable in your Experimental Metadata table, a row is included that shows the regression p-value between that variable and each principal component. These values indicate the strength of the relationship between the principal components and your experimental conditions, helping to identify significant associations."]})]})})]}),(0,a.jsx)(eo.Z,{})]})]})}function PCA(){let{omics:e}=(0,c.tc)(),[t,n]=(0,o.useState)(e[0]),s=(0,o.useRef)();return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(i.Z,{sx:{position:"absolute"},children:(0,a.jsx)(HelpSection,{})}),(0,a.jsx)(ep.Z,{selOmic:t,setSelOmic:n,omicViewRef:s}),(0,a.jsx)(i.Z,{ref:s,sx:{overflow:"hidden"},children:(0,a.jsx)(i.Z,{sx:{display:"flex",width:"".concat(e.length,"00%")},children:e.map(n=>(0,a.jsx)(i.Z,{sx:{width:"".concat(100/e.length,"%"),opacity:n==t?1:0,transition:"all 1s ease"},children:(0,a.jsx)(PCAOmic,{omic:n})},n))})})]})}},55183:function(e,t,n){e.exports=n(89176)},91703:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=(a=n(2265))&&a.__esModule?a:{default:a},s=n(88601),c=n(42280),d=function(e){function CSVDownload(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,CSVDownload);var t=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(CSVDownload.__proto__||Object.getPrototypeOf(CSVDownload)).call(this,e));return t.state={},t}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CSVDownload,e),i(CSVDownload,[{key:"buildURI",value:function(){return s.buildURI.apply(void 0,arguments)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.headers,a=e.separator,i=e.enclosingCharacter,o=e.uFEFF,s=e.target,c=e.specs,d=e.replace;this.state.page=window.open(this.buildURI(t,o,n,a,i),s,c,d)}},{key:"getWindow",value:function(){return this.state.page}},{key:"render",value:function(){return null}}]),CSVDownload}(o.default.Component);d.defaultProps=Object.assign(c.defaultProps,{target:"_blank"}),d.propTypes=c.propTypes,t.default=d},65245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),s=(a=n(2265))&&a.__esModule?a:{default:a},c=n(88601),d=n(42280),u=function(e){function CSVLink(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,CSVLink);var t=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(CSVLink.__proto__||Object.getPrototypeOf(CSVLink)).call(this,e));return t.buildURI=t.buildURI.bind(t),t}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CSVLink,e),o(CSVLink,[{key:"buildURI",value:function(){return c.buildURI.apply(void 0,arguments)}},{key:"handleLegacy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(window.navigator.msSaveOrOpenBlob){e.preventDefault();var n=this.props,a=n.data,i=n.headers,o=n.separator,s=n.filename,d=n.enclosingCharacter,u=n.uFEFF,h=t&&"function"==typeof a?a():a,x=new Blob([u?"\uFEFF":"",(0,c.toCSV)(h,i,o,d)]);return window.navigator.msSaveBlob(x,s),!1}}},{key:"handleAsyncClick",value:function(e){var t=this;this.props.onClick(e,function(n){if(!1===n){e.preventDefault();return}t.handleLegacy(e,!0)})}},{key:"handleSyncClick",value:function(e){if(!1===this.props.onClick(e)){e.preventDefault();return}this.handleLegacy(e)}},{key:"handleClick",value:function(){var e=this;return function(t){if("function"==typeof e.props.onClick)return e.props.asyncOnClick?e.handleAsyncClick(t):e.handleSyncClick(t);e.handleLegacy(t)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.headers,o=t.separator,c=t.filename,d=t.uFEFF,u=t.children,h=(t.onClick,t.asyncOnClick,t.enclosingCharacter),x=function(e,t){var n={};for(var a in e)!(t.indexOf(a)>=0)&&Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(t,["data","headers","separator","filename","uFEFF","children","onClick","asyncOnClick","enclosingCharacter"]),j="undefined"==typeof window?"":this.buildURI(n,d,a,o,h);return s.default.createElement("a",i({download:c},x,{ref:function(t){return e.link=t},target:"_self",href:j,onClick:this.handleClick()}),u)}}]),CSVLink}(s.default.Component);u.defaultProps=d.defaultProps,u.propTypes=d.propTypes,t.default=u},88601:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(!Array.isArray(e))return Array.from(e);for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}var a=t.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},i=t.isJsons=function(e){return Array.isArray(e)&&e.every(function(e){return(void 0===e?"undefined":n(e))==="object"&&!(e instanceof Array)})},o=t.isArrays=function(e){return Array.isArray(e)&&e.every(function(e){return Array.isArray(e)})},s=t.jsonsHeaders=function(e){return Array.from(e.map(function(e){return Object.keys(e)}).reduce(function(e,t){return new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)))},[]))},c=t.jsons2arrays=function(e,t){var n=t=t||s(e),a=t;return i(t)&&(n=t.map(function(e){return e.label}),a=t.map(function(e){return e.key})),[n].concat(_toConsumableArray(e.map(function(e){return a.map(function(t){return d(t,e)})})))},d=t.getHeaderValue=function(e,t){var n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(e,t,n,a){var i=e[t];if(null!=i)return i;a.splice(1)},t);return void 0===n?e in t?t[e]:"":n},u=t.elementOrEmpty=function(e){return null==e?"":e},h=t.joiner=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'"';return e.filter(function(e){return e}).map(function(e){return e.map(function(e){return u(e)}).map(function(e){return""+n+e+n}).join(t)}).join("\n")},x=t.arrays2csv=function(e,t,n,a){return h(t?[t].concat(_toConsumableArray(e)):e,n,a)},j=t.jsons2csv=function(e,t,n,a){return h(c(e,t),n,a)},Z=t.string2csv=function(e,t,n,a){return t?t.join(n)+"\n"+e:e.replace(/"/g,'""')},A=t.toCSV=function(e,t,n,a){if(i(e))return j(e,t,n,a);if(o(e))return x(e,t,n,a);if("string"==typeof e)return Z(e,t,n);throw TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')};t.buildURI=function(e,t,n,i,o){var s=A(e,n,i,o),c=a()?"application/csv":"text/csv",d=new Blob([t?"\uFEFF":"",s],{type:c}),u="data:"+c+";charset=utf-8,"+(t?"\uFEFF":"")+s,h=window.URL||window.webkitURL;return void 0===h.createObjectURL?u:h.createObjectURL(d)}},89176:function(e,t,n){"use strict";t.CSVLink=void 0;var a=_interopRequireDefault(n(91703)),i=_interopRequireDefault(n(65245));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}a.default,t.CSVLink=i.default},42280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropsNotForwarded=t.defaultProps=t.propTypes=void 0,(a=n(2265))&&a.__esModule;var a,i=n(74275);t.propTypes={data:(0,i.oneOfType)([i.string,i.array,i.func]).isRequired,headers:i.array,target:i.string,separator:i.string,filename:i.string,uFEFF:i.bool,onClick:i.func,asyncOnClick:i.bool,enclosingCharacter:i.string},t.defaultProps={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},t.PropsNotForwarded=["data","headers"]},92069:function(e,t,n){"use strict";n.d(t,{LR:function(){return LW},gB:function(){return BW},iL:function(){return G}}),(a=i||(i={})).csv="text/csv",a.tsv="text/tab-separated-values",a.plain="text/plain";var a,i,X=e=>e,z=e=>e,o={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,fileExtension:"csv",mediaType:i.csv,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},G=e=>Object.assign({},o,e);let K=class K extends Error{constructor(e){super(e),this.name="CsvGenerationError"}};let B=class B extends Error{constructor(e){super(e),this.name="EmptyHeadersError"}};let L=class L extends Error{constructor(e){super(e),this.name="CsvDownloadEnvironmentError"}};let P=class P extends Error{constructor(e){super(e),this.name="UnsupportedDataFormatError"}};var w=e=>"object"==typeof e?X(e.key):X(e),y=e=>"object"==typeof e?X(e.displayLabel):X(e),T=(e,...t)=>t.reduce((e,t)=>t(e),e),E=e=>t=>e.useBom?X(z(t)+"\uFEFF"):t,M=e=>t=>e.showTitle?S(X(z(t)+e.title))(X("")):t,S=e=>t=>X(z(e)+z(t)+"\r\n"),O=e=>(t,n)=>l(e)(X(z(t)+z(n))),l=e=>t=>X(z(t)+e.fieldSeparator),b=(e,t)=>n=>{if(!e.showColumnHeaders)return n;if(t.length<1)throw new B("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let a=X("");for(let n=0;n<t.length;n++){let i=y(t[n]);a=O(e)(a,v(e,z(i)))}return a=X(z(a).slice(0,-1)),S(n)(a)},C=(e,t,n)=>a=>{let i=a;for(var o=0;o<n.length;o++){let a=X("");for(let i=0;i<t.length;i++){let s=w(t[i]),c=n[o][z(s)];a=O(e)(a,v(e,c))}a=X(z(a).slice(0,-1)),i=S(i)(a)}return i},m=e=>+e===e&&(!isFinite(e)||!!(e%1)),p=(e,t)=>{if(m(t)){if("locale"===e.decimalSeparator)return X(t.toLocaleString());if(e.decimalSeparator)return X(t.toString().replace(".",e.decimalSeparator))}return X(t.toString())},Q=(e,t)=>{let n=t;return(e.quoteStrings||e.fieldSeparator&&t.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&t.indexOf(e.quoteCharacter)>-1||t.indexOf("\n")>-1||t.indexOf("\r")>-1)&&(n=e.quoteCharacter+('"'==e.quoteCharacter&&t.indexOf('"')>-1?t.replace(/"/g,'""'):t)+e.quoteCharacter),X(n)},g=(e,t)=>X(e.boolDisplay[t?"true":"false"]),r=(e,t)=>void 0===t&&void 0!==e.replaceUndefinedWith?Q(e,e.replaceUndefinedWith+""):null===t?Q(e,"null"):Q(e,""),v=(e,t)=>{if("number"==typeof t)return p(e,t);if("string"==typeof t)return Q(e,t);if("boolean"==typeof t&&e.boolDisplay)return g(e,t);if(null==t)return r(e,t);throw new P(`
    typeof ${typeof t} isn't supported. Only number, string, boolean, null and undefined are supported.
    Please convert the data in your object to one of those before generating the CSV.
    `)},BW=e=>t=>{let n=G(e),a=n.useKeysAsHeaders?Object.keys(t[0]):n.columnHeaders,i=T(X(""),E(n),M(n),b(n,a),C(n,a,t));if(z(i).length<1)throw new K("Output is empty. Is your data formatted correctly?");return i},f=e=>t=>{let n=G(e),a=z(t),i=n.useTextFile?"text/plain":n.mediaType;return new Blob([a],{type:`${i};charset=utf8;`})},LW=e=>t=>{if(!window)throw new L("Downloading only supported in a browser environment.");let n=f(e)(t),a=G(e),i=a.useTextFile?"txt":a.fileExtension,o=`${a.filename}.${i}`,s=document.createElement("a");s.download=o,s.href=URL.createObjectURL(n),s.setAttribute("visibility","hidden"),document.body.appendChild(s),s.click(),document.body.removeChild(s)}}}]);