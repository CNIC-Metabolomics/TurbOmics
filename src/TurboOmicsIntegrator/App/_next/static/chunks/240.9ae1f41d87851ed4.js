(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[240],{42568:function(r,n,o){"use strict";var l=o(26314);n.Z=void 0;var h=l(o(80984)),d=o(57437);n.Z=(0,h.default)([(0,d.jsx)("path",{d:"M6.41 6 5 7.41 9.58 12 5 16.59 6.41 18l6-6z"},"0"),(0,d.jsx)("path",{d:"m13 6-1.41 1.41L16.17 12l-4.58 4.59L13 18l6-6z"},"1")],"KeyboardDoubleArrowRight")},43571:function(r){/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */r.exports=function(){"use strict";function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _setPrototypeOf(r,n){return(_setPrototypeOf=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(r,n)}function _construct(r,n,o){return(_construct=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}()?function(r,n,o){var l=[null];l.push.apply(l,n);var h=new(Function.bind.apply(r,l));return o&&_setPrototypeOf(h,o.prototype),h}:Reflect.construct).apply(null,arguments)}function _toConsumableArray(r){return function(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,n){if(r){if("string"==typeof r)return _arrayLikeToArray(r,n);var o=Object.prototype.toString.call(r).slice(8,-1);if("Object"===o&&r.constructor&&(o=r.constructor.name),"Map"===o||"Set"===o)return Array.from(r);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _arrayLikeToArray(r,n)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,n){(null==n||n>r.length)&&(n=r.length);for(var o=0,l=Array(n);o<n;o++)l[o]=r[o];return l}var r,n=Object.hasOwnProperty,o=Object.setPrototypeOf,l=Object.isFrozen,h=Object.getPrototypeOf,d=Object.getOwnPropertyDescriptor,w=Object.freeze,y=Object.seal,S=Object.create,b="undefined"!=typeof Reflect&&Reflect,_=b.apply,R=b.construct;_||(_=function(r,n,o){return r.apply(n,o)}),w||(w=function(r){return r}),y||(y=function(r){return r}),R||(R=function(r,n){return _construct(r,_toConsumableArray(n))});var P=unapply(Array.prototype.forEach),T=unapply(Array.prototype.pop),I=unapply(Array.prototype.push),O=unapply(String.prototype.toLowerCase),k=unapply(String.prototype.toString),N=unapply(String.prototype.match),L=unapply(String.prototype.replace),j=unapply(String.prototype.indexOf),U=unapply(String.prototype.trim),$=unapply(RegExp.prototype.test),K=(r=TypeError,function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return R(r,o)});function unapply(r){return function(n){for(var o=arguments.length,l=Array(o>1?o-1:0),h=1;h<o;h++)l[h-1]=arguments[h];return _(r,n,l)}}function addToSet(r,n,h){h=null!==(d=h)&&void 0!==d?d:O,o&&o(r,null);for(var d,w=n.length;w--;){var y=n[w];if("string"==typeof y){var S=h(y);S!==y&&(l(n)||(n[w]=S),y=S)}r[y]=!0}return r}function clone(r){var o,l=S(null);for(o in r)!0===_(n,r,[o])&&(l[o]=r[o]);return l}function lookupGetter(r,n){for(;null!==r;){var o=d(r,n);if(o){if(o.get)return unapply(o.get);if("function"==typeof o.value)return unapply(o.value)}r=h(r)}return function(r){return console.warn("fallback value for",r),null}}var Y=w(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),X=w(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),J=w(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Q=w(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ee=w(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),et=w(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ei=w(["#text"]),er=w(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),en=w(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),es=w(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),eo=w(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),el=y(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ea=y(/<%[\w\W]*|[\w\W]*%>/gm),eh=y(/\${[\w\W]*}/gm),ed=y(/^data-[\-\w.\u00B7-\uFFFF]+$/),ec=y(/^aria-[\-\w]+$/),eu=y(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),eg=y(/^(?:\w+script|data):/i),ef=y(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),em=y(/^html$/i),ep=y(/^[a-z][.\w]*(-[.\w]+)+$/i),_createTrustedTypesPolicy=function(r,n){if("object"!==_typeof(r)||"function"!=typeof r.createPolicy)return null;var o=null,l="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(l)&&(o=n.currentScript.getAttribute(l));var h="dompurify"+(o?"#"+o:"");try{return r.createPolicy(h,{createHTML:function(r){return r},createScriptURL:function(r){return r}})}catch(r){return console.warn("TrustedTypes policy "+h+" could not be created."),null}};return function createDOMPurify(){var r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,DOMPurify=function(r){return createDOMPurify(r)};if(DOMPurify.version="2.5.8",DOMPurify.removed=[],!o||!o.document||9!==o.document.nodeType)return DOMPurify.isSupported=!1,DOMPurify;var l=o.document,h=o.document,d=o.DocumentFragment,y=o.HTMLTemplateElement,S=o.Node,b=o.Element,_=o.NodeFilter,R=o.NamedNodeMap,ev=void 0===R?o.NamedNodeMap||o.MozNamedAttrMap:R,eC=o.HTMLFormElement,ew=o.DOMParser,ey=o.trustedTypes,eS=b.prototype,eb=lookupGetter(eS,"cloneNode"),e_=lookupGetter(eS,"nextSibling"),eR=lookupGetter(eS,"childNodes"),eP=lookupGetter(eS,"parentNode");if("function"==typeof y){var eE=h.createElement("template");eE.content&&eE.content.ownerDocument&&(h=eE.content.ownerDocument)}var eT=_createTrustedTypesPolicy(ey,l),eM=eT?eT.createHTML(""):"",eI=h,eO=eI.implementation,ex=eI.createNodeIterator,eA=eI.createDocumentFragment,eF=eI.getElementsByTagName,ek=l.importNode,eH={};try{eH=clone(h).documentMode?h.documentMode:{}}catch(r){}var eN={};DOMPurify.isSupported="function"==typeof eP&&eO&&void 0!==eO.createHTMLDocument&&9!==eH;var eD=eu,eB=null,eL=addToSet({},[].concat(_toConsumableArray(Y),_toConsumableArray(X),_toConsumableArray(J),_toConsumableArray(ee),_toConsumableArray(ei))),eV=null,eG=addToSet({},[].concat(_toConsumableArray(er),_toConsumableArray(en),_toConsumableArray(es),_toConsumableArray(eo))),eW=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ez=null,ej=null,eU=!0,e$=!0,eK=!1,eY=!0,eX=!1,eq=!0,eZ=!1,eJ=!1,eQ=!1,e0=!1,e1=!1,e2=!1,e5=!0,e4=!1,e3=!0,e8=!1,e9={},e7=null,e6=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),te=null,tt=addToSet({},["audio","video","img","source","image","track"]),ti=null,tr=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tn="http://www.w3.org/1998/Math/MathML",ts="http://www.w3.org/2000/svg",to="http://www.w3.org/1999/xhtml",tl=to,ta=!1,th=null,td=addToSet({},[tn,ts,to],k),tc=["application/xhtml+xml","text/html"],tu=null,tg=h.createElement("form"),isRegexOrFunction=function(r){return r instanceof RegExp||r instanceof Function},_parseConfig=function(o){tu&&tu===o||(o&&"object"===_typeof(o)||(o={}),o=clone(o),n="application/xhtml+xml"===(r=r=-1===tc.indexOf(o.PARSER_MEDIA_TYPE)?"text/html":o.PARSER_MEDIA_TYPE)?k:O,eB="ALLOWED_TAGS"in o?addToSet({},o.ALLOWED_TAGS,n):eL,eV="ALLOWED_ATTR"in o?addToSet({},o.ALLOWED_ATTR,n):eG,th="ALLOWED_NAMESPACES"in o?addToSet({},o.ALLOWED_NAMESPACES,k):td,ti="ADD_URI_SAFE_ATTR"in o?addToSet(clone(tr),o.ADD_URI_SAFE_ATTR,n):tr,te="ADD_DATA_URI_TAGS"in o?addToSet(clone(tt),o.ADD_DATA_URI_TAGS,n):tt,e7="FORBID_CONTENTS"in o?addToSet({},o.FORBID_CONTENTS,n):e6,ez="FORBID_TAGS"in o?addToSet({},o.FORBID_TAGS,n):{},ej="FORBID_ATTR"in o?addToSet({},o.FORBID_ATTR,n):{},e9="USE_PROFILES"in o&&o.USE_PROFILES,eU=!1!==o.ALLOW_ARIA_ATTR,e$=!1!==o.ALLOW_DATA_ATTR,eK=o.ALLOW_UNKNOWN_PROTOCOLS||!1,eY=!1!==o.ALLOW_SELF_CLOSE_IN_ATTR,eX=o.SAFE_FOR_TEMPLATES||!1,eq=!1!==o.SAFE_FOR_XML,eZ=o.WHOLE_DOCUMENT||!1,e0=o.RETURN_DOM||!1,e1=o.RETURN_DOM_FRAGMENT||!1,e2=o.RETURN_TRUSTED_TYPE||!1,eQ=o.FORCE_BODY||!1,e5=!1!==o.SANITIZE_DOM,e4=o.SANITIZE_NAMED_PROPS||!1,e3=!1!==o.KEEP_CONTENT,e8=o.IN_PLACE||!1,eD=o.ALLOWED_URI_REGEXP||eD,tl=o.NAMESPACE||to,eW=o.CUSTOM_ELEMENT_HANDLING||{},o.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(eW.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(eW.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(eW.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eX&&(e$=!1),e1&&(e0=!0),e9&&(eB=addToSet({},_toConsumableArray(ei)),eV=[],!0===e9.html&&(addToSet(eB,Y),addToSet(eV,er)),!0===e9.svg&&(addToSet(eB,X),addToSet(eV,en),addToSet(eV,eo)),!0===e9.svgFilters&&(addToSet(eB,J),addToSet(eV,en),addToSet(eV,eo)),!0===e9.mathMl&&(addToSet(eB,ee),addToSet(eV,es),addToSet(eV,eo))),o.ADD_TAGS&&(eB===eL&&(eB=clone(eB)),addToSet(eB,o.ADD_TAGS,n)),o.ADD_ATTR&&(eV===eG&&(eV=clone(eV)),addToSet(eV,o.ADD_ATTR,n)),o.ADD_URI_SAFE_ATTR&&addToSet(ti,o.ADD_URI_SAFE_ATTR,n),o.FORBID_CONTENTS&&(e7===e6&&(e7=clone(e7)),addToSet(e7,o.FORBID_CONTENTS,n)),e3&&(eB["#text"]=!0),eZ&&addToSet(eB,["html","head","body"]),eB.table&&(addToSet(eB,["tbody"]),delete ez.tbody),w&&w(o),tu=o)},tf=addToSet({},["mi","mo","mn","ms","mtext"]),tm=addToSet({},["annotation-xml"]),tp=addToSet({},["title","style","font","a","script"]),tv=addToSet({},X);addToSet(tv,J),addToSet(tv,Q);var tC=addToSet({},ee);addToSet(tC,et);var _checkValidNamespace=function(n){var o=eP(n);o&&o.tagName||(o={namespaceURI:tl,tagName:"template"});var l=O(n.tagName),h=O(o.tagName);return!!th[n.namespaceURI]&&(n.namespaceURI===ts?o.namespaceURI===to?"svg"===l:o.namespaceURI===tn?"svg"===l&&("annotation-xml"===h||tf[h]):!!tv[l]:n.namespaceURI===tn?o.namespaceURI===to?"math"===l:o.namespaceURI===ts?"math"===l&&tm[h]:!!tC[l]:n.namespaceURI===to?(o.namespaceURI!==ts||!!tm[h])&&(o.namespaceURI!==tn||!!tf[h])&&!tC[l]&&(tp[l]||!tv[l]):"application/xhtml+xml"===r&&!!th[n.namespaceURI])},_forceRemove=function(r){I(DOMPurify.removed,{element:r});try{r.parentNode.removeChild(r)}catch(n){try{r.outerHTML=eM}catch(n){r.remove()}}},_removeAttribute=function(r,n){try{I(DOMPurify.removed,{attribute:n.getAttributeNode(r),from:n})}catch(r){I(DOMPurify.removed,{attribute:null,from:n})}if(n.removeAttribute(r),"is"===r&&!eV[r]){if(e0||e1)try{_forceRemove(n)}catch(r){}else try{n.setAttribute(r,"")}catch(r){}}},_initDocument=function(n){if(eQ)n="<remove></remove>"+n;else{var o,l,d=N(n,/^[\r\n\t ]+/);l=d&&d[0]}"application/xhtml+xml"===r&&tl===to&&(n='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+n+"</body></html>");var w=eT?eT.createHTML(n):n;if(tl===to)try{o=new ew().parseFromString(w,r)}catch(r){}if(!o||!o.documentElement){o=eO.createDocument(tl,"template",null);try{o.documentElement.innerHTML=ta?eM:w}catch(r){}}var y=o.body||o.documentElement;return(n&&l&&y.insertBefore(h.createTextNode(l),y.childNodes[0]||null),tl===to)?eF.call(o,eZ?"html":"body")[0]:eZ?o.documentElement:y},_createIterator=function(r){return ex.call(r.ownerDocument||r,r,_.SHOW_ELEMENT|_.SHOW_COMMENT|_.SHOW_TEXT|_.SHOW_PROCESSING_INSTRUCTION|_.SHOW_CDATA_SECTION,null,!1)},_isClobbered=function(r){return r instanceof eC&&("string"!=typeof r.nodeName||"string"!=typeof r.textContent||"function"!=typeof r.removeChild||!(r.attributes instanceof ev)||"function"!=typeof r.removeAttribute||"function"!=typeof r.setAttribute||"string"!=typeof r.namespaceURI||"function"!=typeof r.insertBefore||"function"!=typeof r.hasChildNodes)},_isNode=function(r){return"object"===_typeof(S)?r instanceof S:r&&"object"===_typeof(r)&&"number"==typeof r.nodeType&&"string"==typeof r.nodeName},_executeHook=function(r,n,o){eN[r]&&P(eN[r],function(r){r.call(DOMPurify,n,o,tu)})},_sanitizeElements=function(r){if(_executeHook("beforeSanitizeElements",r,null),_isClobbered(r)||$(/[\u0080-\uFFFF]/,r.nodeName))return _forceRemove(r),!0;var o,l=n(r.nodeName);if(_executeHook("uponSanitizeElement",r,{tagName:l,allowedTags:eB}),r.hasChildNodes()&&!_isNode(r.firstElementChild)&&(!_isNode(r.content)||!_isNode(r.content.firstElementChild))&&$(/<[/\w]/g,r.innerHTML)&&$(/<[/\w]/g,r.textContent)||"select"===l&&$(/<template/i,r.innerHTML)||7===r.nodeType||eq&&8===r.nodeType&&$(/<[/\w]/g,r.data))return _forceRemove(r),!0;if(!eB[l]||ez[l]){if(!ez[l]&&_basicCustomElementTest(l)&&(eW.tagNameCheck instanceof RegExp&&$(eW.tagNameCheck,l)||eW.tagNameCheck instanceof Function&&eW.tagNameCheck(l)))return!1;if(e3&&!e7[l]){var h=eP(r)||r.parentNode,d=eR(r)||r.childNodes;if(d&&h)for(var w=d.length,y=w-1;y>=0;--y){var S=eb(d[y],!0);S.__removalCount=(r.__removalCount||0)+1,h.insertBefore(S,e_(r))}}return _forceRemove(r),!0}return r instanceof b&&!_checkValidNamespace(r)||("noscript"===l||"noembed"===l||"noframes"===l)&&$(/<\/no(script|embed|frames)/i,r.innerHTML)?(_forceRemove(r),!0):(eX&&3===r.nodeType&&(o=L(o=r.textContent,el," "),o=L(o,ea," "),o=L(o,eh," "),r.textContent!==o&&(I(DOMPurify.removed,{element:r.cloneNode()}),r.textContent=o)),_executeHook("afterSanitizeElements",r,null),!1)},_isValidAttribute=function(r,n,o){if(e5&&("id"===n||"name"===n)&&(o in h||o in tg))return!1;if(e$&&!ej[n]&&$(ed,n));else if(eU&&$(ec,n));else if(!eV[n]||ej[n]){if(!(_basicCustomElementTest(r)&&(eW.tagNameCheck instanceof RegExp&&$(eW.tagNameCheck,r)||eW.tagNameCheck instanceof Function&&eW.tagNameCheck(r))&&(eW.attributeNameCheck instanceof RegExp&&$(eW.attributeNameCheck,n)||eW.attributeNameCheck instanceof Function&&eW.attributeNameCheck(n))||"is"===n&&eW.allowCustomizedBuiltInElements&&(eW.tagNameCheck instanceof RegExp&&$(eW.tagNameCheck,o)||eW.tagNameCheck instanceof Function&&eW.tagNameCheck(o))))return!1}else if(ti[n]);else if($(eD,L(o,ef,"")));else if(("src"===n||"xlink:href"===n||"href"===n)&&"script"!==r&&0===j(o,"data:")&&te[r]);else if(eK&&!$(eg,L(o,ef,"")));else if(o)return!1;return!0},_basicCustomElementTest=function(r){return"annotation-xml"!==r&&N(r,ep)},_sanitizeAttributes=function(r){_executeHook("beforeSanitizeAttributes",r,null);var o,l,h,d,w=r.attributes;if(!(!w||_isClobbered(r))){var y={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:eV};for(d=w.length;d--;){var S=(o=w[d]).name,b=o.namespaceURI;if(l="value"===S?o.value:U(o.value),h=n(S),y.attrName=h,y.attrValue=l,y.keepAttr=!0,y.forceKeepAttr=void 0,_executeHook("uponSanitizeAttribute",r,y),l=y.attrValue,!y.forceKeepAttr&&(_removeAttribute(S,r),y.keepAttr)){if(!eY&&$(/\/>/i,l)){_removeAttribute(S,r);continue}eX&&(l=L(l,el," "),l=L(l,ea," "),l=L(l,eh," "));var _=n(r.nodeName);if(_isValidAttribute(_,h,l)){if(e4&&("id"===h||"name"===h)&&(_removeAttribute(S,r),l="user-content-"+l),eq&&$(/((--!?|])>)|<\/(style|title)/i,l)){_removeAttribute(S,r);continue}if(eT&&"object"===_typeof(ey)&&"function"==typeof ey.getAttributeType){if(b);else switch(ey.getAttributeType(_,h)){case"TrustedHTML":l=eT.createHTML(l);break;case"TrustedScriptURL":l=eT.createScriptURL(l)}}try{b?r.setAttributeNS(b,S,l):r.setAttribute(S,l),_isClobbered(r)?_forceRemove(r):T(DOMPurify.removed)}catch(r){}}}}_executeHook("afterSanitizeAttributes",r,null)}},_sanitizeShadowDOM=function _sanitizeShadowDOM(r){var n,o=_createIterator(r);for(_executeHook("beforeSanitizeShadowDOM",r,null);n=o.nextNode();)_executeHook("uponSanitizeShadowNode",n,null),_sanitizeElements(n),_sanitizeAttributes(n),n.content instanceof d&&_sanitizeShadowDOM(n.content);_executeHook("afterSanitizeShadowDOM",r,null)};return DOMPurify.sanitize=function(r){var h,w,y,b,_,R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((ta=!r)&&(r="<!-->"),"string"!=typeof r&&!_isNode(r)){if("function"==typeof r.toString){if("string"!=typeof(r=r.toString()))throw K("dirty is not a string, aborting")}else throw K("toString is not a function")}if(!DOMPurify.isSupported){if("object"===_typeof(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof r)return o.toStaticHTML(r);if(_isNode(r))return o.toStaticHTML(r.outerHTML)}return r}if(eJ||_parseConfig(R),DOMPurify.removed=[],"string"==typeof r&&(e8=!1),e8){if(r.nodeName){var P=n(r.nodeName);if(!eB[P]||ez[P])throw K("root node is forbidden and cannot be sanitized in-place")}}else if(r instanceof S)1===(w=(h=_initDocument("<!---->")).ownerDocument.importNode(r,!0)).nodeType&&"BODY"===w.nodeName?h=w:"HTML"===w.nodeName?h=w:h.appendChild(w);else{if(!e0&&!eX&&!eZ&&-1===r.indexOf("<"))return eT&&e2?eT.createHTML(r):r;if(!(h=_initDocument(r)))return e0?null:e2?eM:""}h&&eQ&&_forceRemove(h.firstChild);for(var T=_createIterator(e8?r:h);y=T.nextNode();)(3!==y.nodeType||y!==b)&&(_sanitizeElements(y),_sanitizeAttributes(y),y.content instanceof d&&_sanitizeShadowDOM(y.content),b=y);if(b=null,e8)return r;if(e0){if(e1)for(_=eA.call(h.ownerDocument);h.firstChild;)_.appendChild(h.firstChild);else _=h;return(eV.shadowroot||eV.shadowrootmod)&&(_=ek.call(l,_,!0)),_}var I=eZ?h.outerHTML:h.innerHTML;return eZ&&eB["!doctype"]&&h.ownerDocument&&h.ownerDocument.doctype&&h.ownerDocument.doctype.name&&$(em,h.ownerDocument.doctype.name)&&(I="<!DOCTYPE "+h.ownerDocument.doctype.name+">\n"+I),eX&&(I=L(I,el," "),I=L(I,ea," "),I=L(I,eh," ")),eT&&e2?eT.createHTML(I):I},DOMPurify.setConfig=function(r){_parseConfig(r),eJ=!0},DOMPurify.clearConfig=function(){tu=null,eJ=!1},DOMPurify.isValidAttribute=function(r,o,l){return tu||_parseConfig({}),_isValidAttribute(n(r),n(o),l)},DOMPurify.addHook=function(r,n){"function"==typeof n&&(eN[r]=eN[r]||[],I(eN[r],n))},DOMPurify.removeHook=function(r){if(eN[r])return T(eN[r])},DOMPurify.removeHooks=function(r){eN[r]&&(eN[r]=[])},DOMPurify.removeAllHooks=function(){eN={}},DOMPurify}()}()},79428:function(){},84695:function(r){r.exports=(function a(r,n,o){function s(h,d){if(!n[h]){if(!r[h]){if(l)return l(h,!0);var w=Error("Cannot find module '"+h+"'");throw w.code="MODULE_NOT_FOUND",w}var y=n[h]={exports:{}};r[h][0].call(y.exports,function(n){return s(r[h][1][n]||n)},y,y.exports,a,r,n,o)}return n[h].exports}for(var l=void 0,h=0;h<o.length;h++)s(o[h]);return s})({1:[function(r,n,o){!function(r){"use strict";var o,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,h=Math.ceil,d=Math.floor,w="[BigNumber Error] ",y=w+"Number primitive has more than 15 significant digits: ",S=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function G(r){var n=0|r;return 0<r||r===n?n:n-1}function V(r){for(var n,o,l=1,h=r.length,d=r[0]+"";l<h;){for(o=14-(n=r[l++]+"").length;o--;n="0"+n);d+=n}for(h=d.length;48===d.charCodeAt(--h););return d.slice(0,h+1||1)}function q(r,n){var o,l,h=r.c,d=n.c,w=r.s,y=n.s,S=r.e,b=n.e;if(!w||!y)return null;if(o=h&&!h[0],l=d&&!d[0],o||l)return o?l?0:-y:w;if(w!=y)return w;if(o=w<0,l=S==b,!h||!d)return l?0:!h^o?1:-1;if(!l)return b<S^o?1:-1;for(y=(S=h.length)<(b=d.length)?S:b,w=0;w<y;w++)if(h[w]!=d[w])return h[w]>d[w]^o?1:-1;return S==b?0:b<S^o?1:-1}function Z(r,n,o,l){if(r<n||o<r||r!==(r<0?h(r):d(r)))throw Error(w+(l||"Argument")+("number"==typeof r?r<n||o<r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(r))}function z(r){var n=r.c.length-1;return G(r.e/14)==n&&r.c[n]%2!=0}function W(r,n){return(1<r.length?r.charAt(0)+"."+r.slice(1):r)+(n<0?"e":"e+")+n}function H(r,n,o){var l,h;if(n<0){for(h=o+".";++n;h+=o);r=h+r}else if(++n>(l=r.length)){for(h=o,n-=l;--n;h+=o);r+=h}else n<l&&(r=r.slice(0,n)+"."+r.slice(n));return r}(o=function e(r){var n,o,b,_,R,P,T,I,O,k=A.prototype={constructor:A,toString:null,valueOf:null},N=new A(1),L=20,j=4,U=-7,$=21,K=-1e7,Y=1e7,X=!1,J=1,Q=0,ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},et="0123456789abcdefghijklmnopqrstuvwxyz";function A(r,n){var h,w,S,_,R,P,T,I,O=this;if(!(O instanceof A))return new A(r,n);if(null==n){if(r instanceof A)return O.s=r.s,O.e=r.e,void(O.c=(r=r.c)?r.slice():r);if((P="number"==typeof r)&&0*r==0){if(O.s=1/r<0?(r=-r,-1):1,r===~~r){for(_=0,R=r;10<=R;R/=10,_++);return O.e=_,void(O.c=[r])}I=String(r)}else{if(I=String(r),!l.test(I))return b(O,I,P);O.s=45==I.charCodeAt(0)?(I=I.slice(1),-1):1}-1<(_=I.indexOf("."))&&(I=I.replace(".","")),0<(R=I.search(/e/i))?(_<0&&(_=R),_+=+I.slice(R+1),I=I.substring(0,R)):_<0&&(_=I.length)}else{if(Z(n,2,et.length,"Base"),I=String(r),10==n)return E(O=new A(r instanceof A?r:I),L+O.e+1,j);if(P="number"==typeof r){if(0*r!=0)return b(O,I,P,n);if(O.s=1/r<0?(I=I.slice(1),-1):1,A.DEBUG&&15<I.replace(/^0\.0*|\./,"").length)throw Error(y+r);P=!1}else O.s=45===I.charCodeAt(0)?(I=I.slice(1),-1):1;for(h=et.slice(0,n),_=R=0,T=I.length;R<T;R++)if(0>h.indexOf(w=I.charAt(R))){if("."==w){if(_<R){_=T;continue}}else if(!S&&(I==I.toUpperCase()&&(I=I.toLowerCase())||I==I.toLowerCase()&&(I=I.toUpperCase()))){S=!0,R=-1,_=0;continue}return b(O,String(r),P,n)}-1<(_=(I=o(I,n,10,O.s)).indexOf("."))?I=I.replace(".",""):_=I.length}for(R=0;48===I.charCodeAt(R);R++);for(T=I.length;48===I.charCodeAt(--T););if(I=I.slice(R,++T)){if(T-=R,P&&A.DEBUG&&15<T&&(9007199254740991<r||r!==d(r)))throw Error(y+O.s*r);if(Y<(_=_-R-1))O.c=O.e=null;else if(_<K)O.c=[O.e=0];else{if(O.e=_,O.c=[],R=(_+1)%14,_<0&&(R+=14),R<T){for(R&&O.c.push(+I.slice(0,R)),T-=14;R<T;)O.c.push(+I.slice(R,R+=14));R=14-(I=I.slice(R)).length}else R-=T;for(;R--;I+="0");O.c.push(+I)}}else O.c=[O.e=0]}function i(r,n,o,l){var h,d,w,y,S;if(null==o?o=j:Z(o,0,8),!r.c)return r.toString();if(h=r.c[0],w=r.e,null==n)S=V(r.c),S=1==l||2==l&&(w<=U||$<=w)?W(S,w):H(S,w,"0");else if(d=(r=E(new A(r),n,o)).e,y=(S=V(r.c)).length,1==l||2==l&&(n<=d||d<=U)){for(;y<n;S+="0",y++);S=W(S,d)}else if(n-=w,S=H(S,d,"0"),y<d+1){if(0<--n)for(S+=".";n--;S+="0");}else if(0<(n+=d-y))for(d+1==y&&(S+=".");n--;S+="0");return r.s<0&&h?"-"+S:S}function B(r,n){for(var o,l=1,h=new A(r[0]);l<r.length;l++){if(!(o=new A(r[l])).s){h=o;break}n.call(h,o)&&(h=o)}return h}function D(r,n,o){for(var l=1,h=n.length;!n[--h];n.pop());for(h=n[0];10<=h;h/=10,l++);return(o=l+14*o-1)>Y?r.c=r.e=null:r.c=o<K?[r.e=0]:(r.e=o,n),r}function E(r,n,o,l){var w,y,b,_,R,P,T,I=r.c;if(I){e:{for(w=1,_=I[0];10<=_;_/=10,w++);if((y=n-w)<0)y+=14,b=n,T=(R=I[P=0])/S[w-b-1]%10|0;else if((P=h((y+1)/14))>=I.length){if(!l)break e;for(;I.length<=P;I.push(0));R=T=0,b=(y%=14)-14+(w=1)}else{for(R=_=I[P],w=1;10<=_;_/=10,w++);T=(b=(y%=14)-14+w)<0?0:R/S[w-b-1]%10|0}if(l=l||n<0||null!=I[P+1]||(b<0?R:R%S[w-b-1]),l=o<4?(T||l)&&(0==o||o==(r.s<0?3:2)):5<T||5==T&&(4==o||l||6==o&&(0<y?0<b?R/S[w-b]:0:I[P-1])%10&1||o==(r.s<0?8:7)),n<1||!I[0])return I.length=0,l?(n-=r.e+1,I[0]=S[(14-n%14)%14],r.e=-n||0):I[0]=r.e=0,r;if(0==y?(I.length=P,_=1,P--):(I.length=P+1,_=S[14-y],I[P]=0<b?d(R/S[w-b]%S[b])*_:0),l)for(;;){if(0==P){for(y=1,b=I[0];10<=b;b/=10,y++);for(b=I[0]+=_,_=1;10<=b;b/=10,_++);y!=_&&(r.e++,1e14==I[0]&&(I[0]=1));break}if(I[P]+=_,1e14!=I[P])break;I[P--]=0,_=1}for(y=I.length;0===I[--y];I.pop());}r.e>Y?r.c=r.e=null:r.e<K&&(r.c=[r.e=0])}return r}function F(r){var n,o=r.e;return null===o?r.toString():(n=V(r.c),n=o<=U||$<=o?W(n,o):H(n,o,"0"),r.s<0?"-"+n:n)}return A.clone=e,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(r){var n,o;if(null!=r){if("object"!=typeof r)throw Error(w+"Object expected: "+r);if(r.hasOwnProperty(n="DECIMAL_PLACES")&&(Z(o=r[n],0,1e9,n),L=o),r.hasOwnProperty(n="ROUNDING_MODE")&&(Z(o=r[n],0,8,n),j=o),r.hasOwnProperty(n="EXPONENTIAL_AT")&&((o=r[n])&&o.pop?(Z(o[0],-1e9,0,n),Z(o[1],0,1e9,n),U=o[0],$=o[1]):(Z(o,-1e9,1e9,n),U=-($=o<0?-o:o))),r.hasOwnProperty(n="RANGE")){if((o=r[n])&&o.pop)Z(o[0],-1e9,-1,n),Z(o[1],1,1e9,n),K=o[0],Y=o[1];else{if(Z(o,-1e9,1e9,n),!o)throw Error(w+n+" cannot be zero: "+o);K=-(Y=o<0?-o:o)}}if(r.hasOwnProperty(n="CRYPTO")){if((o=r[n])!==!!o)throw Error(w+n+" not true or false: "+o);if(o){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw X=!o,Error(w+"crypto unavailable");X=o}else X=o}if(r.hasOwnProperty(n="MODULO_MODE")&&(Z(o=r[n],0,9,n),J=o),r.hasOwnProperty(n="POW_PRECISION")&&(Z(o=r[n],0,1e9,n),Q=o),r.hasOwnProperty(n="FORMAT")){if("object"!=typeof(o=r[n]))throw Error(w+n+" not an object: "+o);ee=o}if(r.hasOwnProperty(n="ALPHABET")){if("string"!=typeof(o=r[n])||/^.$|[+-.\s]|(.).*\1/.test(o))throw Error(w+n+" invalid: "+o);et=o}}return{DECIMAL_PLACES:L,ROUNDING_MODE:j,EXPONENTIAL_AT:[U,$],RANGE:[K,Y],CRYPTO:X,MODULO_MODE:J,POW_PRECISION:Q,FORMAT:ee,ALPHABET:et}},A.isBigNumber=function(r){return r instanceof A||r&&!0===r._isBigNumber||!1},A.maximum=A.max=function(){return B(arguments,k.lt)},A.minimum=A.min=function(){return B(arguments,k.gt)},A.random=(_=9007199254740992*Math.random()&2097151?function(){return d(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(r){var n,o,l,y,b,R=0,P=[],T=new A(N);if(null==r?r=L:Z(r,0,1e9),y=h(r/14),X){if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(y*=2));R<y;)9e15<=(b=131072*n[R]+(n[R+1]>>>11))?(o=crypto.getRandomValues(new Uint32Array(2)),n[R]=o[0],n[R+1]=o[1]):(P.push(b%1e14),R+=2);R=y/2}else{if(!crypto.randomBytes)throw X=!1,Error(w+"crypto unavailable");for(n=crypto.randomBytes(y*=7);R<y;)9e15<=(b=281474976710656*(31&n[R])+1099511627776*n[R+1]+4294967296*n[R+2]+16777216*n[R+3]+(n[R+4]<<16)+(n[R+5]<<8)+n[R+6])?crypto.randomBytes(7).copy(n,R):(P.push(b%1e14),R+=7);R=y/7}}if(!X)for(;R<y;)(b=_())<9e15&&(P[R++]=b%1e14);for(y=P[--R],r%=14,y&&r&&(b=S[14-r],P[R]=d(y/b)*b);0===P[R];P.pop(),R--);if(R<0)P=[l=0];else{for(l=-1;0===P[0];P.splice(0,1),l-=14);for(R=1,b=P[0];10<=b;b/=10,R++);R<14&&(l-=14-R)}return T.e=l,T.c=P,T}),A.sum=function(){for(var r=1,n=arguments,o=new A(n[0]);r<n.length;)o=o.plus(n[r++]);return o},o=function(){var r="0123456789";function m(r,n,o,l){for(var h,d,w=[0],y=0,S=r.length;y<S;){for(d=w.length;d--;w[d]*=n);for(w[0]+=l.indexOf(r.charAt(y++)),h=0;h<w.length;h++)w[h]>o-1&&(null==w[h+1]&&(w[h+1]=0),w[h+1]+=w[h]/o|0,w[h]%=o)}return w.reverse()}return function(o,l,h,d,w){var y,S,b,_,R,P,T,I,O=o.indexOf("."),k=L,N=j;for(0<=O&&(_=Q,Q=0,o=o.replace(".",""),P=(I=new A(l)).pow(o.length-O),Q=_,I.c=m(H(V(P.c),P.e,"0"),10,h,r),I.e=I.c.length),b=_=(T=m(o,l,h,w?(y=et,r):(y=r,et))).length;0==T[--_];T.pop());if(!T[0])return y.charAt(0);if(O<0?--b:(P.c=T,P.e=b,P.s=d,T=(P=n(P,I,k,N,h)).c,R=P.r,b=P.e),O=T[S=b+k+1],_=h/2,R=R||S<0||null!=T[S+1],R=N<4?(null!=O||R)&&(0==N||N==(P.s<0?3:2)):_<O||O==_&&(4==N||R||6==N&&1&T[S-1]||N==(P.s<0?8:7)),S<1||!T[0])o=R?H(y.charAt(1),-k,y.charAt(0)):y.charAt(0);else{if(T.length=S,R)for(--h;++T[--S]>h;)T[S]=0,S||(++b,T=[1].concat(T));for(_=T.length;!T[--_];);for(O=0,o="";O<=_;o+=y.charAt(T[O++]));o=H(o,b,y.charAt(0))}return o}}(),n=function(){function M(r,n,o){var l,h,d,w,y=0,S=r.length,b=n%1e7,_=n/1e7|0;for(r=r.slice();S--;)y=((h=b*(d=r[S]%1e7)+(l=_*d+(w=r[S]/1e7|0)*b)%1e7*1e7+y)/o|0)+(l/1e7|0)+_*w,r[S]=h%o;return y&&(r=[y].concat(r)),r}function B(r,n,o,l){var h,d;if(o!=l)d=l<o?1:-1;else for(h=d=0;h<o;h++)if(r[h]!=n[h]){d=r[h]>n[h]?1:-1;break}return d}function D(r,n,o,l){for(var h=0;o--;)r[o]-=h,h=r[o]<n[o]?1:0,r[o]=h*l+r[o]-n[o];for(;!r[0]&&1<r.length;r.splice(0,1));}return function(r,n,o,l,h){var w,y,S,b,_,R,P,T,I,O,k,N,L,j,U,$,K,Y=r.s==n.s?1:-1,X=r.c,J=n.c;if(!(X&&X[0]&&J&&J[0]))return new A(r.s&&n.s&&(X?!J||X[0]!=J[0]:J)?X&&0==X[0]||!J?0*Y:Y/0:NaN);for(I=(T=new A(Y)).c=[],Y=o+(y=r.e-n.e)+1,h||(h=1e14,y=G(r.e/14)-G(n.e/14),Y=Y/14|0),S=0;J[S]==(X[S]||0);S++);if(J[S]>(X[S]||0)&&y--,Y<0)I.push(1),b=!0;else{for(j=X.length,$=J.length,Y+=2,1<(_=d(h/(J[S=0]+1)))&&(J=M(J,_,h),X=M(X,_,h),$=J.length,j=X.length),L=$,k=(O=X.slice(0,$)).length;k<$;O[k++]=0);K=[0].concat(K=J.slice()),U=J[0],J[1]>=h/2&&U++;do{if(_=0,(w=B(J,O,$,k))<0){if(N=O[0],$!=k&&(N=N*h+(O[1]||0)),1<(_=d(N/U)))for(h<=_&&(_=h-1),P=(R=M(J,_,h)).length,k=O.length;1==B(R,O,P,k);)_--,D(R,$<P?K:J,P,h),P=R.length,w=1;else 0==_&&(w=_=1),P=(R=J.slice()).length;if(P<k&&(R=[0].concat(R)),D(O,R,k,h),k=O.length,-1==w)for(;1>B(J,O,$,k);)_++,D(O,$<k?K:J,k,h),k=O.length}else 0===w&&(_++,O=[0]);I[S++]=_,O[0]?O[k++]=X[L]||0:(O=[X[L]],k=1)}while((L++<j||null!=O[0])&&Y--);b=null!=O[0],I[0]||I.splice(0,1)}if(1e14==h){for(S=1,Y=I[0];10<=Y;Y/=10,S++);E(T,o+(T.e=S+14*y-1)+1,l,b)}else T.e=y,T.r=+b;return T}}(),R=/^(-?)0([xbo])(?=\w[\w.]*$)/i,P=/^([^.]+)\.$/,T=/^\.([^.]+)$/,I=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g,b=function(r,n,o,l){var h,d=o?n:n.replace(O,"");if(I.test(d))r.s=isNaN(d)?null:d<0?-1:1,r.c=r.e=null;else{if(!o&&(d=d.replace(R,function(r,n,o){return h="x"==(o=o.toLowerCase())?16:"b"==o?2:8,l&&l!=h?r:n}),l&&(h=l,d=d.replace(P,"$1").replace(T,"0.$1")),n!=d))return new A(d,h);if(A.DEBUG)throw Error(w+"Not a"+(l?" base "+l:"")+" number: "+n);r.c=r.e=r.s=null}},k.absoluteValue=k.abs=function(){var r=new A(this);return r.s<0&&(r.s=1),r},k.comparedTo=function(r,n){return q(this,new A(r,n))},k.decimalPlaces=k.dp=function(r,n){var o,l,h;if(null!=r)return Z(r,0,1e9),null==n?n=j:Z(n,0,8),E(new A(this),r+this.e+1,n);if(!(o=this.c))return null;if(l=((h=o.length-1)-G(this.e/14))*14,h=o[h])for(;h%10==0;h/=10,l--);return l<0&&(l=0),l},k.dividedBy=k.div=function(r,o){return n(this,new A(r,o),L,j)},k.dividedToIntegerBy=k.idiv=function(r,o){return n(this,new A(r,o),0,1)},k.exponentiatedBy=k.pow=function(r,n){var o,l,y,S,b,_,R,P,T=this;if((r=new A(r)).c&&!r.isInteger())throw Error(w+"Exponent not an integer: "+F(r));if(null!=n&&(n=new A(n)),b=14<r.e,!T.c||!T.c[0]||1==T.c[0]&&!T.e&&1==T.c.length||!r.c||!r.c[0])return P=new A(Math.pow(+F(T),b?2-z(r):+F(r))),n?P.mod(n):P;if(_=r.s<0,n){if(n.c?!n.c[0]:!n.s)return new A(NaN);(l=!_&&T.isInteger()&&n.isInteger())&&(T=T.mod(n))}else{if(9<r.e&&(0<T.e||T.e<-1||(0==T.e?1<T.c[0]||b&&24e7<=T.c[1]:T.c[0]<8e13||b&&T.c[0]<=9999975e7)))return S=T.s<0&&z(r)?-0:0,-1<T.e&&(S=1/S),new A(_?1/S:S);Q&&(S=h(Q/14+2))}for(R=b?(o=new A(.5),_&&(r.s=1),z(r)):(y=Math.abs(+F(r)))%2,P=new A(N);;){if(R){if(!(P=P.times(T)).c)break;S?P.c.length>S&&(P.c.length=S):l&&(P=P.mod(n))}if(y){if(0===(y=d(y/2)))break;R=y%2}else if(E(r=r.times(o),r.e+1,1),14<r.e)R=z(r);else{if(0==(y=+F(r)))break;R=y%2}T=T.times(T),S?T.c&&T.c.length>S&&(T.c.length=S):l&&(T=T.mod(n))}return l?P:(_&&(P=N.div(P)),n?P.mod(n):S?E(P,Q,j,void 0):P)},k.integerValue=function(r){var n=new A(this);return null==r?r=j:Z(r,0,8),E(n,n.e+1,r)},k.isEqualTo=k.eq=function(r,n){return 0===q(this,new A(r,n))},k.isFinite=function(){return!!this.c},k.isGreaterThan=k.gt=function(r,n){return 0<q(this,new A(r,n))},k.isGreaterThanOrEqualTo=k.gte=function(r,n){return 1===(n=q(this,new A(r,n)))||0===n},k.isInteger=function(){return!!this.c&&G(this.e/14)>this.c.length-2},k.isLessThan=k.lt=function(r,n){return 0>q(this,new A(r,n))},k.isLessThanOrEqualTo=k.lte=function(r,n){return -1===(n=q(this,new A(r,n)))||0===n},k.isNaN=function(){return!this.s},k.isNegative=function(){return this.s<0},k.isPositive=function(){return 0<this.s},k.isZero=function(){return!!this.c&&0==this.c[0]},k.minus=function(r,n){var o,l,h,d,w=this.s;if(n=(r=new A(r,n)).s,!w||!n)return new A(NaN);if(w!=n)return r.s=-n,this.plus(r);var y=this.e/14,S=r.e/14,b=this.c,_=r.c;if(!y||!S){if(!b||!_)return b?(r.s=-n,r):new A(_?this:NaN);if(!b[0]||!_[0])return _[0]?(r.s=-n,r):new A(b[0]?this:3==j?-0:0)}if(y=G(y),S=G(S),b=b.slice(),w=y-S){for((h=(d=w<0)?(w=-w,b):(S=y,_)).reverse(),n=w;n--;h.push(0));h.reverse()}else for(l=(d=(w=b.length)<(n=_.length))?w:n,w=n=0;n<l;n++)if(b[n]!=_[n]){d=b[n]<_[n];break}if(d&&(h=b,b=_,_=h,r.s=-r.s),0<(n=(l=_.length)-(o=b.length)))for(;n--;b[o++]=0);for(n=1e14-1;w<l;){if(b[--l]<_[l]){for(o=l;o&&!b[--o];b[o]=n);--b[o],b[l]+=1e14}b[l]-=_[l]}for(;0==b[0];b.splice(0,1),--S);return b[0]?D(r,b,S):(r.s=3==j?-1:1,r.c=[r.e=0],r)},k.modulo=k.mod=function(r,o){var l,h;return r=new A(r,o),this.c&&r.s&&(!r.c||r.c[0])?r.c&&(!this.c||this.c[0])?(9==J?(h=r.s,r.s=1,l=n(this,r,0,3),r.s=h,l.s*=h):l=n(this,r,0,J),(r=this.minus(l.times(r))).c[0]||1!=J||(r.s=this.s),r):new A(this):new A(NaN)},k.multipliedBy=k.times=function(r,n){var o,l,h,d,w,y,S,b,_,R,P,T,I,O=this.c,k=(r=new A(r,n)).c;if(!(O&&k&&O[0]&&k[0]))return this.s&&r.s&&(!O||O[0]||k)&&(!k||k[0]||O)?(r.s*=this.s,O&&k?(r.c=[0],r.e=0):r.c=r.e=null):r.c=r.e=r.s=null,r;for(l=G(this.e/14)+G(r.e/14),r.s*=this.s,(S=O.length)<(R=k.length)&&(I=O,O=k,k=I,h=S,S=R,R=h),h=S+R,I=[];h--;I.push(0));for(h=R;0<=--h;){for(o=0,P=k[h]%1e7,T=k[h]/1e7|0,d=h+(w=S);h<d;)o=((b=P*(b=O[--w]%1e7)+(y=T*b+(_=O[w]/1e7|0)*P)%1e7*1e7+I[d]+o)/1e14|0)+(y/1e7|0)+T*_,I[d--]=b%1e14;I[d]=o}return o?++l:I.splice(0,1),D(r,I,l)},k.negated=function(){var r=new A(this);return r.s=-r.s||null,r},k.plus=function(r,n){var o,l=this.s;if(n=(r=new A(r,n)).s,!l||!n)return new A(NaN);if(l!=n)return r.s=-n,this.minus(r);var h=this.e/14,d=r.e/14,w=this.c,y=r.c;if(!h||!d){if(!w||!y)return new A(l/0);if(!w[0]||!y[0])return y[0]?r:new A(w[0]?this:0*l)}if(h=G(h),d=G(d),w=w.slice(),l=h-d){for((o=0<l?(d=h,y):(l=-l,w)).reverse();l--;o.push(0));o.reverse()}for((l=w.length)-(n=y.length)<0&&(o=y,y=w,w=o,n=l),l=0;n;)l=(w[--n]=w[n]+y[n]+l)/1e14|0,w[n]=1e14===w[n]?0:w[n]%1e14;return l&&(w=[l].concat(w),++d),D(r,w,d)},k.precision=k.sd=function(r,n){var o,l,h;if(null!=r&&!!r!==r)return Z(r,1,1e9),null==n?n=j:Z(n,0,8),E(new A(this),r,n);if(!(o=this.c))return null;if(l=14*(h=o.length-1)+1,h=o[h]){for(;h%10==0;h/=10,l--);for(h=o[0];10<=h;h/=10,l++);}return r&&this.e+1>l&&(l=this.e+1),l},k.shiftedBy=function(r){return Z(r,-9007199254740991,9007199254740991),this.times("1e"+r)},k.squareRoot=k.sqrt=function(){var r,o,l,h,d,w=this.c,y=this.s,S=this.e,b=L+4,_=new A("0.5");if(1!==y||!w||!w[0])return new A(!y||y<0&&(!w||w[0])?NaN:w?this:1/0);if((l=0==(y=Math.sqrt(+F(this)))||y==1/0?(((o=V(w)).length+S)%2==0&&(o+="0"),y=Math.sqrt(+o),S=G((S+1)/2)-(S<0||S%2),new A(o=y==1/0?"1e"+S:(o=y.toExponential()).slice(0,o.indexOf("e")+1)+S)):new A(y+"")).c[0]){for((y=(S=l.e)+b)<3&&(y=0);;)if(d=l,l=_.times(d.plus(n(this,d,b,1))),V(d.c).slice(0,y)===(o=V(l.c)).slice(0,y)){if(l.e<S&&--y,"9999"!=(o=o.slice(y-3,y+1))&&(h||"4999"!=o)){+o&&(+o.slice(1)||"5"!=o.charAt(0))||(E(l,l.e+L+2,1),r=!l.times(l).eq(this));break}if(!h&&(E(d,d.e+L+2,0),d.times(d).eq(this))){l=d;break}b+=4,y+=4,h=1}}return E(l,l.e+L+1,j,r)},k.toExponential=function(r,n){return null!=r&&(Z(r,0,1e9),r++),i(this,r,n,1)},k.toFixed=function(r,n){return null!=r&&(Z(r,0,1e9),r=r+this.e+1),i(this,r,n)},k.toFormat=function(r,n,o){var l;if(null==o)null!=r&&n&&"object"==typeof n?(o=n,n=null):r&&"object"==typeof r?(o=r,r=n=null):o=ee;else if("object"!=typeof o)throw Error(w+"Argument not an object: "+o);if(l=this.toFixed(r,n),this.c){var h,d=l.split("."),y=+o.groupSize,S=+o.secondaryGroupSize,b=o.groupSeparator||"",_=d[0],R=d[1],P=this.s<0,T=P?_.slice(1):_,I=T.length;if(S&&(h=y,y=S,I-=S=h),0<y&&0<I){for(h=I%y||y,_=T.substr(0,h);h<I;h+=y)_+=b+T.substr(h,y);0<S&&(_+=b+T.slice(h)),P&&(_="-"+_)}l=R?_+(o.decimalSeparator||"")+((S=+o.fractionGroupSize)?R.replace(RegExp("\\d{"+S+"}\\B","g"),"$&"+(o.fractionGroupSeparator||"")):R):_}return(o.prefix||"")+l+(o.suffix||"")},k.toFraction=function(r){var o,l,h,d,y,b,_,R,P,T,I,O,k=this.c;if(null!=r&&(!(_=new A(r)).isInteger()&&(_.c||1!==_.s)||_.lt(N)))throw Error(w+"Argument "+(_.isInteger()?"out of range: ":"not an integer: ")+F(_));if(!k)return new A(this);for(o=new A(N),P=l=new A(N),h=R=new A(N),O=V(k),y=o.e=O.length-this.e-1,o.c[0]=S[(b=y%14)<0?14+b:b],r=!r||0<_.comparedTo(o)?0<y?o:P:_,b=Y,Y=1/0,_=new A(O),R.c[0]=0;T=n(_,o,0,1),1!=(d=l.plus(T.times(h))).comparedTo(r);)l=h,h=d,P=R.plus(T.times(d=P)),R=d,o=_.minus(T.times(d=o)),_=d;return d=n(r.minus(l),h,0,1),R=R.plus(d.times(P)),l=l.plus(d.times(h)),R.s=P.s=this.s,I=1>n(P,h,y*=2,j).minus(this).abs().comparedTo(n(R,l,y,j).minus(this).abs())?[P,h]:[R,l],Y=b,I},k.toNumber=function(){return+F(this)},k.toPrecision=function(r,n){return null!=r&&Z(r,1,1e9),i(this,r,n,2)},k.toString=function(r){var n,l=this,h=l.s,d=l.e;return null===d?h?(n="Infinity",h<0&&(n="-"+n)):n="NaN":(n=null==r?d<=U||$<=d?W(V(l.c),d):H(V(l.c),d,"0"):10===r?H(V((l=E(new A(l),L+d+1,j)).c),l.e,"0"):(Z(r,2,et.length,"Base"),o(H(V(l.c),d,"0"),10,r,h,!0)),h<0&&l.c[0]&&(n="-"+n)),n},k.valueOf=k.toJSON=function(){return F(this)},k._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(k[Symbol.toStringTag]="BigNumber",k[Symbol.for("nodejs.util.inspect.custom")]=k.valueOf),null!=r&&A.set(r),A}()).default=o.BigNumber=o,void 0!==n&&n.exports?n.exports=o:(r||(r="undefined"!=typeof self&&self?self:window),r.BigNumber=o)}(this)},{}],2:[function(r,n,o){"use strict";n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(r){var n=r%10;return 1==~~(r%100/10)?"th":1===n?"st":2===n?"nd":3===n?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){"use strict";function C(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var o=[],l=!0,h=!1,d=void 0;try{for(var w,y=r[Symbol.iterator]();!(l=(w=y.next()).done)&&(o.push(w.value),!n||o.length!==n);l=!0);}catch(r){h=!0,d=r}finally{try{l||null==y.return||y.return()}finally{if(h)throw d}}return o}(r,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance")}()}var l=r("./globalState"),h=r("./validating"),d=r("./parsing"),w=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],y={general:{scale:1024,suffixes:w,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:w,marker:"d"}},S={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0;if("string"==typeof n&&(n=d.parseFormat(n)),!h.validateFormat(n))return"ERROR: invalid format";var w=n.prefix||"",b=n.postfix||"",_=function(r,n,o){var h,d,w,b,_,R,P,T,I,O,k,N,L,j,U,$,K,Y,X,J,Q,ee,et,ei,er,en,es,eo;switch(n.output){case"currency":return $=n=A(n,l.currentCurrencyDefaultFormat()),K=l.currentCurrency(),Y=Object.assign({},S,$),X=void 0,J="",Q=!!Y.totalLength||!!Y.forceAverage||Y.average,ee=$.currencyPosition||K.position,et=$.currencySymbol||K.symbol,Y.spaceSeparated&&(J=" "),"infix"===ee&&(X=J+et+J),ei=D({instance:r,providedFormat:$,state:l,decimalSeparator:X}),"prefix"===ee&&(ei=r._value<0&&"sign"===Y.negative?"-".concat(J).concat(et).concat(ei.slice(1)):et+J+ei),ee&&"postfix"!==ee||(ei=ei+(J=Q?"":J)+et),ei;case"percent":return en=(er=n=A(n,l.currentPercentageDefaultFormat())).prefixSymbol,es=D({instance:o(100*r._value),providedFormat:er,state:l}),eo=Object.assign({},S,er),en?"%".concat(eo.spaceSeparated?" ":"").concat(es):"".concat(es).concat(eo.spaceSeparated?" ":"","%");case"byte":return O=y[(I=n=A(n,l.currentByteDefaultFormat())).base||"binary"],N=(k=B(r._value,O.suffixes,O.scale)).value,L=k.suffix,j=D({instance:o(N),providedFormat:I,state:l,defaults:l.currentByteDefaultFormat()}),U=l.currentAbbreviations(),"".concat(j).concat(U.spaced?" ":"").concat(L);case"time":return n=A(n,l.currentTimeDefaultFormat()),R=Math.floor(r._value/60/60),P=Math.floor((r._value-60*R*60)/60),T=Math.round(r._value-60*R*60-60*P),"".concat(R,":").concat(P<10?"0":"").concat(P,":").concat(T<10?"0":"").concat(T);case"ordinal":return h=n=A(n,l.currentOrdinalDefaultFormat()),d=l.currentOrdinal(),w=Object.assign({},S,h),b=D({instance:r,providedFormat:h,state:l}),_=d(r._value),"".concat(b).concat(w.spaceSeparated?" ":"").concat(_);default:return D({instance:r,providedFormat:n,numbro:o})}}(r,n,o);return(_=w+_)+b}function B(r,n,o){var l=n[0],h=Math.abs(r);if(o<=h){for(var d=1;d<n.length;++d){var w=Math.pow(o,d),y=Math.pow(o,d+1);if(w<=h&&h<y){l=n[d],r/=w;break}}l===n[0]&&(r/=Math.pow(o,n.length-1),l=n[n.length-1])}return{value:r,suffix:l}}function p(r){for(var n="",o=0;o<r;o++)n+="0";return n}function D(r){var n,o,h,d,w,y,b,_,R,P=r.instance,T=r.providedFormat,I=r.state,O=void 0===I?l:I,k=r.decimalSeparator,N=r.defaults,L=void 0===N?O.currentDefaults():N,j=P._value;if(0===j&&O.hasZeroFormat())return O.getZeroFormat();if(!isFinite(j))return j.toString();var U,$,K,Y,X,J,Q,ee,et=Object.assign({},S,L,T),ei=et.totalLength,er=ei?0:et.characteristic,en=et.optionalCharacteristic,es=et.forceAverage,eo=!!ei||!!es||et.average,el=ei?-1:eo&&void 0===T.mantissa?0:et.mantissa,ea=!ei&&(void 0===T.optionalMantissa?-1===el:et.optionalMantissa),eh=et.trimMantissa,ed=et.thousandSeparated,ec=et.spaceSeparated,eu=et.negative,eg=et.forceSign,ef=et.exponential,em="";if(eo){var ep,ev,eC,ew,ey,eS,eb,e_,eR,eP,eE=(ev=(ep={value:j,forceAverage:es,abbreviations:O.currentAbbreviations(),spaceSeparated:ec,totalLength:ei}).value,eC=ep.forceAverage,ew=ep.abbreviations,ey=ep.spaceSeparated,eb=void 0===(eS=ep.totalLength)?0:eS,e_="",eP=-1,(eR=Math.abs(ev))>=1e12&&!eC||"trillion"===eC?(e_=ew.trillion,ev/=1e12):eR<1e12&&eR>=1e9&&!eC||"billion"===eC?(e_=ew.billion,ev/=1e9):eR<1e9&&eR>=1e6&&!eC||"million"===eC?(e_=ew.million,ev/=1e6):(eR<1e6&&eR>=1e3&&!eC||"thousand"===eC)&&(e_=ew.thousand,ev/=1e3),e_&&(e_=(void 0!==ey&&ey?" ":"")+e_),eb&&(eP=Math.max(eb-ev.toString().split(".")[0].length,0)),{value:ev,abbreviation:e_,mantissaPrecision:eP});j=eE.value,em+=eE.abbreviation,ei&&(el=eE.mantissaPrecision)}if(ef){var eT=($=(U={value:j,characteristicPrecision:er}).value,Y=void 0===(K=U.characteristicPrecision)?0:K,J=(X=C($.toExponential().split("e"),2))[0],Q=X[1],ee=+J,Y&&1<Y&&(ee*=Math.pow(10,Y-1),Q=0<=(Q=+Q-(Y-1))?"+".concat(Q):Q),{value:ee,abbreviation:"e".concat(Q)});j=eT.value,em=eT.abbreviation+em}var eM,eI,eO=function(r,n,o,l,h){if(-1===l)return r;var d=-1!==n.toString().indexOf("e")?function(r,n){var o=r.toString(),l=C(o.split("e"),2),h=l[0],d=l[1],w=C(h.split("."),2),y=w[0],S=w[1],b=void 0===S?"":S;if(0<+d)o=y+b+p(d-b.length);else{var _=".";_=0>+y?"-0".concat(_):"0".concat(_);var R=(p(-d-1)+Math.abs(y)+b).substr(0,n);R.length<n&&(R+=p(n-R.length)),o=_+R}return 0<+d&&0<n&&(o+=".".concat(p(n))),o}(n,l):(Math.round(+"".concat(n,"e+").concat(l))/Math.pow(10,l)).toFixed(l),w=C(d.toString().split("."),2),y=w[0],S=w[1],b=void 0===S?"":S;if(b.match(/^0+$/)&&(o||h))return y;var _=b.match(/0+$/);return h&&_?"".concat(y,".").concat(b.toString().slice(0,_.index)):d.toString()}(j.toString(),j,ea,el,eh);return n=eO=function(r,n,o,l){var h=r,d=C(h.toString().split("."),2),w=d[0],y=d[1];if(w.match(/^-?0$/)&&o)return y?"".concat(w.replace("0",""),".").concat(y):w.replace("0","");if(w.length<l)for(var S=l-w.length,b=0;b<S;b++)h="0".concat(h);return h.toString()}(eO,0,en,er),o=j,h=k,w=(d=O.currentDelimiters()).thousands,h=h||d.decimal,y=d.thousandsSize||3,_=(b=n.toString()).split(".")[0],R=b.split(".")[1],ed&&(o<0&&(_=_.slice(1)),(function(r,n){for(var o=[],l=0,h=r;0<h;h--)l===n&&(o.unshift(h),l=0),l++;return o})(_.length,y).forEach(function(r,n){_=_.slice(0,r+n)+w+_.slice(r+n)}),o<0&&(_="-".concat(_))),eO=b=R?_+h+R:_,(eo||ef)&&(eO+=em),(eg||j<0)&&(eM=eO,eO=0===(eI=j)?eM:0==+eM?eM.replace("-",""):0<eI?"+".concat(eM):"sign"===eu?eM:"(".concat(eM.replace("-",""),")")),eO}function A(r,n){if(!r)return n;var o=Object.keys(r);return 1===o.length&&"output"===o[0]?n:r}n.exports=function(r){return{format:function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return i.apply(void 0,o.concat([r]))},getByteUnit:function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return(function(r){var n=y.general;return B(r._value,n.suffixes,n.scale).suffix}).apply(void 0,o.concat([r]))},getBinaryByteUnit:function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return(function(r){var n=y.binary;return B(r._value,n.suffixes,n.scale).suffix}).apply(void 0,o.concat([r]))},getDecimalByteUnit:function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return(function(r){var n=y.decimal;return B(r._value,n.suffixes,n.scale).suffix}).apply(void 0,o.concat([r]))},formatOrDefault:A}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){"use strict";var l=r("./en-US"),h=r("./validating"),d=r("./parsing"),w={},y=void 0,S={},b=null,_={};function p(){return S[y]}w.languages=function(){return Object.assign({},S)},w.currentLanguage=function(){return y},w.currentCurrency=function(){return p().currency},w.currentAbbreviations=function(){return p().abbreviations},w.currentDelimiters=function(){return p().delimiters},w.currentOrdinal=function(){return p().ordinal},w.currentDefaults=function(){return Object.assign({},p().defaults,_)},w.currentOrdinalDefaultFormat=function(){return Object.assign({},w.currentDefaults(),p().ordinalFormat)},w.currentByteDefaultFormat=function(){return Object.assign({},w.currentDefaults(),p().byteFormat)},w.currentPercentageDefaultFormat=function(){return Object.assign({},w.currentDefaults(),p().percentageFormat)},w.currentCurrencyDefaultFormat=function(){return Object.assign({},w.currentDefaults(),p().currencyFormat)},w.currentTimeDefaultFormat=function(){return Object.assign({},w.currentDefaults(),p().timeFormat)},w.setDefaults=function(r){r=d.parseFormat(r),h.validateFormat(r)&&(_=r)},w.getZeroFormat=function(){return b},w.setZeroFormat=function(r){return b="string"==typeof r?r:null},w.hasZeroFormat=function(){return null!==b},w.languageData=function(r){if(r){if(S[r])return S[r];throw Error('Unknown tag "'.concat(r,'"'))}return p()},w.registerLanguage=function(r){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!h.validateLanguage(r))throw Error("Invalid language data");S[r.languageTag]=r,n&&(y=r.languageTag)},w.setLanguage=function(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:l.languageTag;if(!S[r]){var o=r.split("-")[0],h=Object.keys(S).find(function(r){return r.split("-")[0]===o});return S[h]?void(y=h):void(y=n)}y=r},w.registerLanguage(l),y=l.languageTag,n.exports=w},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){"use strict";n.exports=function(n){return{loadLanguagesInNode:function(o){o.forEach(function(o){var l=void 0;try{l=r("../languages/".concat(o))}catch(r){console.error('Unable to load "'.concat(o,'". No matching language file found.'))}l&&n.registerLanguage(l)})}}}},{}],6:[function(r,n,o){"use strict";var l=r("bignumber.js");function a(r,n,o){var h=new l(r._value),d=n;return o.isNumbro(n)&&(d=n._value),d=new l(d),r._value=h.minus(d).toNumber(),r}n.exports=function(r){return{add:function(n,o){var h,d;return h=new l(n._value),d=o,r.isNumbro(o)&&(d=o._value),d=new l(d),n._value=h.plus(d).toNumber(),n},subtract:function(n,o){return a(n,o,r)},multiply:function(n,o){var h,d;return h=new l(n._value),d=o,r.isNumbro(o)&&(d=o._value),d=new l(d),n._value=h.times(d).toNumber(),n},divide:function(n,o){var h,d;return h=new l(n._value),d=o,r.isNumbro(o)&&(d=o._value),d=new l(d),n._value=h.dividedBy(d).toNumber(),n},set:function(n,o){var l;return l=o,r.isNumbro(o)&&(l=o._value),n._value=l,n},difference:function(n,o){var l;return a(l=r(n._value),o,r),Math.abs(l._value)}}}},{"bignumber.js":1}],7:[function(r,n,o){"use strict";function i(r,n){for(var o=0;o<n.length;o++){var l=n[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,l.key,l)}}var l=r("./globalState"),h=r("./validating"),d=r("./loading")(g),w=r("./unformatting"),y=r("./formatting")(g),S=r("./manipulating")(g),b=r("./parsing"),_=function(){var r,n;function t(r){(function(r,n){if(!(r instanceof n))throw TypeError("Cannot call a class as a function")})(this,t),this._value=r}return r=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return y.format(this,r)}},{key:"formatCurrency",value:function(r){return"string"==typeof r&&(r=b.parseFormat(r)),(r=y.formatOrDefault(r,l.currentCurrencyDefaultFormat())).output="currency",y.format(this,r)}},{key:"formatTime",value:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return r.output="time",y.format(this,r)}},{key:"binaryByteUnits",value:function(){return y.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return y.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return y.getByteUnit(this)}},{key:"difference",value:function(r){return S.difference(this,r)}},{key:"add",value:function(r){return S.add(this,r)}},{key:"subtract",value:function(r){return S.subtract(this,r)}},{key:"multiply",value:function(r){return S.multiply(this,r)}},{key:"divide",value:function(r){return S.divide(this,r)}},{key:"set",value:function(r){return S.set(this,p(r))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}],i(t.prototype,r),n&&i(t,n),t}();function p(r){var n=r;return g.isNumbro(r)?n=r._value:"string"==typeof r?n=g.unformat(r):isNaN(r)&&(n=NaN),n}function g(r){return new _(p(r))}g.version="2.1.2",g.isNumbro=function(r){return r instanceof _},g.language=l.currentLanguage,g.registerLanguage=l.registerLanguage,g.setLanguage=l.setLanguage,g.languages=l.languages,g.languageData=l.languageData,g.zeroFormat=l.setZeroFormat,g.defaultFormat=l.currentDefaults,g.setDefaults=l.setDefaults,g.defaultCurrencyFormat=l.currentCurrencyDefaultFormat,g.validate=h.validate,g.loadLanguagesInNode=d.loadLanguagesInNode,g.unformat=w.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){"use strict";n.exports={parseFormat:function(r){var n,o,l,h,d,w,y,S,b,_=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof r?r:(function(r,n){if(-1===r.indexOf("$")){if(-1===r.indexOf("%"))return -1!==r.indexOf("bd")?(n.output="byte",n.base="general"):-1!==r.indexOf("b")?(n.output="byte",n.base="binary"):-1!==r.indexOf("d")?(n.output="byte",n.base="decimal"):-1===r.indexOf(":")?-1!==r.indexOf("o")&&(n.output="ordinal"):n.output="time";n.output="percent"}else n.output="currency"}(r=(h=(l=r=(o=(n=r).match(/^{([^}]*)}/))?(_.prefix=o[1],n.slice(o[0].length)):n).match(/{([^}]*)}$/))?(_.postfix=h[1],l.slice(0,-h[0].length)):l,_),(d=r.match(/[1-9]+[0-9]*/))&&(_.totalLength=+d[0]),(w=r.split(".")[0].match(/0+/))&&(_.characteristic=w[0].length),function(r,n){if(-1!==r.indexOf(".")){var o=r.split(".")[0];n.optionalCharacteristic=-1===o.indexOf("0")}}(r,_),-1!==r.indexOf("a")&&(_.average=!0),-1!==(y=r).indexOf("K")?_.forceAverage="thousand":-1!==y.indexOf("M")?_.forceAverage="million":-1!==y.indexOf("B")?_.forceAverage="billion":-1!==y.indexOf("T")&&(_.forceAverage="trillion"),function(r,n){var o=r.split(".")[1];if(o){var l=o.match(/0+/);l&&(n.mantissa=l[0].length)}}(r,_),(S=r).match(/\[\.]/)?_.optionalMantissa=!0:S.match(/\./)&&(_.optionalMantissa=!1),-1!==r.indexOf(",")&&(_.thousandSeparated=!0),-1!==r.indexOf(" ")&&(_.spaceSeparated=!0),(b=r).match(/^\+?\([^)]*\)$/)&&(_.negative="parenthesis"),b.match(/^\+?-/)&&(_.negative="sign"),r.match(/^\+/)&&(_.forceSign=!0),_)}}},{}],9:[function(r,n,o){"use strict";var l=[{key:"ZiB",factor:11805916207174113e5},{key:"ZB",factor:1e21},{key:"YiB",factor:12089258196146292e8},{key:"YB",factor:1e24},{key:"TiB",factor:1099511627776},{key:"TB",factor:1e12},{key:"PiB",factor:0x4000000000000},{key:"PB",factor:1e15},{key:"MiB",factor:1048576},{key:"MB",factor:1e6},{key:"KiB",factor:1024},{key:"KB",factor:1e3},{key:"GiB",factor:1073741824},{key:"GB",factor:1e9},{key:"EiB",factor:0x1000000000000000},{key:"EB",factor:1e18},{key:"B",factor:1}];function x(r){return r.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}n.exports={unformat:function(n,o){var h,d,w,y=r("./globalState"),S=y.currentDelimiters(),b=y.currentCurrency().symbol,_=y.currentOrdinal(),R=y.getZeroFormat(),P=y.currentAbbreviations(),T=void 0;if("string"==typeof n)T=!function(r,n){if(!r.indexOf(":")||":"===n.thousands)return!1;var o=r.split(":");if(3!==o.length)return!1;var l=+o[0],h=+o[1],d=+o[2];return!isNaN(l)&&!isNaN(h)&&!isNaN(d)}(n,S)?function(r,n){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,w=5<arguments.length?arguments[5]:void 0,y=6<arguments.length?arguments[6]:void 0;if(""!==r)return r===d?0:function e(r,n){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,w=5<arguments.length?arguments[5]:void 0,y=6<arguments.length?arguments[6]:void 0;if(!isNaN(+r))return+r;var S="",b=r.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(b!==r)return -1*e(b,n,o,h,d,w,y);for(var _=0;_<l.length;_++){var R=l[_];if((S=r.replace(R.key,""))!==r)return e(S,n,o,h,d,w,y)*R.factor}if((S=r.replace("%",""))!==r)return e(S,n,o,h,d,w,y)/100;var P=parseFloat(r);if(!isNaN(P)){var T=h(P);if(T&&"."!==T&&(S=r.replace(new RegExp("".concat(x(T),"$")),""))!==r)return e(S,n,o,h,d,w,y);var I={};Object.keys(w).forEach(function(r){I[w[r]]=r});for(var O=Object.keys(I).sort().reverse(),k=O.length,N=0;N<k;N++){var L=O[N],j=I[L];if((S=r.replace(L,""))!==r){var U=void 0;switch(j){case"thousand":U=1e3;break;case"million":U=1e6;break;case"billion":U=1e9;break;case"trillion":U=1e12}return e(S,n,o,h,d,w,y)*U}}}}(function(r,n){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",l=r.replace(o,"");return(l=l.replace(RegExp("([0-9])".concat(x(n.thousands),"([0-9])"),"g"),"$1$2")).replace(n.decimal,".")}(r,n,o),n,o,h,d,w,y)}(n,S,b,_,R,P,o):(d=+(h=n.split(":"))[0],w=+h[1],+h[2]+60*w+3600*d);else{if("number"!=typeof n)return;T=n}if(void 0!==T)return T}}},{"./globalState":4}],10:[function(r,n,o){"use strict";function f(r){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}var l=r("./unformatting"),h=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,d={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(r,n){return"byte"===n.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(r){return"byte"===r.output}},characteristic:{type:"number",restriction:function(r){return 0<=r},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(r){return 0<=r},message:"value must be positive"},{restriction:function(r,n){return!n.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(r){return 0<=r},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(r,n){return"percent"===n.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},w={languageTag:{type:"string",mandatory:!0,restriction:function(r){return r.match(h)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function u(r){return!!l.unformat(r)}function g(r,n,o){var l,h=3<arguments.length&&void 0!==arguments[3]&&arguments[3],w=Object.keys(r).map(function(l){if(!n[l])return console.error("".concat(o," Invalid key: ").concat(l)),!1;var h=r[l],w=n[l];if("string"==typeof w&&(w={type:w}),"format"===w.type){if(!g(h,d,"[Validate ".concat(l,"]"),!0))return!1}else if(f(h)!==w.type)return console.error("".concat(o," ").concat(l,' type mismatched: "').concat(w.type,'" expected, "').concat(f(h),'" provided')),!1;if(w.restrictions&&w.restrictions.length)for(var y=w.restrictions.length,S=0;S<y;S++){var b=w.restrictions[S],_=b.restriction,R=b.message;if(!_(h,r))return console.error("".concat(o," ").concat(l," invalid value: ").concat(R)),!1}return w.restriction&&!w.restriction(h,r)?(console.error("".concat(o," ").concat(l," invalid value: ").concat(w.message)),!1):w.validValues&&-1===w.validValues.indexOf(h)?(console.error("".concat(o," ").concat(l," invalid value: must be among ").concat(JSON.stringify(w.validValues),', "').concat(h,'" provided')),!1):!w.children||!!g(h,w.children,"[Validate ".concat(l,"]"))});return h||w.push.apply(w,function(r){if(Array.isArray(r)){for(var n=0,o=Array(r.length);n<r.length;n++)o[n]=r[n];return o}}(l=Object.keys(n).map(function(l){var h=n[l];if("string"==typeof h&&(h={type:h}),h.mandatory){var d=h.mandatory;if("function"==typeof d&&(d=d(r)),d&&void 0===r[l])return console.error("".concat(o,' Missing mandatory key "').concat(l,'"')),!1}return!0}))||function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}(l)||function(){throw TypeError("Invalid attempt to spread non-iterable instance")}()),w.reduce(function(r,n){return r&&n},!0)}function c(r){return g(r,d,"[Validate format]")}n.exports={validate:function(r,n){var o=u(r),l=c(n);return o&&l},validateFormat:c,validateInput:u,validateLanguage:function(r){return g(r,w,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},86284:function(r,n,o){"use strict";var l=o(80043),h=o(71747),d=TypeError;r.exports=function(r){if(l(r))return r;throw new d(h(r)+" is not a function")}},7285:function(r,n,o){"use strict";var l=o(45930),h=String,d=TypeError;r.exports=function(r){if(l(r))return r;throw new d("Can't set "+h(r)+" as a prototype")}},81e3:function(r,n,o){"use strict";var l=o(85026).has;r.exports=function(r){return l(r),r}},38609:function(r,n,o){"use strict";var l=o(61350),h=o(42957),d=o(94982).f,w=l("unscopables"),y=Array.prototype;void 0===y[w]&&d(y,w,{configurable:!0,value:h(null)}),r.exports=function(r){y[w][r]=!0}},51485:function(r,n,o){"use strict";var l=o(56695),h=String,d=TypeError;r.exports=function(r){if(l(r))return r;throw new d(h(r)+" is not an object")}},28786:function(r,n,o){"use strict";var l=o(50949),h=o(70076),d=o(24464),createMethod=function(r){return function(n,o,w){var y,S=l(n),b=d(S);if(0===b)return!r&&-1;var _=h(w,b);if(r&&o!=o){for(;b>_;)if((y=S[_++])!=y)return!0}else for(;b>_;_++)if((r||_ in S)&&S[_]===o)return r||_||0;return!r&&-1}};r.exports={includes:createMethod(!0),indexOf:createMethod(!1)}},56609:function(r,n,o){"use strict";var l=o(12534),h=o(97631),d=TypeError,w=Object.getOwnPropertyDescriptor,y=l&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(r){return r instanceof TypeError}}();r.exports=y?function(r,n){if(h(r)&&!w(r,"length").writable)throw new d("Cannot set read only .length");return r.length=n}:function(r,n){return r.length=n}},32482:function(r,n,o){"use strict";var l=o(58842);r.exports=l([].slice)},6938:function(r,n,o){"use strict";var l=o(58842),h=l({}.toString),d=l("".slice);r.exports=function(r){return d(h(r),8,-1)}},99743:function(r,n,o){"use strict";var l=o(8830),h=o(80043),d=o(6938),w=o(61350)("toStringTag"),y=Object,S="Arguments"===d(function(){return arguments}()),tryGet=function(r,n){try{return r[n]}catch(r){}};r.exports=l?d:function(r){var n,o,l;return void 0===r?"Undefined":null===r?"Null":"string"==typeof(o=tryGet(n=y(r),w))?o:S?d(n):"Object"===(l=d(n))&&h(n.callee)?"Arguments":l}},70783:function(r,n,o){"use strict";var l=o(19472),h=o(35191),d=o(85575),w=o(94982);r.exports=function(r,n,o){for(var y=h(n),S=w.f,b=d.f,_=0;_<y.length;_++){var R=y[_];l(r,R)||o&&l(o,R)||S(r,R,b(n,R))}}},60549:function(r,n,o){"use strict";var l=o(12534),h=o(94982),d=o(29085);r.exports=l?function(r,n,o){return h.f(r,n,d(1,o))}:function(r,n,o){return r[n]=o,r}},29085:function(r){"use strict";r.exports=function(r,n){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:n}}},64584:function(r,n,o){"use strict";var l=o(12534),h=o(94982),d=o(29085);r.exports=function(r,n,o){l?h.f(r,n,d(0,o)):r[n]=o}},64897:function(r,n,o){"use strict";var l=o(80043),h=o(94982),d=o(75412),w=o(43743);r.exports=function(r,n,o,y){y||(y={});var S=y.enumerable,b=void 0!==y.name?y.name:n;if(l(o)&&d(o,b,y),y.global)S?r[n]=o:w(n,o);else{try{y.unsafe?r[n]&&(S=!0):delete r[n]}catch(r){}S?r[n]=o:h.f(r,n,{value:o,enumerable:!1,configurable:!y.nonConfigurable,writable:!y.nonWritable})}return r}},43743:function(r,n,o){"use strict";var l=o(84023),h=Object.defineProperty;r.exports=function(r,n){try{h(l,r,{value:n,configurable:!0,writable:!0})}catch(o){l[r]=n}return n}},36138:function(r,n,o){"use strict";var l=o(71747),h=TypeError;r.exports=function(r,n){if(!delete r[n])throw new h("Cannot delete property "+l(n)+" of "+l(r))}},12534:function(r,n,o){"use strict";var l=o(44256);r.exports=!l(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},47039:function(r,n,o){"use strict";var l=o(84023),h=o(56695),d=l.document,w=h(d)&&h(d.createElement);r.exports=function(r){return w?d.createElement(r):{}}},53745:function(r){"use strict";var n=TypeError;r.exports=function(r){if(r>9007199254740991)throw n("Maximum allowed index exceeded");return r}},51971:function(r){"use strict";r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},34532:function(r,n,o){"use strict";var l=o(679);r.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(l)},65436:function(r,n,o){"use strict";var l=o(30224);r.exports="NODE"===l},679:function(r,n,o){"use strict";var l=o(84023).navigator,h=l&&l.userAgent;r.exports=h?String(h):""},77144:function(r,n,o){"use strict";var l,h,d=o(84023),w=o(679),y=d.process,S=d.Deno,b=y&&y.versions||S&&S.version,_=b&&b.v8;_&&(h=(l=_.split("."))[0]>0&&l[0]<4?1:+(l[0]+l[1])),!h&&w&&(!(l=w.match(/Edge\/(\d+)/))||l[1]>=74)&&(l=w.match(/Chrome\/(\d+)/))&&(h=+l[1]),r.exports=h},30224:function(r,n,o){"use strict";var l=o(84023),h=o(679),d=o(6938),userAgentStartsWith=function(r){return h.slice(0,r.length)===r};r.exports=userAgentStartsWith("Bun/")?"BUN":userAgentStartsWith("Cloudflare-Workers")?"CLOUDFLARE":userAgentStartsWith("Deno/")?"DENO":userAgentStartsWith("Node.js/")?"NODE":l.Bun&&"string"==typeof Bun.version?"BUN":l.Deno&&"object"==typeof Deno.version?"DENO":"process"===d(l.process)?"NODE":l.window&&l.document?"BROWSER":"REST"},55759:function(r,n,o){"use strict";var l=o(58842),h=Error,d=l("".replace),w=String(new h("zxcasd").stack),y=/\n\s*at [^:]*:[^\n]*/,S=y.test(w);r.exports=function(r,n){if(S&&"string"==typeof r&&!h.prepareStackTrace)for(;n--;)r=d(r,y,"");return r}},47865:function(r,n,o){"use strict";var l=o(60549),h=o(55759),d=o(96653),w=Error.captureStackTrace;r.exports=function(r,n,o,y){d&&(w?w(r,n):l(r,"stack",h(o,y)))}},96653:function(r,n,o){"use strict";var l=o(44256),h=o(29085);r.exports=!l(function(){var r=Error("a");return!("stack"in r)||(Object.defineProperty(r,"stack",h(1,7)),7!==r.stack)})},69272:function(r,n,o){"use strict";var l=o(84023),h=o(85575).f,d=o(60549),w=o(64897),y=o(43743),S=o(70783),b=o(51559);r.exports=function(r,n){var o,_,R,P,T,I=r.target,O=r.global,k=r.stat;if(o=O?l:k?l[I]||y(I,{}):l[I]&&l[I].prototype)for(_ in n){if(P=n[_],R=r.dontCallGetSet?(T=h(o,_))&&T.value:o[_],!b(O?_:I+(k?".":"#")+_,r.forced)&&void 0!==R){if(typeof P==typeof R)continue;S(P,R)}(r.sham||R&&R.sham)&&d(P,"sham",!0),w(o,_,P,r)}}},44256:function(r){"use strict";r.exports=function(r){try{return!!r()}catch(r){return!0}}},35815:function(r,n,o){"use strict";var l=o(21115),h=Function.prototype,d=h.apply,w=h.call;r.exports="object"==typeof Reflect&&Reflect.apply||(l?w.bind(d):function(){return w.apply(d,arguments)})},39668:function(r,n,o){"use strict";var l=o(16919),h=o(86284),d=o(21115),w=l(l.bind);r.exports=function(r,n){return h(r),void 0===n?r:d?w(r,n):function(){return r.apply(n,arguments)}}},21115:function(r,n,o){"use strict";var l=o(44256);r.exports=!l(function(){var r=(function(){}).bind();return"function"!=typeof r||r.hasOwnProperty("prototype")})},55817:function(r,n,o){"use strict";var l=o(21115),h=Function.prototype.call;r.exports=l?h.bind(h):function(){return h.apply(h,arguments)}},56309:function(r,n,o){"use strict";var l=o(12534),h=o(19472),d=Function.prototype,w=l&&Object.getOwnPropertyDescriptor,y=h(d,"name"),S=y&&(!l||l&&w(d,"name").configurable);r.exports={EXISTS:y,PROPER:y&&"something"===(function(){}).name,CONFIGURABLE:S}},46346:function(r,n,o){"use strict";var l=o(58842),h=o(86284);r.exports=function(r,n,o){try{return l(h(Object.getOwnPropertyDescriptor(r,n)[o]))}catch(r){}}},16919:function(r,n,o){"use strict";var l=o(6938),h=o(58842);r.exports=function(r){if("Function"===l(r))return h(r)}},58842:function(r,n,o){"use strict";var l=o(21115),h=Function.prototype,d=h.call,w=l&&h.bind.bind(d,d);r.exports=l?w:function(r){return function(){return d.apply(r,arguments)}}},35651:function(r,n,o){"use strict";var l=o(84023),h=o(80043);r.exports=function(r,n){var o;return arguments.length<2?h(o=l[r])?o:void 0:l[r]&&l[r][n]}},7359:function(r){"use strict";r.exports=function(r){return{iterator:r,next:r.next,done:!1}}},52789:function(r,n,o){"use strict";var l=o(99743),h=o(22112),d=o(86617),w=o(18778),y=o(61350)("iterator");r.exports=function(r){if(!d(r))return h(r,y)||h(r,"@@iterator")||w[l(r)]}},38397:function(r,n,o){"use strict";var l=o(55817),h=o(86284),d=o(51485),w=o(71747),y=o(52789),S=TypeError;r.exports=function(r,n){var o=arguments.length<2?y(r):n;if(h(o))return d(l(o,r));throw new S(w(r)+" is not iterable")}},22112:function(r,n,o){"use strict";var l=o(86284),h=o(86617);r.exports=function(r,n){var o=r[n];return h(o)?void 0:l(o)}},96621:function(r,n,o){"use strict";var l=o(86284),h=o(51485),d=o(55817),w=o(55963),y=o(7359),S="Invalid size",b=RangeError,_=TypeError,R=Math.max,SetRecord=function(r,n){this.set=r,this.size=R(n,0),this.has=l(r.has),this.keys=l(r.keys)};SetRecord.prototype={getIterator:function(){return y(h(d(this.keys,this.set)))},includes:function(r){return d(this.has,this.set,r)}},r.exports=function(r){h(r);var n=+r.size;if(n!=n)throw new _(S);var o=w(n);if(o<0)throw new b(S);return new SetRecord(r,o)}},7175:function(r,n,o){"use strict";var l=o(58842),h=o(84405),d=Math.floor,w=l("".charAt),y=l("".replace),S=l("".slice),b=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,_=/\$([$&'`]|\d{1,2})/g;r.exports=function(r,n,o,l,R,P){var T=o+r.length,I=l.length,O=_;return void 0!==R&&(R=h(R),O=b),y(P,O,function(h,y){var b;switch(w(y,0)){case"$":return"$";case"&":return r;case"`":return S(n,0,o);case"'":return S(n,T);case"<":b=R[S(y,1,-1)];break;default:var _=+y;if(0===_)return h;if(_>I){var P=d(_/10);if(0===P)return h;if(P<=I)return void 0===l[P-1]?w(y,1):l[P-1]+w(y,1);return h}b=l[_-1]}return void 0===b?"":b})}},84023:function(r,n,o){"use strict";var check=function(r){return r&&r.Math===Math&&r};r.exports=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof o.g&&o.g)||check("object"==typeof this&&this)||function(){return this}()||Function("return this")()},19472:function(r,n,o){"use strict";var l=o(58842),h=o(84405),d=l({}.hasOwnProperty);r.exports=Object.hasOwn||function(r,n){return d(h(r),n)}},68347:function(r){"use strict";r.exports={}},91162:function(r,n,o){"use strict";var l=o(35651);r.exports=l("document","documentElement")},11149:function(r,n,o){"use strict";var l=o(12534),h=o(44256),d=o(47039);r.exports=!l&&!h(function(){return 7!==Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a})},33910:function(r,n,o){"use strict";var l=o(58842),h=o(44256),d=o(6938),w=Object,y=l("".split);r.exports=h(function(){return!w("z").propertyIsEnumerable(0)})?function(r){return"String"===d(r)?y(r,""):w(r)}:w},16752:function(r,n,o){"use strict";var l=o(80043),h=o(56695),d=o(37908);r.exports=function(r,n,o){var w,y;return d&&l(w=n.constructor)&&w!==o&&h(y=w.prototype)&&y!==o.prototype&&d(r,y),r}},12402:function(r,n,o){"use strict";var l=o(58842),h=o(80043),d=o(29145),w=l(Function.toString);h(d.inspectSource)||(d.inspectSource=function(r){return w(r)}),r.exports=d.inspectSource},83950:function(r,n,o){"use strict";var l=o(56695),h=o(60549);r.exports=function(r,n){l(n)&&"cause"in n&&h(r,"cause",n.cause)}},65230:function(r,n,o){"use strict";var l,h,d,w=o(99819),y=o(84023),S=o(56695),b=o(60549),_=o(19472),R=o(29145),P=o(80050),T=o(68347),I="Object already initialized",O=y.TypeError,k=y.WeakMap;if(w||R.state){var N=R.state||(R.state=new k);N.get=N.get,N.has=N.has,N.set=N.set,l=function(r,n){if(N.has(r))throw new O(I);return n.facade=r,N.set(r,n),n},h=function(r){return N.get(r)||{}},d=function(r){return N.has(r)}}else{var L=P("state");T[L]=!0,l=function(r,n){if(_(r,L))throw new O(I);return n.facade=r,b(r,L,n),n},h=function(r){return _(r,L)?r[L]:{}},d=function(r){return _(r,L)}}r.exports={set:l,get:h,has:d,enforce:function(r){return d(r)?h(r):l(r,{})},getterFor:function(r){return function(n){var o;if(!S(n)||(o=h(n)).type!==r)throw new O("Incompatible receiver, "+r+" required");return o}}}},88714:function(r,n,o){"use strict";var l=o(61350),h=o(18778),d=l("iterator"),w=Array.prototype;r.exports=function(r){return void 0!==r&&(h.Array===r||w[d]===r)}},97631:function(r,n,o){"use strict";var l=o(6938);r.exports=Array.isArray||function(r){return"Array"===l(r)}},80043:function(r){"use strict";var n="object"==typeof document&&document.all;r.exports=void 0===n&&void 0!==n?function(r){return"function"==typeof r||r===n}:function(r){return"function"==typeof r}},51559:function(r,n,o){"use strict";var l=o(44256),h=o(80043),d=/#|\.prototype\./,isForced=function(r,n){var o=y[w(r)];return o===b||o!==S&&(h(n)?l(n):!!n)},w=isForced.normalize=function(r){return String(r).replace(d,".").toLowerCase()},y=isForced.data={},S=isForced.NATIVE="N",b=isForced.POLYFILL="P";r.exports=isForced},86617:function(r){"use strict";r.exports=function(r){return null==r}},56695:function(r,n,o){"use strict";var l=o(80043);r.exports=function(r){return"object"==typeof r?null!==r:l(r)}},45930:function(r,n,o){"use strict";var l=o(56695);r.exports=function(r){return l(r)||null===r}},9168:function(r){"use strict";r.exports=!1},97947:function(r,n,o){"use strict";var l=o(56695),h=o(65230).get;r.exports=function(r){if(!l(r))return!1;var n=h(r);return!!n&&"RawJSON"===n.type}},91059:function(r,n,o){"use strict";var l=o(56695),h=o(6938),d=o(61350)("match");r.exports=function(r){var n;return l(r)&&(void 0!==(n=r[d])?!!n:"RegExp"===h(r))}},65375:function(r,n,o){"use strict";var l=o(35651),h=o(80043),d=o(50112),w=o(20327),y=Object;r.exports=w?function(r){return"symbol"==typeof r}:function(r){var n=l("Symbol");return h(n)&&d(n.prototype,y(r))}},63700:function(r,n,o){"use strict";var l=o(55817);r.exports=function(r,n,o){for(var h,d,w=o?r:r.iterator,y=r.next;!(h=l(y,w)).done;)if(void 0!==(d=n(h.value)))return d}},5040:function(r,n,o){"use strict";var l=o(39668),h=o(55817),d=o(51485),w=o(71747),y=o(88714),S=o(24464),b=o(50112),_=o(38397),R=o(52789),P=o(84471),T=TypeError,Result=function(r,n){this.stopped=r,this.result=n},I=Result.prototype;r.exports=function(r,n,o){var O,k,N,L,j,U,$,K=o&&o.that,Y=!!(o&&o.AS_ENTRIES),X=!!(o&&o.IS_RECORD),J=!!(o&&o.IS_ITERATOR),Q=!!(o&&o.INTERRUPTED),ee=l(n,K),stop=function(r){return O&&P(O,"normal"),new Result(!0,r)},callFn=function(r){return Y?(d(r),Q?ee(r[0],r[1],stop):ee(r[0],r[1])):Q?ee(r,stop):ee(r)};if(X)O=r.iterator;else if(J)O=r;else{if(!(k=R(r)))throw new T(w(r)+" is not iterable");if(y(k)){for(N=0,L=S(r);L>N;N++)if((j=callFn(r[N]))&&b(I,j))return j;return new Result(!1)}O=_(r,k)}for(U=X?r.next:O.next;!($=h(U,O)).done;){try{j=callFn($.value)}catch(r){P(O,"throw",r)}if("object"==typeof j&&j&&b(I,j))return j}return new Result(!1)}},84471:function(r,n,o){"use strict";var l=o(55817),h=o(51485),d=o(22112);r.exports=function(r,n,o){var w,y;h(r);try{if(!(w=d(r,"return"))){if("throw"===n)throw o;return o}w=l(w,r)}catch(r){y=!0,w=r}if("throw"===n)throw o;if(y)throw w;return h(w),o}},18778:function(r){"use strict";r.exports={}},24464:function(r,n,o){"use strict";var l=o(42510);r.exports=function(r){return l(r.length)}},75412:function(r,n,o){"use strict";var l=o(58842),h=o(44256),d=o(80043),w=o(19472),y=o(12534),S=o(56309).CONFIGURABLE,b=o(12402),_=o(65230),R=_.enforce,P=_.get,T=String,I=Object.defineProperty,O=l("".slice),k=l("".replace),N=l([].join),L=y&&!h(function(){return 8!==I(function(){},"length",{value:8}).length}),j=String(String).split("String"),U=r.exports=function(r,n,o){"Symbol("===O(T(n),0,7)&&(n="["+k(T(n),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),o&&o.getter&&(n="get "+n),o&&o.setter&&(n="set "+n),(!w(r,"name")||S&&r.name!==n)&&(y?I(r,"name",{value:n,configurable:!0}):r.name=n),L&&o&&w(o,"arity")&&r.length!==o.arity&&I(r,"length",{value:o.arity});try{o&&w(o,"constructor")&&o.constructor?y&&I(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch(r){}var l=R(r);return w(l,"source")||(l.source=N(j,"string"==typeof n?n:"")),r};Function.prototype.toString=U(function(){return d(this)&&P(this).source||b(this)},"toString")},61325:function(r){"use strict";var n=Math.ceil,o=Math.floor;r.exports=Math.trunc||function(r){var l=+r;return(l>0?o:n)(l)}},73978:function(r,n,o){"use strict";var l=o(44256);r.exports=!l(function(){var r="9007199254740993",n=JSON.rawJSON(r);return!JSON.isRawJSON(n)||JSON.stringify(n)!==r})},20409:function(r,n,o){"use strict";var l=o(92455);r.exports=function(r,n){return void 0===r?arguments.length<2?"":n:l(r)}},42957:function(r,n,o){"use strict";var l,h=o(51485),d=o(79400),w=o(51971),y=o(68347),S=o(91162),b=o(47039),_=o(80050),R="prototype",P="script",T=_("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(r){return"<"+P+">"+r+"</"+P+">"},NullProtoObjectViaActiveX=function(r){r.write(scriptTag("")),r.close();var n=r.parentWindow.Object;return r=null,n},NullProtoObjectViaIFrame=function(){var r,n=b("iframe");return n.style.display="none",S.appendChild(n),n.src=String("java"+P+":"),(r=n.contentWindow.document).open(),r.write(scriptTag("document.F=Object")),r.close(),r.F},NullProtoObject=function(){try{l=new ActiveXObject("htmlfile")}catch(r){}NullProtoObject="undefined"!=typeof document?document.domain&&l?NullProtoObjectViaActiveX(l):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(l);for(var r=w.length;r--;)delete NullProtoObject[R][w[r]];return NullProtoObject()};y[T]=!0,r.exports=Object.create||function(r,n){var o;return null!==r?(EmptyConstructor[R]=h(r),o=new EmptyConstructor,EmptyConstructor[R]=null,o[T]=r):o=NullProtoObject(),void 0===n?o:d.f(o,n)}},79400:function(r,n,o){"use strict";var l=o(12534),h=o(81887),d=o(94982),w=o(51485),y=o(50949),S=o(15540);n.f=l&&!h?Object.defineProperties:function(r,n){w(r);for(var o,l=y(n),h=S(n),b=h.length,_=0;b>_;)d.f(r,o=h[_++],l[o]);return r}},94982:function(r,n,o){"use strict";var l=o(12534),h=o(11149),d=o(81887),w=o(51485),y=o(87843),S=TypeError,b=Object.defineProperty,_=Object.getOwnPropertyDescriptor,R="enumerable",P="configurable",T="writable";n.f=l?d?function(r,n,o){if(w(r),n=y(n),w(o),"function"==typeof r&&"prototype"===n&&"value"in o&&T in o&&!o[T]){var l=_(r,n);l&&l[T]&&(r[n]=o.value,o={configurable:P in o?o[P]:l[P],enumerable:R in o?o[R]:l[R],writable:!1})}return b(r,n,o)}:b:function(r,n,o){if(w(r),n=y(n),w(o),h)try{return b(r,n,o)}catch(r){}if("get"in o||"set"in o)throw new S("Accessors not supported");return"value"in o&&(r[n]=o.value),r}},85575:function(r,n,o){"use strict";var l=o(12534),h=o(55817),d=o(96787),w=o(29085),y=o(50949),S=o(87843),b=o(19472),_=o(11149),R=Object.getOwnPropertyDescriptor;n.f=l?R:function(r,n){if(r=y(r),n=S(n),_)try{return R(r,n)}catch(r){}if(b(r,n))return w(!h(d.f,r,n),r[n])}},67613:function(r,n,o){"use strict";var l=o(49852),h=o(51971).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(r){return l(r,h)}},4531:function(r,n){"use strict";n.f=Object.getOwnPropertySymbols},50112:function(r,n,o){"use strict";var l=o(58842);r.exports=l({}.isPrototypeOf)},49852:function(r,n,o){"use strict";var l=o(58842),h=o(19472),d=o(50949),w=o(28786).indexOf,y=o(68347),S=l([].push);r.exports=function(r,n){var o,l=d(r),b=0,_=[];for(o in l)!h(y,o)&&h(l,o)&&S(_,o);for(;n.length>b;)h(l,o=n[b++])&&(~w(_,o)||S(_,o));return _}},15540:function(r,n,o){"use strict";var l=o(49852),h=o(51971);r.exports=Object.keys||function(r){return l(r,h)}},96787:function(r,n){"use strict";var o={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,h=l&&!o.call({1:2},1);n.f=h?function(r){var n=l(this,r);return!!n&&n.enumerable}:o},37908:function(r,n,o){"use strict";var l=o(46346),h=o(56695),d=o(12924),w=o(7285);r.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var r,n=!1,o={};try{(r=l(Object.prototype,"__proto__","set"))(o,[]),n=o instanceof Array}catch(r){}return function(o,l){return d(o),w(l),h(o)&&(n?r(o,l):o.__proto__=l),o}}():void 0)},61823:function(r,n,o){"use strict";var l=o(55817),h=o(80043),d=o(56695),w=TypeError;r.exports=function(r,n){var o,y;if("string"===n&&h(o=r.toString)&&!d(y=l(o,r))||h(o=r.valueOf)&&!d(y=l(o,r))||"string"!==n&&h(o=r.toString)&&!d(y=l(o,r)))return y;throw new w("Can't convert object to primitive value")}},35191:function(r,n,o){"use strict";var l=o(35651),h=o(58842),d=o(67613),w=o(4531),y=o(51485),S=h([].concat);r.exports=l("Reflect","ownKeys")||function(r){var n=d.f(y(r)),o=w.f;return o?S(n,o(r)):n}},22715:function(r,n,o){"use strict";var l=o(58842),h=o(19472),d=SyntaxError,w=parseInt,y=String.fromCharCode,S=l("".charAt),b=l("".slice),_=l(/./.exec),R={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"	"},P=/^[\da-f]{4}$/i,T=/^[\u0000-\u001F]$/;r.exports=function(r,n){for(var o=!0,l="";n<r.length;){var I=S(r,n);if("\\"===I){var O=b(r,n,n+2);if(h(R,O))l+=R[O],n+=2;else if("\\u"===O){var k=b(r,n+=2,n+4);if(!_(P,k))throw new d("Bad Unicode escape at: "+n);l+=y(w(k,16)),n+=4}else throw new d('Unknown escape sequence: "'+O+'"')}else if('"'===I){o=!1,n++;break}else{if(_(T,I))throw new d("Bad control character in string literal at: "+n);l+=I,n++}}if(o)throw new d("Unterminated string at: "+n);return{value:l,end:n}}},25121:function(r,n,o){"use strict";var l=o(94982).f;r.exports=function(r,n,o){o in r||l(r,o,{configurable:!0,get:function(){return n[o]},set:function(r){n[o]=r}})}},76091:function(r,n,o){"use strict";var l=o(84023),h=o(44256),d=l.RegExp,w=!h(function(){var r=!0;try{d(".","d")}catch(n){r=!1}var n={},o="",l=r?"dgimsy":"gimsy",addGetter=function(r,l){Object.defineProperty(n,r,{get:function(){return o+=l,!0}})},h={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var w in r&&(h.hasIndices="d"),h)addGetter(w,h[w]);return Object.getOwnPropertyDescriptor(d.prototype,"flags").get.call(n)!==l||o!==l});r.exports={correct:w}},4045:function(r,n,o){"use strict";var l=o(51485);r.exports=function(){var r=l(this),n="";return r.hasIndices&&(n+="d"),r.global&&(n+="g"),r.ignoreCase&&(n+="i"),r.multiline&&(n+="m"),r.dotAll&&(n+="s"),r.unicode&&(n+="u"),r.unicodeSets&&(n+="v"),r.sticky&&(n+="y"),n}},80290:function(r,n,o){"use strict";var l=o(55817),h=o(19472),d=o(50112),w=o(76091),y=o(4045),S=RegExp.prototype;r.exports=w.correct?function(r){return r.flags}:function(r){return!w.correct&&d(S,r)&&!h(r,"flags")?l(y,r):r.flags}},12924:function(r,n,o){"use strict";var l=o(86617),h=TypeError;r.exports=function(r){if(l(r))throw new h("Can't call method on "+r);return r}},50290:function(r,n,o){"use strict";var l,h=o(84023),d=o(35815),w=o(80043),y=o(30224),S=o(679),b=o(32482),_=o(15373),R=h.Function,P=/MSIE .\./.test(S)||"BUN"===y&&((l=h.Bun.version.split(".")).length<3||"0"===l[0]&&(l[1]<3||"3"===l[1]&&"0"===l[2]));r.exports=function(r,n){var o=n?2:1;return P?function(l,h){var y=_(arguments.length,1)>o,S=w(l)?l:R(l),P=y?b(arguments,o):[],T=y?function(){d(S,this,P)}:S;return n?r(T,h):r(T)}:r}},53775:function(r,n,o){"use strict";var l=o(85026),h=o(40162),d=l.Set,w=l.add;r.exports=function(r){var n=new d;return h(r,function(r){w(n,r)}),n}},73430:function(r,n,o){"use strict";var l=o(81e3),h=o(85026),d=o(53775),w=o(90807),y=o(96621),S=o(40162),b=o(63700),_=h.has,R=h.remove;r.exports=function(r){var n=l(this),o=y(r),h=d(n);return w(n)<=o.size?S(n,function(r){o.includes(r)&&R(h,r)}):b(o.getIterator(),function(r){_(h,r)&&R(h,r)}),h}},85026:function(r,n,o){"use strict";var l=o(58842),h=Set.prototype;r.exports={Set:Set,add:l(h.add),has:l(h.has),remove:l(h.delete),proto:h}},48785:function(r,n,o){"use strict";var l=o(81e3),h=o(85026),d=o(90807),w=o(96621),y=o(40162),S=o(63700),b=h.Set,_=h.add,R=h.has;r.exports=function(r){var n=l(this),o=w(r),h=new b;return d(n)>o.size?S(o.getIterator(),function(r){R(n,r)&&_(h,r)}):y(n,function(r){o.includes(r)&&_(h,r)}),h}},75636:function(r,n,o){"use strict";var l=o(81e3),h=o(85026).has,d=o(90807),w=o(96621),y=o(40162),S=o(63700),b=o(84471);r.exports=function(r){var n=l(this),o=w(r);if(d(n)<=o.size)return!1!==y(n,function(r){if(o.includes(r))return!1},!0);var _=o.getIterator();return!1!==S(_,function(r){if(h(n,r))return b(_,"normal",!1)})}},20850:function(r,n,o){"use strict";var l=o(81e3),h=o(90807),d=o(40162),w=o(96621);r.exports=function(r){var n=l(this),o=w(r);return!(h(n)>o.size)&&!1!==d(n,function(r){if(!o.includes(r))return!1},!0)}},871:function(r,n,o){"use strict";var l=o(81e3),h=o(85026).has,d=o(90807),w=o(96621),y=o(63700),S=o(84471);r.exports=function(r){var n=l(this),o=w(r);if(d(n)<o.size)return!1;var b=o.getIterator();return!1!==y(b,function(r){if(!h(n,r))return S(b,"normal",!1)})}},40162:function(r,n,o){"use strict";var l=o(58842),h=o(63700),d=o(85026),w=d.Set,y=d.proto,S=l(y.forEach),b=l(y.keys),_=b(new w).next;r.exports=function(r,n,o){return o?h({iterator:b(r),next:_},n):S(r,n)}},79152:function(r,n,o){"use strict";var l=o(35651),createSetLike=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},createSetLikeWithInfinitySize=function(r){return{size:r,has:function(){return!0},keys:function(){throw Error("e")}}};r.exports=function(r,n){var o=l("Set");try{new o()[r](createSetLike(0));try{return new o()[r](createSetLike(-1)),!1}catch(l){if(!n)return!0;try{return new o()[r](createSetLikeWithInfinitySize(-1/0)),!1}catch(l){var h=new o([1,2]);return n(h[r](createSetLikeWithInfinitySize(1/0)))}}}catch(r){return!1}}},13150:function(r){"use strict";r.exports=function(r){try{var n=new Set,o=n[r]({size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return n.clear(),n.add(4),function(){return{done:!0}}}})}});return 1===o.size&&4===o.values().next().value}catch(r){return!1}}},90807:function(r,n,o){"use strict";var l=o(46346),h=o(85026);r.exports=l(h.proto,"size","get")||function(r){return r.size}},34262:function(r,n,o){"use strict";var l=o(81e3),h=o(85026),d=o(53775),w=o(96621),y=o(63700),S=h.add,b=h.has,_=h.remove;r.exports=function(r){var n=l(this),o=w(r).getIterator(),h=d(n);return y(o,function(r){b(n,r)?_(h,r):S(h,r)}),h}},39793:function(r,n,o){"use strict";var l=o(81e3),h=o(85026).add,d=o(53775),w=o(96621),y=o(63700);r.exports=function(r){var n=l(this),o=w(r).getIterator(),S=d(n);return y(o,function(r){h(S,r)}),S}},80050:function(r,n,o){"use strict";var l=o(93801),h=o(97246),d=l("keys");r.exports=function(r){return d[r]||(d[r]=h(r))}},29145:function(r,n,o){"use strict";var l=o(9168),h=o(84023),d=o(43743),w="__core-js_shared__",y=r.exports=h[w]||d(w,{});(y.versions||(y.versions=[])).push({version:"3.47.0",mode:l?"pure":"global",copyright:"\xa9 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})},93801:function(r,n,o){"use strict";var l=o(29145);r.exports=function(r,n){return l[r]||(l[r]=n||{})}},24072:function(r,n,o){"use strict";var l=o(77144),h=o(44256),d=o(84023).String;r.exports=!!Object.getOwnPropertySymbols&&!h(function(){var r=Symbol("symbol detection");return!d(r)||!(Object(r) instanceof Symbol)||!Symbol.sham&&l&&l<41})},48150:function(r,n,o){"use strict";var l,h,d,w,y=o(84023),S=o(35815),b=o(39668),_=o(80043),R=o(19472),P=o(44256),T=o(91162),I=o(32482),O=o(47039),k=o(15373),N=o(34532),L=o(65436),j=y.setImmediate,U=y.clearImmediate,$=y.process,K=y.Dispatch,Y=y.Function,X=y.MessageChannel,J=y.String,Q=0,ee={},et="onreadystatechange";P(function(){l=y.location});var run=function(r){if(R(ee,r)){var n=ee[r];delete ee[r],n()}},runner=function(r){return function(){run(r)}},eventListener=function(r){run(r.data)},globalPostMessageDefer=function(r){y.postMessage(J(r),l.protocol+"//"+l.host)};j&&U||(j=function(r){k(arguments.length,1);var n=_(r)?r:Y(r),o=I(arguments,1);return ee[++Q]=function(){S(n,void 0,o)},h(Q),Q},U=function(r){delete ee[r]},L?h=function(r){$.nextTick(runner(r))}:K&&K.now?h=function(r){K.now(runner(r))}:X&&!N?(w=(d=new X).port2,d.port1.onmessage=eventListener,h=b(w.postMessage,w)):y.addEventListener&&_(y.postMessage)&&!y.importScripts&&l&&"file:"!==l.protocol&&!P(globalPostMessageDefer)?(h=globalPostMessageDefer,y.addEventListener("message",eventListener,!1)):h=et in O("script")?function(r){T.appendChild(O("script"))[et]=function(){T.removeChild(this),run(r)}}:function(r){setTimeout(runner(r),0)}),r.exports={set:j,clear:U}},70076:function(r,n,o){"use strict";var l=o(55963),h=Math.max,d=Math.min;r.exports=function(r,n){var o=l(r);return o<0?h(o+n,0):d(o,n)}},50949:function(r,n,o){"use strict";var l=o(33910),h=o(12924);r.exports=function(r){return l(h(r))}},55963:function(r,n,o){"use strict";var l=o(61325);r.exports=function(r){var n=+r;return n!=n||0===n?0:l(n)}},42510:function(r,n,o){"use strict";var l=o(55963),h=Math.min;r.exports=function(r){var n=l(r);return n>0?h(n,9007199254740991):0}},84405:function(r,n,o){"use strict";var l=o(12924),h=Object;r.exports=function(r){return h(l(r))}},61777:function(r,n,o){"use strict";var l=o(55817),h=o(56695),d=o(65375),w=o(22112),y=o(61823),S=o(61350),b=TypeError,_=S("toPrimitive");r.exports=function(r,n){if(!h(r)||d(r))return r;var o,S=w(r,_);if(S){if(void 0===n&&(n="default"),!h(o=l(S,r,n))||d(o))return o;throw new b("Can't convert object to primitive value")}return void 0===n&&(n="number"),y(r,n)}},87843:function(r,n,o){"use strict";var l=o(61777),h=o(65375);r.exports=function(r){var n=l(r,"string");return h(n)?n:n+""}},8830:function(r,n,o){"use strict";var l=o(61350)("toStringTag"),h={};h[l]="z",r.exports="[object z]"===String(h)},92455:function(r,n,o){"use strict";var l=o(99743),h=String;r.exports=function(r){if("Symbol"===l(r))throw TypeError("Cannot convert a Symbol value to a string");return h(r)}},71747:function(r){"use strict";var n=String;r.exports=function(r){try{return n(r)}catch(r){return"Object"}}},97246:function(r,n,o){"use strict";var l=o(58842),h=0,d=Math.random(),w=l(1.1.toString);r.exports=function(r){return"Symbol("+(void 0===r?"":r)+")_"+w(++h+d,36)}},20327:function(r,n,o){"use strict";var l=o(24072);r.exports=l&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},81887:function(r,n,o){"use strict";var l=o(12534),h=o(44256);r.exports=l&&h(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},15373:function(r){"use strict";var n=TypeError;r.exports=function(r,o){if(r<o)throw new n("Not enough arguments");return r}},99819:function(r,n,o){"use strict";var l=o(84023),h=o(80043),d=l.WeakMap;r.exports=h(d)&&/native code/.test(String(d))},61350:function(r,n,o){"use strict";var l=o(84023),h=o(93801),d=o(19472),w=o(97246),y=o(24072),S=o(20327),b=l.Symbol,_=h("wks"),R=S?b.for||b:b&&b.withoutSetter||w;r.exports=function(r){return d(_,r)||(_[r]=y&&d(b,r)?b[r]:R("Symbol."+r)),_[r]}},33700:function(r,n,o){"use strict";var l=o(35651),h=o(19472),d=o(60549),w=o(50112),y=o(37908),S=o(70783),b=o(25121),_=o(16752),R=o(20409),P=o(83950),T=o(47865),I=o(12534),O=o(9168);r.exports=function(r,n,o,k){var N="stackTraceLimit",L=k?2:1,j=r.split("."),U=j[j.length-1],$=l.apply(null,j);if($){var K=$.prototype;if(!O&&h(K,"cause")&&delete K.cause,!o)return $;var Y=l("Error"),X=n(function(r,n){var o=R(k?n:r,void 0),l=k?new $(r):new $;return void 0!==o&&d(l,"message",o),T(l,X,l.stack,2),this&&w(K,this)&&_(l,this,X),arguments.length>L&&P(l,arguments[L]),l});if(X.prototype=K,"Error"!==U?y?y(X,Y):S(X,Y,{name:!0}):I&&N in $&&(b(X,$,N),b(X,$,"prepareStackTrace")),S(X,$),!O)try{K.name!==U&&d(K,"name",U),K.constructor=X}catch(r){}return X}}},47933:function(r,n,o){"use strict";var l=o(69272),h=o(84405),d=o(24464),w=o(55963),y=o(38609);l({target:"Array",proto:!0},{at:function(r){var n=h(this),o=d(n),l=w(r),y=l>=0?l:o+l;return y<0||y>=o?void 0:n[y]}}),y("at")},58563:function(r,n,o){"use strict";var l=o(69272),h=o(84405),d=o(24464),w=o(56609),y=o(53745);l({target:"Array",proto:!0,arity:1,forced:o(44256)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(r){return r instanceof TypeError}}()},{push:function(r){var n=h(this),o=d(n),l=arguments.length;y(o+l);for(var S=0;S<l;S++)n[o]=arguments[S],o++;return w(n,o),o}})},79328:function(r,n,o){"use strict";o(38609)("flatMap")},21767:function(r,n,o){"use strict";o(38609)("flat")},95606:function(r,n,o){"use strict";var l=o(69272),h=o(84405),d=o(24464),w=o(56609),y=o(36138),S=o(53745);l({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(r){return r instanceof TypeError}}()},{unshift:function(r){var n=h(this),o=d(n),l=arguments.length;if(l){S(o+l);for(var b=o;b--;){var _=b+l;b in n?n[_]=n[b]:y(n,_)}for(var R=0;R<l;R++)n[R]=arguments[R]}return w(n,o+l)}})},57855:function(r,n,o){"use strict";var l=o(69272),h=o(84023),d=o(35815),w=o(33700),y="WebAssembly",S=h[y],b=7!==Error("e",{cause:7}).cause,exportGlobalErrorCauseWrapper=function(r,n){var o={};o[r]=w(r,n,b),l({global:!0,constructor:!0,arity:1,forced:b},o)},exportWebAssemblyErrorCauseWrapper=function(r,n){if(S&&S[r]){var o={};o[r]=w(y+"."+r,n,b),l({target:y,stat:!0,constructor:!0,arity:1,forced:b},o)}};exportGlobalErrorCauseWrapper("Error",function(r){return function(n){return d(r,this,arguments)}}),exportGlobalErrorCauseWrapper("EvalError",function(r){return function(n){return d(r,this,arguments)}}),exportGlobalErrorCauseWrapper("RangeError",function(r){return function(n){return d(r,this,arguments)}}),exportGlobalErrorCauseWrapper("ReferenceError",function(r){return function(n){return d(r,this,arguments)}}),exportGlobalErrorCauseWrapper("SyntaxError",function(r){return function(n){return d(r,this,arguments)}}),exportGlobalErrorCauseWrapper("TypeError",function(r){return function(n){return d(r,this,arguments)}}),exportGlobalErrorCauseWrapper("URIError",function(r){return function(n){return d(r,this,arguments)}}),exportWebAssemblyErrorCauseWrapper("CompileError",function(r){return function(n){return d(r,this,arguments)}}),exportWebAssemblyErrorCauseWrapper("LinkError",function(r){return function(n){return d(r,this,arguments)}}),exportWebAssemblyErrorCauseWrapper("RuntimeError",function(r){return function(n){return d(r,this,arguments)}})},92648:function(r,n,o){"use strict";var l=o(69272),h=o(35651),d=o(35815),w=o(55817),y=o(58842),S=o(44256),b=o(97631),_=o(80043),R=o(97947),P=o(65375),T=o(6938),I=o(92455),O=o(32482),k=o(22715),N=o(97246),L=o(24072),j=o(73978),U=String,$=h("JSON","stringify"),K=y(/./.exec),Y=y("".charAt),X=y("".charCodeAt),J=y("".replace),Q=y("".slice),ee=y([].push),et=y(1.1.toString),ei=/[\uD800-\uDFFF]/g,er=/^[\uD800-\uDBFF]$/,en=/^[\uDC00-\uDFFF]$/,es=N(),eo=es.length,el=!L||S(function(){var r=h("Symbol")("stringify detection");return"[null]"!==$([r])||"{}"!==$({a:r})||"{}"!==$(Object(r))}),ea=S(function(){return'"\udf06\ud834"'!==$("\uDF06\uD834")||'"\udead"'!==$("\uDEAD")}),eh=el?function(r,n){var o=O(arguments),l=getReplacerFunction(n);if(!(!_(l)&&(void 0===r||P(r))))return o[1]=function(r,n){if(_(l)&&(n=w(l,this,U(r),n)),!P(n))return n},d($,null,o)}:$,fixIllFormedJSON=function(r,n,o){var l=Y(o,n-1),h=Y(o,n+1);return K(er,r)&&!K(en,h)||K(en,r)&&!K(er,l)?"\\u"+et(X(r,0),16):r},getReplacerFunction=function(r){if(_(r))return r;if(b(r)){for(var n=r.length,o=[],l=0;l<n;l++){var h=r[l];"string"==typeof h?ee(o,h):("number"==typeof h||"Number"===T(h)||"String"===T(h))&&ee(o,I(h))}var d=o.length,w=!0;return function(r,n){if(w)return w=!1,n;if(b(this))return n;for(var l=0;l<d;l++)if(o[l]===r)return n}}};$&&l({target:"JSON",stat:!0,arity:3,forced:el||ea||!j},{stringify:function(r,n,o){var l=getReplacerFunction(n),h=[],d=eh(r,function(r,n){var o=_(l)?w(l,this,U(r),n):n;return!j&&R(o)?es+(ee(h,o.rawJSON)-1):o},o);if("string"!=typeof d||(ea&&(d=J(d,ei,fixIllFormedJSON)),j))return d;for(var y="",S=d.length,b=0;b<S;b++){var P=Y(d,b);if('"'===P){var T=k(d,++b).end-1,I=Q(d,b,T);y+=Q(I,0,eo)===es?h[Q(I,eo)]:'"'+I+'"',b=T}else y+=P}return y}})},35214:function(r,n,o){"use strict";var l=o(69272),h=o(5040),d=o(64584);l({target:"Object",stat:!0},{fromEntries:function(r){var n={};return h(r,function(r,o){d(n,r,o)},{AS_ENTRIES:!0}),n}})},88901:function(r,n,o){"use strict";var l=o(69272),h=o(73430),d=o(44256);l({target:"Set",proto:!0,real:!0,forced:!o(79152)("difference",function(r){return 0===r.size})||d(function(){var r=new Set([1,2,3,4]);return 3!==r.difference({size:1,has:function(){return!0},keys:function(){var n=0;return{next:function(){var o=n++>1;return r.has(1)&&r.clear(),{done:o,value:2}}}}}).size})},{difference:h})},11297:function(r,n,o){"use strict";var l=o(69272),h=o(44256),d=o(48785);l({target:"Set",proto:!0,real:!0,forced:!o(79152)("intersection",function(r){return 2===r.size&&r.has(1)&&r.has(2)})||h(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))})},{intersection:d})},84213:function(r,n,o){"use strict";var l=o(69272),h=o(75636);l({target:"Set",proto:!0,real:!0,forced:!o(79152)("isDisjointFrom",function(r){return!r})},{isDisjointFrom:h})},21511:function(r,n,o){"use strict";var l=o(69272),h=o(20850);l({target:"Set",proto:!0,real:!0,forced:!o(79152)("isSubsetOf",function(r){return r})},{isSubsetOf:h})},7519:function(r,n,o){"use strict";var l=o(69272),h=o(871);l({target:"Set",proto:!0,real:!0,forced:!o(79152)("isSupersetOf",function(r){return!r})},{isSupersetOf:h})},49573:function(r,n,o){"use strict";var l=o(69272),h=o(34262),d=o(13150);l({target:"Set",proto:!0,real:!0,forced:!o(79152)("symmetricDifference")||!d("symmetricDifference")},{symmetricDifference:h})},53652:function(r,n,o){"use strict";var l=o(69272),h=o(39793),d=o(13150);l({target:"Set",proto:!0,real:!0,forced:!o(79152)("union")||!d("union")},{union:h})},4554:function(r,n,o){"use strict";var l=o(69272),h=o(58842),d=o(12924),w=o(55963),y=o(92455),S=o(44256),b=h("".charAt);l({target:"String",proto:!0,forced:S(function(){return"\uD842"!=="\uD842\uDFB7".at(-2)})},{at:function(r){var n=y(d(this)),o=n.length,l=w(r),h=l>=0?l:o+l;return h<0||h>=o?void 0:b(n,h)}})},43510:function(r,n,o){"use strict";var l=o(69272),h=o(55817),d=o(58842),w=o(12924),y=o(80043),S=o(56695),b=o(91059),_=o(92455),R=o(22112),P=o(80290),T=o(7175),I=o(61350),O=o(9168),k=I("replace"),N=TypeError,L=d("".indexOf),j=d("".replace),U=d("".slice),$=Math.max;l({target:"String",proto:!0},{replaceAll:function(r,n){var o,l,d,I,K,Y,X,J,Q,ee=w(this),et=0,ei="";if(S(r)){if((o=b(r))&&!~L(_(w(P(r))),"g"))throw new N("`.replaceAll` does not allow non-global regexes");if(l=R(r,k))return h(l,r,ee,n);if(O&&o)return j(_(ee),r,n)}for(d=_(ee),I=_(r),(K=y(n))||(n=_(n)),X=$(1,Y=I.length),J=L(d,I);-1!==J;)Q=K?_(n(I,J,d)):T(I,d,J,[],void 0,n),ei+=U(d,et,J)+Q,et=J+Y,J=J+X>d.length?-1:L(d,I,J+X);return et<d.length&&(ei+=U(d,et)),ei}})},95711:function(r,n,o){"use strict";var l=o(69272),h=o(84023),d=o(48150).clear;l({global:!0,bind:!0,enumerable:!0,forced:h.clearImmediate!==d},{clearImmediate:d})},22548:function(r,n,o){"use strict";o(95711),o(70949)},70949:function(r,n,o){"use strict";var l=o(69272),h=o(84023),d=o(48150).set,w=o(50290),y=h.setImmediate?w(d,!1):d;l({global:!0,bind:!0,enumerable:!0,forced:h.setImmediate!==y},{setImmediate:y})},46022:function(r,n,o){"use strict";o.d(n,{sZ:function(){return en}});var l,h,d,w,y,S=o(2265),b=o(54887),_=o(73553),R=o(3732),P=o(38015),T=o(54317),I=o(78444),O=o(36324),k=o(1518),N=o(98422),L=o(11070),j=o(51648);function Handsontable(r,n){let o=new _.Z(r,n||{},R.mc);return o.init(),o}(0,O.xN)(k.n),Handsontable.editors={BaseEditor:N.Hf},Handsontable.Core=function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new _.Z(r,n,R.mc)},Handsontable.DefaultSettings=(0,P.Z)(),Handsontable.hooks=T.Z.getSingleton(),Handsontable.CellCoords=L.Z,Handsontable.CellRange=j.Z,Handsontable.packageName="handsontable",Handsontable.buildDate="07/02/2025 16:13:23",Handsontable.version="14.6.2",Handsontable.languages={dictionaryKeys:I.Zs,getLanguageDictionary:I.qG,getLanguagesDictionaries:I.vq,registerLanguageDictionary:I.MG,getTranslatedPhrase:I.vk};var U=o(36903),$=o(57416);function _arrayLikeToArray(r,n){(null==n||n>r.length)&&(n=r.length);for(var o=0,l=Array(n);o<n;o++)l[o]=r[o];return l}function _callSuper(r,n,o){return n=_getPrototypeOf(n),function(r,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw TypeError("Derived constructors may only return object or undefined");return function(r){if(void 0===r)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return r}(r)}(r,_isNativeReflectConstruct()?Reflect.construct(n,o||[],_getPrototypeOf(r).constructor):n.apply(r,o))}function _classCallCheck(r,n){if(!(r instanceof n))throw TypeError("Cannot call a class as a function")}function _defineProperties(r,n){for(var o=0;o<n.length;o++){var l=n[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,_toPropertyKey(l.key),l)}}function _createClass(r,n,o){return n&&_defineProperties(r.prototype,n),o&&_defineProperties(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function _getPrototypeOf(r){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}function _inherits(r,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),n&&_setPrototypeOf(r,n)}function _isNativeReflectConstruct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(r){}return(_isNativeReflectConstruct=function(){return!!r})()}function ownKeys(r,n){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);n&&(l=l.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),o.push.apply(o,l)}return o}function _setPrototypeOf(r,n){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r})(r,n)}function _toPropertyKey(r){var n=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n);if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(r,"string");return"symbol"==typeof n?n:n+""}var K=null,Y="global";function getChildElementByType(r,n){var o=S.Children.toArray(r),l=S.Children.count(r),h=null;return 0!==l&&(h=1===l&&o[0].props[n]?o[0]:o.find(function(r){return void 0!==r.props[n]})),h||null}function getOriginalEditorClass(r){return r?r.type.WrappedComponent?r.type.WrappedComponent:r.type:null}function createEditorPortal(r,n){if(void 0===r||null===n)return null;var o=getContainerAttributesProps(n.props,!1);return o.className="".concat("hot-wrapper-editor-container"," ").concat(o.className),b.createPortal(S.createElement("div",Object.assign({},o),n),r.body)}function getExtendedEditorElement(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Y,l=getChildElementByType(r,"hot-editor"),h=getOriginalEditorClass(l);return l?S.cloneElement(l,{emitEditorInstance:function(r,o){n.get(h)||n.set(h,new Map),n.get(h).set(null!=o?o:Y,r)},editorColumnScope:o,isEditor:!0}):null}function getContainerAttributesProps(r){var n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return{id:r.id||(n?"hot-"+Math.random().toString(36).substring(5):void 0),className:r.className||"",style:r.style||{}}}var X=_createClass(function SettingsMapper(){_classCallCheck(this,SettingsMapper)},null,[{key:"getSettings",value:function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.prevProps,l=void 0===o?{}:o,h=n.isInit,d=void 0!==h&&h,w=n.initOnlySettingKeys,y=void 0===w?[]:w,shouldSkipProp=function(n){return!!(!d&&y.includes(n))&&l[n]===r[n]},S={};if(r.settings){var b=r.settings;for(var _ in b)b.hasOwnProperty(_)&&!shouldSkipProp(_)&&(S[_]=b[_])}for(var R in r)"settings"!==R&&"children"!==R&&!shouldSkipProp(R)&&r.hasOwnProperty(R)&&(S[R]=r[R]);return S}}]),J=function(r){function HotColumn(){return _classCallCheck(this,HotColumn),_callSuper(this,HotColumn,arguments)}return _inherits(HotColumn,r),_createClass(HotColumn,[{key:"getSettingsProps",value:function(){var r=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(n){return!r.internalProps.includes(n)}).reduce(function(n,o){return n[o]=r.props[o],n},{})}},{key:"getLocalEditorElement",value:function(){return getExtendedEditorElement(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var r=this.props._getChildElementByType(this.props.children,"hot-renderer"),n=this.getLocalEditorElement();this.columnSettings=X.getSettings(this.getSettingsProps()),null!==r&&(this.columnSettings.renderer=this.props._getRendererWrapper(r),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==n&&(this.columnSettings.editor=this.props._getEditorClass(n,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var r=createEditorPortal(this.props._getOwnerDocument(),this.getLocalEditorElement());return S.createElement(S.Fragment,null,r)}}])}(S.Component),Q=function(r){function RenderersPortalManager(){var r;return _classCallCheck(this,RenderersPortalManager),r=_callSuper(this,RenderersPortalManager,arguments),r.state={portals:[]},r}return _inherits(RenderersPortalManager,r),_createClass(RenderersPortalManager,[{key:"render",value:function(){return S.createElement(S.Fragment,null,this.state.portals)}}])}(S.Component),ee={exports:{}};ee.exports=(function(){if(y)return w;y=1;var r=d?h:(d=1,h="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");function emptyFunction(){}function emptyFunctionWithReset(){}return emptyFunctionWithReset.resetWarningCache=emptyFunction,w=function(){function shim(n,o,l,h,d,w){if(w!==r){var y=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}function getShim(){return shim}shim.isRequired=shim;var n={array:shim,bigint:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return n.PropTypes=n,n}})()();var et=(l=ee.exports)&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,ei=function(r){function HotTableClass(){var r;return _classCallCheck(this,HotTableClass),r=_callSuper(this,HotTableClass,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return _inherits(HotTableClass,r),_createClass(HotTableClass,[{key:"hotInstance",get:function(){return this.__hotInstance&&(!this.__hotInstance||this.__hotInstance.isDestroyed)?(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null):this.__hotInstance},set:function(r){this.__hotInstance=r}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!=typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(r){this.hotElementRef=r}},{key:"getRendererWrapper",value:function(r){var n=this;return function(o,l,h,d,w,y,_){var R=n.getRenderedCellCache(),P=n.getPortalContainerCache(),T="".concat(h,"-").concat(d),I=o.guid,O="".concat(I,"-").concat(T),k="".concat(T,"-").concat(I);if(R.has(T)&&(l.innerHTML=R.get(T).innerHTML),l&&!l.getAttribute("ghost-table")){for(var N=n.portalCache.get(k),L=P.get(O);l.firstChild;)l.removeChild(l.firstChild);if(N&&L)l.appendChild(L);else{var j=function(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,l=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0;o||(o=document),K||(K=o.createDocumentFragment());var d=null!=h?h:o.createElement("DIV");K.appendChild(d);var w=S.cloneElement(r,function(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(o),!0).forEach(function(n){var l,h;l=n,h=o[n],(l=_toPropertyKey(l))in r?Object.defineProperty(r,l,{value:h,enumerable:!0,configurable:!0,writable:!0}):r[l]=h}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(o,n))})}return r}({key:"".concat(n.row,"-").concat(n.col)},n));return{portal:b.createPortal(w,d,l),portalContainer:d}}(r,{TD:l,row:h,col:d,prop:w,value:y,cellProperties:_,isRenderer:!0},l.ownerDocument,k,L),U=j.portal,$=j.portalContainer;P.set(O,$),l.appendChild($),n.portalCache.set(k,U)}}return R.set(T,l),l}}},{key:"getEditorClass",value:function(r){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y,l=getOriginalEditorClass(r),h=null===(n=this.getEditorCache().get(l))||void 0===n?void 0:n.get(o);return this.makeEditorClass(h)}},{key:"makeEditorClass",value:function(r){var n=function(n){function CustomEditor(n){var o;return _classCallCheck(this,CustomEditor),o=_callSuper(this,CustomEditor,[n]),r.hotCustomEditorInstance=o,o.editorComponent=r,o}return _inherits(CustomEditor,n),_createClass(CustomEditor,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Handsontable.editors.BaseEditor);return Object.getOwnPropertyNames(Handsontable.editors.BaseEditor.prototype).forEach(function(o){"constructor"!==o&&(n.prototype[o]=function(){for(var n,l=arguments.length,h=Array(l),d=0;d<l;d++)h[d]=arguments[d];return(n=r[o]).call.apply(n,[r].concat(h))})}),n}},{key:"getGlobalRendererElement",value:function(){return getChildElementByType(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return getExtendedEditorElement(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var r,n,o,l=arguments.length>0&&void 0!==arguments[0]&&arguments[0],h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=this._isHotInstanceDestroyed()?[]:(null===(r=this.hotInstance)||void 0===r||null===(r=r.getSettings())||void 0===r?void 0:r._initOnlySettings)||[],w=X.getSettings(this.props,{prevProps:h,isInit:l,initOnlySettingKeys:d}),y=this.getGlobalRendererElement(),S=this.getGlobalEditorElement();return w.columns=this.columnSettings.length?this.columnSettings:w.columns,S?w.editor=this.getEditorClass(S,Y):this.props.editor||null!==(n=this.props.settings)&&void 0!==n&&n.editor?w.editor=this.props.editor||this.props.settings.editor:w.editor=(0,$.y$)("text"),y?(w.renderer=this.getRendererWrapper(y),this.componentRendererColumns.set("global",!0)):this.props.renderer||null!==(o=this.props.settings)&&void 0!==o&&o.renderer?w.renderer=this.props.renderer||this.props.settings.renderer:w.renderer=(0,U.Bp)("text"),w}},{key:"displayAutoSizeWarning",value:function(r){var n,o;this.hotInstance&&(null!==(n=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==n&&n.enabled||null!==(o=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==o&&o.enabled)&&this.componentRendererColumns.size>0&&function(){if("undefined"!=typeof console){var r;(r=console).warn.apply(r,arguments)}}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(r,n){this.columnSettings[n]=r}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var r;this.renderersPortalManager.setState({portals:function(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r=this.portalCache.values())||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,n){if(r){if("string"==typeof r)return _arrayLikeToArray(r,n);var o=({}).toString.call(r).slice(8,-1);return"Object"===o&&r.constructor&&(o=r.constructor.name),"Map"===o||"Set"===o?Array.from(r):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(r,n):void 0}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()})}},{key:"updateHot",value:function(r){this.hotInstance&&this.hotInstance.updateSettings(r,!1)}},{key:"setRenderersPortalManagerRef",value:function(r){this.renderersPortalManager=r}},{key:"componentDidMount",value:function(){var r=this,n=this.createNewGlobalSettings(!0);this.hotInstance=new Handsontable.Core(this.hotElementRef,n),this.hotInstance.addHook("beforeViewRender",function(){return r.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return r.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(n)}},{key:"componentDidUpdate",value:function(r){this.clearCache();var n=this.createNewGlobalSettings(!1,r);this.updateHot(n),this.displayAutoSizeWarning(n)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var r=this,n=S.Children.toArray(this.props.children).filter(function(r){return r.type===J}).map(function(n,o){return S.cloneElement(n,{_componentRendererColumns:r.componentRendererColumns,_emitColumnSettings:r.setHotColumnSettings.bind(r),_columnIndex:o,_getChildElementByType:getChildElementByType.bind(r),_getRendererWrapper:r.getRendererWrapper.bind(r),_getEditorClass:r.getEditorClass.bind(r),_getOwnerDocument:r.getOwnerDocument.bind(r),_getEditorCache:r.getEditorCache.bind(r),children:n.props.children})}),o=getContainerAttributesProps(this.props),l=createEditorPortal(this.getOwnerDocument(),this.getGlobalEditorElement());return S.createElement(S.Fragment,null,S.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),n),S.createElement(Q,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return"14.6.2"}}])}(S.Component);ei.propTypes={style:et.object,id:et.string,className:et.string};var er=["children"],en=S.forwardRef(function(r,n){var o,l=r.children,h=function(r,n){if(null==r)return{};var o,l,h=function(r,n){if(null==r)return{};var o={};for(var l in r)if(({}).hasOwnProperty.call(r,l)){if(n.includes(l))continue;o[l]=r[l]}return o}(r,n);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(r);for(l=0;l<d.length;l++)o=d[l],n.includes(o)||({}).propertyIsEnumerable.call(r,o)&&(h[o]=r[o])}return h}(r,er),d="function"==typeof S.useId?S.useId():void 0,w=null!==(o=h.id)&&void 0!==o?o:d;return S.createElement(ei,Object.assign({id:w},h,{ref:n}),l)});en.version=ei.version,S.Component},90292:function(r,n,o){"use strict";o.d(n,{P:function(){return stringify},Q:function(){return parse}});let l=/^(\r\n|\n\r|\r|\n)/,h=/^[^\t\r\n]+/,d=/^\t/;function parse(r){let n;let o=[[""]];if(0===r.length)return o;let w=0,y=0;for(;r.length>0&&n!==r.length;)if(n=r.length,r.match(d))r=r.replace(d,""),w+=1,o[y][w]="";else if(r.match(l))r=r.replace(l,""),w=0,o[y+=1]=[""];else{let n="";if(r.startsWith('"')){let o=0,l=!0;for(;l;){let h=r.slice(0,1);'"'===h&&(o+=1),n+=h,(0===(r=r.slice(1)).length||r.match(/^[\t\r\n]/)&&o%2==0)&&(l=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,r=>Array(Math.floor(r.length/2)).fill('"').join(""))}else{let o=r.match(h);n=o?o[0]:"",r=r.slice(n.length)}o[y][w]=n}return o}function stringify(r){let n,o,l,h,d;let w="";for(n=0,o=r.length;n<o;n+=1){for(l=0,h=r[n].length;l<h;l+=1)l>0&&(w+="	"),"string"==typeof(d=r[n][l])?d.indexOf("\n")>-1?w+=`"${d.replace(/"/g,'""')}"`:w+=d:null==d?w+="":w+=d;n!==o-1&&(w+="\n")}return w}},26582:function(r,n,o){"use strict";function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}o.d(n,{f:function(){return ViewportBaseCalculator}}),o(57855);let ViewportBaseCalculator=class ViewportBaseCalculator{constructor(r){_defineProperty(this,"calculationTypes",[]),_defineProperty(this,"calculationResults",new Map),this.calculationTypes=r}_initialize(r){this.calculationTypes.forEach(n=>{let[o,l]=n;this.calculationResults.set(o,l),l.initialize(r)})}_process(r,n){this.calculationTypes.forEach(o=>{let[,l]=o;return l.process(r,n)})}_finalize(r){this.calculationTypes.forEach(n=>{let[,o]=n;return o.finalize(r)})}getResultsFor(r){return this.calculationResults.get(r)}}},27431:function(r,n,o){"use strict";o.d(n,{$:function(){return h},E:function(){return ViewportColumnsCalculator}}),o(57855),o(58563);var l=o(26582);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let h=50;let ViewportColumnsCalculator=class ViewportColumnsCalculator extends l.f{constructor(r){let{calculationTypes:n,viewportWidth:o,scrollOffset:l,totalColumns:h,columnWidthFn:d,overrideFn:w,inlineStartOffset:y}=r;super(n),_defineProperty(this,"viewportWidth",0),_defineProperty(this,"scrollOffset",0),_defineProperty(this,"zeroBasedScrollOffset",0),_defineProperty(this,"totalColumns",0),_defineProperty(this,"columnWidthFn",null),_defineProperty(this,"columnWidth",0),_defineProperty(this,"overrideFn",null),_defineProperty(this,"inlineStartOffset",0),_defineProperty(this,"totalCalculatedWidth",0),_defineProperty(this,"startPositions",[]),_defineProperty(this,"needReverse",!0),this.viewportWidth=o,this.scrollOffset=l,this.zeroBasedScrollOffset=Math.max(l,0),this.totalColumns=h,this.columnWidthFn=d,this.overrideFn=w,this.inlineStartOffset=y,this.calculate()}calculate(){this._initialize(this);for(let r=0;r<this.totalColumns;r++)if(this.columnWidth=this.getColumnWidth(r),this._process(r,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(r){let n=this.columnWidthFn(r);return isNaN(n)?h:n}}},3391:function(r,n,o){"use strict";o.d(n,{R:function(){return h},U:function(){return ViewportRowsCalculator}}),o(57855),o(58563);var l=o(26582);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let h=23;let ViewportRowsCalculator=class ViewportRowsCalculator extends l.f{constructor(r){let{calculationTypes:n,viewportHeight:o,scrollOffset:l,totalRows:h,rowHeightFn:d,overrideFn:w,horizontalScrollbarHeight:y}=r;super(n),_defineProperty(this,"viewportHeight",0),_defineProperty(this,"scrollOffset",0),_defineProperty(this,"zeroBasedScrollOffset",0),_defineProperty(this,"totalRows",0),_defineProperty(this,"rowHeightFn",null),_defineProperty(this,"rowHeight",0),_defineProperty(this,"overrideFn",null),_defineProperty(this,"horizontalScrollbarHeight",0),_defineProperty(this,"innerViewportHeight",0),_defineProperty(this,"totalCalculatedHeight",0),_defineProperty(this,"startPositions",[]),_defineProperty(this,"needReverse",!0),this.viewportHeight=o,this.scrollOffset=l,this.zeroBasedScrollOffset=Math.max(l,0),this.totalRows=h,this.rowHeightFn=d,this.overrideFn=w,this.horizontalScrollbarHeight=null!=y?y:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let r=0;r<this.totalRows;r++)if(this.rowHeight=this.getRowHeight(r),this._process(r,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(r){let n=this.rowHeightFn(r);return isNaN(n)?h:n}}},11070:function(r,n,o){"use strict";function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function _classPrivateFieldGet(r,n){return r.get(_assertClassBrand(r,n))}function _classPrivateFieldSet(r,n,o){return r.set(_assertClassBrand(r,n),o),o}function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}o(57855);var l=new WeakMap;let CellCoords=class CellCoords{constructor(r,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_defineProperty(this,"row",null),_defineProperty(this,"col",null),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,!1),_classPrivateFieldSet(l,this,o),void 0!==r&&void 0!==n&&(this.row=r,this.col=n)}isValid(r){let{countRows:n,countCols:o,countRowHeaders:l,countColHeaders:h}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...r};return!!Number.isInteger(this.row)&&!!Number.isInteger(this.col)&&!(this.row<-h)&&!(this.col<-l)&&!(this.row>=n)&&!(this.col>=o)}isEqual(r){return r===this||this.row===r.row&&this.col===r.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet(l,this)}isSouthEastOf(r){return this.row>=r.row&&(_classPrivateFieldGet(l,this)?this.col<=r.col:this.col>=r.col)}isNorthWestOf(r){return this.row<=r.row&&(_classPrivateFieldGet(l,this)?this.col>=r.col:this.col<=r.col)}isSouthWestOf(r){return this.row>=r.row&&(_classPrivateFieldGet(l,this)?this.col>=r.col:this.col<=r.col)}isNorthEastOf(r){return this.row<=r.row&&(_classPrivateFieldGet(l,this)?this.col<=r.col:this.col>=r.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(r){return Number.isInteger(null==r?void 0:r.row)&&(this.row=r.row),Number.isInteger(null==r?void 0:r.col)&&(this.col=r.col),r instanceof CellCoords&&_classPrivateFieldSet(l,this,r.isRtl()),this}clone(){return new CellCoords(this.row,this.col,_classPrivateFieldGet(l,this))}toObject(){return{row:this.row,col:this.col}}};n.Z=CellCoords},51648:function(r,n,o){"use strict";o(57855),o(58563);var l=o(11070);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function _classPrivateFieldGet(r,n){return r.get(_assertClassBrand(r,n))}function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var h=new WeakMap;let CellRange=class CellRange{constructor(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_defineProperty(this,"highlight",null),_defineProperty(this,"from",null),_defineProperty(this,"to",null),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,h),h.set(this,!1),this.highlight=r.clone(),this.from=n.clone(),this.to=o.clone(),h.set(_assertClassBrand(h,this),l)}setHighlight(r){return this.highlight=r.clone(),this}setFrom(r){return this.from=r.clone(),this}setTo(r){return this.to=r.clone(),this}isValid(r){return this.from.isValid(r)&&this.to.isValid(r)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!!(this.from.isHeader()&&this.to.isHeader())||this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(r){let{row:n,col:o}=r,l=this.getOuterTopStartCorner(),h=this.getOuterBottomEndCorner();return l.row<=n&&h.row>=n&&l.col<=o&&h.col>=o}includesRange(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}isEqual(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}overlaps(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}isNorthWestOf(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}isOverlappingHorizontally(r){return this.getOuterTopEndCorner().col>=r.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=r.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=r.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=r.getOuterTopStartCorner().col}isOverlappingVertically(r){return this.getOuterBottomStartCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=r.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=r.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=r.getOuterTopRightCorner().row}expand(r){let n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return(r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col)&&(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0)}expandByRange(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this.includesRange(r)||!this.overlaps(r))return!1;let o=this.getOuterTopStartCorner(),l=this.getOuterBottomEndCorner(),h=this.getDirection(),d=r.getOuterTopStartCorner(),w=r.getOuterBottomEndCorner(),y=Math.min(o.row,d.row),S=Math.min(o.col,d.col),b=Math.max(l.row,w.row),_=Math.max(l.col,w.col),R=this._createCellCoords(y,S),P=this._createCellCoords(b,_);return this.from=R,this.to=P,this.setDirection(h),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(r){switch(r){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){let r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){let r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet(h,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet(h,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet(h,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet(h,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet(h,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet(h,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet(h,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet(h,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(r){return r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(r){return r instanceof l.Z&&(r.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():r.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():r.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():r.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(r){if(!this.includesRange(r))return[];let n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},l=[];return n.top===o.top&&l.push("top"),n.right===o.right&&l.push(_classPrivateFieldGet(h,this)?"left":"right"),n.bottom===o.bottom&&l.push("bottom"),n.left===o.left&&l.push(_classPrivateFieldGet(h,this)?"right":"left"),l}getInner(){let r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[];for(let l=r.row;l<=n.row;l++)for(let h=r.col;h<=n.col;h++)this.from.row===l&&this.from.col===h||this.to.row===l&&this.to.col===h||o.push(this._createCellCoords(l,h));return o}getAll(){let r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[];for(let l=r.row;l<=n.row;l++)for(let h=r.col;h<=n.col;h++)r.row===l&&r.col===h?o.push(r):n.row===l&&n.col===h?o.push(n):o.push(this._createCellCoords(l,h));return o}forAll(r){let n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let l=n.row;l<=o.row;l++)for(let h=n.col;h<=o.col;h++){let n=r(l,h);if(!1===n)return}}clone(){return new CellRange(this.highlight,this.from,this.to,_classPrivateFieldGet(h,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(r,n){return new l.Z(r,n,_classPrivateFieldGet(h,this))}};n.Z=CellRange},58352:function(r,n,o){"use strict";o.d(n,{$7:function(){return _},AI:function(){return d},BA:function(){return b},CD:function(){return l},Nc:function(){return h},Os:function(){return S},P$:function(){return y},t8:function(){return w}});let l="active-header",h="header",d="area",w="focus",y="fill",S="row",b="column",_="custom-selection"},36324:function(r,n,o){"use strict";o.d(n,{DA:function(){return _getItem},V1:function(){return b},xN:function(){return _register}}),o(57855);var l=o(82656),h=o(57416),d=o(36903),w=o(92740);let{register:y,getItem:S,hasItem:b,getNames:_,getValues:R}=(0,l.Z)("cellTypes");function _getItem(r){if(!b(r))throw Error(`You declared cell type "${r}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return S(r)}function _register(r,n){"string"!=typeof r&&(r=(n=r).CELL_TYPE);let{editor:o,renderer:l,validator:S}=n;o&&(0,h.qm)(r,o),l&&(0,d.zn)(r,l),S&&(0,w.Ie)(r,S),y(r,n)}},1518:function(r,n,o){"use strict";o.d(n,{n:function(){return d}});var l=o(2694),h=o(49532);let d={CELL_TYPE:"text",editor:l.H,renderer:h.V}},18435:function(r,n,o){"use strict";o.d(n,{o:function(){return installFocusCatcher}});var l=o(82659),h=o(5566),d=o(18200);function createInputElement(r){let n=r.rootDocument,o=n.createElement("input");return o.type="text",o.classList.add("htFocusCatcher"),r.getSettings().ariaTags&&(0,h.P$)(o,[(0,d.Rn)(),(0,d.cV)()]),o}function installFocusCatcher(r){let n;let clampCoordsIfNeeded=n=>{if(!n)return null;let o=getMostTopStartPosition(r),l=getMostBottomEndPosition(r);return n.col<o.col&&(n.col=o.col),n.col>l.col&&(n.col=l.col),n.row<o.row&&(n.row=o.row),n.row>l.row&&(n.row=l.row),n},{activate:o,deactivate:h}=function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.rootElement,l=createInputElement(r),h=createInputElement(r);return l.addEventListener("focus",()=>null==n?void 0:n.onFocusFromTop()),h.addEventListener("focus",()=>null==n?void 0:n.onFocusFromBottom()),o.firstChild.before(l),o.lastChild.after(h),{activate(){r._registerTimeout(()=>{l.tabIndex=0,h.tabIndex=0},10)},deactivate(){r._registerTimeout(()=>{l.tabIndex=-1,h.tabIndex=-1},10)}}}(r,{onFocusFromTop(){var o;let l=null!==(o=clampCoordsIfNeeded(n))&&void 0!==o?o:getMostTopStartPosition(r);l&&(r.runHooks("modifyFocusOnTabNavigation","from_above",l),r.selectCell(l.row,l.col)),r.listen()},onFocusFromBottom(){var o;let l=null!==(o=clampCoordsIfNeeded(n))&&void 0!==o?o:getMostBottomEndPosition(r);l&&(r.runHooks("modifyFocusOnTabNavigation","from_below",l),r.selectCell(l.row,l.col)),r.listen()}}),d={wrapped:!1,flipped:!1},w=!0,y=!1,S=!1;r.addHook("afterListen",()=>h()),r.addHook("afterUnlisten",()=>o()),r.addHook("afterSelection",(o,l,h,b,_)=>{if(y&&(d.wrapped&&d.flipped||S)&&(S=!1,_.value=!0),w){var R;n=null===(R=r.getSelectedRangeLast())||void 0===R?void 0:R.highlight}}),r.addHook("beforeRowWrap",(r,n,o)=>{d.wrapped=!0,d.flipped=o});let b={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:l.W,group:"focusCatcher"};r.getShortcutManager().getContext("grid").addShortcuts([{...b,callback:()=>{let{tabNavigation:n}=r.getSettings();y=!0,r.getSelectedRangeLast()&&!n&&(w=!1),n||(S=!0)},position:"before"},{...b,callback:o=>{let{tabNavigation:l,autoWrapRow:h}=r.getSettings();if(y=!1,w=!0,!l||!r.selection.isSelected()||h&&d.wrapped&&d.flipped||!h&&d.wrapped)return h&&d.wrapped&&d.flipped&&(n=o.shiftKey?getMostTopStartPosition(r):getMostBottomEndPosition(r)),d.wrapped=!1,d.flipped=!1,r.deselectCell(),r.unlisten(),!1;o.preventDefault()},position:"after"}])}function getMostTopStartPosition(r){let{rowIndexMapper:n,columnIndexMapper:o}=r,{navigableHeaders:l}=r.getSettings(),h=l&&r.countColHeaders()>0?-r.countColHeaders():0,d=l&&r.countRowHeaders()>0?-r.countRowHeaders():0;return(0===h&&(h=n.getVisualFromRenderableIndex(h)),0===d&&(d=o.getVisualFromRenderableIndex(d)),null===h||null===d)?null:r._createCellCoords(h,d)}function getMostBottomEndPosition(r){var n,o;let{rowIndexMapper:l,columnIndexMapper:h}=r,{navigableHeaders:d}=r.getSettings(),w=l.getRenderableIndexesLength()-1,y=h.getRenderableIndexesLength()-1;if(w<0){if(!d||0===r.countColHeaders())return null;w=-1}if(y<0){if(!d||0===r.countColHeaders())return null;y=-1}return r._createCellCoords(null!==(n=l.getVisualFromRenderableIndex(w))&&void 0!==n?n:w,null!==(o=h.getVisualFromRenderableIndex(y))&&void 0!==o?o:y)}},53996:function(r,n,o){"use strict";function createViewportScroller(r){let{selection:n}=r,o=!1,l=!1;return{resume(){l=!1},suspend(){l=!0},skipNextScrollCycle(){o=!0},scrollTo(h){var d;let w;if(o||l){o=!1;return}n.isFocusSelectionChanged()?w=n=>{r.scrollViewportTo(n.toObject())}:n.isSelectedByCorner()?w=()=>{}:n.isSelectedByRowHeader()?w=n=>{let{row:o}=n;r.scrollViewportTo({row:o})}:n.isSelectedByColumnHeader()?w=n=>{let{col:o}=n;r.scrollViewportTo({col:o})}:1===n.getSelectedRange().size()&&n.isMultiple()?w=n=>{r.scrollViewportTo(n.toObject())}:1!==n.getSelectedRange().size()||n.isMultiple()?n.getSelectedRange().size()>1&&(w=n=>{r.scrollViewportTo(n.toObject())}):w=n=>{let o=r.selection.getSelectionSource(),{row:l,col:h}=n;if(l<0&&h>=0)r.scrollViewportTo({col:h});else if(h<0&&l>=0)r.scrollViewportTo({row:l});else{if("mouse"===o&&(h===r.view.getLastPartiallyVisibleColumn()||l===r.view.getLastPartiallyVisibleRow()))return;r.scrollViewportTo({row:l,col:h})}},null===(d=w)||void 0===d||d(h)}}}o.d(n,{t:function(){return createViewportScroller}})},63891:function(r,n,o){"use strict";o(57855),o(58563);var l=o(69488),h=o(77628),d=o(99440),w=o(67790),y=o(98179);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}n.Z=class{constructor(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_defineProperty(this,"hot",void 0),_defineProperty(this,"data",void 0),_defineProperty(this,"dataType","array"),_defineProperty(this,"colToProp",()=>{}),_defineProperty(this,"propToCol",()=>{}),this.hot=r,this.data=n}modifyRowData(r){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),void 0===n||Number.isInteger(n)?this.data[r]:n}getData(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,r):this.data}setData(r){this.data=r}getAtColumn(r){let n=[];return(0,d.Bk)(this.data,(o,l)=>{let h=this.getAtCell(l,r);n.push(h)}),n}getAtRow(r,n,o){let h=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=void 0===n&&void 0===o,{dataDotNotation:S}=this.hot.getSettings(),b=null,_=null;if(Array.isArray(b=this.modifyRowData(r)))_=[],d?b.forEach((n,o)=>{_[o]=this.getAtPhysicalCell(r,o,b)}):(0,w.q4)(n,o,o=>{_[o-n]=this.getAtPhysicalCell(r,o,b)});else if((0,l.Kn)(b)||(0,y.mf)(b)){if(_=h?[]:{},!d||h){let d=this.countFirstRowKeys()-1;(0,w.q4)(0,d,w=>{let y=this.colToProp(w);if(w>=(n||0)&&w<=(o||d)&&!Number.isInteger(y)){let n=this.getAtPhysicalCell(r,y,b);h?_.push(n):S?(0,l.Hn)(_,y,n):_[y]=n}})}else(0,l._l)(b,(n,o)=>{let h=this.getAtPhysicalCell(r,o,b);S?(0,l.Hn)(_,o,h):_[o]=h})}return _}setAtCell(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let h=(0,l.sm)(o);this.hot.runHooks("modifySourceData",r,n,h,"set"),h.isTouched()&&(o=h.value)}Number.isInteger(n)?this.data[r][n]=o:(0,l.Hn)(this.data[r],n,o)}}getAtPhysicalCell(r,n,o){let h=null;if(o){if("string"==typeof n){let{dataDotNotation:r}=this.hot.getSettings();h=r?(0,l.$s)(o,n):o[n]}else h="function"==typeof n?n(o):o[n]}if(this.hot.hasHook("modifySourceData")){let o=(0,l.sm)(h);this.hot.runHooks("modifySourceData",r,n,o,"get"),o.isTouched()&&(h=o.value)}return h}getAtCell(r,n){let o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}getByRange(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=!1,h=null,d=null,y=null,S=null;null===r||null===n?(l=!0,h=0,y=this.countRows()-1):(h=Math.min(r.row,n.row),d=Math.min(r.col,n.col),y=Math.max(r.row,n.row),S=Math.max(r.col,n.col));let b=[];return(0,w.q4)(h,y,r=>{b.push(l?this.getAtRow(r,void 0,void 0,o):this.getAtRow(r,d,S,o))}),b}countRows(){if(this.hot.hasHook("modifySourceLength")){let r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}countFirstRowKeys(){return(0,h.Eb)(this.data)}destroy(){this.data=null,this.hot=null}}},82230:function(r,n,o){"use strict";o.d(n,{Z:function(){return MetaManager}}),o(57855);var l=o(69488);o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var h=o(36324);function extendByMetaType(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,d="string"==typeof n.type?(0,h.DA)(n.type):n.type;if(r._automaticallyAssignedMetaProps&&(0,l._l)(n,(n,o)=>void r._automaticallyAssignedMetaProps.delete(o)),!(0,l.Kn)(d))return;o!==r||r._automaticallyAssignedMetaProps||(r._automaticallyAssignedMetaProps=new Set);let w={};(0,l._l)(d,(n,h)=>{var d,y;"CELL_TYPE"!==h&&((null===(d=o._automaticallyAssignedMetaProps)||void 0===d?void 0:d.has(h))||!(0,l.nr)(o,h))&&(w[h]=n,null===(y=r._automaticallyAssignedMetaProps)||void 0===y||y.add(h))}),(0,l.l7)(r,w)}function isUnsignedNumber(r){return Number.isInteger(r)&&r>=0}function assert(r,n){if(!r())throw Error(`Assertion failed: ${n}`)}var d=o(38015);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let GlobalMeta=class GlobalMeta{constructor(r){_defineProperty(this,"metaCtor",class{}),_defineProperty(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,l.l7)(this.meta,(0,d.Z)()),this.meta.instance=r}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(r){var n;(0,l.l7)(this.meta,r),extendByMetaType(this.meta,{...r,type:null!==(n=r.type)&&void 0!==n?n:this.meta.type},r)}};let TableMeta=class TableMeta{constructor(r){var n,o,l;o=void 0,(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n="meta","string"))?l:l+"")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o;let h=r.getMetaConstructor();this.meta=new h}getMeta(){return this.meta}updateMeta(r){(0,l.l7)(this.meta,r),extendByMetaType(this.meta,r,r)}};o(58563);var w=o(99440);function lazyFactoryMap_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let LazyFactoryMap=class LazyFactoryMap{constructor(r){lazyFactoryMap_defineProperty(this,"valueFactory",void 0),lazyFactoryMap_defineProperty(this,"data",[]),lazyFactoryMap_defineProperty(this,"index",[]),lazyFactoryMap_defineProperty(this,"holes",new Set),this.valueFactory=r}obtain(r){let n;assert(()=>isUnsignedNumber(r),"Expecting an unsigned number.");let o=this._getStorageIndexByKey(r);if(o>=0)void 0===(n=this.data[o])&&(n=this.valueFactory(r),this.data[o]=n);else if(n=this.valueFactory(r),this.holes.size>0){let o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=n,this.index[r]=o}else this.data.push(n),this.index[r]=this.data.length-1;return n}insert(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;assert(()=>isUnsignedNumber(r)||null==r,"Expecting an unsigned number or null/undefined argument.");let o=[],l=this.data.length;for(let r=0;r<n;r++)o.push(l+r),this.data.push(void 0);let h=null==r?this.index.length:r;this.index=[...this.index.slice(0,h),...o,...this.index.slice(h)]}remove(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;assert(()=>isUnsignedNumber(r)||null==r,"Expecting an unsigned number or null/undefined argument.");let o=this.index.splice(null==r?this.index.length-n:r,n);for(let r=0;r<o.length;r++){let n=o[r];"number"==typeof n&&this.holes.add(n)}}size(){return this.data.length-this.holes.size}values(){return(0,w.w7)(this.data,(r,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){let r=[];for(let n=0;n<this.data.length;n++){let o=this._getKeyByStorageIndex(n);-1!==o&&r.push([o,this.data[n]])}let n=0;return{next:()=>{if(n<r.length){let o=r[n];return n+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(r){return this.index.length>r?this.index[r]:-1}_getKeyByStorageIndex(r){return this.index.indexOf(r)}[Symbol.iterator](){return this.entries()}};function columnMeta_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let y=["data","width"];let ColumnMeta=class ColumnMeta{constructor(r){columnMeta_defineProperty(this,"globalMeta",void 0),columnMeta_defineProperty(this,"metas",new LazyFactoryMap(()=>this._createMeta())),this.globalMeta=r,this.metas=new LazyFactoryMap(()=>this._createMeta())}updateMeta(r,n){let o=this.getMeta(r);(0,l.l7)(o,n),extendByMetaType(o,n)}createColumn(r,n){this.metas.insert(r,n)}removeColumn(r,n){this.metas.remove(r,n)}getMeta(r){return this.metas.obtain(r)}getMetaConstructor(r){return this.metas.obtain(r).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function ColumnMeta(){}(0,l.ED)(ColumnMeta,r);for(let r=0;r<n.length;r++)ColumnMeta.prototype[n[r]]=void 0;return ColumnMeta}(this.globalMeta.getMetaConstructor(),y).prototype}};var S=o(2518);function cellMeta_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let CellMeta=class CellMeta{constructor(r){cellMeta_defineProperty(this,"columnMeta",void 0),cellMeta_defineProperty(this,"metas",new LazyFactoryMap(()=>this._createRow())),this.columnMeta=r}updateMeta(r,n,o){let h=this.getMeta(r,n);(0,l.l7)(h,o),extendByMetaType(h,o)}createRow(r,n){this.metas.insert(r,n)}createColumn(r,n){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}removeRow(r,n){this.metas.remove(r,n)}removeColumn(r,n){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}getMeta(r,n,o){let l=this.metas.obtain(r).obtain(n);return void 0===o?l:l[o]}setMeta(r,n,o,l){var h;let d=this.metas.obtain(r).obtain(n);null===(h=d._automaticallyAssignedMetaProps)||void 0===h||h.delete(o),d[o]=l}removeMeta(r,n,o){let l=this.metas.obtain(r).obtain(n);delete l[o]}getMetas(){let r=[],n=Array.from(this.metas.values());for(let o=0;o<n.length;o++)(0,S.$K)(n[o])&&r.push(...n[o].values());return r}getMetasAtRow(r){assert(()=>isUnsignedNumber(r),"Expecting an unsigned number.");let n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap(r=>this._createMeta(r))}_createMeta(r){let n=this.columnMeta.getMetaConstructor(r);return new n}};var b=o(63437);let MetaManager=class MetaManager{constructor(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=r,this.globalMeta=new GlobalMeta(r),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),o.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(r){this.globalMeta.updateMeta(r)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(r){this.tableMeta.updateMeta(r)}getColumnMeta(r){return this.columnMeta.getMeta(r)}updateColumnMeta(r,n){this.columnMeta.updateMeta(r,n)}getCellMeta(r,n,o){let{visualRow:l,visualColumn:h}=o,d=this.cellMeta.getMeta(r,n);return d.visualRow=l,d.visualCol=h,d.row=r,d.col=n,this.runLocalHooks("afterGetCellMeta",d),d}getCellMetaKeyValue(r,n,o){if("string"!=typeof o)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}setCellMeta(r,n,o,l){this.cellMeta.setMeta(r,n,o,l)}updateCellMeta(r,n,o){this.cellMeta.updateMeta(r,n,o)}removeCellMeta(r,n,o){this.cellMeta.removeMeta(r,n,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(r){return this.cellMeta.getMetasAtRow(r)}createRow(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(r,n)}removeRow(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(r,n)}createColumn(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}removeColumn(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};(0,l.jB)(MetaManager,b.Z)},90243:function(r,n,o){"use strict";o.d(n,{$:function(){return DynamicCellMetaMod}}),o(57855),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var l=o(54317),h=o(69488),d=o(98179);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let DynamicCellMetaMod=class DynamicCellMetaMod{constructor(r){_defineProperty(this,"metaManager",void 0),_defineProperty(this,"metaSyncMemo",new Map),this.metaManager=r,r.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),l.Z.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(r){var n,o;let{row:l,col:w}=r;if(null!==(n=this.metaSyncMemo.get(l))&&void 0!==n&&n.has(w))return;let{visualRow:y,visualCol:S}=r,b=this.metaManager.hot,_=b.colToProp(S);r.prop=_,b.runHooks("beforeGetCellMeta",y,S,r);let R=(0,h.nr)(r,"type")?r.type:null,P=(0,d.mf)(r.cells)?r.cells(l,w,_):null;R&&(P?P.type=null!==(o=P.type)&&void 0!==o?o:R:P={type:R}),P&&this.metaManager.updateCellMeta(l,w,P),b.runHooks("afterGetCellMeta",y,S,r),this.metaSyncMemo.has(l)||this.metaSyncMemo.set(l,new Set),this.metaSyncMemo.get(l).add(w)}}},60045:function(r,n,o){"use strict";function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}o.d(n,{_:function(){return ExtendMetaPropertiesMod}}),o(57855),o(58563),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var l=new WeakMap;let ExtendMetaPropertiesMod=class ExtendMetaPropertiesMod{constructor(r){_defineProperty(this,"metaManager",void 0),_defineProperty(this,"usageTracker",new Set),_defineProperty(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){let n=this.metaManager.hot.isRtl();if(n&&"fixedColumnsLeft"===r)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,(r,n,o)=>{if(!o)throw Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=r,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((r,n)=>{let{initOnly:o,target:h,onChange:d}=r,w="string"==typeof h,y=w?h:n,S=`_${y}`;(this.metaManager.globalMeta.meta[S]=this.metaManager.globalMeta.meta[y],d)?(this.installPropWatcher(n,S,d),w&&this.installPropWatcher(h,S,d)):o&&(this.installPropWatcher(n,S,l.get(function(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:void 0;throw TypeError("Private element is not present on this object")}(l,this))),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(r,n,o){let l=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get(){return this[n]},set(h){let d=!l.usageTracker.has(r);l.usageTracker.add(r),o.call(l,r,h,d),this[n]=h},enumerable:!0,configurable:!0})}}},39620:function(r,n,o){"use strict";o.d(n,{o:function(){return replaceData}}),o(57855),o(58563);var l=o(66411),h=o(98179),d=o(90292),w=o(77628),y=o(69488),S=o(99440),b=o(67790),_=o(2518);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let DataMap=class DataMap{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(r,n,o){_defineProperty(this,"hot",void 0),_defineProperty(this,"metaManager",void 0),_defineProperty(this,"tableMeta",void 0),_defineProperty(this,"dataSource",void 0),_defineProperty(this,"duckSchema",void 0),_defineProperty(this,"colToPropCache",void 0),_defineProperty(this,"propToColCache",void 0),this.hot=r,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let r;let n=this.getSchema();if(void 0===n)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let o=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,o){let l=0,h=0,d=!1;if("function"==typeof o){let r=(0,y.Q8)(n);l=r>0?r:this.countFirstRowKeys(),d=!0}else{let r=this.tableMeta.maxCols;l=Math.min(r,o.length)}for(r=0;r<l;r++){let n=d?o(r):o[r];if((0,y.Kn)(n)){if(void 0!==n.data){let o=d?h:r;this.colToPropCache[o]=n.data,this.propToColCache.set(n.data,o)}h+=1}}}else this.recursiveDuckColumns(n)}countFirstRowKeys(){return(0,w.Eb)(this.dataSource)}recursiveDuckColumns(r,n,o){let l,h=n,d=o;return void 0===h&&(h=0,d=""),"object"!=typeof r||Array.isArray(r)||(0,y._l)(r,(r,n)=>{null===r?(l=d+n,this.colToPropCache.push(l),this.propToColCache.set(l,h),h+=1):h=this.recursiveDuckColumns(r,h,`${n}.`)}),h}colToProp(r){if(!1===Number.isInteger(r))return r;let n=this.hot.toPhysicalColumn(r);return null===n?r:this.colToPropCache&&(0,_.$K)(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(r){let n=this.propToColCache.get(r);if((0,_.$K)(n))return this.hot.toVisualColumn(n);let o=this.hot.toVisualColumn(r);return null===o?r:o}getSchema(){let r=this.tableMeta.dataSchema;return r?"function"==typeof r?r():r:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,y.ie)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:l="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=this.hot.countSourceRows(),d=h,w=0,S=r;("number"!=typeof S||S>=h)&&(S=h),S<this.hot.countRows()&&(d=this.hot.toPhysicalRow(S));let _=this.hot.runHooks("beforeCreateRow",S,n,o);if(!1===_||null===d)return{delta:0};let R=this.tableMeta.maxRows,P=this.getSchema().length,T=[];for(;w<n&&h+w<R;){let r=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?r=(0,y.I8)(this.getSchema()):(r=[],(0,b.q4)(P-1,()=>r.push(null))):"function"===this.hot.dataType?r=this.tableMeta.dataSchema(S+w):(r={},(0,y.ZB)(r,this.getSchema())),T.push(r),w+=1}this.hot.rowIndexMapper.insertIndexes(S,w),"below"===l&&(d=Math.min(d+1,h)),this.spliceData(d,0,T);let I=this.hot.toVisualRow(d);return this.hot.countSourceRows()===T.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),w>0&&(null==r?this.metaManager.createRow(null,w):"auto"!==o&&this.metaManager.createRow(d,n)),this.hot.runHooks("afterCreateRow",I,w,o),this.hot.forceFullRender=!0,{delta:w,startPhysicalIndex:d}}createCol(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:l="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let h=this.dataSource,d=this.tableMeta.maxCols,w=this.hot.countSourceCols(),y=r;("number"!=typeof y||y>=w)&&(y=w);let S=this.hot.runHooks("beforeCreateCol",y,n,o);if(!1===S)return{delta:0};let b=w;y<this.hot.countCols()&&(b=this.hot.toPhysicalColumn(y));let _=this.hot.countSourceRows(),R=this.hot.countCols(),P=0,T=b;"end"===l&&(T=Math.min(T+1,w));let I=T;for(;P<n&&R<d;){if("number"!=typeof y||y>=R){if(_>0)for(let r=0;r<_;r+=1)void 0===h[r]&&(h[r]=[]),h[r].push(null);else h.push([null])}else for(let r=0;r<_;r++)h[r].splice(T,0,null);P+=1,T+=1,R+=1}this.hot.columnIndexMapper.insertIndexes(y,P),P>0&&(null==r?this.metaManager.createColumn(null,P):"auto"!==o&&this.metaManager.createColumn(I,n));let O=this.hot.toVisualColumn(I);return this.hot.runHooks("afterCreateCol",O,P,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:P,startPhysicalIndex:I}}removeRow(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,l=Number.isInteger(r)?r:-n,h=this.visualRowsToPhysical(l,n),d=this.hot.countSourceRows();l=(d+l)%d;let w=this.hot.runHooks("beforeRemoveRow",l,h.length,h,o);if(!1===w)return!1;let y=h.length;if(this.filterData(l,y,h),l<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(h);let r=(0,_.$K)(this.tableMeta.columns)||(0,_.$K)(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===r&&this.hot.columnIndexMapper.setIndexesSequence([])}let S=h.slice(0).sort((r,n)=>n-r);return S.forEach(r=>{this.metaManager.removeRow(r,1)}),this.hot.runHooks("afterRemoveRow",l,y,h,o),this.hot.forceFullRender=!0,!0}removeCol(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");let l="number"!=typeof r?-n:r;l=(this.hot.countCols()+l)%this.hot.countCols();let h=this.visualColumnsToPhysical(l,n),d=h.slice(0).sort((r,n)=>n-r),w=this.hot.runHooks("beforeRemoveCol",l,n,h,o);if(!1===w)return!1;let y=!0,S=d.length,b=this.dataSource;for(let r=0;r<S;r++)y&&h[0]!==h[r]-r&&(y=!1);if(y)for(let r=0,o=this.hot.countSourceRows();r<o;r++)b[r].splice(h[0],n),0===r&&this.metaManager.removeColumn(h[0],n);else for(let r=0,n=this.hot.countSourceRows();r<n;r++)for(let n=0;n<S;n++)b[r].splice(d[n],1),0===r&&this.metaManager.removeColumn(d[n],1);return l<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(h),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",l,n,h,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(r,n,o){let l=this.hot.getDataAtCol(r),h=l.slice(n,n+o),d=l.slice(n+o);for(var w=arguments.length,y=Array(w>3?w-3:0),b=3;b<w;b++)y[b-3]=arguments[b];(0,S.g9)(y,d);let _=0;for(;_<o;)y.push(null),_+=1;return(0,S.PI)(y),this.hot.populateFromArray(n,r,y,null,null,"spliceCol"),h}spliceRow(r,n,o){let l=this.hot.getSourceDataAtRow(r),h=l.slice(n,n+o),d=l.slice(n+o);for(var w=arguments.length,y=Array(w>3?w-3:0),b=3;b<w;b++)y[b-3]=arguments[b];(0,S.g9)(y,d);let _=0;for(;_<o;)y.push(null),_+=1;return this.hot.populateFromArray(r,n,[y],null,null,"spliceRow"),h}spliceData(r,n,o){let l=this.hot.runHooks("beforeDataSplice",r,n,o);if(!1!==l){let n=[...this.dataSource.slice(0,r),...o,...this.dataSource.slice(r)];this.dataSource.length=0,n.forEach(r=>this.dataSource.push(r))}}filterData(r,n,o){let l=this.hot.runHooks("filterData",r,n,o);!1===Array.isArray(l)&&(l=this.dataSource.filter((r,n)=>-1===o.indexOf(n))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,l)}get(r,n){let o=this.hot.toPhysicalRow(r),l=this.dataSource[o],h=this.hot.runHooks("modifyRowData",o);l=isNaN(h)?h:l;let{dataDotNotation:d}=this.hot.getSettings(),w=null;if(l&&l.hasOwnProperty&&(0,y.nr)(l,n))w=l[n];else if(d&&"string"==typeof n&&n.indexOf(".")>-1){let r=l;if(!r)return null;let o=n.split(".");for(let n=0,l=o.length;n<l;n++)if(void 0===(r=r[o[n]]))return null;w=r}else"function"==typeof n&&(w=n(this.dataSource.slice(o,o+1)[0]));if(this.hot.hasHook("modifyData")){let r=(0,y.sm)(w);this.hot.runHooks("modifyData",o,this.propToCol(n),r,"get"),r.isTouched()&&(w=r.value)}return w}getCopyable(r,n){return this.hot.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}set(r,n,o){let l=this.hot.toPhysicalRow(r),h=o,d=this.dataSource[l],w=this.hot.runHooks("modifyRowData",l);if(d=isNaN(w)?w:d,this.hot.hasHook("modifyData")){let r=(0,y.sm)(h);this.hot.runHooks("modifyData",l,this.propToCol(n),r,"set"),r.isTouched()&&(h=r.value)}let{dataDotNotation:S}=this.hot.getSettings();if(d&&d.hasOwnProperty&&(0,y.nr)(d,n))d[n]=h;else if(S&&"string"==typeof n&&n.indexOf(".")>-1){let r,o=d,l=0,w=n.split(".");for(l=0,r=w.length-1;l<r;l++)void 0===o[w[l]]&&(o[w[l]]={}),o=o[w[l]];o[w[l]]=h}else"function"==typeof n?n(this.dataSource.slice(l,l+1)[0],h):d[n]=h}visualRowsToPhysical(r,n){let o=this.hot.countSourceRows(),l=[],h=(o+r)%o,d=n;for(;h<o&&d;)l.push(this.hot.toPhysicalRow(h)),d-=1,h+=1;return l}visualColumnsToPhysical(r,n){let o=this.hot.countCols(),l=[],h=(o+r)%o,d=n;for(;h<o&&d;){let r=this.hot.toPhysicalColumn(h);l.push(r),d-=1,h+=1}return l}clear(){for(let r=0;r<this.hot.countSourceRows();r++)for(let n=0;n<this.hot.countCols();n++)this.set(r,this.colToProp(n),"")}getLength(){let r=this.tableMeta.maxRows,n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r<0||0===r?0:r||1/0)}getAll(){let r={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return r.row-n.row!=0||this.hot.countSourceRows()?this.getRange(r,n,DataMap.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(r,n,o){let l,h,d;let w=[],y=this.tableMeta.maxRows,S=this.tableMeta.maxCols;if(0===y||0===S)return[];let b=o===DataMap.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,_=Math.min(Math.max(y-1,0),Math.max(r.row,n.row)),R=Math.min(Math.max(S-1,0),Math.max(r.col,n.col));for(l=Math.min(r.row,n.row);l<=_;l++){d=[];let o=l>=0?this.hot.toPhysicalRow(l):l;for(h=Math.min(r.col,n.col);h<=R&&null!==o;h++)d.push(b.call(this,l,this.colToProp(h)));null!==o&&w.push(d)}return w}getText(r,n){return(0,d.P)(this.getRange(r,n,DataMap.DESTINATION_RENDERER))}getCopyableText(r,n){return(0,d.P)(this.getRange(r,n,DataMap.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}};var R=o(5566),P=o(18200);function replaceData(r,n,o,d){let{hotInstance:w,dataMap:S,dataSource:b,internalSource:_,source:T,metaManager:I,firstRun:O}=d,k=(0,l.ct)(_),N=w.getSettings();Array.isArray(N.dataSchema)?w.dataType="array":(0,h.mf)(N.dataSchema)?w.dataType="function":w.dataType="object",S&&S.destroy(),r=w.runHooks(`before${k}`,r,O,T);let L=new DataMap(w,r,I);if(n(L),"object"==typeof r&&null!==r)r.push&&r.splice||(r=[r]);else if(null===r){let n;let o=L.getSchema();r=[];let l=0,h=0;for(l=0,h=N.startRows;l<h;l++)if(("object"===w.dataType||"function"===w.dataType)&&N.dataSchema)n=(0,y.I8)(o),r.push(n);else if("array"===w.dataType)n=(0,y.I8)(o[0]),r.push(n);else{n=[];for(let r=0,o=N.startCols;r<o;r++)n.push(null);r.push(n)}}else throw Error(`${_} only accepts array of objects or array of arrays (${typeof r} given)`);Array.isArray(r[0])&&(w.dataType="array"),N.data=r,L.dataSource=r,b.data=r,b.dataType=w.dataType,b.colToProp=L.colToProp.bind(L),b.propToCol=L.propToCol.bind(L),b.countCachedColumns=L.countCachedColumns.bind(L),o(L),w.runHooks(`after${k}`,r,O,T),O||(w.runHooks("afterChange",null,_),w.render()),w.getSettings().ariaTags&&(0,R.P$)(w.rootElement,[(0,P.a2)(-1),(0,P.Wv)(w.countCols()+(w.view?w.countRowHeaders():0))])}},24692:function(r,n,o){"use strict";o(57855);var l=o(66678),h=o(27687),d=o(57416),w=o(49773);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var y=new WeakSet;let EditorManager=class EditorManager{constructor(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,y),y.add(this),_defineProperty(this,"hot",void 0),_defineProperty(this,"tableMeta",void 0),_defineProperty(this,"selection",void 0),_defineProperty(this,"eventManager",void 0),_defineProperty(this,"destroyed",!1),_defineProperty(this,"activeEditor",void 0),_defineProperty(this,"cellProperties",void 0),this.hot=r,this.tableMeta=n,this.selection=o,this.eventManager=new w.Z(r),this.hot.addHook("afterDocumentKeyDown",r=>_assertClassBrand(y,this,_onAfterDocumentKeyDown).call(this,r)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",r)}),this.hot.view._wt.update("onCellDblClick",(r,n,o)=>_assertClassBrand(y,this,_onCellDblClick).call(this,r,n,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var r;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,r=>{r&&this.prepareEditor()});return}let n=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;if(!n||n.isHeader())return;let{row:o,col:l}=n,h=this.hot.runHooks("modifyGetCellCoords",o,l),w=o,y=l;if(Array.isArray(h)&&([w,y]=h),this.cellProperties=this.hot.getCellMeta(w,y),!this.isCellEditable()){this.clearActiveEditor();return}let S=this.hot.getCell(o,l,!0);if(S){let r=this.hot.getCellEditor(this.cellProperties),n=this.hot.colToProp(y),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(w),y);this.activeEditor=(0,d.Jq)(r,this.hot),this.activeEditor.prepare(o,l,n,S,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(r,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}let l=this.hot.getSelectedRangeLast(),h=this.hot.runHooks("beforeBeginEditing",l.highlight.row,l.highlight.col,r,n,o);if(n instanceof MouseEvent&&"boolean"!=typeof h&&(h=0===this.hot.selection.getLayerLevel()&&l.isSingle()),!1===h){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}closeEditor(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}closeEditorAndSaveChanges(r){this.closeEditor(!1,r)}closeEditorAndRestoreOriginalValue(r){this.closeEditor(!0,r)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let r=this.hot.getSelectedRangeLast();if(!r)return!1;let n=this.hot.getCellEditor(this.cellProperties),{row:o,col:l}=r.highlight,{rowIndexMapper:h,columnIndexMapper:d}=this.hot,w=h.isHidden(this.hot.toPhysicalRow(o))||d.isHidden(this.hot.toPhysicalColumn(l));return!this.cellProperties.readOnly&&!!n&&!w}moveSelectionAfterEnter(r){let n={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(r):this.tableMeta.enterMoves};r.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}};function _onAfterDocumentKeyDown(r){let n=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!n||n.highlight.isHeader()||(0,h.Ty)(r))return;let{keyCode:o}=r,d=(r.ctrlKey||r.metaKey)&&!r.altKey;this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||(0,l.DC)(o)||(0,l.T2)(o)||d||this.isEditorOpened()||this.openEditor("",r)}function _onCellDblClick(r,n){n.isCell()&&this.openEditor(null,r,!0)}let S=new WeakMap;EditorManager.getInstance=function(r,n,o){let l=S.get(r);return l||(l=new EditorManager(r,n,o),S.set(r,l)),l},n.Z=EditorManager},98422:function(r,n,o){"use strict";o.d(n,{Hf:function(){return BaseEditor},ed:function(){return S}}),o(57855);var l=o(2518),h=o(69488);o(58563);var d=o(99440);let w={_hooksStorage:Object.create(null),addHook(r,n){return this._hooksStorage[r]||(this._hooksStorage[r]=[]),this.hot.addHook(r,n),this._hooksStorage[r].push(n),this},removeHooksByKey(r){(0,d.Bk)(this._hooksStorage[r]||[],n=>{this.hot.removeHook(r,n)})},clearHooks(){(0,h._l)(this._hooksStorage,(r,n)=>this.removeHooksByKey(n)),this._hooksStorage={}}};(0,h.jW)(w,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var y=o(5566);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let S=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});let BaseEditor=class BaseEditor{static get EDITOR_TYPE(){return"base"}constructor(r){_defineProperty(this,"hot",void 0),_defineProperty(this,"state",S.VIRGIN),_defineProperty(this,"_opened",!1),_defineProperty(this,"_fullEditMode",!1),_defineProperty(this,"_closeCallback",null),_defineProperty(this,"TD",null),_defineProperty(this,"row",null),_defineProperty(this,"col",null),_defineProperty(this,"prop",null),_defineProperty(this,"originalValue",null),_defineProperty(this,"cellProperties",null),this.hot=r,this.init()}_fireCallbacks(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(r,n,o,l,h,d){this.TD=l,this.row=r,this.col=n,this.prop=o,this.originalValue=h,this.cellProperties=d,this.state=this.isOpened()?this.state:S.VIRGIN}extend(){return class extends this.constructor{}}saveValue(r,n){let o,l,h,d;if(n){let r=this.hot.getSelectedLast();o=Math.max(Math.min(r[0],r[2]),0),l=Math.max(Math.min(r[1],r[3]),0),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3])}else[o,l,h,d]=[this.row,this.col,null,null];let w=this.hot.runHooks("modifyGetCellCoords",o,l);Array.isArray(w)&&([o,l]=w),this.hot.populateFromArray(o,l,r,h,d,"edit")}beginEditing(r,n){if(this.state!==S.VIRGIN)return;let o=this.hot,h=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),d=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(h,d)),this.state=S.EDITING,this.isInFullEditMode()){let n="string"==typeof r?r:(0,l.Pz)(this.originalValue);this.setValue(n)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(r,n,o){let l;if(o){let r=this._closeCallback;this._closeCallback=n=>{r&&r(n),o(n),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===S.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===S.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}let o=this.getValue();l=this.cellProperties.trimWhitespace?[["string"==typeof o?String.prototype.trim.call(o||""):o]]:[[o]],this.state=S.WAITING,this.saveValue(l,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",r=>{this.state=S.FINISHED,this.discardEditor(r)}):(this.state=S.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=S.FINISHED,this.discardEditor()}discardEditor(r){if(this.state===S.FINISHED){if(!1===r&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=S.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=S.VIRGIN,this._fireCallbacks(!0);let r=this.hot.getShortcutManager();r.setActiveContextName("grid")}}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===S.WAITING}getEditedCellRect(){var r;let n=this.getEditedCell();if(!n)return;let{wtOverlays:o,wtViewport:l}=this.hot.view._wt,h=this.hot.rootWindow,d=(0,y.cv)(n),w=(0,y.iO)(n),S=(0,y.cv)(this.hot.rootElement),b=(0,y.iO)(this.hot.rootElement),_=o.topOverlay.holder,R=o.inlineStartOverlay.holder,P=_!==h?_.scrollTop:0,T=R!==h?R.scrollLeft:0,I=h.innerWidth-S.left-b,{wtTable:O}=null!==(r=o.getParentOverlay(n))&&void 0!==r?r:this.hot.view._wt,k=O.name,N=["master","inline_start"].includes(k)?P:0,L=["master","top","bottom"].includes(k)?T:0,j=d.top===S.top?0:1,U=d.top-S.top-j-N,$=0;$=this.hot.isRtl()?h.innerWidth-d.left-w-I-1+L:d.left-S.left-1-L,["top","top_inline_start_corner"].includes(k)&&(U+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(k)&&($+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));let K=this.hot.hasColHeaders(),Y=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),X=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),J=this.hot.rowIndexMapper.getRenderableIndexesLength(),Q=J-this.hot.view._wt.getSetting("fixedRowsBottom");(K&&Y<=0||Y===Q)&&(U+=1),X<=0&&($+=1);let ee=l.rowsRenderCalculator.startPosition,et=l.columnsRenderCalculator.startPosition,ei=Math.abs(o.inlineStartOverlay.getScrollPosition()),er=o.topOverlay.getScrollPosition(),en=(0,y.np)(this.hot.rootDocument),es=n.offsetTop;if(["inline_start","master"].includes(k)&&(es+=ee-er),["bottom","bottom_inline_start_corner"].includes(k)){let{wtViewport:r,wtTable:n}=o.bottomOverlay.clone;es+=r.getWorkspaceHeight()-n.getHeight()-en}let eo=n.offsetLeft;this.hot.isRtl()?eo=(eo>=0?O.getWidth()-n.offsetLeft:Math.abs(eo))+(et-ei-w):["top","master","bottom"].includes(k)&&(eo+=et-ei);let el=(0,y.Dx)(this.TD,this.hot.rootWindow),ea=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",eh=parseInt(el[ea],10)>0?0:1,ed=parseInt(el.borderTopWidth,10)>0?0:1,ec=(0,y.iO)(n)+eh,eu=(0,y.Pb)(n)+ed,eg=(0,y.do)(_)?en:0,ef=(0,y.vw)(R)?en:0,em=this.hot.view.maximumVisibleElementWidth(eo)-eg+eh,ep=Math.max(this.hot.view.maximumVisibleElementHeight(es)-ef+ed,23);return{top:U,start:$,height:eu,maxHeight:ep,width:ec,maxWidth:em}}getEditedCellsLayerClass(){let r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?n=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?n=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}};(0,h.jB)(BaseEditor,w)},57416:function(r,n,o){"use strict";o.d(n,{Jq:function(){return _getEditorInstance},Wu:function(){return S},qm:function(){return _register},y$:function(){return _getItem}}),o(57855);var l=o(54317),h=o(82656);let d=new WeakMap,{register:w,getItem:y,hasItem:S,getNames:b,getValues:_}=(0,h.Z)("editors");function RegisteredEditor(r){let n={};this.getConstructor=function(){return r},this.getInstance=function(o){return o.guid in n||(n[o.guid]=new r(o)),n[o.guid]},l.Z.getSingleton().add("afterDestroy",function(){n[this.guid]=null})}function _getEditorInstance(r,n){let o;if("function"==typeof r)d.get(r)||_register(null,r),o=d.get(r);else if("string"==typeof r)o=y(r);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!o)throw Error(`No editor registered under name "${r}"`);return o.getInstance(n)}function _getItem(r){if("function"==typeof r)return r;if(!S(r))throw Error(`No registered editor found under "${r}" name`);return y(r).getConstructor()}function _register(r,n){r&&"string"!=typeof r&&(r=(n=r).EDITOR_TYPE);let o=new RegisteredEditor(n);"string"==typeof r&&w(r,o),d.set(n,o)}},2694:function(r,n,o){"use strict";o.d(n,{H:function(){return TextEditor}}),o(57855);var l=o(98422),h=o(49773),d=o(2228),w=o(5566),y=o(67790);function observe(r,n,o){r.addEventListener(n,o,!1)}function unObserve(r,n,o){r.removeEventListener(n,o,!1)}function getComputedStyle(r){return r.ownerDocument.defaultView.getComputedStyle(r)}var S=o(2518);function updateCaretPosition(r,n){let o=(0,w.qK)(n),l=n.value.split("\n"),h=o,d=0;for(let n=0;n<l.length;n++){let w=l[n];0!==n&&(d+=l[n-1].length+1);let y=d+w.length;if("home"===r?h=d:"end"===r&&(h=y),o<=y)break}(0,w.Mq)(n,h)}var b=o(18200);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let _="ht_editor_hidden",R="textEditor";let TextEditor=class TextEditor extends l.Hf{static get EDITOR_TYPE(){return"text"}constructor(r){super(r),_defineProperty(this,"eventManager",new h.Z(this)),_defineProperty(this,"autoResize",function(r){let n;let o={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},l=r.body,h=r.createTextNode(""),d=r.createElement("span");function resize(){h.textContent=n.value,d.style.position="absolute",d.style.fontSize=getComputedStyle(n).fontSize,d.style.fontFamily=getComputedStyle(n).fontFamily,d.style.whiteSpace="pre",l.appendChild(d);let r=d.clientWidth+2;l.removeChild(d);let w=n.style;w.height=`${o.minHeight}px`,o.minWidth>r?w.width=`${o.minWidth}px`:r>o.maxWidth?w.width=`${o.maxWidth}px`:w.width=`${r}px`;let y=n.scrollHeight?n.scrollHeight-1:0;o.minHeight>y?w.height=`${o.minHeight}px`:o.maxHeight<y?(w.height=`${o.maxHeight}px`,w.overflowY="visible"):w.height=`${y}px`}function delayedResize(){r.defaultView.setTimeout(resize,0)}return{init:function(r,l){let w=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n=r,function(r){if(r&&r.minHeight){if("inherit"===r.minHeight)o.minHeight=n.clientHeight;else{let n=parseInt(r.minHeight,10);isNaN(n)||(o.minHeight=n)}}if(r&&r.maxHeight){if("inherit"===r.maxHeight)o.maxHeight=n.clientHeight;else{let n=parseInt(r.maxHeight,10);isNaN(n)||(o.maxHeight=n)}}if(r&&r.minWidth){if("inherit"===r.minWidth)o.minWidth=n.clientWidth;else{let n=parseInt(r.minWidth,10);isNaN(n)||(o.minWidth=n)}}if(r&&r.maxWidth){if("inherit"===r.maxWidth)o.maxWidth=n.clientWidth;else{let n=parseInt(r.maxWidth,10);isNaN(n)||(o.maxWidth=n)}}d.firstChild||(d.className="autoResize",d.style.display="inline-block",d.appendChild(h))}(l),"TEXTAREA"===n.nodeName&&(n.style.resize="none",n.style.height=`${o.minHeight}px`,n.style.minWidth=`${o.minWidth}px`,n.style.maxWidth=`${o.maxWidth}px`,n.style.overflowY="hidden"),w&&(observe(n,"input",resize),observe(n,"keydown",delayedResize)),resize()},resize,unObserve(){unObserve(n,"input",resize),unObserve(n,"keydown",delayedResize)}}}(this.hot.rootDocument)),_defineProperty(this,"TEXTAREA",void 0),_defineProperty(this,"textareaStyle",void 0),_defineProperty(this,"TEXTAREA_PARENT",void 0),_defineProperty(this,"textareaParentStyle",void 0),_defineProperty(this,"layerClass",void 0),this.eventManager=new h.Z(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(r){this.TEXTAREA.value=r}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,w.yv)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(r,n,o,h,d,w){let y=this.state;if(super.prepare(r,n,o,h,d,w),!w.readOnly){this.refreshDimensions(!0);let{allowInvalid:r}=w;r&&!this.isOpened()&&(this.TEXTAREA.value=""),y===l.ed.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(r,n){this.state===l.ed.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(r,n))}focus(){this.TEXTAREA.select(),(0,w.Mq)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:r}=this.hot;this.TEXTAREA=r.createElement("TEXTAREA"),(0,w.P$)(this.TEXTAREA,[["data-hot-input",""],(0,b.Qk)(-1)]),(0,w.cn)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=r.createElement("DIV"),(0,w.cn)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,w.pv)(this.TEXTAREA_PARENT,this.layerClass)&&(0,w.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,w.cn)(this.TEXTAREA_PARENT,_),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,d.un)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,w.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,w.cn)(this.TEXTAREA_PARENT,_)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";let r=this.TEXTAREA_PARENT.childNodes,n=!1;(0,y.q4)(r.length-1,o=>{let l=r[o];if((0,w.pv)(l,"handsontableEditor"))return n=!0,!1}),(0,w.pv)(this.TEXTAREA_PARENT,_)&&(0,w.IV)(this.TEXTAREA_PARENT,_),n?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,w.cn)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){let r=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(r,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==l.ed.EDITING&&!r)return;if(this.TD=this.getEditedCell(),!this.TD){r||this.close();return}let{top:n,start:o,width:h,maxWidth:d,height:y,maxHeight:S}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();let b=(0,w.Dx)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=b.fontSize,this.TEXTAREA.style.fontFamily=b.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let _=(0,w.Dx)(this.TEXTAREA),R=parseInt(_.paddingLeft,10)+parseInt(_.paddingRight,10),P=parseInt(_.paddingTop,10)+parseInt(_.paddingBottom,10),T=d-R,I=S-P;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(h-R,T),minHeight:Math.min(y-P,I),maxWidth:T,maxHeight:I},!0)}bindEvents(){(0,d.gn)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===l.ed.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===l.ed.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("editor"),insertNewLine=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(insertNewLine(),!1),runOnlyIf:r=>!this.hot.selection.isMultiple()&&!r.altKey},{keys:[["Meta","Enter"]],callback:()=>(insertNewLine(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(insertNewLine(),!1)},{keys:[["Home"]],callback:(r,n)=>{let[o]=n;updateCaretPosition(o,this.TEXTAREA)}},{keys:[["End"]],callback:(r,n)=>{let[o]=n;updateCaretPosition(o,this.TEXTAREA)}}],{runOnlyIf:()=>(0,S.$K)(this.hot.getSelected()),group:R})}unregisterShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("editor");n.removeShortcutsByGroup(R)}}},49773:function(r,n,o){"use strict";o(57855),o(58563);var l=o(27687);let h=0;n.Z=class{constructor(){var r,n,o;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n=void 0,(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="context","string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this.context=l||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(r,n,o){let d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function callbackProxy(r){o.call(this,function(r){let n=r.stopImmediatePropagation;return r.stopImmediatePropagation=function(){n.apply(this),(0,l.mM)(this)},r}(r))}return this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy,options:d,eventManager:this}),r.addEventListener(n,callbackProxy,d),h+=1,()=>{this.removeEventListener(r,n,o)}}removeEventListener(r,n,o){let l,d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],w=this.context.eventListeners.length;for(;w;)if(w-=1,(l=this.context.eventListeners[w]).event===n&&l.element===r){if(o&&o!==l.callback||d&&l.eventManager!==this)continue;this.context.eventListeners.splice(w,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),h-=1}}clearEvents(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;let o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),h-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(r,n){let o,l=r.document,h=r;l||(h=(l=r.ownerDocument?r.ownerDocument:r).defaultView);let d={bubbles:!0,cancelable:"mousemove"!==n,view:h,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};l.createEvent?(o=l.createEvent("MouseEvents")).initMouseEvent(n,d.bubbles,d.cancelable,d.view,d.detail,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,d.button,d.relatedTarget||l.body.parentNode):o=l.createEventObject(),r.dispatchEvent?r.dispatchEvent(o):r.fireEvent(`on${n}`,o)}}},18407:function(r,n,o){"use strict";o.d(n,{I:function(){return FocusManager}}),o(57855);var l=o(24748),h=o(5566),d=o(98179);function _classPrivateFieldInitSpec(r,n,o){_checkPrivateRedeclaration(r,n),n.set(r,o)}function _checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(r,n){return r.get(_assertClassBrand(r,n))}function _classPrivateFieldSet(r,n,o){return r.set(_assertClassBrand(r,n),o),o}function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let w=Object.freeze({CELL:"cell",MIXED:"mixed"});var y=new WeakMap,S=new WeakMap,b=new WeakMap,_=new WeakMap,R=new WeakMap,P=new WeakSet;let FocusManager=class FocusManager{constructor(r){var n=this;_checkPrivateRedeclaration(this,P),P.add(this),_classPrivateFieldInitSpec(this,y,void 0),_classPrivateFieldInitSpec(this,S,void 0),_classPrivateFieldInitSpec(this,b,1),_classPrivateFieldInitSpec(this,_,null),_classPrivateFieldInitSpec(this,R,new Map);let o=r.getSettings();_classPrivateFieldSet(y,this,r),_classPrivateFieldSet(S,this,o.imeFastEdit?w.MIXED:w.CELL),_classPrivateFieldGet(y,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return _assertClassBrand(P,n,_onUpdateSettings).call(n,...o)}),_classPrivateFieldGet(y,this).addHook("afterSelection",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return _assertClassBrand(P,n,_focusCell).call(n,...o)}),_classPrivateFieldGet(y,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return _assertClassBrand(P,n,_focusCell).call(n,...o)}),_classPrivateFieldGet(y,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return _assertClassBrand(P,n,_focusEditorElement).call(n,...o)})}getFocusMode(){return _classPrivateFieldGet(S,this)}setFocusMode(r){Object.values(w).includes(r)?_classPrivateFieldSet(S,this,r):(0,l.ZK)(`"${r}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet(b,this)}setRefocusDelay(r){_classPrivateFieldSet(b,this,r)}setRefocusElementGetter(r){_classPrivateFieldSet(_,this,r)}getRefocusElement(){var r;return"function"==typeof _classPrivateFieldGet(_,this)?_classPrivateFieldGet(_,this).call(this):null===(r=_classPrivateFieldGet(y,this).getActiveEditor())||void 0===r?void 0:r.TEXTAREA}focusOnHighlightedCell(r){let focusElement=r=>{var n,o;let l=null===(n=_classPrivateFieldGet(y,this).getSelectedRangeLast())||void 0===n?void 0:n.highlight;if(!l)return;let h=_classPrivateFieldGet(y,this).runHooks("modifyFocusedElement",l.row,l.col,r);h instanceof HTMLElement||(h=r),h&&!(null!==(o=_classPrivateFieldGet(y,this).getActiveEditor())&&void 0!==o&&o.isOpened())&&h.focus({preventScroll:!0})};r?focusElement(r):_assertClassBrand(P,this,_getSelectedCell).call(this,r=>focusElement(r))}refocusToEditorTextarea(){var r;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_classPrivateFieldGet(b,this),o=this.getRefocusElement();_classPrivateFieldGet(y,this).getSettings().imeFastEdit&&!(null!==(r=_classPrivateFieldGet(y,this).getActiveEditor())&&void 0!==r&&r.isOpened())&&o&&(_classPrivateFieldGet(R,this).has(n)||_classPrivateFieldGet(R,this).set(n,(0,d.Ds)(()=>{o.select()},n)),_classPrivateFieldGet(R,this).get(n)())}};function _getSelectedCell(r){var n;let o=null===(n=_classPrivateFieldGet(y,this).getSelectedRangeLast())||void 0===n?void 0:n.highlight;if(!o||!_classPrivateFieldGet(y,this).selection.isCellVisible(o)){r(null);return}let l=_classPrivateFieldGet(y,this).getCell(o.row,o.col,!0);null===l?_classPrivateFieldGet(y,this).addHookOnce("afterScroll",()=>{r(_classPrivateFieldGet(y,this).getCell(o.row,o.col,!0))}):r(l)}function _focusCell(){_assertClassBrand(P,this,_getSelectedCell).call(this,r=>{let{activeElement:n}=_classPrivateFieldGet(y,this).rootDocument;n&&(0,h.pV)(n)&&n.blur(),this.focusOnHighlightedCell(r)})}function _focusEditorElement(){_assertClassBrand(P,this,_getSelectedCell).call(this,r=>{this.getFocusMode()===w.MIXED&&"TD"===r.nodeName&&this.refocusToEditorTextarea()})}function _onUpdateSettings(r){"boolean"==typeof r.imeFastEdit&&this.setFocusMode(r.imeFastEdit?w.MIXED:w.CELL)}},18200:function(r,n,o){"use strict";o.d(n,{Ak:function(){return A11Y_SELECTED},Ct:function(){return A11Y_ROWGROUP},DT:function(){return A11Y_SETSIZE},Ez:function(){return A11Y_LIVE},JV:function(){return A11Y_EXPANDED},LO:function(){return A11Y_COMBOBOX},Ng:function(){return A11Y_COLUMNHEADER},Nl:function(){return A11Y_OPTION},Nr:function(){return A11Y_TEXT},Pn:function(){return A11Y_CHECKED},Pp:function(){return A11Y_SCOPE_ROW},QK:function(){return A11Y_LABEL},Qk:function(){return A11Y_TABINDEX},Qz:function(){return A11Y_GRIDCELL},Rn:function(){return A11Y_PRESENTATION},Up:function(){return A11Y_RELEVANT},Wv:function(){return A11Y_COLCOUNT},a2:function(){return A11Y_ROWCOUNT},a6:function(){return A11Y_LISTBOX},cV:function(){return A11Y_HIDDEN},d:function(){return A11Y_CONTROLS},d5:function(){return A11Y_ROWINDEX},f3:function(){return A11Y_ROW},fv:function(){return A11Y_HASPOPUP},gw:function(){return A11Y_DISABLED},iJ:function(){return A11Y_SCOPE_COL},iL:function(){return A11Y_ROWHEADER},jH:function(){return A11Y_POSINSET},l_:function(){return A11Y_SORT},nO:function(){return A11Y_TREEGRID},nT:function(){return A11Y_ACTIVEDESCENDANT},qt:function(){return A11Y_MULTISELECTABLE},rQ:function(){return A11Y_MENU_ITEM},tm:function(){return A11Y_MENU},w1:function(){return A11Y_INVALID},wt:function(){return A11Y_CHECKBOX},ys:function(){return A11Y_MENU_ITEM_CHECKBOX},yz:function(){return A11Y_COLINDEX},zR:function(){return A11Y_READONLY},zV:function(){return A11Y_AUTOCOMPLETE}});let A11Y_TABINDEX=r=>["tabindex",r],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=r=>["aria-label",r],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=()=>["aria-disabled","true"],A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=r=>["aria-haspopup",r],A11Y_ROWCOUNT=r=>["aria-rowcount",r],A11Y_COLCOUNT=r=>["aria-colcount",r],A11Y_ROWINDEX=r=>["aria-rowindex",r],A11Y_COLINDEX=r=>["aria-colindex",r],A11Y_EXPANDED=r=>["aria-expanded",r],A11Y_SORT=r=>["aria-sort",r],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=r=>["aria-checked",r],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=r=>["aria-controls",r],A11Y_ACTIVEDESCENDANT=r=>["aria-activedescendant",r],A11Y_LIVE=r=>["aria-live",r],A11Y_RELEVANT=r=>["aria-relevant",r],A11Y_SETSIZE=r=>["aria-setsize",r],A11Y_POSINSET=r=>["aria-posinset",r]},99440:function(r,n,o){"use strict";function to2dArray(r){let n=r.length,o=0;for(;o<n;)r[o]=[r[o]],o+=1}function extendArray(r,n){let o=n.length,l=0;for(;l<o;)r.push(n[l]),l+=1}function pivot(r){let n=[];if(!r||0===r.length||!r[0]||0===r[0].length)return n;let o=r.length,l=r[0].length;for(let h=0;h<o;h++)for(let o=0;o<l;o++)n[o]||(n[o]=[]),n[o][h]=r[h][o];return n}function arrayReduce(r,n,o,l){let h=-1,d=r,w=o;Array.isArray(r)||(d=Array.from(r));let y=d.length;for(l&&y&&(h+=1,w=d[h]),h+=1;h<y;)w=n(w,d[h],h,d),h+=1;return w}function arrayFilter(r,n){let o=0,l=r;Array.isArray(r)||(l=Array.from(r));let h=l.length,d=[],w=-1;for(;o<h;){let r=l[o];n(r,o,l)&&(d[w+=1]=r),o+=1}return d}function arrayMap(r,n){let o=0,l=r;Array.isArray(r)||(l=Array.from(r));let h=l.length,d=[],w=-1;for(;o<h;){let r=l[o];d[w+=1]=n(r,o,l),o+=1}return d}function arrayEach(r,n){let o=0,l=r;Array.isArray(r)||(l=Array.from(r));let h=l.length;for(;o<h&&!1!==n(l[o],o,l);)o+=1;return r}function arrayUnique(r){let n=[];return arrayEach(r,r=>{-1===n.indexOf(r)&&n.push(r)}),n}function getDifferenceOfArrays(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];let[l,...h]=[...n],d=l;return arrayEach(h,r=>{d=d.filter(n=>!r.includes(n))}),d}function stringToArray(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return r.split(n)}o.d(n,{Bk:function(){return arrayEach},PI:function(){return to2dArray},Sc:function(){return arrayMap},W7:function(){return stringToArray},g9:function(){return extendArray},jz:function(){return pivot},k$:function(){return arrayReduce},o0:function(){return getDifferenceOfArrays},uW:function(){return arrayUnique},w7:function(){return arrayFilter}}),o(58563),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652)},2228:function(r,n,o){"use strict";o.d(n,{E6:function(){return isChromeWebKit},G6:function(){return isSafari},K1:function(){return isMobileBrowser},L:function(){return isIpadOS},eE:function(){return isMacOS},gn:function(){return isIOS},i7:function(){return isChrome},iF:function(){return isFirefoxWebKit},uM:function(){return isWindowsOS},un:function(){return isEdge},vU:function(){return isFirefox}});var l=o(69488),h=o(60973);let tester=r=>{let n={value:!1};return n.test=(o,l)=>{n.value=r(o,l)},n},d={chrome:tester((r,n)=>/Chrome/.test(r)&&/Google/.test(n)),chromeWebKit:tester(r=>/CriOS/.test(r)),edge:tester(r=>/Edge/.test(r)),edgeWebKit:tester(r=>/EdgiOS/.test(r)),firefox:tester(r=>/Firefox/.test(r)),firefoxWebKit:tester(r=>/FxiOS/.test(r)),mobile:tester(r=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r)),safari:tester((r,n)=>/Safari/.test(r)&&/Apple Computer/.test(n))},w={mac:tester(r=>/^Mac/.test(r)),win:tester(r=>/^Win/.test(r)),linux:tester(r=>/^Linux/.test(r)),ios:tester(r=>/iPhone|iPad|iPod/i.test(r))};function isChrome(){return d.chrome.value}function isChromeWebKit(){return d.chromeWebKit.value}function isFirefox(){return d.firefox.value}function isFirefoxWebKit(){return d.firefoxWebKit.value}function isSafari(){return d.safari.value}function isEdge(){return d.edge.value}function isMobileBrowser(){return d.mobile.value}function isIOS(){return w.ios.value}function isIpadOS(){let{maxTouchPoints:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return r>2&&w.mac.value}function isWindowsOS(){return w.win.value}function isMacOS(){return w.mac.value}(0,h.o6)()&&(!function(){let{userAgent:r=navigator.userAgent,vendor:n=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,l._l)(d,o=>{let{test:l}=o;l(r,n)})}(),function(){let{platform:r=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,l._l)(w,n=>{let{test:o}=n;o(r)})}())},24748:function(r,n,o){"use strict";o.d(n,{ZK:function(){return warn},vU:function(){return error}});var l=o(2518);function warn(){(0,l.$K)(console)&&console.warn(...arguments)}function error(){(0,l.$K)(console)&&console.error(...arguments)}},77628:function(r,n,o){"use strict";o.d(n,{Eb:function(){return countFirstRowKeys},Jr:function(){return isArrayOfArrays},Pj:function(){return isArrayOfObjects},Yl:function(){return spreadsheetColumnLabel},ec:function(){return dataRowToChangesArray}}),o(58563);var l=o(69488);function spreadsheetColumnLabel(r){let n,o=r+1,l="";for(;o>0;)l=String.fromCharCode(65+(n=(o-1)%26))+l,o=parseInt((o-n)/26,10);return l}function dataRowToChangesArray(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=r,l=[];return Array.isArray(r)&&Array.isArray(r[0])||(o=[r]),o.forEach((r,o)=>{Array.isArray(r)?r.forEach((r,h)=>{l.push([o+n,h,r])}):Object.keys(r).forEach(h=>{l.push([o+n,h,r[h]])})}),l}function countFirstRowKeys(r){let n=0;return Array.isArray(r)&&(r[0]&&Array.isArray(r[0])?n=r[0].length:r[0]&&(0,l.Kn)(r[0])&&(n=(0,l.Q8)(r[0]))),n}function isArrayOfArrays(r){return!!(Array.isArray(r)&&r.length&&r.every(r=>Array.isArray(r)))}function isArrayOfObjects(r){return!!(Array.isArray(r)&&r.length&&r.every(r=>"object"==typeof r&&!Array.isArray(r)&&null!==r))}},5566:function(r,n,o){"use strict";let l;o.d(n,{$g:function(){return getTrimmingContainer},AQ:function(){return getWindowScrollTop},C2:function(){return getStyle},DZ:function(){return getWindowScrollLeft},Dx:function(){return getComputedStyle},G_:function(){return getParent},I2:function(){return setOverlayPosition},IV:function(){return removeClass},Kz:function(){return index},MO:function(){return isChildOf},Mq:function(){return setCaretPosition},P$:function(){return setAttribute},Pb:function(){return outerHeight},TT:function(){return observeVisibilityChangeOnce},Tb:function(){return getMaximumScrollLeft},W6:function(){return closestDown},WH:function(){return resetCssTransform},WS:function(){return innerHeight},Wu:function(){return function removeTextNodes(r){if(3===r.nodeType)r.parentNode.removeChild(r);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(r.nodeName)>-1){let n=r.childNodes;for(let r=n.length-1;r>=0;r--)removeTextNodes(n[r])}}},a7:function(){return clearTextSelection},cS:function(){return empty},cn:function(){return addClass},cv:function(){return offset},cx:function(){return getScrollTop},d$:function(){return removeAttribute},dD:function(){return getScrollableElement},do:function(){return hasVerticalScrollbar},f5:function(){return getParentWindow},fy:function(){return getMaximumScrollTop},iO:function(){return outerWidth},kg:function(){return getSelectionEndPosition},l2:function(){return makeElementContentEditableAndSelectItsContent},lq:function(){return runWithSelectedContendEditableElement},mK:function(){return overlayContainsElement},np:function(){return getScrollbarWidth},oq:function(){return closest},pV:function(){return isOutsideInput},pn:function(){return function isVisible(r){let n=r.ownerDocument.documentElement,o=r;for(;o!==n;){if(null===o)return!1;if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(!o.host)return!1;if(o.host.impl)return isVisible(o.host.impl);if(o.host)return isVisible(o.host);throw Error("Lost in Web Components world")}if("none"===getComputedStyle(o).display)return!1;o=o.parentNode}return!0}},pv:function(){return hasClass},qK:function(){return getCaretPosition},tT:function(){return fastInnerText},u7:function(){return isInput},uS:function(){return fastInnerHTML},vj:function(){return getScrollLeft},vw:function(){return hasHorizontalScrollbar},x9:function(){return innerWidth},yY:function(){return removeContentEditableFromElementAndDeselect},yv:function(){return isThisHotChild},z4:function(){return isDetached}}),o(57855),o(58563);var h=o(66411),d=o(18200);function getParent(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=-1,l=null,h=r;for(;null!==h;){if(o===n){l=h;break}h.host&&h.nodeType===Node.DOCUMENT_FRAGMENT_NODE?h=h.host:(o+=1,h=h.parentNode)}return l}function isThisHotChild(r,n){let o=r.closest(".handsontable");return!!o&&(o.parentNode===n||o===n)}function getParentWindow(r){return Object.getPrototypeOf(r.parent)&&r.frameElement&&r.parent}function closest(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:l,DOCUMENT_FRAGMENT_NODE:h}=Node,d=r;for(;null!=d&&d!==o;){let{nodeType:r,nodeName:o}=d;if(r===l&&(n.includes(o)||n.includes(d)))return d;let{host:w}=d;d=w&&r===h?w:d.parentNode}return null}function closestDown(r,n,o){let l=[],h=r;for(;h&&(h=closest(h,n,o))&&(!o||o.contains(h));)l.push(h),h=h.host&&h.nodeType===Node.DOCUMENT_FRAGMENT_NODE?h.host:h.parentNode;let d=l.length;return d?l[d-1]:null}function isChildOf(r,n){let o=r.parentNode,l=[];for("string"==typeof n?l=r.defaultView?Array.prototype.slice.call(r.querySelectorAll(n),0):Array.prototype.slice.call(r.ownerDocument.querySelectorAll(n),0):l.push(n);null!==o;){if(l.indexOf(o)>-1)return!0;o=o.parentNode}return!1}function index(r){let n=0,o=r;if(o.previousSibling)for(;o=o.previousSibling;)n+=1;return n}function overlayContainsElement(r,n,o){let l=o.parentElement.querySelector(`.ht_clone_${r}`);return l?l.contains(n):null}function filterEmptyClassNames(r){return r&&r.length?r.filter(r=>!!r):[]}function filterRegexes(r,n){if(!r||!r.length)return n?{regexFree:[],regexes:[]}:[];let o=[],l=[];return l.push(...r.filter(r=>{let l=r instanceof RegExp;return l&&n&&o.push(r),!l})),n?{regexFree:l,regexes:o}:l}function hasClass(r,n){return void 0!==r.classList&&"string"==typeof n&&""!==n&&r.classList.contains(n)}function addClass(r,n){"string"==typeof n&&(n=n.split(" ")),(n=filterEmptyClassNames(n)).length>0&&r.classList.add(...n)}function removeClass(r,n){"string"==typeof n?n=n.split(" "):n instanceof RegExp&&(n=[n]);let{regexFree:o,regexes:l}=filterRegexes(n,!0);(o=filterEmptyClassNames(o)).length>0&&r.classList.remove(...o),l.forEach(n=>{r.classList.forEach(o=>{n.test(o)&&r.classList.remove(o)})})}function setAttribute(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;Array.isArray(n)||(n=[[n,o]]),n.forEach(n=>{Array.isArray(n)&&""!==n[0]&&r.setAttribute(...n)})}function removeAttribute(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof n?n=n.split(" "):n instanceof RegExp&&(n=[n]);let{regexFree:o,regexes:l}=filterRegexes(n,!0);o.forEach(n=>{""!==n&&r.removeAttribute(n)}),l.forEach(n=>{r.getAttributeNames().forEach(o=>{n.test(o)&&r.removeAttribute(o)})})}function empty(r){let n;for(;n=r.lastChild;)r.removeChild(n)}let w=/(<(.*)>|&(.*);)/;function fastInnerHTML(r,n){let o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];w.test(n)?r.innerHTML=o?(0,h.Nw)(n):n:fastInnerText(r,n)}function fastInnerText(r,n){let o=r.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=n:(empty(r),r.appendChild(r.ownerDocument.createTextNode(n)))}function offset(r){let n,o,l;let h=r.ownerDocument,d=h.defaultView,w=h.documentElement,y=r;for(n=y.offsetLeft,o=y.offsetTop,l=y;(y=y.offsetParent)&&y!==h.body&&("offsetLeft"in y);)n+=y.offsetLeft,o+=y.offsetTop,l=y;return l&&"fixed"===l.style.position&&(n+=d.pageXOffset||w.scrollLeft,o+=d.pageYOffset||w.scrollTop),{left:n,top:o}}function getWindowScrollTop(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return r.scrollY}function getWindowScrollLeft(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return r.scrollX}function getScrollTop(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return r===n?getWindowScrollTop(n):r.scrollTop}function getScrollLeft(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return r===n?getWindowScrollLeft(n):r.scrollLeft}function getScrollableElement(r){let n=r.ownerDocument,o=n?n.defaultView:void 0;n||(o=(n=r.document?r.document:r).defaultView);let l=["auto","scroll"],h=r.parentNode;for(;h&&h.style&&n.body!==h;){let{overflow:r,overflowX:n,overflowY:d}=h.style;if([r,n,d].includes("scroll")||({overflow:r,overflowX:n,overflowY:d}=o.getComputedStyle(h),l.includes(r)||l.includes(n)||l.includes(d))||h.clientHeight<=h.scrollHeight+1&&(l.includes(d)||l.includes(r))||h.clientWidth<=h.scrollWidth+1&&(l.includes(n)||l.includes(r)))return h;h=h.parentNode}return o}function getMaximumScrollTop(r){return r.scrollHeight-r.clientHeight}function getMaximumScrollLeft(r){return r.scrollWidth-r.clientWidth}function getTrimmingContainer(r){let n=r.ownerDocument,o=n.defaultView,l=r.parentNode;for(;l&&l.style&&n.body!==l;){if("visible"!==l.style.overflow&&""!==l.style.overflow)return l;let r=getComputedStyle(l,o),n=["scroll","hidden","auto"],h=r.getPropertyValue("overflow"),d=r.getPropertyValue("overflow-y"),w=r.getPropertyValue("overflow-x");if(n.includes(h)||n.includes(d)||n.includes(w))return l;l=l.parentNode}return o}function getStyle(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!r)return;if(r===o)return"width"===n?`${o.innerWidth}px`:"height"===n?`${o.innerHeight}px`:void 0;let l=r.style[n];if(""!==l&&void 0!==l)return l;let h=getComputedStyle(r,o);if(""!==h[n]&&void 0!==h[n])return h[n]}function getComputedStyle(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return r.currentStyle||n.getComputedStyle(r)}function outerWidth(r){return r.offsetWidth}function outerHeight(r){return r.offsetHeight}function innerHeight(r){return r.clientHeight||r.innerHeight}function innerWidth(r){return r.clientWidth||r.innerWidth}function getCaretPosition(r){return r.selectionStart?r.selectionStart:0}function getSelectionEndPosition(r){return r.selectionEnd?r.selectionEnd:0}function clearTextSelection(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;r.getSelection&&(r.getSelection().empty?r.getSelection().empty():r.getSelection().removeAllRanges&&r.getSelection().removeAllRanges())}function setCaretPosition(r,n,o){if(void 0===o&&(o=n),r.setSelectionRange){r.focus();try{r.setSelectionRange(n,o)}catch(d){let l=r.parentNode,h=l.style.display;l.style.display="block",r.setSelectionRange(n,o),l.style.display=h}}}function getScrollbarWidth(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===l&&(l=function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=r.createElement("div");n.style.height="200px",n.style.width="100%";let o=r.createElement("div");o.style.boxSizing="content-box",o.style.height="150px",o.style.left="0px",o.style.overflow="hidden",o.style.position="absolute",o.style.top="0px",o.style.width="200px",o.style.visibility="hidden",o.appendChild(n),(r.body||r.documentElement).appendChild(o);let l=n.offsetWidth;o.style.overflow="scroll";let h=n.offsetWidth;return l===h&&(h=o.clientWidth),(r.body||r.documentElement).removeChild(o),l-h}(r)),l}function hasVerticalScrollbar(r){return r.offsetWidth!==r.clientWidth}function hasHorizontalScrollbar(r){return r.offsetHeight!==r.clientHeight}function setOverlayPosition(r,n,o){r.style.transform=`translate3d(${n},${o},0)`}function resetCssTransform(r){r.style.transform&&""!==r.style.transform&&(r.style.transform="")}function isInput(r){return r&&(["INPUT","SELECT","TEXTAREA"].indexOf(r.nodeName)>-1||"true"===r.contentEditable)}function isOutsideInput(r){return isInput(r)&&!1===r.hasAttribute("data-hot-input")}function isDetached(r){return!r.parentNode}function observeVisibilityChangeOnce(r,n){let o=new IntersectionObserver((o,l)=>{o.forEach(o=>{o.isIntersecting&&null!==r.offsetParent&&(n(),l.unobserve(r))})},{root:r.ownerDocument.body});o.observe(r)}function makeElementContentEditableAndSelectItsContent(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=r.ownerDocument,h=l.createRange(),w=l.defaultView.getSelection();setAttribute(r,"contenteditable",!0),o&&setAttribute(r,...(0,d.cV)()),n&&addClass(r,"invisibleSelection"),h.selectNodeContents(r),w.removeAllRanges(),w.addRange(h)}function removeContentEditableFromElementAndDeselect(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=r.ownerDocument.defaultView.getSelection();r.hasAttribute("aria-hidden")&&r.removeAttribute("aria-hidden"),o.removeAllRanges(),n&&removeClass(r,"invisibleSelection"),r.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(r,n){let o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];makeElementContentEditableAndSelectItsContent(r,o),n(),removeContentEditableFromElementAndDeselect(r,o)}},27687:function(r,n,o){"use strict";function stopImmediatePropagation(r){r.isImmediatePropagationEnabled=!1,r.cancelBubble=!0}function isImmediatePropagationStopped(r){return!1===r.isImmediatePropagationEnabled}function isRightClick(r){return 2===r.button}function isLeftClick(r){return 0===r.button}function isTouchEvent(r){return r instanceof TouchEvent}function offsetRelativeTo(r,n){let o={x:r.offsetX,y:r.offsetY},l=r.target;if(!(n instanceof HTMLElement)||l!==n&&l.contains(n))return o;for(;l!==n;)o.x+=l.offsetLeft,o.y+=l.offsetTop,l=l.offsetParent;return o}o.d(n,{Ty:function(){return isImmediatePropagationStopped},Zb:function(){return offsetRelativeTo},dO:function(){return isRightClick},mM:function(){return stopImmediatePropagation},pW:function(){return isLeftClick},z6:function(){return isTouchEvent}})},60973:function(r,n,o){"use strict";let l;function requestAnimationFrame(r){return window.requestAnimationFrame(r)}function cancelAnimationFrame(r){window.cancelAnimationFrame(r)}function isTouchSupported(){return"ontouchstart"in window}function isCSR(){return"undefined"!=typeof window}function getComparisonFunction(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l||(l="object"==typeof Intl?new Intl.Collator(r,n).compare:"function"==typeof String.prototype.localeCompare?(r,n)=>`${r}`.localeCompare(n):(r,n)=>r===n?0:r>n?-1:1)}o.d(n,{JS:function(){return isTouchSupported},U7:function(){return requestAnimationFrame},Wx:function(){return cancelAnimationFrame},o6:function(){return isCSR},sx:function(){return getComparisonFunction}})},98179:function(r,n,o){"use strict";o.d(n,{$Z:function(){return fastCall},Ds:function(){return debounce},WA:function(){return curry},mf:function(){return isFunction},r$:function(){return partial}});var l=o(2518);function isFunction(r){return"function"==typeof r}function debounce(r){let n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,l=null;return function(){for(var h=arguments.length,d=Array(h),w=0;w<h;w++)d[w]=arguments[w];return l&&clearTimeout(l),l=setTimeout(()=>{n=r.apply(this,d)},o),n}}function partial(r){for(var n=arguments.length,o=Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];return function(){for(var n=arguments.length,l=Array(n),h=0;h<n;h++)l[h]=arguments[h];return r.apply(this,o.concat(l))}}function curry(r){let n=r.length;return function given(o){return function(){for(var l=arguments.length,h=Array(l),d=0;d<l;d++)h[d]=arguments[d];let w=o.concat(h);return w.length>=n?r.apply(this,w):given(w)}}([])}function fastCall(r,n,o,h,d,w,y,S){return(0,l.$K)(S)?r.call(n,o,h,d,w,y,S):(0,l.$K)(y)?r.call(n,o,h,d,w,y):(0,l.$K)(w)?r.call(n,o,h,d,w):(0,l.$K)(d)?r.call(n,o,h,d):(0,l.$K)(h)?r.call(n,o,h):(0,l.$K)(o)?r.call(n,o):r.call(n)}},2518:function(r,n,o){"use strict";o.d(n,{$K:function(){return isDefined},Kj:function(){return isRegExp},Pz:function(){return stringify},ge:function(){return _injectProductInfo},o8:function(){return isUndefined},xb:function(){return isEmpty}});var l=o(62067),h=o(32836);function stringify(r){let n;switch(typeof r){case"string":case"number":n=`${r}`;break;case"object":n=null===r?"":r.toString();break;case"undefined":n="";break;default:n=r.toString()}return n}function isDefined(r){return void 0!==r}function isUndefined(r){return void 0===r}function isEmpty(r){return null===r||""===r||isUndefined(r)}function isRegExp(r){return"[object RegExp]"===Object.prototype.toString.call(r)}let d="length",_hd=r=>parseInt(r,16),_pi=r=>parseInt(r,10),_ss=(r,n,o)=>r.substr(n,o),_cp=r=>r.codePointAt(0)-65,_norm=r=>`${r}`.replace(/\-/g,""),_extractTime=r=>_hd(_ss(_norm(r),_hd("12"),_cp("F")))/(_hd(_ss(_norm(r),_cp("B"),~~![][d]))||9),_ignored=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),w=!1,y={invalid:()=>h.e`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:r=>{let{keyValidityDate:n,hotVersion:o}=r;return h.e`
    The license key for Handsontable expired on ${n}, and is not valid for the installed\x20
    version ${o}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${n}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>h.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},S={invalid:()=>h.e`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:r=>{let{keyValidityDate:n,hotVersion:o}=r;return h.e`
    The license key for Handsontable expired on ${n}, and is not valid for the installed\x20
    version ${o}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${n}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>h.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(r,n){let o;let h=!isEmpty(r),b="string"==typeof r&&"non-commercial-and-evaluation"===r.toLowerCase(),_="14.6.2",R="invalid",P="invalid";r=_norm(r||"");let T=function(r){let n=[][d],o=n;if(r[d]!==_cp("Z"))return!1;for(let n="",l="B<H4P+".split(""),h=_cp(l.shift());h;h=_cp(l.shift()||"A"))--h<""[d]?o|=(_pi(`${_pi(_hd(n)+(_hd(_ss(r,Math.abs(h),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=_ss(r,h,h?1===l[d]?9:8:6);return o===n}(r);if(h||b||T){if(T){let n=l("10/02/2025","DD/MM/YYYY"),h=Math.floor(n.toDate().getTime()/864e5),d=_extractTime(r);o=l((d+1)*864e5,"x").format("MMMM DD, YYYY"),h>d?(R="expired",P="expired"):(R="valid",P="valid")}else b?(R="non_commercial",P="valid"):(R="invalid",P="invalid")}else R="missing",P="missing";if(_ignored()&&(R="valid",P="valid"),!w&&"valid"!==R){let r=y[R]({keyValidityDate:o,hotVersion:_});r&&console["non_commercial"===R?"info":"warn"](y[R]({keyValidityDate:o,hotVersion:_})),w=!0}if("valid"!==P&&n.parentNode){let r=S[P]({keyValidityDate:o,hotVersion:_});if(r){let r=document.createElement("div");r.className="hot-display-license-info",r.innerHTML=S[P]({keyValidityDate:o,hotVersion:_}),n.parentNode.insertBefore(r,n.nextSibling)}}}},67790:function(r,n,o){"use strict";function isNumeric(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=typeof r;if("number"===o)return!isNaN(r)&&isFinite(r);if("string"===o){if(0===r.length)return!1;if(1===r.length)return/\d/.test(r);let o=Array.from(new Set([".",...n])).map(r=>`\\${r}`).join("|");return RegExp(`^[+-]?(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(r.trim())}return"object"===o&&!!r&&"number"==typeof r.valueOf()&&!(r instanceof Date)}function isNumericLike(r){return isNumeric(r,[","])}function rangeEach(r,n,o){let l=-1;for("function"==typeof n?(o=n,n=r):l=r-1;++l<=n&&!1!==o(l););}function rangeEachReverse(r,n,o){let l=r+1;for("function"==typeof n&&(o=n,n=0);--l>=n&&!1!==o(l););}function valueAccordingPercent(r,n){return parseInt(r*(n=isNaN(n=parseInt(n.toString().replace("%",""),10))?0:n)/100,10)}function clamp(r,n,o){return Math.min(r,n)===r?n:Math.max(r,o)===r?o:r}o.d(n,{N1:function(){return valueAccordingPercent},TR:function(){return isNumericLike},kE:function(){return isNumeric},q4:function(){return rangeEach},uZ:function(){return clamp},yh:function(){return rangeEachReverse}}),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652)},69488:function(r,n,o){"use strict";o.d(n,{$s:function(){return getProperty},ED:function(){return inherit},Hn:function(){return setProperty},I8:function(){return deepClone},Kn:function(){return isObject},Q8:function(){return deepObjectSize},Z1:function(){return isObjectEqual},ZB:function(){return function deepExtend(r,n){objectEach(n,(o,l)=>{n[l]&&"object"==typeof n[l]?(r[l]||(Array.isArray(n[l])?r[l]=[]:"[object Date]"===Object.prototype.toString.call(n[l])?r[l]=n[l]:r[l]={}),deepExtend(r[l],n[l])):r[l]=n[l]})}},_l:function(){return objectEach},d9:function(){return clone},ie:function(){return function duckSchema(r){let n;return Array.isArray(r)?n=r.length?Array(r.length).fill(null):[]:(n={},objectEach(r,(r,o)=>{"__children"!==o&&(r&&"object"==typeof r&&!Array.isArray(r)?n[o]=duckSchema(r):Array.isArray(r)?r.length&&"object"==typeof r[0]&&!Array.isArray(r[0])?n[o]=[duckSchema(r[0])]:n[o]=[]:n[o]=null)})),n}},jB:function(){return mixin},jW:function(){return defineGetter},l7:function(){return extend},nr:function(){return hasOwnProperty},sm:function(){return createObjectPropListener}}),o(57855),o(58563),o(92648);var l=o(99440);function inherit(r,n){return n.prototype.constructor=n,r.prototype=new n,r.prototype.constructor=r,r}function extend(r,n,o){let l=Array.isArray(o);return objectEach(n,(n,h)=>{(!1===l||o.includes(h))&&(r[h]=n)}),r}function deepClone(r){return"object"==typeof r?JSON.parse(JSON.stringify(r)):r}function clone(r){let n={};return objectEach(r,(r,o)=>{n[o]=r}),n}function mixin(r){r.MIXINS||(r.MIXINS=[]);for(var n=arguments.length,o=Array(n>1?n-1:0),h=1;h<n;h++)o[h-1]=arguments[h];return(0,l.Bk)(o,n=>{r.MIXINS.push(n.MIXIN_NAME),objectEach(n,(n,o)=>{if(void 0!==r.prototype[o])throw Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);"function"==typeof n?r.prototype[o]=n:Object.defineProperty(r.prototype,o,{get:function(r,n){let o=`_${r}`,initValue=r=>{let n=r;return(Array.isArray(n)||isObject(n))&&(n=deepClone(n)),n};return function(){return void 0===this[o]&&(this[o]=initValue(n)),this[o]}}(o,n),set:function(r){let n=`_${r}`;return function(r){this[n]=r}}(o),configurable:!0})})}),r}function isObjectEqual(r,n){return JSON.stringify(r)===JSON.stringify(n)}function isObject(r){return"[object Object]"===Object.prototype.toString.call(r)}function defineGetter(r,n,o,l){l.value=o,l.writable=!1!==l.writable,l.enumerable=!1!==l.enumerable,l.configurable=!1!==l.configurable,Object.defineProperty(r,n,l)}function objectEach(r,n){for(let o in r)if((!r.hasOwnProperty||r.hasOwnProperty&&Object.prototype.hasOwnProperty.call(r,o))&&!1===n(r[o],o,r))break;return r}function getProperty(r,n){let o=n.split("."),l=r;return objectEach(o,r=>{if(void 0===(l=l[r]))return l=void 0,!1}),l}function setProperty(r,n,o){let l=n.split("."),h=r;l.forEach((r,n)=>{n!==l.length-1?(hasOwnProperty(h,r)||(h[r]={}),h=h[r]):h[r]=o})}function deepObjectSize(r){if(!isObject(r))return 0;let recursObjLen=function(r){let n=0;return isObject(r)?objectEach(r,(r,o)=>{"__children"!==o&&(n+=recursObjLen(r))}):n+=1,n};return recursObjLen(r)}function createObjectPropListener(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",o=`_${n}`,l={_touched:!1,[o]:r,isTouched(){return this._touched}};return Object.defineProperty(l,n,{get(){return this[o]},set(r){this._touched=!0,this[o]=r},enumerable:!0,configurable:!0}),l}function hasOwnProperty(r,n){return Object.prototype.hasOwnProperty.call(r,n)}},66411:function(r,n,o){"use strict";o.d(n,{Nw:function(){return sanitize},O1:function(){return randomString},ct:function(){return toUpperCaseFirst},ng:function(){return substitute},oN:function(){return stripTags},wK:function(){return isPercentValue}}),o(58563);var l=o(43571);function toUpperCaseFirst(r){return r[0].toUpperCase()+r.substr(1)}function randomString(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return s4()+s4()+s4()+s4()}function isPercentValue(r){return/^([0-9][0-9]?%$)|(^100%$)/.test(r)}function substitute(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${r}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,o)=>"\\"===r.charAt(0)?r.substr(1,r.length-1):void 0===n[o]?"":n[o])}function stripTags(r){return sanitize(`${r}`,{ALLOWED_TAGS:[]})}function sanitize(r,n){return l.sanitize(r,n)}},32836:function(r,n,o){"use strict";o.d(n,{e:function(){return toSingleLine}});var l=o(99440);function toSingleLine(r){for(var n=arguments.length,o=Array(n>1?n-1:0),h=1;h<n;h++)o[h-1]=arguments[h];let d=(0,l.k$)(r,(r,n,l)=>{let h=n.replace(/\r?\n\s*/g,""),d=o[l]?o[l]:"";return r+h+d},"");return d.trim()}},66678:function(r,n,o){"use strict";o.d(n,{DC:function(){return isFunctionKey},EA:function(){return isPrintableChar},T2:function(){return isCtrlMetaKey},nx:function(){return d},ot:function(){return isKey}}),o(58563);var l=o(99440),h=o(2228);let d={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,h.vU)()?182:174,AUDIO_MUTE:(0,h.vU)()?181:173,AUDIO_UP:(0,h.vU)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},w=[d.ALT,d.ARROW_DOWN,d.ARROW_LEFT,d.ARROW_RIGHT,d.ARROW_UP,d.AUDIO_DOWN,d.AUDIO_MUTE,d.AUDIO_UP,d.BACKSPACE,d.CAPS_LOCK,d.DELETE,d.END,d.ENTER,d.ESCAPE,d.F1,d.F2,d.F3,d.F4,d.F5,d.F6,d.F7,d.F8,d.F9,d.F10,d.F11,d.F12,d.F13,d.F14,d.F15,d.F16,d.F17,d.F18,d.F19,d.HOME,d.INSERT,d.MEDIA_NEXT,d.MEDIA_PLAY_PAUSE,d.MEDIA_PREV,d.MEDIA_STOP,d.NULL,d.NUM_LOCK,d.PAGE_DOWN,d.PAGE_UP,d.PAUSE,d.SCROLL_LOCK,d.SHIFT,d.TAB];function isPrintableChar(r){return 32===r||r>=48&&r<=57||r>=96&&r<=111||r>=186&&r<=192||r>=219&&r<=222||r>=226||r>=65&&r<=90}function isFunctionKey(r){return w.includes(r)}function isCtrlMetaKey(r){return[d.CONTROL,d.COMMAND_LEFT,d.COMMAND_RIGHT,d.COMMAND_FIREFOX].includes(r)}function isKey(r,n){let o=n.split("|"),h=!1;return(0,l.Bk)(o,n=>{if(r===d[n])return h=!0,!1}),h}},52855:function(r,n,o){"use strict";o.r(n),o.d(n,{CHECKBOX_CHECKED:function(){return e5},CHECKBOX_RENDERER_NAMESPACE:function(){return e2},CHECKBOX_UNCHECKED:function(){return e4},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return X},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return et},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return ea},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return er},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return es},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return ei},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return el},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return en},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return eo},CONTEXTMENU_ITEMS_BORDERS:function(){return eh},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return eu},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return eg},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return ec},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return ed},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return I},CONTEXTMENU_ITEMS_COPY:function(){return O},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return L},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return N},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return k},CONTEXTMENU_ITEMS_CUT:function(){return j},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return J},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return U},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return ev},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return ew},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return y},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return S},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return K},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return ep},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return em},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return h},CONTEXTMENU_ITEMS_READ_ONLY:function(){return T},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return ee},CONTEXTMENU_ITEMS_REDO:function(){return P},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return ef},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return _},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return Q},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return b},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return d},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return w},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return eC},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return ey},CONTEXTMENU_ITEMS_UNDO:function(){return R},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return $},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return Y},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return l},FILTERS_BUTTONS_CANCEL:function(){return eJ},FILTERS_BUTTONS_CLEAR:function(){return eq},FILTERS_BUTTONS_OK:function(){return eZ},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return eQ},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return e1},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return e0},FILTERS_BUTTONS_SELECT_ALL:function(){return eX},FILTERS_CONDITIONS_AFTER:function(){return eL},FILTERS_CONDITIONS_BEFORE:function(){return eV},FILTERS_CONDITIONS_BEGINS_WITH:function(){return eM},FILTERS_CONDITIONS_BETWEEN:function(){return eD},FILTERS_CONDITIONS_BY_VALUE:function(){return eA},FILTERS_CONDITIONS_CONTAINS:function(){return eO},FILTERS_CONDITIONS_EMPTY:function(){return eR},FILTERS_CONDITIONS_ENDS_WITH:function(){return eI},FILTERS_CONDITIONS_EQUAL:function(){return eE},FILTERS_CONDITIONS_GREATER_THAN:function(){return eF},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return ek},FILTERS_CONDITIONS_LESS_THAN:function(){return eH},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return eN},FILTERS_CONDITIONS_NAMESPACE:function(){return eb},FILTERS_CONDITIONS_NONE:function(){return e_},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return eB},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return ex},FILTERS_CONDITIONS_NOT_EMPTY:function(){return eP},FILTERS_CONDITIONS_NOT_EQUAL:function(){return eT},FILTERS_CONDITIONS_TODAY:function(){return eG},FILTERS_CONDITIONS_TOMORROW:function(){return eW},FILTERS_CONDITIONS_YESTERDAY:function(){return ez},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return ej},FILTERS_DIVS_FILTER_BY_VALUE:function(){return eU},FILTERS_LABELS_CONJUNCTION:function(){return e$},FILTERS_LABELS_DISJUNCTION:function(){return eK},FILTERS_NAMESPACE:function(){return eS},FILTERS_VALUES_BLANK_CELLS:function(){return eY}});let l="ContextMenu:items",h=`${l}.noItems`,d=`${l}.insertRowAbove`,w=`${l}.insertRowBelow`,y=`${l}.insertColumnOnTheLeft`,S=`${l}.insertColumnOnTheRight`,b=`${l}.removeRow`,_=`${l}.removeColumn`,R=`${l}.undo`,P=`${l}.redo`,T=`${l}.readOnly`,I=`${l}.clearColumn`,O=`${l}.copy`,k=`${l}.copyWithHeaders`,N=`${l}.copyWithGroupHeaders`,L=`${l}.copyHeadersOnly`,j=`${l}.cut`,U=`${l}.freezeColumn`,$=`${l}.unfreezeColumn`,K=`${l}.mergeCells`,Y=`${l}.unmergeCells`,X=`${l}.addComment`,J=`${l}.editComment`,Q=`${l}.removeComment`,ee=`${l}.readOnlyComment`,et=`${l}.align`,ei=`${l}.align.left`,er=`${l}.align.center`,en=`${l}.align.right`,es=`${l}.align.justify`,eo=`${l}.align.top`,el=`${l}.align.middle`,ea=`${l}.align.bottom`,eh=`${l}.borders`,ed=`${l}.borders.top`,ec=`${l}.borders.right`,eu=`${l}.borders.bottom`,eg=`${l}.borders.left`,ef=`${l}.borders.remove`,em=`${l}.nestedHeaders.insertChildRow`,ep=`${l}.nestedHeaders.detachFromParent`,ev=`${l}.hideColumn`,eC=`${l}.showColumn`,ew=`${l}.hideRow`,ey=`${l}.showRow`,eS="Filters:",eb=`${eS}conditions`,e_=`${eb}.none`,eR=`${eb}.isEmpty`,eP=`${eb}.isNotEmpty`,eE=`${eb}.isEqualTo`,eT=`${eb}.isNotEqualTo`,eM=`${eb}.beginsWith`,eI=`${eb}.endsWith`,eO=`${eb}.contains`,ex=`${eb}.doesNotContain`,eA=`${eb}.byValue`,eF=`${eb}.greaterThan`,ek=`${eb}.greaterThanOrEqualTo`,eH=`${eb}.lessThan`,eN=`${eb}.lessThanOrEqualTo`,eD=`${eb}.isBetween`,eB=`${eb}.isNotBetween`,eL=`${eb}.after`,eV=`${eb}.before`,eG=`${eb}.today`,eW=`${eb}.tomorrow`,ez=`${eb}.yesterday`,ej=`${eS}labels.filterByCondition`,eU=`${eS}labels.filterByValue`,e$=`${eS}labels.conjunction`,eK=`${eS}labels.disjunction`,eY=`${eS}values.blankCells`,eX=`${eS}buttons.selectAll`,eq=`${eS}buttons.clear`,eZ=`${eS}buttons.ok`,eJ=`${eS}buttons.cancel`,eQ=`${eS}buttons.placeholder.search`,e0=`${eS}buttons.placeholder.value`,e1=`${eS}buttons.placeholder.secondValue`,e2="CheckboxRenderer:",e5=`${e2}checked`,e4=`${e2}unchecked`},78444:function(r,n,o){"use strict";o.d(n,{Zs:function(){return P},qG:function(){return getLanguageDictionary},vq:function(){return getLanguagesDictionaries},vk:function(){return getTranslatedPhrase},gr:function(){return getValidLanguageCode},RY:function(){return hasLanguageDictionary},MG:function(){return registerLanguageDictionary}});var l=o(69488),h=o(99440),d=o(2518),w=o(31870),y=o(82656);let{register:S,getValues:b}=(0,y.Z)("phraseFormatters");S("pluralize",function(r,n){let o=Array.isArray(r)&&Number.isInteger(n);return o?r[n]:r});var _=o(52855);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */let R={languageCode:"en-US",[_.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[_.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[_.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[_.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[_.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[_.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[_.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[_.CONTEXTMENU_ITEMS_UNDO]:"Undo",[_.CONTEXTMENU_ITEMS_REDO]:"Redo",[_.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[_.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[_.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[_.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[_.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[_.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[_.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[_.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[_.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[_.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[_.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[_.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[_.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[_.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[_.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[_.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[_.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[_.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[_.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[_.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[_.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[_.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[_.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[_.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[_.CONTEXTMENU_ITEMS_COPY]:"Copy",[_.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[_.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[_.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[_.CONTEXTMENU_ITEMS_CUT]:"Cut",[_.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[_.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[_.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[_.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[_.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[_.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[_.FILTERS_CONDITIONS_NONE]:"None",[_.FILTERS_CONDITIONS_EMPTY]:"Is empty",[_.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[_.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[_.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[_.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[_.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[_.FILTERS_CONDITIONS_CONTAINS]:"Contains",[_.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[_.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[_.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[_.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[_.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[_.FILTERS_CONDITIONS_BETWEEN]:"Is between",[_.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[_.FILTERS_CONDITIONS_AFTER]:"After",[_.FILTERS_CONDITIONS_BEFORE]:"Before",[_.FILTERS_CONDITIONS_TODAY]:"Today",[_.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[_.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[_.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[_.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[_.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[_.FILTERS_LABELS_CONJUNCTION]:"And",[_.FILTERS_LABELS_DISJUNCTION]:"Or",[_.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[_.FILTERS_BUTTONS_CLEAR]:"Clear",[_.FILTERS_BUTTONS_OK]:"OK",[_.FILTERS_BUTTONS_CANCEL]:"Cancel",[_.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[_.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[_.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[_.CHECKBOX_CHECKED]:"Checked",[_.CHECKBOX_UNCHECKED]:"Unchecked"},P=_,T=R.languageCode,{register:I,getItem:O,hasItem:k,getValues:N}=(0,y.Z)("languagesDictionaries");function registerLanguageDictionary(r,n){var o,h;let d=r,y=n;return(0,l.Kn)(r)&&(d=(y=r).languageCode),o=d,h=y,o!==T&&(0,w.eb)(h,O(T)),I(d,(0,l.I8)(y)),(0,l.I8)(y)}function getLanguageDictionary(r){return k(r)?(0,l.I8)(O(r)):null}function hasLanguageDictionary(r){return k(r)}function getLanguagesDictionaries(){return N()}function getTranslatedPhrase(r,n,o){let l;let w=getLanguageDictionary(r);if(null===w)return null;let y=w[n];if((0,d.o8)(y))return null;let S=(l=y,(0,h.Bk)(b(),r=>{l=r(y,o)}),l);return Array.isArray(S)?S[0]:S}function getValidLanguageCode(r){let n=(0,w.TH)(r);return k(n)||(n=T,(0,w.Vn)(r)),n}registerLanguageDictionary(R)},31870:function(r,n,o){"use strict";o.d(n,{TH:function(){return normalizeLanguageCode},Vn:function(){return warnUserAboutLanguageRegistration},eb:function(){return extendNotExistingKeys}});var l=o(2518),h=o(69488),d=o(24748),w=o(32836);function extendNotExistingKeys(r,n){return(0,h._l)(n,(n,o)=>{(0,l.o8)(r[o])&&(r[o]=n)}),r}function normalizeLanguageCode(r){let n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(r);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:r}function warnUserAboutLanguageRegistration(r){(0,l.$K)(r)&&(0,d.vU)(w.e`Language with code "${r}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}},63437:function(r,n,o){"use strict";o(58563);var l=o(69488),h=o(98179);let d={_localHooks:Object.create(null),addLocalHook(r,n){return this._localHooks[r]||(this._localHooks[r]=[]),this._localHooks[r].push(n),this},runLocalHooks(r,n,o,l,d,w,y){if(this._localHooks[r]){let S=this._localHooks[r].length;for(let b=0;b<S;b++)(0,h.$Z)(this._localHooks[r][b],this,n,o,l,d,w,y)}},clearLocalHooks(){return this._localHooks={},this}};(0,l.jW)(d,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),n.Z=d},54317:function(r,n,o){"use strict";o(57855),o(58563),o(79328);var l=o(99440),h=o(69488),d=o(66411),w=o(24748),y=o(32836),S=o(98179);let b=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],_=y.e`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,R=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),P=new Map([[]]),T=new WeakMap;let Hooks=class Hooks{static getSingleton(){return I}constructor(){var r,n,o;n=void 0,(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="globalBucket","string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let r=Object.create(null);return(0,l.Bk)(b,n=>{r[n]=[],this.initOrderMap(r,n)}),r}getBucket(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}add(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,h=arguments.length>3?arguments[3]:void 0;if(Array.isArray(n))(0,l.Bk)(n,n=>this.add(r,n,o));else{R.has(r)&&(0,w.ZK)((0,d.ng)(_,{hookName:r,removedInVersion:R.get(r)})),P.has(r)&&(0,w.ZK)(P.get(r));let y=this.getBucket(o);if(void 0===y[r]&&(this.register(r),y[r]=[],this.initOrderMap(y,r)),n.skip=!1,-1===y[r].indexOf(n)){let o=!1;n.initialHook&&(0,l.Bk)(y[r],(l,h)=>{if(l.initialHook)return y[r][h]=n,o=!0,!1}),o||y[r].push(n)}this.setCallbackOrderIndex(y,r,n,h),this.orderBucketByOrderIndex(y,r)}return this}once(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,h=arguments.length>3?arguments[3]:void 0;Array.isArray(n)?(0,l.Bk)(n,n=>this.once(r,n,o)):(n.runOnce=!0,this.add(r,n,o,h))}remove(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=this.getBucket(o);return!!(void 0!==l[r]&&l[r].indexOf(n)>=0)&&(n.skip=!0,!0)}has(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=this.getBucket(n);return!!(void 0!==o[r]&&o[r].length)}run(r,n,o,l,h,d,w,y){{let b=this.globalBucket[n],_=b?b.length:0,R=0;if(_)for(;R<_;){if(!b[R]||b[R].skip){R+=1;continue}let _=(0,S.$Z)(b[R],r,o,l,h,d,w,y);void 0!==_&&(o=_),b[R]&&b[R].runOnce&&this.remove(n,b[R]),R+=1}}{let b=this.getBucket(r)[n],_=b?b.length:0,R=0;if(_)for(;R<_;){if(!b[R]||b[R].skip){R+=1;continue}let _=(0,S.$Z)(b[R],r,o,l,h,d,w,y);void 0!==_&&(o=_),b[R]&&b[R].runOnce&&this.remove(n,b[R],r),R+=1}}return o}destroy(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,h._l)(this.getBucket(r),(r,n,o)=>o[n].length=0)}register(r){this.isRegistered(r)||b.push(r)}deregister(r){this.isRegistered(r)&&b.splice(b.indexOf(r),1)}isDeprecated(r){return P.has(r)||R.has(r)}isRegistered(r){return b.indexOf(r)>=0}getRegistered(){return b}setCallbackOrderIndex(r,n,o,l){let h=Number.isInteger(l)?l:0,d=this.getCallbackOrderMap(r,n);d.set(h,[...d.get(h)||[],o])}orderBucketByOrderIndex(r,n){let o=this.getCallbackOrderMap(r,n);void 0===o||0===o.size||1===o.size&&o.has(0)||(r[n]=[...o].sort((r,n)=>r[0]-n[0]).flatMap(r=>{let[,n]=r;return n}))}initOrderMap(r,n){T.has(r)||T.set(r,[]),T.get(r)[n]=new Map}getCallbackOrderMap(r,n){return T.get(r)[n]}};let I=new Hooks;n.Z=Hooks},55915:function(r,n,o){"use strict";o.d(n,{s3:function(){return getPlugin},a9:function(){return getPluginsNames},_j:function(){return hasPlugin},fo:function(){return registerPlugin}}),o(57855);var l=o(66411),h=o(67790),d=o(98179);let w=new Map([["asc",[-1,1]],["desc",[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=r=>`The priority '${r}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=r=>`The priority '${r}' is not a number.`;var y=o(2488);o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);let DEFAULT_ERROR_ITEM_EXISTS=r=>`'${r}' value is already declared in a unique set.`,ERROR_PLUGIN_REGISTERED=r=>`There is already registered "${r}" plugin.`,S=function(){let{errorPriorityExists:r,errorPriorityNaN:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=new Map;return r=(0,d.mf)(r)?r:DEFAULT_ERROR_PRIORITY_EXISTS,n=(0,d.mf)(n)?n:DEFAULT_ERROR_PRIORITY_NAN,{addItem:function(l,d){if(!(0,h.kE)(l))throw Error(n(l));if(o.has(l))throw Error(r(l));o.set(l,d)},getItems:function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",[n,l]=w.get(r)||w.get("asc");return[...o].sort((r,o)=>r[0]<o[0]?n:l).map(r=>r[1])}}}({errorPriorityExists:r=>`There is already registered plugin on priority "${r}".`,errorPriorityNaN:r=>`The priority "${r}" is not a number.`}),b=function(){let{errorItemExists:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new Set;return r=(0,d.mf)(r)?r:DEFAULT_ERROR_ITEM_EXISTS,{addItem:function(o){if(n.has(o))throw Error(r(o));n.add(o)},clear:function(){n.clear()},getItems:function(){return[...n]}}}({errorItemExists:ERROR_PLUGIN_REGISTERED}),_=(0,y.I)({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...S.getItems(),...b.getItems()]}function getPlugin(r){let n=(0,l.ct)(r);return _.getItem(n)}function hasPlugin(r){return!!getPlugin(r)}function registerPlugin(r,n,o){var h,d,w;[r,n,o]=(h=r,d=n,w=o,"function"==typeof h&&(h=(d=h).PLUGIN_KEY,w=d.PLUGIN_PRIORITY),[h,d,w]),void 0===getPlugin(r)&&function(r,n,o){let h=(0,l.ct)(r);if(_.hasItem(h))throw Error(ERROR_PLUGIN_REGISTERED(h));void 0===o?b.addItem(h):S.addItem(o,h),_.addItem(h,n)}(r,n,o)}},34141:function(r,n,o){"use strict";o.d(n,{t9:function(){return registerAllModules}}),o(57855),o(58563);var l=o(2694),h=o(5566),d=o(27687),w=o(69488),y=o(82659);let S="handsontableEditor";let HandsontableEditor=class HandsontableEditor extends l.H{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,h.Mq)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(r,n,o,l,h,d){super.prepare(r,n,o,l,h,d);let y=this,S={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(r,n){let o=this.getSourceData(n.row,n.col);void 0!==o&&y.setValue(o),y.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,w.l7)(S,d.handsontable),this.htOptions=S}beginEditing(r,n){let o=this.hot.getSettings().onBeginEditing;o&&!1===o()||super.beginEditing(r,n)}createElements(){super.createElements();let r=this.hot.rootDocument.createElement("DIV");r.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(r),this.htContainer=r,this.assignHooks()}finishEditing(r,n,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let r=this.htEditor.getValue();void 0!==r&&this.setValue(r)}super.finishEditing(r,n,o)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("editor");super.registerShortcuts();let o={group:S,relativeToGroup:y.I,position:"before"},action=(r,n)=>{let o=this.htEditor;if(void 0!==r&&(r<0||o.flipped&&r>o.countRows()-1?o.deselectCell():o.selectCell(r,0),o.getData().length))return n.preventDefault(),(0,d.mM)(n),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:r=>{let n;let o=this.htEditor;return!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(n=o.flipped?Math.max(0,o.getSelectedLast()[0]-1):o.getSelectedLast()[0]-1),action(n,r)},preventDefault:!1},{keys:[["ArrowDown"]],callback:r=>{let n;let o=this.htEditor;if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast()){if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){let r=o.countRows()-1;n=Math.min(r,o.getSelectedLast()[0]+1)}}}else n=0;return action(n,r)},preventDefault:!1}],o)}unregisterShortcuts(){super.unregisterShortcuts();let r=this.hot.getShortcutManager(),n=r.getContext("editor");n.removeShortcutsByGroup(S)}};var b=o(99440),_=o(2518),R=o(66411),P=o(66678),T=o(2228),I=o(49532),O=o(18200);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var k=new WeakMap;let AutocompleteEditor=class AutocompleteEditor extends HandsontableEditor{constructor(){var r;super(...arguments),_defineProperty(this,"query",null),_defineProperty(this,"strippedChoices",[]),_defineProperty(this,"rawChoices",[]),r=this.hot.guid.slice(0,9),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,k),k.set(this,r),_defineProperty(this,"sortByRelevance",function(r,n,o){let l,h,d,w;let y=[],S=[],b=r.length,P=n.length;if(0===b){for(d=0;d<P;d++)S.push(d);return S}for(d=0;d<P;d++){if(h=(0,R.oN)((0,_.Pz)(n[d])),o)w=h.indexOf(r);else{let n=this.cellProperties.locale;w=h.toLocaleLowerCase(n).indexOf(r.toLocaleLowerCase(n))}-1!==w&&(l=h.length-w-b,y.push({baseIndex:d,index:w,charsLeft:l,value:h}))}for(y.sort((r,n)=>{if(-1===n.index)return -1;if(-1===r.index)return 1;if(r.index<n.index)return -1;if(n.index<r.index)return 1;if(r.index===n.index){if(r.charsLeft<n.charsLeft)return -1;if(r.charsLeft>n.charsLeft)return 1}return 0}),d=0,P=y.length;d<P;d++)S.push(y[d].baseIndex);return S})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){let r=this.rawChoices.find(r=>{let n=this.stripValueIfNeeded(r);return n===this.TEXTAREA.value});return(0,_.$K)(r)?r:this.TEXTAREA.value}createElements(){super.createElements(),(0,h.cn)(this.htContainer,"autocompleteEditor"),(0,h.cn)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,h.P$)(this.TEXTAREA,[(0,O.Nr)(),(0,O.LO)(),(0,O.fv)("listbox"),(0,O.zV)()])}prepare(r,n,o,l,d,w){super.prepare(r,n,o,l,d,w),this.hot.getSettings().ariaTags&&(0,h.P$)(this.TEXTAREA,[(0,O.JV)("false"),(0,O.d)(`${k.get(_assertClassBrand(k,this))}-listbox-${r}-${n}`)])}open(){super.open();let r=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,o=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,l=null==o?void 0:o.length,{row:d,col:w}=this;this.showEditableElement(),this.focus();let y=(0,h.np)();0===y&&(0,T.eE)()&&(y+=15),this.addHook("beforeKeyDown",r=>this.onBeforeKeyDown(r)),this.htEditor.updateSettings({colWidths:r?[(0,h.iO)(this.TEXTAREA)-2]:void 0,width:r?(0,h.iO)(this.TEXTAREA)+y:void 0,autoColumnSize:!0,renderer:(r,d,w,y,S,b,R)=>{let P,T;(0,I.V)(r,d,w,y,S,b,R);let{filteringCaseSensitive:k,allowHtml:N,locale:L}=this.cellProperties,j=this.query,U=(0,_.Pz)(b);U&&!N&&-1!==(P=!0===k?U.indexOf(j):U.toLocaleLowerCase(L).indexOf(j.toLocaleLowerCase(L)))&&(T=U.substr(P,j.length),U=U.replace(T,`<strong>${T}</strong>`)),n&&(0,h.P$)(d,[(0,O.Nl)(),...o?[(0,O.DT)(l)]:[],...o?[(0,O.jH)(o.indexOf(b)+1)]:[],["id",`${this.htEditor.rootElement.id}_${w}-${y}`]]),d.innerHTML=U},afterSelectionEnd:(r,o)=>{if(n){let n=this.htEditor.getCell(r,o,!0);(0,h.P$)(n,[(0,O.Ak)()]),(0,h.P$)(this.TEXTAREA,...(0,O.nT)(n.id))}}}),n&&((0,h.P$)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,O.Rn)()),(0,h.P$)(this.htEditor.rootElement,[(0,O.a6)(),(0,O.Ez)("polite"),(0,O.Up)("text"),["id",`${k.get(_assertClassBrand(k,this))}-listbox-${d}-${w}`]]),(0,h.P$)(this.TEXTAREA,...(0,O.JV)("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,h.P$)(this.TEXTAREA,[(0,O.JV)("false")])}discardEditor(r){super.discardEditor(r),this.hot.view.render()}queryChoices(r){let n=this.cellProperties.source;this.query=r,"function"==typeof n?n.call(this.cellProperties,r,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(r){let n=(0,h.qK)(this.TEXTAREA),o=(0,h.kg)(this.TEXTAREA),l=this.cellProperties.sortByRelevance,d=this.cellProperties.filter,w=null,y=null,S=r;l&&(w=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),S,this.cellProperties.filteringCaseSensitive));let _=Array.isArray(w)?w.length:0;if(!1===d)_&&(y=w[0]);else{let r=[];for(let n=0,o=S.length;n<o&&(!l||!(_<=n));n++)_?r.push(S[w[n]]):r.push(S[n]);y=0,S=r}this.strippedChoices=S,0===S.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData((0,b.jz)([S])),S.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(y)),this.hot.listen(),(0,h.Mq)(this.TEXTAREA,n,n===o?void 0:o)}flipDropdownIfNeeded(){let r=(0,h.$g)(this.hot.view._wt.wtTable.TABLE),n=r===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(n||!n&&(o||"horizontal"===o))return!1;let l=(0,h.cv)(this.TEXTAREA),d=(0,h.Pb)(this.TEXTAREA),w=this.getDropdownHeight(),y=r.scrollTop,S=(0,h.Pb)(this.hot.view._wt.wtTable.THEAD),b=(0,h.cv)(r),_=l.top-b.top-S+y,R=r.scrollHeight-_-S-d,P=w>R&&_>R;return P?this.flipDropdown(w):this.unflipDropdown(),this.limitDropdownIfNeeded(P?_:R,w),P}limitDropdownIfNeeded(r,n){if(n>r){let o=0,l=0,h=0,d=null;do o+=h=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),l+=1;while(o<r);d=o-h,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-d}px`),this.setDropdownHeight(o-h)}}flipDropdown(r){let n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-r}px`,this.htEditor.flipped=!0}unflipDropdown(){let r=this.htEditor.rootElement.style;r.position="absolute",r.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){let r=this.htEditor.getColWidth(0)+(0,h.np)(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:r}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(r){this.htEditor.updateSettings({height:r})}highlightBestMatchingChoice(r){"number"==typeof r?this.htEditor.selectCell(r,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){let r=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*r:this.strippedChoices.length*r+8}stripValueIfNeeded(r){return this.stripValuesIfNeeded([r])[0]}stripValuesIfNeeded(r){let{allowHtml:n}=this.cellProperties,o=(0,b.Sc)(r,r=>(0,_.Pz)(r)),l=(0,b.Sc)(o,r=>n?r:(0,R.oN)(r));return l}allowKeyEventPropagation(r){let n=this.htEditor.getSelectedRangeLast(),o={row:n?n.from.row:-1},l=!1;return r===P.nx.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(l=!0),r===P.nx.ARROW_UP&&o.row>-1&&(l=!0),l}onBeforeKeyDown(r){if((0,P.EA)(r.keyCode)||r.keyCode===P.nx.BACKSPACE||r.keyCode===P.nx.DELETE||r.keyCode===P.nx.INSERT){let n=10;r.keyCode===P.nx.C&&(r.ctrlKey||r.metaKey)||(this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n))}}};var N=o(98422);let CheckboxEditor=class CheckboxEditor extends N.Hf{static get EDITOR_TYPE(){return"checkbox"}beginEditing(r,n){if(n&&"mouseup"===n.type&&"TD"===n.target.nodeName){let r=this.TD.querySelector('input[type="checkbox"]');(0,h.pv)(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}};var L=o(62067);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */let getWindow=()=>window,getDocument=()=>window.document,sto=(r,n)=>window.setTimeout(r,n),addEvent=function(r,n,o,l){r.addEventListener(n,o,!!l)},removeEvent=function(r,n,o,l){r.removeEventListener(n,o,!!l)},hasClass=function(r,n){return -1!==(" "+r.className+" ").indexOf(" "+n+" ")},addClass=function(r,n){hasClass(r,n)||(r.className=""===r.className?n:r.className+" "+n)},removeClass=function(r,n){var o;r.className=(o=(" "+r.className+" ").replace(" "+n+" "," ")).trim?o.trim():o.replace(/^\s+|\s+$/g,"")},isArray=function(r){return/Array/.test(Object.prototype.toString.call(r))},isDate=function(r){return/Date/.test(Object.prototype.toString.call(r))&&!isNaN(r.getTime())},isWeekend=function(r){let n=r.getDay();return 0===n||6===n},getDaysInMonth=function(r,n){return[31,r%4==0&&r%100!=0||r%400==0?29:28,31,30,31,30,31,31,30,31,30,31][n]},setToStartOfDay=function(r){isDate(r)&&r.setHours(0,0,0,0)},compareDates=function(r,n){return r.getTime()===n.getTime()},extend=function(r,n,o){let l,h;for(l in n)(h=void 0!==r[l])&&"object"==typeof n[l]&&null!==n[l]&&void 0===n[l].nodeName?isDate(n[l])?o&&(r[l]=new Date(n[l].getTime())):isArray(n[l])?o&&(r[l]=n[l].slice(0)):r[l]=extend({},n[l],o):(o||!h)&&(r[l]=n[l]);return r},fireEvent=function(r,n,o){let l=getDocument().createEvent("HTMLEvents");l.initEvent(n,!0,!1),l=extend(l,o),r.dispatchEvent(l)},adjustCalendar=function(r){return r.month<0&&(r.year-=Math.ceil(Math.abs(r.month)/12),r.month+=12),r.month>11&&(r.year+=Math.floor(Math.abs(r.month)/12),r.month-=12),r},j={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(r,n,o){for(n+=r.firstDay;n>=7;)n-=7;return o?r.i18n.weekdaysShort[n]:r.i18n.weekdays[n]},renderDay=function(r){let n=[],o="false";if(r.isEmpty){if(!r.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';n.push("is-outside-current-month"),r.enableSelectionDaysInNextAndPreviousMonths||n.push("is-selection-disabled")}return r.isDisabled&&n.push("is-disabled"),r.isToday&&n.push("is-today"),r.isSelected&&(n.push("is-selected"),o="true"),r.hasEvent&&n.push("has-event"),r.isInRange&&n.push("is-inrange"),r.isStartRange&&n.push("is-startrange"),r.isEndRange&&n.push("is-endrange"),'<td data-day="'+r.day+'" class="'+n.join(" ")+'" aria-selected="'+o+'"><button class="pika-button pika-day" type="button" data-pika-year="'+r.year+'" data-pika-month="'+r.month+'" data-pika-day="'+r.day+'">'+r.day+"</button></td>"},isoWeek=function(r,n){r.setHours(0,0,0,0);let o=r.getDate(),l=r.getDay(),h=n-1,prevWeekDay=function(r){return(r+7-1)%7};r.setDate(o+h-prevWeekDay(l));let d=new Date(r.getFullYear(),0,n);return 1+Math.round(((r.getTime()-d.getTime())/864e5-h+prevWeekDay(d.getDay()))/7)},renderWeek=function(r,n,o,l,h){let d=new Date(l,o,n);return'<td class="pika-week">'+(r.hasMoment?r.moment(d).isoWeek():isoWeek(d,h))+"</td>"},renderHead=function(r){let n,o=[];for(r.showWeekNumber&&o.push("<th></th>"),n=0;n<7;n++)o.push('<th scope="col"><abbr title="'+renderDayName(r,n)+'">'+renderDayName(r,n,!0)+"</abbr></th>");return"<thead><tr>"+(r.isRTL?o.reverse():o).join("")+"</tr></thead>"},renderTitle=function(r,n,o,l,h,d){let w,y,S,b=r._o,_=o===b.minYear,R=o===b.maxYear,P='<div id="'+d+'" class="pika-title" role="heading" aria-live="polite">',T,I,O=!0,k=!0;for(S=[],w=0;w<12;w++)S.push('<option value="'+(o===h?w-n:12+w-n)+'"'+(w===l?' selected="selected"':"")+(_&&w<b.minMonth||R&&w>b.maxMonth?' disabled="disabled"':"")+">"+b.i18n.months[w]+"</option>");for(T='<div class="pika-label">'+b.i18n.months[l]+'<select class="pika-select pika-select-month" tabindex="-1">'+S.join("")+"</select></div>",isArray(b.yearRange)?(w=b.yearRange[0],y=b.yearRange[1]+1):(w=o-b.yearRange,y=1+o+b.yearRange),S=[];w<y&&w<=b.maxYear;w++)w>=b.minYear&&S.push('<option value="'+w+'"'+(w===o?' selected="selected"':"")+">"+w+"</option>");return I='<div class="pika-label">'+o+b.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+S.join("")+"</select></div>",b.showMonthAfterYear?P+=I+T:P+=T+I,_&&(0===l||b.minMonth>=l)&&(O=!1),R&&(11===l||b.maxMonth<=l)&&(k=!1),0===n&&(P+='<button class="pika-prev'+(O?"":" is-disabled")+'" type="button">'+b.i18n.previousMonth+"</button>"),n===r._o.numberOfMonths-1&&(P+='<button class="pika-next'+(k?"":" is-disabled")+'" type="button">'+b.i18n.nextMonth+"</button>"),P+"</div>"};function Pikaday(r){let n=this,o=n.config(r);n._onMouseDown=function(r){if(!n._v)return;let l=(r=r||getWindow().event).target||r.srcElement;if(l){if(!hasClass(l,"is-disabled")&&(!hasClass(l,"pika-button")||hasClass(l,"is-empty")||hasClass(l.parentNode,"is-disabled")?hasClass(l,"pika-prev")?n.prevMonth():hasClass(l,"pika-next")&&n.nextMonth():(n.setDate(new Date(l.getAttribute("data-pika-year"),l.getAttribute("data-pika-month"),l.getAttribute("data-pika-day"))),o.bound&&sto(function(){n.hide(),o.blurFieldOnSelect&&o.field&&o.field.blur()},100))),hasClass(l,"pika-select"))n._c=!0;else{if(!r.preventDefault)return r.returnValue=!1,!1;r.preventDefault()}}},n._onChange=function(r){let o=(r=r||getWindow().event).target||r.srcElement;o&&(hasClass(o,"pika-select-month")?n.gotoMonth(o.value):hasClass(o,"pika-select-year")&&n.gotoYear(o.value))},n._onKeyChange=function(r){if(r=r||getWindow().event,n.isVisible())switch(r.keyCode){case 13:case 27:o.field&&o.field.blur();break;case 37:n.adjustDate("subtract",1);break;case 38:n.adjustDate("subtract",7);break;case 39:n.adjustDate("add",1);break;case 40:n.adjustDate("add",7);break;case 8:case 46:n.setDate(null)}},n._parseFieldValue=function(){if(o.parse)return o.parse(o.field.value,o.format);if(!this.hasMoment)return new Date(Date.parse(o.field.value));{let r=this.moment(o.field.value,o.format,o.formatStrict);return r&&r.isValid()?r.toDate():null}},n._onInputChange=function(r){let o;r.firedBy!==n&&(isDate(o=n._parseFieldValue())&&n.setDate(o),n._v||n.show())},n._onInputFocus=function(){n.show()},n._onInputClick=function(){n.show()},n._onInputBlur=function(){let r=getDocument().activeElement;do if(hasClass(r,"pika-single"))return;while(r=r.parentNode);n._c||(n._b=sto(function(){n.hide()},50)),n._c=!1},n._onClick=function(r){let l=(r=r||getWindow().event).target||r.srcElement,h=l;if(l){!hasEventListeners&&hasClass(l,"pika-select")&&!l.onchange&&(l.setAttribute("onchange","return;"),addEvent(l,"change",n._onChange));do if(hasClass(h,"pika-single")||h===o.trigger)return;while(h=h.parentNode);n._v&&l!==o.trigger&&h!==o.trigger&&n.hide()}},n.el=getDocument().createElement("div"),n.el.className="pika-single"+(o.isRTL?" is-rtl":"")+(o.theme?" "+o.theme:""),addEvent(n.el,"mousedown",n._onMouseDown,!0),addEvent(n.el,"touchend",n._onMouseDown,!0),addEvent(n.el,"change",n._onChange),o.keyboardInput&&addEvent(getDocument(),"keydown",n._onKeyChange),o.field&&(o.container?o.container.appendChild(n.el):o.bound?getDocument().body.appendChild(n.el):o.field.parentNode.insertBefore(n.el,o.field.nextSibling),addEvent(o.field,"change",n._onInputChange),o.defaultDate||(o.defaultDate=n._parseFieldValue(),o.setDefaultDate=!0));let l=o.defaultDate;isDate(l)?o.setDefaultDate?n.setDate(l,!0):n.gotoDate(l):n.gotoDate(new Date),o.bound?(this.hide(),n.el.className+=" is-bound",addEvent(o.trigger,"click",n._onInputClick),addEvent(o.trigger,"focus",n._onInputFocus),addEvent(o.trigger,"blur",n._onInputBlur)):this.show()}function dateEditor_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}Pikaday.prototype={config:function(r){this._o||(this._o=extend({},j,!0));let n=extend(this._o,r,!0);n.isRTL=!!n.isRTL,n.field=n.field&&n.field.nodeName?n.field:null,n.theme="string"==typeof n.theme&&n.theme?n.theme:null,n.bound=!!(void 0!==n.bound?n.field&&n.bound:n.field),n.trigger=n.trigger&&n.trigger.nodeName?n.trigger:n.field,n.disableWeekends=!!n.disableWeekends,n.disableDayFn="function"==typeof n.disableDayFn?n.disableDayFn:null;let o=parseInt(n.numberOfMonths,10)||1;if(n.numberOfMonths=o>4?4:o,isDate(n.minDate)||(n.minDate=!1),isDate(n.maxDate)||(n.maxDate=!1),n.minDate&&n.maxDate&&n.maxDate<n.minDate&&(n.maxDate=n.minDate=!1),n.minDate&&this.setMinDate(n.minDate),n.maxDate&&this.setMaxDate(n.maxDate),isArray(n.yearRange)){let r=new Date().getFullYear()-10;n.yearRange[0]=parseInt(n.yearRange[0],10)||r,n.yearRange[1]=parseInt(n.yearRange[1],10)||r}else n.yearRange=Math.abs(parseInt(n.yearRange,10))||j.yearRange,n.yearRange>100&&(n.yearRange=100);return n},toString:function(r){return(r=r||this._o.format,isDate(this._d))?this._o.toString?this._o.toString(this._d,r):this.hasMoment?this.moment(this._d).format(r):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(r,n){this.hasMoment&&this.moment.isMoment(r)&&this.setDate(r.toDate(),n)},useMoment:function(r){this.hasMoment=!0,this.moment=r},getDate:function(){return isDate(this._d)?new Date(this._d.getTime()):null},setDate:function(r,n){if(!r)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof r&&(r=new Date(Date.parse(r))),!isDate(r))return;let o=this._o.minDate,l=this._o.maxDate;isDate(o)&&r<o?r=o:isDate(l)&&r>l&&(r=l),this._d=new Date(r.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),n||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(r){let n=!0;if(isDate(r)){if(this.calendars){let o=new Date(this.calendars[0].year,this.calendars[0].month,1),l=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),h=r.getTime();l.setMonth(l.getMonth()+1),l.setDate(l.getDate()-1),n=h<o.getTime()||l.getTime()<h}n&&(this.calendars=[{month:r.getMonth(),year:r.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(r,n){let o,l=this.getDate()||new Date,h=864e5*parseInt(n);"add"===r?o=new Date(l.valueOf()+h):"subtract"===r&&(o=new Date(l.valueOf()-h)),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let r=1;r<this._o.numberOfMonths;r++)this.calendars[r]=adjustCalendar({month:this.calendars[0].month+r,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(r){isNaN(r)||(this.calendars[0].month=parseInt(r,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(r){isNaN(r)||(this.calendars[0].year=parseInt(r,10),this.adjustCalendars())},setMinDate:function(r){r instanceof Date?(setToStartOfDay(r),this._o.minDate=r,this._o.minYear=r.getFullYear(),this._o.minMonth=r.getMonth()):(this._o.minDate=j.minDate,this._o.minYear=j.minYear,this._o.minMonth=j.minMonth,this._o.startRange=j.startRange),this.draw()},setMaxDate:function(r){r instanceof Date?(setToStartOfDay(r),this._o.maxDate=r,this._o.maxYear=r.getFullYear(),this._o.maxMonth=r.getMonth()):(this._o.maxDate=j.maxDate,this._o.maxYear=j.maxYear,this._o.maxMonth=j.maxMonth,this._o.endRange=j.endRange),this.draw()},setStartRange:function(r){this._o.startRange=r},setEndRange:function(r){this._o.endRange=r},draw:function(r){if(!this._v&&!r)return;let n=this._o,o=n.minYear,l=n.maxYear,h=n.minMonth,d=n.maxMonth,w="",y;this._y<=o&&(this._y=o,!isNaN(h)&&this._m<h&&(this._m=h)),this._y>=l&&(this._y=l,!isNaN(d)&&this._m>d&&(this._m=d));for(let r=0;r<n.numberOfMonths;r++)y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),w+='<div class="pika-lendar">'+renderTitle(this,r,this.calendars[r].year,this.calendars[r].month,this.calendars[0].year,y)+this.render(this.calendars[r].year,this.calendars[r].month,y)+"</div>";this.el.innerHTML=w,n.bound&&"hidden"!==n.field.type&&sto(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let r,n,o,l,h,d,w,y,S,b,_;this._o.container||(this.el.style.position="absolute",r=this._o.trigger,n=this.el.offsetWidth,o=this.el.offsetHeight,l=getWindow().innerWidth||getDocument().documentElement.clientWidth,h=getWindow().innerHeight||getDocument().documentElement.clientHeight,d=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,b=!0,_=!0,w=(S=r.getBoundingClientRect()).left+getWindow().pageXOffset,y=S.bottom+getWindow().pageYOffset,(this._o.reposition&&w+n>l||this._o.position.indexOf("right")>-1&&w-n+r.offsetWidth>0)&&(w=w-n+r.offsetWidth,b=!1),(this._o.reposition&&y+o>h+d||this._o.position.indexOf("top")>-1&&y-o-r.offsetHeight>0)&&(y=y-o-r.offsetHeight,_=!1),w<0&&(w=0),y<0&&(y=0),this.el.style.left=w+"px",this.el.style.top=y+"px",addClass(this.el,b?"left-aligned":"right-aligned"),addClass(this.el,_?"bottom-aligned":"top-aligned"),removeClass(this.el,b?"right-aligned":"left-aligned"),removeClass(this.el,_?"top-aligned":"bottom-aligned"))},render:function(r,n,o){var l,h;let d=this._o,w=new Date,y=getDaysInMonth(r,n),S=new Date(r,n,1).getDay(),b=[],_=[];setToStartOfDay(w),d.firstDay>0&&(S-=d.firstDay)<0&&(S+=7);let R=0===n?11:n-1,P=11===n?0:n+1,T=0===n?r-1:r,I=11===n?r+1:r,O=getDaysInMonth(T,R),k=y+S,N=k;for(;N>7;)N-=7;k+=7-N;let L=!1;for(let o=0,N=0;o<k;o++){let k=new Date(r,n,1+(o-S)),j=!!isDate(this._d)&&compareDates(k,this._d),U=compareDates(k,w),$=-1!==d.events.indexOf(k.toDateString()),K=o<S||o>=y+S,Y=1+(o-S),X=n,J=r,Q=d.startRange&&compareDates(d.startRange,k),ee=d.endRange&&compareDates(d.endRange,k),et=d.startRange&&d.endRange&&d.startRange<k&&k<d.endRange,ei=d.minDate&&k<d.minDate||d.maxDate&&k>d.maxDate||d.disableWeekends&&isWeekend(k)||d.disableDayFn&&d.disableDayFn(k);K&&(o<S?(Y=O+Y,X=R,J=T):(Y-=y,X=P,J=I));let er={day:Y,month:X,year:J,hasEvent:$,isSelected:j,isToday:U,isDisabled:ei,isEmpty:K,isStartRange:Q,isEndRange:ee,isInRange:et,showDaysInNextAndPreviousMonths:d.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:d.enableSelectionDaysInNextAndPreviousMonths};d.pickWholeWeek&&j&&(L=!0),_.push(renderDay(er)),7==++N&&(d.showWeekNumber&&_.unshift(renderWeek(this,o-S,n,r,d.firstWeekOfYearMinDays)),b.push((l=_,h=d.isRTL,'<tr class="pika-row'+(d.pickWholeWeek?" pick-whole-week":"")+(L?" is-selected":"")+'">'+(h?l.reverse():l).join("")+"</tr>")),_=[],N=0,L=!1)}return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+o+'">'+renderHead(d)+"<tbody>"+b.join("")+"</tbody></table>"},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent(getDocument(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let r=this._v;!1!==r&&(this._o.bound&&removeEvent(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass(this.el,"is-hidden"),this._v=!1,void 0!==r&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let r=this._o;this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"touchend",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),r.keyboardInput&&removeEvent(getDocument(),"keydown",this._onKeyChange),r.field&&(removeEvent(r.field,"change",this._onInputChange),r.bound&&(removeEvent(r.trigger,"click",this._onInputClick),removeEvent(r.trigger,"focus",this._onInputFocus),removeEvent(r.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};let U="date",$="dateEditor";let DateEditor=class DateEditor extends l.H{constructor(){super(...arguments),dateEditor_defineProperty(this,"defaultDateFormat","DD/MM/YYYY"),dateEditor_defineProperty(this,"parentDestroyed",!1),dateEditor_defineProperty(this,"$datePicker",null)}static get EDITOR_TYPE(){return U}init(){if("function"!=typeof L)throw Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,h.cn)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",r=>{(0,h.pv)(r.target,"pika-day")&&this.hideDatepicker(),r.stopPropagation()})}destroyElements(){let r=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),r&&r.removeChild(this.datePicker)}prepare(r,n,o,l,h,d){super.prepare(r,n,o,l,h,d)}open(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.hot.getShortcutManager(),o=n.getContext("editor");this.showDatepicker(r),super.open(),o.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:$})}close(){var r;this._opened=!1,null!==(r=this.$datePicker)&&void 0!==r&&r.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{let r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()});let n=this.hot.getShortcutManager(),o=n.getContext("editor");o.removeShortcutsByGroup($),super.close()}finishEditing(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(r,n)}showDatepicker(r){let n;let o=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.hot.view.isMouseDown(),h=!!r&&(0,P.DC)(r.keyCode);this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(L),this.$datePicker._onInputFocus=function(){},this.originalValue?(L(n=this.originalValue,o,!0).isValid()&&this.$datePicker.setMoment(L(n,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),h||l||this.setValue("")):this.cellProperties.defaultDate?(L(n=this.cellProperties.defaultDate,o,!0).isValid()&&this.$datePicker.setMoment(L(n,o),!0),h||l||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){let r=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,w.ZB)(n,this.cellProperties.datePickerConfig);let o=n.onSelect,l=n.onClose;return n.field=r,n.trigger=r,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=r=>{let n=r;isNaN(n.getTime())||(n=L(n).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(n),o&&o()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),l&&l()},n}refreshDimensions(r){var n;if(super.refreshDimensions(r),this.state!==N.ed.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}let{rowIndexMapper:o,columnIndexMapper:l}=this.hot,{wtOverlays:d}=this.hot.view._wt,{wtTable:w}=null!==(n=d.getParentOverlay(this.TD))&&void 0!==n?n:this.hot.view._wt,y=o.getVisualFromRenderableIndex(w.getFirstPartiallyVisibleRow()),S=o.getVisualFromRenderableIndex(w.getLastPartiallyVisibleRow()),b=l.getVisualFromRenderableIndex(w.getFirstPartiallyVisibleColumn()),_=l.getVisualFromRenderableIndex(w.getLastPartiallyVisibleColumn());if(this.row>=y&&this.row<=S&&this.col>=b&&this.col<=_){let r=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+r.top+(0,h.Pb)(this.TD)}px`;let n=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?n+=r.right-(0,h.iO)(this.datePicker):n+=r.left,this.datePickerStyle.left=`${n}px`}else this.hideDatepicker()}};var K=o(54317);let DropdownEditor=class DropdownEditor extends AutocompleteEditor{static get EDITOR_TYPE(){return"dropdown"}prepare(r,n,o,l,h,d){super.prepare(r,n,o,l,h,d),this.cellProperties.filter=!1,this.cellProperties.strict=!0}};K.Z.getSingleton().add("beforeValidate",function(r,n,o){let l=this.propToCol(o);if(Number.isInteger(l)){let r=this.getCellMeta(n,l);r.editor===DropdownEditor&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}});let NumericEditor=class NumericEditor extends l.H{static get EDITOR_TYPE(){return"numeric"}};let PasswordEditor=class PasswordEditor extends l.H{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,h.cS)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}};let Y="ht_editor_visible",X="selectEditor";let SelectEditor=class SelectEditor extends N.Hf{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",(0,h.cn)(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(r){this.select.value=r}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";let r=this.hot.getShortcutManager();r.setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",(0,h.pv)(this.select,Y)&&(0,h.IV)(this.select,Y),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(r,n,o,l,d,y){let S;super.prepare(r,n,o,l,d,y);let b=this.cellProperties.selectOptions;S="function"==typeof b?this.prepareOptions(b(this.row,this.col,this.prop)):this.prepareOptions(b),(0,h.cS)(this.select),(0,w._l)(S,(r,n)=>{let o=this.hot.rootDocument.createElement("OPTION");o.value=n,(0,h.uS)(o,r),this.select.appendChild(o)})}prepareOptions(r){let n={};if(Array.isArray(r))for(let o=0,l=r.length;o<l;o++)n[r[o]]=r[o];else"object"==typeof r&&(n=r);return n}refreshValue(){let r=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){if(this.state!==N.ed.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:r,start:n,width:o,height:l}=this.getEditedCellRect(),d=this.select.style;d.height=`${l}px`,d.width=`${o}px`,d.top=`${r}px`,d[this.hot.isRtl()?"right":"left"]=`${n}px`,d.margin="0px",(0,h.cn)(this.select,Y)}registerShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("editor");this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{let r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],{group:X})}unregisterShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("editor");n.removeShortcutsByGroup(X)}};let TimeEditor=class TimeEditor extends l.H{static get EDITOR_TYPE(){return"time"}prepare(r,n,o,l,h,d){super.prepare(r,n,o,l,h,d),this.TEXTAREA.dir="ltr"}};var J=o(57416),Q=o(51774);function htmlRenderer(r,n,o,l,d,w,y){Q.Z.apply(this,[r,n,o,l,d,w,y]),(0,h.uS)(n,null==w?"":w,!1)}htmlRenderer.RENDERER_TYPE="html";var ee=o(49773);function autocompleteRenderer(r,n,o,l,d,w,y){let{rootDocument:S}=r,b=y.allowHtml?htmlRenderer:I.V,_=S.createElement("DIV"),R=r.getSettings().ariaTags;if(_.className="htAutocompleteArrow",R&&_.setAttribute(...(0,O.cV)()),_.appendChild(S.createTextNode(String.fromCharCode(9660))),b.apply(this,[r,n,o,l,d,w,y]),n.firstChild||n.appendChild(S.createTextNode(String.fromCharCode(160))),n.insertBefore(_,n.firstChild),(0,h.cn)(n,"htAutocomplete"),!r.acArrowListener){let d=new ee.Z(r);r.acArrowListener=function(d){(0,h.pv)(d.target,"htAutocompleteArrow")&&r.view._wt.getSetting("onCellDblClick",null,r._createCellCoords(o,l),n)},d.addEventListener(r.rootElement,"mousedown",r.acArrowListener),r.addHookOnce("afterDestroy",()=>{d.destroy()})}}function dropdownRenderer(r,n,o,l,h,d,w){autocompleteRenderer.apply(this,[r,n,o,l,h,d,w])}autocompleteRenderer.RENDERER_TYPE="autocomplete",dropdownRenderer.RENDERER_TYPE="dropdown";var et=o(52855);let ei=new WeakMap,er=new WeakMap,en="data-row",es="data-col",eo="checkbox";function checkboxRenderer(r,n,o,l,d,w,S){let{rootDocument:b}=r,R=r.getSettings().ariaTags;Q.Z.apply(this,[r,n,o,l,d,w,S]),function(r){let n=er.get(r);if(!n){let{rootElement:o}=r;(n=new ee.Z(r)).addEventListener(o,"click",n=>(function(r,n){let{target:o}=r;if(!isCheckboxInput(o)||!o.hasAttribute(en)||!o.hasAttribute(es))return;let l=parseInt(o.getAttribute(en),10),h=parseInt(o.getAttribute(es),10),d=n.getCellMeta(l,h);d.readOnly&&r.preventDefault()})(n,r)),n.addEventListener(o,"mouseup",n=>(function(r,n){let{target:o}=r;isCheckboxInput(o)&&o.hasAttribute(en)&&o.hasAttribute(es)&&setTimeout(n.listen,10)})(n,r)),n.addEventListener(o,"change",n=>(function(r,n){let{target:o}=r;if(!isCheckboxInput(o)||!o.hasAttribute(en)||!o.hasAttribute(es))return;let l=parseInt(o.getAttribute(en),10),h=parseInt(o.getAttribute(es),10),d=n.getCellMeta(l,h);if(!d.readOnly){let o=null;o=r.target.checked?void 0===d.uncheckedTemplate||d.checkedTemplate:void 0!==d.uncheckedTemplate&&d.uncheckedTemplate,n.setDataAtCell(l,h,o)}})(n,r)),er.set(r,n)}}(r);let P=function(r){let n=r.createElement("input");return n.className="htCheckboxRendererInput",n.type="checkbox",n.setAttribute("tabindex","-1"),n.cloneNode(!1)}(b),T=S.label,I=!1;if(void 0===S.checkedTemplate&&(S.checkedTemplate=!0),void 0===S.uncheckedTemplate&&(S.uncheckedTemplate=!1),(0,h.cS)(n),w===S.checkedTemplate||(0,_.Pz)(w).toLocaleLowerCase(S.locale)===(0,_.Pz)(S.checkedTemplate).toLocaleLowerCase(S.locale)?P.checked=!0:w===S.uncheckedTemplate||(0,_.Pz)(w).toLocaleLowerCase(S.locale)===(0,_.Pz)(S.uncheckedTemplate).toLocaleLowerCase(S.locale)?P.checked=!1:(0,_.xb)(w)?(0,h.cn)(P,"noValue"):(P.style.display="none",(0,h.cn)(P,"htBadValue"),I=!0),(0,h.P$)(P,[[en,o],[es,l]]),R&&(0,h.P$)(P,[(0,O.QK)(P.checked?r.getTranslatedPhrase(et.CHECKBOX_CHECKED):r.getTranslatedPhrase(et.CHECKBOX_UNCHECKED)),(0,O.Pn)(P.checked),(0,O.wt)()]),!I&&T){let h="";if(T.value)h="function"==typeof T.value?T.value.call(this,o,l,d,w):T.value;else if(T.property){let n=r.getDataAtRowProp(o,T.property);h=null!==n?n:""}let y=function(r,n,o){let l=r.createElement("label");return l.className=`htCheckboxRendererLabel ${o?"fullWidth":""}`,l.appendChild(r.createTextNode(n)),l.cloneNode(!0)}(b,h,!0!==T.separated);"before"===T.position?T.separated?(n.appendChild(y),n.appendChild(P)):(y.appendChild(P),P=y):T.position&&"after"!==T.position||(T.separated?(n.appendChild(P),n.appendChild(y)):(y.insertBefore(P,y.firstChild),P=y))}function changeSelectedCheckboxesState(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=r.getSelectedRange(),l=[],h=new Map,d=[],w=0;if(o){for(let y=0;y<o.length;y++){let{row:S,col:b}=o[y].getTopStartCorner(),{row:_,col:R}=o[y].getBottomEndCorner();for(let o=S;o<=_;o+=1)for(let y=b;y<=R;y+=1){let S=r.getCellMeta(o,y),b={checkedTemplate:S.checkedTemplate,uncheckedTemplate:S.uncheckedTemplate};if("checkbox"!==S.type){!0!==n||S.readOnly||(h.has(l.length)?h.set(l.length,[...h.get(l.length),[o,y,null]]):h.set(l.length,[[o,y,null]]));continue}if(!0===S.readOnly)continue;void 0===S.checkedTemplate&&(S.checkedTemplate=!0),void 0===S.uncheckedTemplate&&(S.uncheckedTemplate=!1);let _=r.getDataAtCell(o,y);!1===n?[S.checkedTemplate,S.checkedTemplate.toString()].includes(_)?d.push([o,y,S.uncheckedTemplate,b]):[S.uncheckedTemplate,S.uncheckedTemplate.toString(),null,void 0].includes(_)&&d.push([o,y,S.checkedTemplate,b]):d.push([o,y,S.uncheckedTemplate,b]),w+=1}l.push(w),w=0}(d=d.every(r=>{let[,,n]=r;return n===d[0][2]})?d.map(r=>{let[n,o,l]=r;return[n,o,l]}):d.map(r=>{let[n,o,,l]=r;return[n,o,l.checkedTemplate]})).length>0&&l.forEach((n,o)=>{let l=d.splice(0,n);h.size&&h.has(o)&&(l=[...l,...h.get(o)]),r.setDataAtCell(l)})}}function areSelectedCheckboxCells(){let n=r.getSelectedRange();if(n){for(let o=0;o<n.length;o++){let l=n[o].getTopStartCorner(),h=n[o].getBottomEndCorner();for(let n=l.row;n<=h.row;n++)for(let o=l.col;o<=h.col;o++){let l=r.getCellMeta(n,o),h=r.getCell(n,o);if(null==h)return!0;{let r=h.querySelectorAll("input[type=checkbox]");if(r.length>0&&!l.readOnly)return!0}}}return!1}}T&&(!T||T.separated)||n.appendChild(P),I&&n.appendChild(b.createTextNode("#bad-value#")),ei.has(r)||(ei.set(r,!0),function(){let n=r.getShortcutManager(),o=n.getContext("grid"),l={group:"checkboxRenderer",relativeToGroup:y.I,position:"before"};o.addShortcuts([{keys:[["space"]],callback:()=>(changeSelectedCheckboxesState(),!areSelectedCheckboxCells()),runOnlyIf:()=>{var n;return null===(n=r.getSelectedRangeLast())||void 0===n?void 0:n.highlight.isCell()}},{keys:[["enter"]],callback:()=>(changeSelectedCheckboxesState(),!areSelectedCheckboxCells()),runOnlyIf:()=>{let n=r.getSelectedRangeLast();return r.getSettings().enterBeginsEditing&&(null==n?void 0:n.isSingle())&&n.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(changeSelectedCheckboxesState(!0),!areSelectedCheckboxCells()),runOnlyIf:()=>{var n;return null===(n=r.getSelectedRangeLast())||void 0===n?void 0:n.highlight.isCell()}}],l)}())}function isCheckboxInput(r){return"INPUT"===r.tagName&&"checkbox"===r.getAttribute("type")}function handsontableRenderer(r,n,o,l,h,d,w){autocompleteRenderer.apply(this,[r,n,o,l,h,d,w])}K.Z.getSingleton().add("modifyAutoColumnSizeSeed",function(r,n,o){let{label:l,type:h,row:d,column:w,prop:y}=n;if(h===eo){if(l){let{value:n,property:h}=l,S=o;if(n)S="function"==typeof n?n(d,w,y,o):n;else if(h){let r=this.getDataAtRowProp(d,h);S=null!==r?r:o}r=S}return r}}),checkboxRenderer.RENDERER_TYPE=eo,handsontableRenderer.RENDERER_TYPE="handsontable";var el=o(84695),ea=o(67790);function getRenderedValue(r,n){if((0,ea.kE)(r)){let o=n.numericFormat,l=o&&o.culture||"-",h=o&&o.pattern;if(void 0!==l&&!el.languages()[l]){let r=l.replace("-",""),n=el.allLanguages?el.allLanguages[l]:el[r];n&&el.registerLanguage(n)}el.setLanguage(l),r=el(r).format(h||"0")}return r}function numericRenderer(r,n,o,l,h,d,w){let y=d;if((0,ea.kE)(y)){let r=w.className||"",o=r.length?r.split(" "):[];y=getRenderedValue(y,w),0>o.indexOf("htLeft")&&0>o.indexOf("htCenter")&&0>o.indexOf("htRight")&&0>o.indexOf("htJustify")&&o.push("htRight"),0>o.indexOf("htNumeric")&&o.push("htNumeric"),w.className=o.join(" "),n.dir="ltr"}(0,I.V)(r,n,o,l,h,y,w)}function passwordRenderer(r,n,o,l,d,w,y){I.V.apply(this,[r,n,o,l,d,w,y]);let S=y.hashLength||n.innerHTML.length,b=y.hashSymbol||"*",_="";(0,ea.q4)(S-1,()=>{_+=b}),(0,h.uS)(n,_)}function selectRenderer(r,n,o,l,h,d,w){I.V.apply(this,[r,n,o,l,h,d,w])}function timeRenderer(r,n,o,l,h,d,w){I.V.apply(this,[r,n,o,l,h,d,w]),n.dir="ltr"}numericRenderer.RENDERER_TYPE="numeric",passwordRenderer.RENDERER_TYPE="password",selectRenderer.RENDERER_TYPE="select",timeRenderer.RENDERER_TYPE="time";var eh=o(36903);function autocompleteValidator(r,n){let o=r;if(null==o&&(o=""),this.allowEmpty&&""===o){n(!0);return}this.strict&&this.source?"function"==typeof this.source?this.source(o,process(o,n)):process(o,n)(this.source):n(!0)}function process(r,n){return function(o){let l=!1;for(let n=0,h=o.length;n<h;n++)if(r===o[n]){l=!0;break}n(l)}}function dateValidator(r,n){let o=(0,J.Jq)(U,this.instance),l=r,h=!0;null==l&&(l="");let d=L(l,this.dateFormat||o.defaultDateFormat,!0).isValid(),w=L(new Date(l)).isValid()||d;if(this.allowEmpty&&""===l&&(w=!0,d=!0),w||(h=!1),!w&&d&&(h=!0),w&&!d){if(!0===this.correctFormat){let r=function(r,n){let o=L(function(r){let n=new Date(r);return isNaN(new Date(`${r}T00:00`).getDate())?n:new Date(n.getTime()+6e4*n.getTimezoneOffset())}(r)),l=L(r,n),h=r.search(/[A-z]/g)>-1;return(o.isValid()&&o.format("x")===l.format("x")||!l.isValid()||h?o:l).format(n)}(l,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,r,"dateValidator"),h=!0}else h=!1}n(h)}function dropdownValidator(r,n){autocompleteValidator.apply(this,[r,n])}function numericValidator(r,n){let o=r;null==o&&(o=""),n(!!this.allowEmpty&&""===o||""!==o&&(0,ea.kE)(r))}autocompleteValidator.VALIDATOR_TYPE="autocomplete",dateValidator.VALIDATOR_TYPE="date",dropdownValidator.VALIDATOR_TYPE="dropdown",numericValidator.VALIDATOR_TYPE="numeric";let ed=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function timeValidator(r,n){let o=this.timeFormat||"h:mm:ss a",l=!0,h=r;null===h&&(h=""),h=/^\d{3,}$/.test(h)?parseInt(h,10):h;let d=/^\d{1,2}$/.test(h);d&&(h+=":00");let w=L(h,ed,!0).isValid()?L(h):L(h,o),y=w.isValid(),S=L(h,o,!0).isValid()&&!d;if(this.allowEmpty&&""===h&&(y=!0,S=!0),y||(l=!1),!y&&S&&(l=!0),y&&!S){if(!0===this.correctFormat){let r=w.format(o);this.instance.setDataAtCell(this.visualRow,this.visualCol,r,"timeValidator"),l=!0}else l=!1}n(l)}timeValidator.VALIDATOR_TYPE="time";var ec=o(92740);let eu={CELL_TYPE:"autocomplete",editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},eg={CELL_TYPE:"checkbox",editor:CheckboxEditor,renderer:checkboxRenderer};function dateRenderer(r,n,o,l,h,d,w){autocompleteRenderer.apply(this,[r,n,o,l,h,d,w])}dateRenderer.RENDERER_TYPE="date";let ef={CELL_TYPE:"date",editor:DateEditor,renderer:dateRenderer,validator:dateValidator},em={CELL_TYPE:"dropdown",editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator},ep={CELL_TYPE:"handsontable",editor:HandsontableEditor,renderer:handsontableRenderer},ev={CELL_TYPE:"numeric",editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},eC={CELL_TYPE:"password",editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},ew={CELL_TYPE:"select",editor:SelectEditor,renderer:selectRenderer};var ey=o(1518);let eS={CELL_TYPE:"time",editor:TimeEditor,renderer:timeRenderer,validator:timeValidator};var eb=o(36324),e_=o(55915);function base_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function base_classPrivateFieldGet(r,n){return r.get(base_assertClassBrand(r,n))}function base_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let eR=new Map([["plugin",e_._j],["cell-type",eb.V1],["editor",J.Wu],["renderer",eh.Y3],["validator",ec.oh]]),eP=[],eE=null;var eT=new WeakMap,eM=new WeakSet;let BasePlugin=class BasePlugin{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(r){base_checkPrivateRedeclaration(this,eM),eM.add(this),base_defineProperty(this,"eventManager",new ee.Z(this)),base_defineProperty(this,"pluginName",null),base_defineProperty(this,"pluginsInitializedCallbacks",[]),base_defineProperty(this,"isPluginsReady",!1),base_defineProperty(this,"enabled",!1),base_defineProperty(this,"initialized",!1),base_checkPrivateRedeclaration(this,eT),eT.set(this,{}),(0,w.jW)(this,"hot",r,{writable:!1}),eE=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let r=this.constructor.PLUGIN_DEPS,n=Array.isArray(r)?r:[];if(n.length>0){let r=[];if(n.forEach(n=>{let[o,l]=n.split(":");if(!eR.has(o))throw Error(`Unknown plugin dependency type "${o}" was found.`);eR.get(o)(l)||r.push(` - ${l} (${o})`)}),r.length>0){let n=`The ${this.pluginName} plugin requires the following modules:
${r.join("\n")}
`;eP.push(n)}}eE||(eE=(0,e_.a9)()),eE.indexOf("UndoRedo")>=0&&eE.splice(eE.indexOf("UndoRedo"),1),eE.indexOf(this.pluginName)>=0&&eE.splice(eE.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()});let o=0===eE.length;if(o){if(eP.length>0){let r=`${eP.join("\n")}
You have to import and register them manually.`;throw Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var r;null===(r=this.eventManager)||void 0===r||r.clear(),this.clearHooks(),this.enabled=!1}addHook(r,n,o){base_classPrivateFieldGet(eT,this)[r]=base_classPrivateFieldGet(eT,this)[r]||[];let l=base_classPrivateFieldGet(eT,this)[r];this.hot.addHook(r,n,o),l.push(n),base_classPrivateFieldGet(eT,this)[r]=l}removeHooks(r){(0,b.Bk)(base_classPrivateFieldGet(eT,this)[r]||[],n=>{this.hot.removeHook(r,n)})}clearHooks(){let r=base_classPrivateFieldGet(eT,this);(0,w._l)(r,(r,n)=>this.removeHooks(n)),r.length=0}callOnPluginsReady(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}onAfterPluginsInitialized(){(0,b.Bk)(this.pluginsInitializedCallbacks,r=>r()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(r){let n=base_assertClassBrand(eM,this,_isRelevantToSettings).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}updatePlugin(){}destroy(){var r;null===(r=this.eventManager)||void 0===r||r.destroy(),this.clearHooks(),(0,w._l)(this,(r,n)=>{"hot"!==n&&(this[n]=null)}),delete this.t,delete this.hot}};function _isRelevantToSettings(r){if(!r)return!1;let n=this.constructor.SETTING_KEYS;if("boolean"==typeof n)return n;for(let o=0;o<n.length;o++)if(void 0!==r[n[o]])return!0;return!1}var eI=o(60973);function ghostTable_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var eO=class{constructor(r){ghostTable_defineProperty(this,"hot",null),ghostTable_defineProperty(this,"container",null),ghostTable_defineProperty(this,"injected",!1),ghostTable_defineProperty(this,"rows",[]),ghostTable_defineProperty(this,"columns",[]),ghostTable_defineProperty(this,"samples",null),ghostTable_defineProperty(this,"settings",{useHeaders:!0}),this.hot=r}addRow(r,n){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(r)),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}addColumnHeadersRow(r){let n=this.hot.getColHeader(0);if(null!=n){let n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(r,n){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(r)&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}getHeights(r){this.injected||this.injectTable(),(0,b.Bk)(this.rows,n=>{let{height:o}=n.table.getBoundingClientRect();r(n.row,Math.ceil(o)-1)})}getWidths(r){this.injected||this.injectTable(),(0,b.Bk)(this.columns,n=>{let{width:o}=n.table.getBoundingClientRect();r(n.col,Math.ceil(o))})}setSettings(r){this.settings=r}setSetting(r,n){this.settings||(this.settings={}),this.settings[r]=n}getSettings(){return this.settings}getSetting(r){return this.settings?this.settings[r]:null}createColGroupsCol(r){let n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(o=>{(0,b.Bk)(o.strings,o=>{n.appendChild(this.createColElement(o.col,r))})}),n}createRow(r){let{rootDocument:n}=this.hot,o=n.createDocumentFragment(),l=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,l),o.appendChild(l)),this.samples.forEach(l=>{(0,b.Bk)(l.strings,l=>{let h=l.col,d=this.hot.getCellMeta(r,h),w=this.hot.getCellRenderer(d),y=n.createElement("td");y.setAttribute("ghost-table",1),w(this.hot,y,r,h,this.hot.colToProp(h),l.value,d),o.appendChild(y)})}),o}appendColumnHeadersRow(){let{rootDocument:r}=this.hot,n=r.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){let l=r.createElement("th");o.push([-1,l]),n.appendChild(l)}this.samples.forEach(l=>{(0,b.Bk)(l.strings,l=>{let h=l.col,d=r.createElement("th");o.push([h,d]),n.appendChild(d)})}),this.table.tHead.appendChild(n),(0,b.Bk)(o,r=>{let[n,o]=r;this.hot.view.appendColHeader(n,o)})}createCol(r){let{rootDocument:n}=this.hot,o=n.createDocumentFragment();return this.samples.forEach(l=>{(0,b.Bk)(l.strings,l=>{let h=l.row,d=this.hot.getCellMeta(h,r),w=this.hot.getCellRenderer(d),y=n.createElement("td"),S=n.createElement("tr");y.setAttribute("ghost-table",1),w(this.hot,y,h,r,this.hot.colToProp(r),l.value,d),S.appendChild(y),o.appendChild(S)})}),o}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(r,n){let o=this.hot.rootDocument.createElement("col"),l=0;n>=0&&r>=0&&(l=this.hot.getCellMeta(n,r).colspan);let h=this.hot.getColWidth(r);if(l>1)for(let n=r+1;n<r+l;n++)h+=this.hot.getColWidth(n);return o.style.width=`${h}px`,o}createTable(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:n}=this.hot,o=n.createDocumentFragment(),l=n.createElement("table"),d=n.createElement("thead"),w=n.createElement("tbody"),y=n.createElement("colgroup"),S=n.createElement("tr"),b=n.createElement("th");return this.isVertical()&&l.appendChild(y),this.isHorizontal()&&(S.appendChild(b),d.appendChild(S),l.style.tableLayout="auto",l.style.width="auto"),l.appendChild(d),this.isVertical()&&w.appendChild(S),l.appendChild(w),(0,h.cn)(l,r),o.appendChild(l),{fragment:o,table:l,tHead:d,tBody:w,colGroup:y,tr:S,th:b}}createContainer(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:n}=this.hot,o=n.createDocumentFragment(),l=n.createElement("div"),d=`htGhostTable htAutoSize ${r.trim()}`;return(0,h.cn)(l,d),o.appendChild(l),{fragment:o,container:l}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function samplesGenerator_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let SamplesGenerator=class SamplesGenerator{static get SAMPLE_COUNT(){return 3}constructor(r){samplesGenerator_defineProperty(this,"samples",null),samplesGenerator_defineProperty(this,"dataFactory",null),samplesGenerator_defineProperty(this,"customSampleCount",null),samplesGenerator_defineProperty(this,"allowDuplicates",!1),this.dataFactory=r}getSampleCount(){return this.customSampleCount?this.customSampleCount:SamplesGenerator.SAMPLE_COUNT}setSampleCount(r){this.customSampleCount=r}setAllowDuplicates(r){this.allowDuplicates=r}generateRowSamples(r,n){return this.generateSamples("row",n,r)}generateColumnSamples(r,n){return this.generateSamples("col",n,r)}generateSamples(r,n,o){let l=new Map,{from:h,to:d}="number"==typeof o?{from:o,to:o}:o;return(0,ea.q4)(h,d,o=>{let h=this.generateSample(r,n,o);l.set(o,h)}),l}generateSample(r,n,o){if("row"!==r&&"col"!==r)throw Error("Unsupported sample type");let l=new Map,h="row"===r?"col":"row",d=[];return(0,ea.q4)(n.from,n.to,n=>{let y;let S="row"===r?this.dataFactory(o,n):this.dataFactory(n,o);if(!1===S)return;let{value:b,bundleSeed:R}=S,P="string"==typeof R&&R.length>0;y=P?R:(0,w.Kn)(b)?`${Object.keys(b).length}`:Array.isArray(b)?`${b.length}`:`${(0,_.Pz)(b).length}`,l.has(y)||l.set(y,{needed:this.getSampleCount(),strings:[]});let T=l.get(y);if(T.needed){let r=d.indexOf(b)>-1;(!r||this.allowDuplicates||P)&&(T.strings.push({value:b,[h]:n}),d.push(b),T.needed-=1)}}),l}};var ex=o(27431),eA=o(45843);function autoColumnSize_classPrivateFieldInitSpec(r,n,o){autoColumnSize_checkPrivateRedeclaration(r,n),n.set(r,o)}function autoColumnSize_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function autoColumnSize_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function autoColumnSize_classPrivateFieldGet(r,n){return r.get(autoColumnSize_assertClassBrand(r,n))}function _classPrivateFieldSet(r,n,o){return r.set(autoColumnSize_assertClassBrand(r,n),o),o}function autoColumnSize_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("modifyAutoColumnSizeSeed");let eF="autoColumnSize";var ek=new WeakMap,eH=new WeakMap,eN=new WeakSet;let AutoColumnSize=class AutoColumnSize extends BasePlugin{static get PLUGIN_KEY(){return eF}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(r){super(r),autoColumnSize_checkPrivateRedeclaration(this,eN),eN.add(this),autoColumnSize_defineProperty(this,"ghostTable",new eO(this.hot)),autoColumnSize_defineProperty(this,"samplesGenerator",new SamplesGenerator((r,n)=>{let o=this.hot.toPhysicalRow(r),l=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(l))return!1;let h=this.hot.getCellMeta(r,n),d="";h.spanned||(d=this.hot.getDataAtCell(r,n));let w="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(w=this.hot.runHooks("modifyAutoColumnSizeSeed",w,h,d)),{value:d,bundleSeed:w}})),autoColumnSize_defineProperty(this,"inProgress",!1),autoColumnSize_defineProperty(this,"measuredColumns",0),autoColumnSize_defineProperty(this,"columnWidthsMap",new eA.L),autoColumnSize_classPrivateFieldInitSpec(this,ek,[]),autoColumnSize_classPrivateFieldInitSpec(this,eH,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,o)=>autoColumnSize_assertClassBrand(eN,this,_onBeforeColumnResize).call(this,r,n,o))}isEnabled(){return!1!==this.hot.getSettings()[eF]&&!this.hot.getSettings().colWidths}enablePlugin(){var r=this;if(this.enabled)return;let n=this.hot.getSettings()[eF];n&&null!==n.useHeaders&&void 0!==n.useHeaders&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return autoColumnSize_assertClassBrand(eN,r,_onAfterLoadData).call(r,...o)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return autoColumnSize_assertClassBrand(eN,r,_onBeforeChange).call(r,...o)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return autoColumnSize_assertClassBrand(eN,r,_onAfterFormulasValuesUpdate).call(r,...o)}),this.addHook("beforeRender",()=>autoColumnSize_assertClassBrand(eN,this,_onBeforeRender).call(this)),this.addHook("modifyColWidth",(r,n)=>this.getColumnWidth(n,r)),this.addHook("init",()=>autoColumnSize_assertClassBrand(eN,this,_onInit).call(this)),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet(eH,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(r,n,o)=>autoColumnSize_assertClassBrand(eN,this,_onBeforeColumnResize).call(this,r,n,o))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;let r=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(-1===r||-1===n)return;let o=this.hot.renderCall;this.calculateColumnsWidth({from:r,to:n},void 0,o)}calculateColumnsWidth(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l="number"==typeof r?{from:r,to:r}:r,h="number"==typeof n?{from:n,to:n}:n;(0,ea.q4)(l.from,l.to,r=>{let n=this.hot.toPhysicalColumn(r);if(null===n&&(n=r),o||null===this.columnWidthsMap.getValueAtIndex(n)&&!this.hot._getColWidthFromSettings(n)){let n=this.samplesGenerator.generateColumnSamples(r,h);n.forEach((r,n)=>this.ghostTable.addColumn(n,r))}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,n)=>{let o=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(o,n)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=0,l=this.hot.countCols()-1,h=null;this.inProgress=!0;let loop=()=>{if(!this.hot){(0,eI.Wx)(h),this.inProgress=!1;return}this.calculateColumnsWidth({from:o,to:Math.min(o+AutoColumnSize.CALCULATION_STEP,l)},r,n),(o=o+AutoColumnSize.CALCULATION_STEP+1)<l?h=(0,eI.U7)(loop):((0,eI.Wx)(h),this.inProgress=!1,this.hot.view.adjustElementsSize())},d=this.getSyncCalculationLimit();d>=0&&(this.calculateColumnsWidth({from:0,to:d},r,n),o=d+1),o<l?loop():this.inProgress=!1}setSamplingOptions(){let r=this.hot.getSettings()[eF],n=r&&(0,w.nr)(r,"samplingRatio")?r.samplingRatio:void 0,o=r&&(0,w.nr)(r,"allowSampleDuplicates")?r.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){let r=this.hot.getSettings()[eF],n=AutoColumnSize.SYNC_CALCULATION_LIMIT,o=this.hot.countCols()-1;return(0,w.Kn)(r)&&(n=r.syncLimit,(0,R.wK)(n)?n=(0,ea.N1)(o,n):n>>=0),Math.min(n,o)}getColumnWidth(r,n){let o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=n;return void 0===l&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r)),o&&"number"==typeof l&&(l=Math.max(l,ex.$))),l}getFirstVisibleColumn(){var r;return null!==(r=this.hot.view.getFirstRenderedVisibleColumn())&&void 0!==r?r:-1}getLastVisibleColumn(){var r;return null!==(r=this.hot.view.getLastRenderedVisibleColumn())&&void 0!==r?r:-1}findColumnsWhereHeaderWasChanged(){let r=this.hot.getColHeader(),n=r.reduce((r,n,o)=>{let l=autoColumnSize_classPrivateFieldGet(ek,this).length;return(l-1<o||autoColumnSize_classPrivateFieldGet(ek,this)[o]!==n)&&r.push(this.hot.toVisualColumn(o)),l-1<o?autoColumnSize_classPrivateFieldGet(ek,this).push(n):autoColumnSize_classPrivateFieldGet(ek,this)[o]=n,r},[]);return n}clearCache(r){Array.isArray(r)?this.hot.batchExecution(()=>{r.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(r=>null===r).length}destroy(){this.ghostTable.clean(),super.destroy()}};function _calculateSpecificColumnsWidth(r){let n={from:0,to:this.hot.countRows()-1};r.forEach(r=>{let o=this.hot.toPhysicalColumn(r);if(null!==o&&!this.hot._getColWidthFromSettings(o)){let o=this.samplesGenerator.generateColumnSamples(r,n);o.forEach((r,n)=>this.ghostTable.addColumn(n,r))}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,n)=>{let o=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(o,n)})},!0),this.ghostTable.clean())}function _onBeforeRender(){this.calculateVisibleColumnsWidth(),this.inProgress||(autoColumnSize_assertClassBrand(eN,this,_calculateSpecificColumnsWidth).call(this,autoColumnSize_classPrivateFieldGet(eH,this)),_classPrivateFieldSet(eH,this,[]))}function _onAfterLoadData(r,n){n||this.recalculateAllColumnsWidth()}function _onBeforeChange(r){let n=r.reduce((r,n)=>{let[,o]=n,l=this.hot.propToCol(o);return Number.isInteger(l)&&-1===r.indexOf(l)&&r.push(l),r},[]);autoColumnSize_classPrivateFieldGet(eH,this).push(...n)}function _onBeforeColumnResize(r,n,o){let l=r;return o&&(this.calculateColumnsWidth(n,void 0,!0),l=this.getColumnWidth(n,void 0,!1)),l}function _onInit(){_classPrivateFieldSet(ek,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function _onAfterFormulasValuesUpdate(r){let n=r.reduce((r,n)=>{var o;let l=null===(o=n.address)||void 0===o?void 0:o.col;if(Number.isInteger(l)){let n=this.hot.toVisualColumn(l);-1===r.indexOf(n)&&r.push(n)}return r},[]);autoColumnSize_classPrivateFieldGet(eH,this).push(...n)}let eD={horizontal:"horizontal",vertical:"vertical"};function autofill_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function autofill_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("modifyAutofillRange"),K.Z.getSingleton().register("beforeAutofill"),K.Z.getSingleton().register("afterAutofill");let eB="autofill",eL=["fillHandle"];var eV=new WeakSet;let Autofill=class Autofill extends BasePlugin{constructor(){super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,eV),eV.add(this),autofill_defineProperty(this,"addingStarted",!1),autofill_defineProperty(this,"mouseDownOnCellCorner",!1),autofill_defineProperty(this,"mouseDragOutside",!1),autofill_defineProperty(this,"handleDraggedCells",0),autofill_defineProperty(this,"directions",[]),autofill_defineProperty(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return eB}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[eB,...eL]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",r=>autofill_assertClassBrand(eV,this,_onAfterCellCornerMouseDown).call(this,r)),this.addHook("afterOnCellCornerDblClick",r=>autofill_assertClassBrand(eV,this,_onCellCornerDblClick).call(this,r)),this.addHook("beforeOnCellMouseOver",(r,n)=>autofill_assertClassBrand(eV,this,_onBeforeCellMouseOver).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let r=this.hot.getSelectedRangeLast(),{row:n,col:o}=r.getTopStartCorner(),{row:l,col:h}=r.getBottomEndCorner(),d=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:o,endRow:l,endCol:h}]),w=[],y=[],S=[];return(0,b.Bk)(d,r=>{for(let n=r.startRow;n<=r.endRow;n+=1)-1===w.indexOf(n)&&w.push(n);for(let n=r.startCol;n<=r.endCol;n+=1)-1===y.indexOf(n)&&y.push(n)}),(0,b.Bk)(w,r=>{let n=[];(0,b.Bk)(y,o=>{n.push(this.hot.getCopyableData(r,o))}),S.push(n)}),S}fillIn(){var r;let n,o,l;if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[h,d,w,y]=this.hot.selection.highlight.getFill().getVisualCorners(),S=this.hot.getSelectedRangeLast(),b=S.getTopStartCorner(),_=S.getBottomEndCorner();this.resetSelectionOfDraggedArea();let R=[b.row,b.col,_.row,_.col],P=this.hot.runHooks("modifyAutofillRange",[Math.min(b.row,h),Math.min(b.col,d),Math.max(_.row,w),Math.max(_.col,y)],R),{directionOfDrag:T,startOfDragCoords:I,endOfDragCoords:O}=(r=(r,n)=>this.hot._createCellCoords(r,n),P[0]===R[0]&&P[1]<R[1]?(l="left",n=r(P[0],P[1]),o=r(P[2],R[1]-1)):P[2]===R[2]&&P[0]===R[0]&&P[3]>R[3]?(l="right",n=r(P[0],R[3]+1),o=r(P[2],P[3])):P[0]<R[0]&&P[1]===R[1]?(l="up",n=r(P[0],P[1]),o=r(R[0]-1,P[3])):P[2]>R[2]&&P[1]===R[1]&&(l="down",n=r(R[2]+1,P[1]),o=r(P[2],P[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:l,startOfDragCoords:n,endOfDragCoords:o});if(I&&I.row>-1&&I.col>-1){let r=this.getSelectionData(),n=S.clone(),o=this.hot._createCellRange(I,I,O),l=this.hot.runHooks("beforeAutofill",r,n,o,T);if(!1===l)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let h=l;if(["up","left"].indexOf(T)>-1&&!(1===l.length&&0===l[0].length)){if(h=[],"up"===T){let r=O.row-I.row+1,n=r%l.length;for(let o=0;o<r;o++)h.push(l[(o+(l.length-n))%l.length])}else{let r=O.col-I.col+1,n=r%l[0].length;for(let o=0;o<l.length;o++){h.push([]);for(let d=0;d<r;d++)h[o].push(l[o][(d+(l[o].length-n))%l[o].length])}}}this.hot.populateFromArray(I.row,I.col,h,O.row,O.col,`${this.pluginName}.fill`,null),this.setSelection(P),this.hot.runHooks("afterAutofill",h,n,o,T),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(r){return r.row<0&&(r.row=0),r.col<0&&(r.col=0),r}getCoordsOfDragAndDropBorders(r){let n=this.hot.getSelectedRangeLast(),o=n.getBottomEndCorner(),l=r;if(this.directions.includes(eD.vertical)&&this.directions.includes(eD.horizontal)){let h=n.getTopStartCorner();(o.col<=r.col||h.col>=r.col)&&(l=this.hot._createCellCoords(o.row,r.col)),(o.row<r.row||h.row>r.row)&&(l=this.hot._createCellCoords(r.row,o.col))}else if(this.directions.includes(eD.vertical))l=this.hot._createCellCoords(r.row,o.col);else{if(!this.directions.includes(eD.horizontal))return;l=this.hot._createCellCoords(o.row,r.col)}return this.reduceSelectionAreaIfNeeded(l)}showBorder(r){let n=this.getCoordsOfDragAndDropBorders(r);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){let r=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();r[2]<o-1&&n[2]===o-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(r){let n;let o=this.hot.getData(),l=this.hot.countRows();for(let h=r[2]+1;h<l;h++){for(let n=r[1];n<=r[3];n++){let r=o[h][n];if(!(0,_.xb)(r))return -1}let l=o[h][r[1]-1],d=o[h][r[3]+1];(0,_.xb)(l)&&(0,_.xb)(d)||(n=h)}return n}addSelectionFromStartAreaToSpecificRowIndex(r,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(r[0],r[1])).add(this.hot._createCellCoords(n,r[3])).commit()}setSelection(r){this.hot.selectCell(...(0,b.Sc)(r,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){let r=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(r);return -1!==n&&void 0!==n&&(this.addSelectionFromStartAreaToSpecificRowIndex(r,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(r){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(r).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(r){let{documentElement:n}=this.hot.rootDocument,o=(0,h.cv)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+(0,h.Pb)(this.hot.table),l=(0,h.cv)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+(0,h.iO)(this.hot.table);return r.clientY>o&&r.clientX<=l}registerEvents(){let{documentElement:r}=this.hot.rootDocument;this.eventManager.addEventListener(r,"mouseup",()=>autofill_assertClassBrand(eV,this,_onMouseUp).call(this)),this.eventManager.addEventListener(r,"mousemove",r=>autofill_assertClassBrand(eV,this,_onMouseMove).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let r=function(r){let n={};return!0===r?(n.directions=Object.keys(eD),n.autoInsertRow=!0):(0,w.Kn)(r)?((0,_.$K)(r.autoInsertRow)?r.direction===eD.horizontal?n.autoInsertRow=!1:n.autoInsertRow=r.autoInsertRow:n.autoInsertRow=!1,(0,_.$K)(r.direction)?n.directions=[r.direction]:n.directions=Object.keys(eD)):"string"==typeof r?(n.directions=[r],n.autoInsertRow=!0):(n.directions=[],n.autoInsertRow=!1),n}(this.hot.getSettings().fillHandle);this.directions=r.directions,this.autoInsertRow=r.autoInsertRow}destroy(){super.destroy()}};function _onCellCornerDblClick(){let r=this.selectAdjacent();r&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(r){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(r),this.addNewRowIfNeeded())}function _onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove(r){let n=this.getIfMouseWasDraggedOutside(r);!1===this.addingStarted&&this.handleDraggedCells>0&&n?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function autoRowSize_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function autoRowSize_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function autoRowSize_classPrivateFieldGet(r,n){return r.get(autoRowSize_assertClassBrand(r,n))}function autoRowSize_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let eG="autoRowSize";var eW=new WeakMap,ez=new WeakSet;let AutoRowSize=class AutoRowSize extends BasePlugin{static get PLUGIN_KEY(){return eG}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(r){super(r),autoRowSize_checkPrivateRedeclaration(this,ez),ez.add(this),autoRowSize_defineProperty(this,"headerHeight",null),autoRowSize_defineProperty(this,"ghostTable",new eO(this.hot)),autoRowSize_defineProperty(this,"samplesGenerator",new SamplesGenerator((r,n)=>{let o;let l=this.hot.toPhysicalRow(r),h=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(l)||this.hot.columnIndexMapper.isHidden(h))return!1;if(r>=0&&n>=0){let o=this.hot.getCellMeta(r,n);if(o.hidden)return!1}return r>=0?o=this.hot.getDataAtCell(r,n):-1===r&&(o=this.hot.getColHeader(n)),{value:o}})),autoRowSize_defineProperty(this,"inProgress",!1),autoRowSize_defineProperty(this,"measuredRows",0),autoRowSize_defineProperty(this,"rowHeightsMap",new eA.L),autoRowSize_checkPrivateRedeclaration(this,eW),eW.set(this,[]),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,o)=>autoRowSize_assertClassBrand(ez,this,_onBeforeRowResize).call(this,r,n,o))}isEnabled(){let r=this.hot.getSettings()[eG];return!0===r||(0,w.Kn)(r)}enablePlugin(){var r=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return autoRowSize_assertClassBrand(ez,r,autoRowSize_onAfterLoadData).call(r,...o)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return autoRowSize_assertClassBrand(ez,r,autoRowSize_onBeforeChange).call(r,...o)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return autoRowSize_assertClassBrand(ez,r,autoRowSize_onAfterFormulasValuesUpdate).call(r,...o)}),this.addHook("beforeRender",()=>autoRowSize_assertClassBrand(ez,this,autoRowSize_onBeforeRender).call(this)),this.addHook("modifyRowHeight",(r,n)=>this.getRowHeight(n,r)),this.addHook("init",()=>autoRowSize_assertClassBrand(ez,this,autoRowSize_onInit).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(r,n,o)=>autoRowSize_assertClassBrand(ez,this,_onBeforeRowResize).call(this,r,n,o))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;let r=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1===r||-1===n)return;let o=this.hot.renderCall;this.calculateRowsHeight({from:r,to:n},void 0,o)}calculateRowsHeight(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l="number"==typeof r?{from:r,to:r}:r,h="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){let r=this.samplesGenerator.generateRowSamples(-1,h);this.ghostTable.addColumnHeadersRow(r.get(-1))}(0,ea.q4)(l.from,l.to,r=>{let n=this.hot.toPhysicalRow(r);if(null===n&&(n=r),o||null===this.rowHeightsMap.getValueAtIndex(n)){let n=this.samplesGenerator.generateRowSamples(r,h);n.forEach((r,n)=>this.ghostTable.addRow(n,r))}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{r<0?this.headerHeight=n:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(r),n)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=0,l=this.hot.countRows()-1,h=null;this.inProgress=!0;let loop=()=>{if(!this.hot){(0,eI.Wx)(h),this.inProgress=!1;return}this.calculateRowsHeight({from:o,to:Math.min(o+AutoRowSize.CALCULATION_STEP,l)},r,n),(o=o+AutoRowSize.CALCULATION_STEP+1)<l?h=(0,eI.U7)(loop):((0,eI.Wx)(h),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},d=this.getSyncCalculationLimit();d>=0&&(this.calculateRowsHeight({from:0,to:d},r,n),o=d+1),o<l?loop():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){let r=this.hot.getSettings()[eG],n=r&&(0,w.nr)(r,"samplingRatio")?r.samplingRatio:void 0,o=r&&(0,w.nr)(r,"allowSampleDuplicates")?r.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){let r=this.hot.getSettings()[eG],n=AutoRowSize.SYNC_CALCULATION_LIMIT,o=this.hot.countRows()-1;return(0,w.Kn)(r)&&(n=r.syncLimit,(0,R.wK)(n)?n=(0,ea.N1)(o,n):n>>=0),Math.min(n,o)}getRowHeight(r,n){let o=r<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(r)),l=n;return null!==o&&o>(n||0)&&(l=o),l}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var r;return null!==(r=this.hot.view.getFirstRenderedVisibleRow())&&void 0!==r?r:-1}getLastVisibleRow(){var r;return null!==(r=this.hot.view.getLastRenderedVisibleRow())&&void 0!==r?r:-1}clearCache(r){this.headerHeight=null,Array.isArray(r)?this.hot.batchExecution(()=>{r.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(r){let{from:n,to:o}="number"==typeof r?{from:r,to:r}:r;this.hot.batchExecution(()=>{(0,ea.q4)(Math.min(n,o),Math.max(n,o),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(r=>null===r).length}destroy(){this.ghostTable.clean(),super.destroy()}};function _calculateSpecificRowsHeight(r){let n={from:0,to:this.hot.countCols()-1};r.forEach(r=>{let o=this.samplesGenerator.generateRowSamples(r,n);o.forEach((r,n)=>this.ghostTable.addRow(n,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{let o=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(o,n)})},!0),this.ghostTable.clean())}function autoRowSize_onBeforeRender(){this.calculateVisibleRowsHeight(),!this.inProgress&&(autoRowSize_assertClassBrand(ez,this,_calculateSpecificRowsHeight).call(this,autoRowSize_classPrivateFieldGet(eW,this)),eW.set(autoRowSize_assertClassBrand(eW,this),[]))}function _onBeforeRowResize(r,n,o){let l=r;return o&&(this.calculateRowsHeight(n,void 0,!0),l=this.getRowHeight(n)),l}function autoRowSize_onAfterLoadData(r,n){n||this.recalculateAllRowsHeight()}function autoRowSize_onBeforeChange(r){let n=r.reduce((r,n)=>{let[o]=n;return -1===r.indexOf(o)&&r.push(o),r},[]);autoRowSize_classPrivateFieldGet(eW,this).push(...n)}function autoRowSize_onInit(){this.recalculateAllRowsHeight()}function autoRowSize_onAfterFormulasValuesUpdate(r){let n=r.reduce((r,n)=>{var o;let l=null===(o=n.address)||void 0===o?void 0:o.row;if(Number.isInteger(l)){let n=this.hot.toVisualRow(l);-1===r.indexOf(n)&&r.push(n)}return r},[]);autoRowSize_classPrivateFieldGet(eW,this).push(...n)}var ej=o(97362),eU=o(5354);let e$=new Map([["indexesSequence",{getListWithInsertedItems:ej.S,getListWithRemovedItems:ej.t}],["physicallyIndexed",{getListWithInsertedItems:eU.S,getListWithRemovedItems:eU.t}]]),alterUtilsFactory=r=>{if(!1===e$.has(r))throw Error(`Alter strategy with ID '${r}' does not exist.`);return e$.get(r)};var eK=o(16301),eY=o(65724);let{getListWithInsertedItems:eX,getListWithRemovedItems:eq}=alterUtilsFactory("physicallyIndexed");let LooseBindsMap=class LooseBindsMap extends eK.n{constructor(){super(r=>r)}insert(r,n){let o=(0,eY.X)(this.indexedValues,n);this.indexedValues=eX(o,r,n,this.initValueOrFn),super.insert(r,n)}remove(r){let n=eq(this.indexedValues,r);this.indexedValues=(0,eY.i)(n,r),super.remove(r)}};let{getListWithInsertedItems:eZ,getListWithRemovedItems:eJ}=alterUtilsFactory("physicallyIndexed");let StrictBindsMap=class StrictBindsMap extends eK.n{constructor(){super(r=>r)}insert(r,n){this.indexedValues=eZ(this.indexedValues,r,n,(r,n)=>this.getNextValue(n)),super.insert(r,n)}remove(r){this.indexedValues=eJ(this.indexedValues,r),super.remove(r)}getNextValue(r){return Math.max(...this.getValues())+1+r}};let eQ="bindRowsWithHeaders",e0=new Map([["loose",LooseBindsMap],["strict",StrictBindsMap]]);var e1=new WeakSet;let BindRowsWithHeaders=class BindRowsWithHeaders extends BasePlugin{constructor(){var r,n;super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,e1),e1.add(this),(r="symbol"==typeof(n=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="headerIndexes","string"))?n:n+"")in this?Object.defineProperty(this,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[r]=null}static get PLUGIN_KEY(){return eQ}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[eQ]}enablePlugin(){if(this.enabled)return;let r=this.hot.getSettings()[eQ];"string"!=typeof r&&(r="loose");let n=e0.get(r);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>(function(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")})(e1,this,_onModifyRowHeader).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}};function _onModifyRowHeader(r){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(r))}var e2=o(24748);function collapsibleColumns_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function collapsibleColumns_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function collapsibleColumns_classPrivateFieldSet(r,n,o){return r.set(collapsibleColumns_assertClassBrand(r,n),o),o}function collapsibleColumns_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let e5="collapsibleColumns",e4=["nestedHeaders"],e3="collapsibleIndicator",e8=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var e9=new WeakMap,e7=new WeakSet;let CollapsibleColumns=class CollapsibleColumns extends BasePlugin{constructor(){super(...arguments),collapsibleColumns_checkPrivateRedeclaration(this,e7),e7.add(this),collapsibleColumns_defineProperty(this,"nestedHeadersPlugin",null),collapsibleColumns_defineProperty(this,"headerStateManager",null),collapsibleColumns_checkPrivateRedeclaration(this,e9),e9.set(this,null)}static get PLUGIN_KEY(){return e5}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[e5,...e4]}isEnabled(){return!!this.hot.getSettings()[e5]}enablePlugin(){var r=this;if(this.enabled)return;let{nestedHeaders:n}=this.hot.getSettings();n||(0,e2.ZK)("You need to configure the Nested Headers plugin in order to use collapsible headers."),collapsibleColumns_classPrivateFieldSet(e9,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>collapsibleColumns_assertClassBrand(e7,this,collapsibleColumns_onInit).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return collapsibleColumns_assertClassBrand(e7,r,collapsibleColumns_onAfterLoadData).call(r,...o)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return collapsibleColumns_assertClassBrand(e7,r,_onAfterGetColHeader).call(r,...o)}),this.addHook("beforeOnCellMouseDown",(r,n,o)=>collapsibleColumns_assertClassBrand(e7,this,_onBeforeOnCellMouseDown).call(this,r,n,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:r}=this.hot.getSettings();"boolean"==typeof r?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(r)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(r))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),collapsibleColumns_classPrivateFieldSet(e9,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var r;let{row:n,col:o}=this.hot.getSelectedRangeLast().highlight,{collapsible:l,isCollapsed:h,columnIndex:d}=null!==(r=this.headerStateManager.getHeaderTreeNodeData(n,o))&&void 0!==r?r:{};if(l)return h?this.expandSection({row:n,col:d}):this.collapseSection({row:n,col:d}),!1},runOnlyIf:()=>{var r,n;return(null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.isSingle())&&(null===(n=this.hot.getSelectedRangeLast())||void 0===n?void 0:n.highlight.isHeader())},group:e5,relativeToGroup:y.I,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(e5)}clearButtons(){if(!this.hot.view)return;let r=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,removeButton=function(r){r&&r.parentNode.removeChild(r)};(0,ea.q4)(0,r-1,r=>{let h=n.childNodes[r],d=o.childNodes[r],w=l?l.childNodes[r]:null;(0,ea.q4)(0,h.childNodes.length-1,r=>{let n=h.childNodes[r].querySelector(`.${e3}`);removeButton(n),d&&d.childNodes[r]&&removeButton(n=d.childNodes[r].querySelector(`.${e3}`)),l&&w&&w.childNodes[r]&&removeButton(n=w.childNodes[r].querySelector(`.${e3}`))})},!0)}expandSection(r){this.toggleCollapsibleSection([r],"expand")}collapseSection(r){this.toggleCollapsibleSection([r],"collapse")}toggleAllCollapsibleSections(r){let n=this.headerStateManager.mapNodes(n=>{let{collapsible:o,origColspan:l,headerLevel:h,columnIndex:d,isCollapsed:w}=n;if(!0===o&&l>1&&(w&&"expand"===r||!w&&"collapse"===r))return{row:this.headerStateManager.levelToRowCoords(h),col:d}});this.toggleCollapsibleSection(n,r)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(r,n){if(!e8.has(n))throw Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(r))return;let o=(0,b.w7)(r,r=>{let{row:n}=r;return n<0}),l=o.length>0;(0,b.Bk)(o,r=>{var o;let{row:h,col:d}=r,{collapsible:w,isCollapsed:y}=null!==(o=this.headerStateManager.getHeaderSettings(h,d))&&void 0!==o?o:{};if(!w||y&&"collapse"===n||!y&&"expand"===n)return l=!1,!1});let h=[],d=[];l&&(0,b.Bk)(o,r=>{let{row:o,col:l}=r,{colspanCompensation:w,affectedColumns:y,rollbackModification:S}=this.headerStateManager.triggerNodeModification(n,o,l);w>0&&(d.push(...y),h.push(S))});let w=this.getCollapsedColumns(),y=[];"collapse"===n?y=(0,b.uW)([...w,...d]):"expand"===n&&(y=(0,b.w7)(w,r=>!d.includes(r)));let S=e8.get(n),_=this.hot.runHooks(S.beforeHook,w,y,l);if(!1===_){(0,b.Bk)(h,r=>{r()});return}this.hot.batchExecution(()=>{(0,b.Bk)(d,r=>{e9.get(collapsibleColumns_assertClassBrand(e9,this)).setValueAtIndex(this.hot.toPhysicalColumn(r),S.hideColumn)})},!0);let R=this.getCollapsedColumns().length!==w.length,P=this.hot.getSelectedRangeLast();if("collapse"===n&&R&&P){let{row:r,col:n}=P.highlight,o=this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(n);if(o&&d.includes(n)){let o=r>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0):r,l=n>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1,!0):n;null!==o&&null!==l&&this.hot.selectCell(o,l)}}this.hot.runHooks(S.afterHook,w,y,l,R),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return e9.get(collapsibleColumns_assertClassBrand(e9,this)).getHiddenIndexes()}destroy(){collapsibleColumns_classPrivateFieldSet(e9,this,null),super.destroy()}};function _onAfterGetColHeader(r,n,o){var l,d;let{collapsible:w,origColspan:y,isCollapsed:S}=null!==(l=this.headerStateManager.getHeaderSettings(o,r))&&void 0!==l?l:{},b=w&&y>1&&r>=this.hot.getSettings().fixedColumnsStart,_=this.hot.getSettings().ariaTags,R=n.querySelector(`.${e3}`);(0,h.d$)(n,[(0,O.JV)("")[0]]),b?(R||(R=this.hot.rootDocument.createElement("div"),(0,h.cn)(R,e3),n.querySelector("div:first-child").appendChild(R)),(0,h.IV)(R,["collapsed","expanded"]),S?((0,h.cn)(R,"collapsed"),(0,h.tT)(R,"+"),_&&(0,h.P$)(n,...(0,O.JV)(!1))):((0,h.cn)(R,"expanded"),(0,h.tT)(R,"-"),_&&(0,h.P$)(n,...(0,O.JV)(!0))),_&&(0,h.P$)(R,...(0,O.cV)())):null===(d=R)||void 0===d||d.remove()}function _onBeforeOnCellMouseDown(r,n){(0,h.pv)(r.target,e3)&&((0,h.pv)(r.target,"expanded")?(this.eventManager.fireEvent(r.target,"mouseup"),this.toggleCollapsibleSection([n],"collapse")):(0,h.pv)(r.target,"collapsed")&&(this.eventManager.fireEvent(r.target,"mouseup"),this.toggleCollapsibleSection([n],"expand")),(0,d.mM)(r))}function collapsibleColumns_onInit(){this.updatePlugin()}function collapsibleColumns_onAfterLoadData(r,n){n||this.updatePlugin()}var e6=o(98179),te=o(42457),tt=o(537);function columnStatesManager_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let ti=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];let ColumnStatesManager=class ColumnStatesManager{constructor(r,n){columnStatesManager_defineProperty(this,"hot",void 0),columnStatesManager_defineProperty(this,"sortingStates",new tt.A),columnStatesManager_defineProperty(this,"sortEmptyCells",!1),columnStatesManager_defineProperty(this,"indicator",!0),columnStatesManager_defineProperty(this,"headerAction",!0),columnStatesManager_defineProperty(this,"compareFunctionFactory",void 0),columnStatesManager_defineProperty(this,"mapName",void 0),this.hot=r,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(r){(0,w.Kn)(r)&&(0,w._l)(r,(r,n)=>{ti.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){let r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(r.compareFunctionFactory=this.compareFunctionFactory),r}getSortOrderOfColumn(r){var n;return null===(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))||void 0===n?void 0:n.sortOrder}getIndexOfColumnInSortQueue(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(n=>{let[o]=n;return o===r})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(r){return(0,w.Kn)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}getSortStates(){if(null===this.sortingStates)return[];let r=this.sortingStates.getEntries();return r.map(r=>{let[n,o]=r;return{column:this.hot.toVisualColumn(n),...o}})}getColumnSortState(r){let n=this.getSortOrderOfColumn(r);if((0,_.$K)(n))return{column:r,sortOrder:n}}setSortStates(r){this.sortingStates.clear();for(let n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}};function compareFunctionFactory(r,n,o){let l=n.locale;return function(n,h){let{sortEmptyCells:d}=o;return("string"==typeof n&&(n=n.toLocaleLowerCase(l)),"string"==typeof h&&(h=h.toLocaleLowerCase(l)),n===h)?td:(0,_.xb)(n)?(0,_.xb)(h)?td:d&&"asc"===r?tc:tu:(0,_.xb)(h)?d&&"asc"===r?tu:tc:isNaN(n)&&!isNaN(h)?"asc"===r?tu:tc:!isNaN(n)&&isNaN(h)?"asc"===r?tc:tu:(isNaN(n)||isNaN(h)||(n=parseFloat(n),h=parseFloat(h)),n<h)?"asc"===r?tc:tu:n>h?"asc"===r?tu:tc:td}}o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);let tr="default";var tn=o(82656);let{register:ts,getItem:to,hasItem:tl}=(0,tn.Z)("sorting.compareFunctionFactory"),{register:ta,getItem:th}=(0,tn.Z)("sorting.mainSortComparator");function getCompareFunctionFactory(r){return tl(r)?to(r):to(tr)}ts("checkbox",function(r,n,o){let l=n.checkedTemplate,h=n.uncheckedTemplate,{sortEmptyCells:d}=o;return function(w,y){let S=(0,_.xb)(w),b=(0,_.xb)(y),R=S?h:w,P=b?h:y,T=R===h||R===l,I=P===h||P===l;if(!1===d){if(S&&!1===b)return tu;if(!1===S&&b)return tc}return!1===T&&I?"asc"===r?tc:tu:T&&!1===I?"asc"===r?tu:tc:!1===T&&!1===I?compareFunctionFactory(r,n,o)(w,y):R===h&&P===l?"asc"===r?tc:tu:R===l&&P===h?"asc"===r?tu:tc:td}}),ts("date",function(r,n,o){return createDateTimeCompareFunction(r,n.dateFormat,o)}),ts(tr,compareFunctionFactory),ts("numeric",function(r,n,o){return function(n,l){let h=parseFloat(n),d=parseFloat(l),{sortEmptyCells:w}=o;if(h===d||isNaN(h)&&isNaN(d))return td;if(w){if((0,_.xb)(n))return"asc"===r?tc:tu;if((0,_.xb)(l))return"asc"===r?tu:tc}return isNaN(h)?tu:isNaN(d)?tc:h<d?"asc"===r?tc:tu:h>d?"asc"===r?tu:tc:td}}),ts("time",function(r,n,o){return createDateTimeCompareFunction(r,n.timeFormat,o)});let td=0,tc=-1,tu=1,tg="desc",tf="colHeader";function getNextSortOrder(r){return r===tg?void 0:"asc"===r?tg:"asc"}function getHeaderSpanElement(r){let n=r.querySelector(`.${tf}`);return n}function isFirstLevelColumnHeader(r,n){if(r<0||!n.parentNode)return!1;let o=n.parentNode.parentNode.childNodes,l=Array.from(o).indexOf(n.parentNode)-o.length;return -1===l}function wasHeaderClickedProperly(r,n,o){return -1===r&&n>=0&&!1===(0,d.dO)(o)}function createDateTimeCompareFunction(r,n,o){return function(l,h){let{sortEmptyCells:d}=o;if(l===h)return td;if((0,_.xb)(l))return(0,_.xb)(h)?td:d&&"asc"===r?tc:tu;if((0,_.xb)(h))return d&&"asc"===r?tu:tc;let w=L(l,n),y=L(h,n);return w.isValid()?y.isValid()?y.isAfter(w)?"asc"===r?tc:tu:y.isBefore(w)?"asc"===r?tu:tc:td:tc:tu}}let tm="indicatorDisabled",tp="columnSorting",tv="sortAction",tC=new Map([["asc","ascending"],[tg,"descending"]]);function columnSorting_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function columnSorting_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let tw="columnSorting",ty="append";ta(tw,function(r,n){return function(o,l){let[,...h]=o,[,...d]=l;return function(o){let l=r[o],w=n[o],y=h[o],S=d[o],b=w.columnSorting,_=b.compareFunctionFactory?b.compareFunctionFactory:getCompareFunctionFactory(w.type),R=_(l,w,b)(y,S);return R}(0)}}),K.Z.getSingleton().register("beforeColumnSort"),K.Z.getSingleton().register("afterColumnSort");var tS=new WeakSet;let ColumnSorting=class ColumnSorting extends BasePlugin{constructor(){super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,tS),tS.add(this),columnSorting_defineProperty(this,"columnStatesManager",null),columnSorting_defineProperty(this,"columnMetaCache",null),columnSorting_defineProperty(this,"pluginKey",tw),columnSorting_defineProperty(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return tw}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var r=this;this.enabled||(this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new eA.L(r=>{let n=this.hot.toVisualColumn(r);return null===n&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>columnSorting_assertClassBrand(tS,this,columnSorting_onAfterGetColHeader).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return columnSorting_assertClassBrand(tS,r,columnSorting_onBeforeOnCellMouseDown).call(r,...o)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>columnSorting_assertClassBrand(tS,this,_loadOrSortBySettings).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return columnSorting_assertClassBrand(tS,r,columnSorting_onAfterLoadData).call(r,...o)}),this.hot.view&&columnSorting_assertClassBrand(tS,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){let clearColHeader=(r,n)=>{let o=getHeaderSpanElement(n);!1!==isFirstLevelColumnHeader(r,n)&&null!==o&&this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",clearColHeader),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",clearColHeader)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:r}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(r.col)),!1},runOnlyIf:()=>{var r,n;let o=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return o&&(null===(n=this.hot.getSelectedRangeLast())||void 0===n?void 0:n.isSingle())&&this.hot.selection.isCellVisible(o)&&-1===o.row&&o.col>=0},relativeToGroup:y.I,position:"before",group:tw})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tw)}sort(r){let n=this.getSortConfig(),o=this.getNormalizedSortConfigs(r),l=this.areValidSortConfigs(o),h=this.hot.runHooks("beforeColumnSort",n,o,l);!1!==h&&(0===n.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new te.b),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",n,l?o:n,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(r){return(0,_.$K)(r)?this.columnStatesManager.getColumnSortState(r):this.columnStatesManager.getSortStates()}setSortConfig(r){let n=this.getNormalizedSortConfigs(r);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(r)?r.slice(0,1):[r]}areValidSortConfigs(r){let n=this.hot.countCols();return function(r){if(r.some(r=>!1===function(r){if(!1===(0,w.Kn)(r))return!1;let{column:n,sortOrder:o}=r;return Number.isInteger(n)&&["asc",tg].includes(o)}(r)))return!1;let n=r.map(r=>{let{column:n}=r;return n});return new Set(n).size===n.length}(r)&&r.every(r=>{let{column:o}=r;return o<=n&&o>=0})}saveAllSortSettings(r){let n=this.columnStatesManager.getAllColumnsProperties();n.initialConfig=(0,b.Sc)(r,r=>{let{column:n,...o}=r;return{column:this.hot.toPhysicalColumn(n),...o}}),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){let r={};this.hot.runHooks("persistentStateLoad","columnSorting",r);let n=r.value;return(0,_.$K)(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=(0,b.Sc)(n.initialConfig,r=>{let{column:n,...o}=r;return{column:this.hot.toVisualColumn(n),...o}})),n}getColumnNextConfig(r){let n=this.columnStatesManager.getSortOrderOfColumn(r);if((0,_.$K)(n)){let o=getNextSortOrder(n);return(0,_.$K)(o)?{column:r,sortOrder:o}:void 0}let o=this.hot.countCols();if(Number.isInteger(r)&&r>=0&&r<o)return{column:r,sortOrder:getNextSortOrder()}}getNextSortConfig(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ty,o=this.columnStatesManager.getIndexOfColumnInSortQueue(r),l=-1!==o,h=this.getSortConfig(),d=this.getColumnNextConfig(r);if(l){if((0,_.o8)(d))return[...h.slice(0,o),...h.slice(o+1)];if(n===ty)return[...h.slice(0,o),...h.slice(o+1),d];if("replace"===n)return[...h.slice(0,o),d,...h.slice(o+1)]}return(0,_.$K)(d)?h.concat(d):h}getPluginColumnConfig(r){if((0,w.Kn)(r)){let n=r[this.pluginKey];if((0,w.Kn)(n))return n}return{}}getMergedPluginSettings(r){let n=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,r),h=Object.getPrototypeOf(l);return Array.isArray(h.columns)?Object.assign(o,n,this.getPluginColumnConfig(h.columns[r])):(0,e6.mf)(h.columns)?Object.assign(o,n,this.getPluginColumnConfig(h.columns(r))):Object.assign(o,n)}getFirstCellSettings(r){let n=this.hot.getCellMeta(0,r),o=Object.create(n);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(r)),o}getNumberOfRowsToSort(r){let n=this.hot.getSettings();return n.maxRows<=r?n.maxRows:r-n.minSpareRows}sortByPresetSortStates(r){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===r.length)return;let n=[],o=this.hot.countRows(),getDataForSortedColumns=n=>(0,b.Sc)(r,r=>this.hot.getDataAtCell(n,r.column));for(let r=0;r<this.getNumberOfRowsToSort(o);r+=1)n.push([this.hot.toPhysicalRow(r)].concat(getDataForSortedColumns(r)));let l=(0,b.Sc)(n,r=>r[0]);!function(r,n){let o=th(n);for(var l=arguments.length,h=Array(l>2?l-2:0),d=2;d<l;d++)h[d-2]=arguments[d];r.sort(o(...h))}(n,this.pluginKey,(0,b.Sc)(r,r=>r.sortOrder),(0,b.Sc)(r,r=>this.getFirstCellSettings(r.column)));for(let r=n.length;r<o;r+=1)n.push([r].concat(getDataForSortedColumns(r)));let h=(0,b.Sc)(n,r=>r[0]),d=new Map((0,b.Sc)(l,(r,n)=>[r,h[n]])),w=(0,b.Sc)(this.hot.rowIndexMapper.getIndexesSequence(),r=>d.has(r)?d.get(r):r);this.hot.rowIndexMapper.setIndexesSequence(w)}sortBySettings(r){if((0,w.Kn)(r)){this.columnStatesManager.updateAllColumnsProperties(r);let n=r.initialConfig;(Array.isArray(n)||(0,w.Kn)(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(r){if((0,h.IV)(r,Array.from(tC.values()).concat(tv,tm,tp)),!1!==this.enabled){for(var n=arguments.length,o=Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];(0,h.cn)(r,function(r,n,o,l){let h=[tp];if(l&&h.push(tv),!1===o)return h.push(tm),h;let d=r.getSortOrderOfColumn(n);return(0,_.$K)(d)&&h.push(tC.get(d)),h}(...o))}}onUpdateSettings(r){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,_.$K)(r[this.pluginKey])&&this.sortBySettings(r[this.pluginKey])}wasClickableHeaderClicked(r,n){let o=this.getFirstCellSettings(n)[this.pluginKey],l=o.headerAction;return l&&(0,h.pv)(r.target,tf)}onAfterOnCellMouseDown(r,n){if(!1!==wasHeaderClickedProperly(n.row,n.col,r)&&this.wasClickableHeaderClicked(r,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));let r=this.hot.getActiveEditor(),o=this.getColumnNextConfig(n.col);null!=r&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(o)}):this.sort(o)}}destroy(){var r;null===(r=this.columnStatesManager)||void 0===r||r.destroy(),super.destroy()}};function _loadOrSortBySettings(){let r=this.getAllSavedSortSettings();if((0,w.Kn)(r))this.sortBySettings(r);else{let r=this.hot.getSettings()[this.pluginKey];this.sortBySettings(r)}}function columnSorting_onAfterGetColHeader(r,n){let o=getHeaderSpanElement(n);if(!1===isFirstLevelColumnHeader(r,n)||null===o)return;let l=this.getFirstCellSettings(r)[this.pluginKey],d=l.indicator,w=l.headerAction;if(this.updateHeaderClasses(o,this.columnStatesManager,r,d,w),this.hot.getSettings().ariaTags){let o=this.columnStatesManager.getSortOrderOfColumn(r);(0,h.P$)(n,...(0,O.l_)(o?`${o}ending`:"none"))}}function columnSorting_onAfterLoadData(r){!0===r&&this.hot.view&&columnSorting_assertClassBrand(tS,this,_loadOrSortBySettings).call(this)}function columnSorting_onBeforeOnCellMouseDown(r,n,o,l){!1!==wasHeaderClickedProperly(n.row,n.col,r)&&this.wasClickableHeaderClicked(r,n.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}function endpoints_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var tb=class{constructor(r,n){endpoints_defineProperty(this,"plugin",void 0),endpoints_defineProperty(this,"hot",void 0),endpoints_defineProperty(this,"endpoints",[]),endpoints_defineProperty(this,"settings",void 0),endpoints_defineProperty(this,"settingsType","array"),endpoints_defineProperty(this,"currentEndpoint",null),endpoints_defineProperty(this,"cellsToSetCache",[]),this.plugin=r,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(r){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(r){return this.parseSettings(r.call(this))}parseSettings(r){let n=[],o=r;if(!o&&"function"==typeof this.settings){this.settingsType="function";return}return o||(o=this.settings),(0,b.Bk)(o,r=>{let o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(r,n,o,l){if("ranges"===o&&void 0===r[o]){n[o]=l;return}if("ranges"!==o||0!==r[o].length){if(void 0===r[o]){if(l instanceof Error)throw l;n[o]=l}else"destinationRow"===o&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}}resetSetupBeforeStructureAlteration(r,n,o){if("function"!==this.settingsType)return;let l=r.indexOf("row")>-1?"row":"col",h=this.getAllEndpoints();(0,b.Bk)(h,h=>{"row"===l&&h.destinationRow>=n&&("insert_row"===r?h.alterRowOffset=o:"remove_row"===r&&(h.alterRowOffset=-1*o)),"col"===l&&h.destinationColumn>=n&&("insert_col"===r?h.alterColumnOffset=o:"remove_col"===r&&(h.alterColumnOffset=-1*o))}),this.resetAllEndpoints(h,!1)}resetSetupAfterStructureAlteration(r,n,o,l,h){let d=!(arguments.length>5)||void 0===arguments[5]||arguments[5];if("function"===this.settingsType){let beforeViewRenderCallback=()=>(this.hot.removeHook("beforeViewRender",beforeViewRenderCallback),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",beforeViewRenderCallback);return}let w=r.indexOf("row")>-1?"row":"col",y=r.indexOf("remove")>-1?-1:1,S=this.getAllEndpoints(),_=0===r.indexOf("move_row");(0,b.Bk)(S,r=>{"row"===w&&r.destinationRow>=n&&(r.alterRowOffset=y*o),"col"===w&&r.destinationColumn>=n&&(r.alterColumnOffset=y*o)}),this.resetAllEndpoints(S,!_),_?(0,b.Bk)(S,r=>{this.extendEndpointRanges(r,n,l[0],l.length),this.recreatePhysicalRanges(r),this.clearOffsetInformation(r)}):(0,b.Bk)(S,r=>{this.shiftEndpointCoordinates(r,n)}),d&&this.refreshAllEndpoints()}clearOffsetInformation(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}extendEndpointRanges(r,n,o,l){(0,b.Bk)(r.ranges,r=>{r[1]&&(n>=r[0]&&n<=r[1]?o>r[1]?r[1]+=l:o<r[0]&&(r[0]-=l):o>=r[0]&&o<=r[1]&&(r[1]-=l,n<=r[0]&&(r[0]+=1,r[1]+=1)))})}recreatePhysicalRanges(r){let n=r.ranges,o=[],l=[];(0,b.Bk)(n,r=>{let n=[];if(r[1])for(let o=r[0];o<=r[1];o++)n.push(this.hot.toPhysicalRow(o));else n.push(this.hot.toPhysicalRow(r[0]));l.push(n)}),(0,b.Bk)(l,r=>{let n=[];(0,b.Bk)(r,(l,h)=>{0===h?n.push(l):r[h]!==r[h-1]+1&&(n.push(r[h-1]),o.push(n),(n=[]).push(l)),h===r.length-1&&(n.push(l),o.push(n))})}),r.ranges=o}shiftEndpointCoordinates(r,n){r.alterRowOffset&&0!==r.alterRowOffset?(r.destinationRow+=r.alterRowOffset||0,(0,b.Bk)(r.ranges,o=>{(0,b.Bk)(o,(l,h)=>{l>=n&&(o[h]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&0!==r.alterColumnOffset&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}resetAllEndpoints(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=r.some(r=>{let n=r.alterRowOffset||0,o=r.alterColumnOffset||0;return!!(r.destinationRow+n>=this.hot.countRows()||r.destinationColumn+o>=this.hot.countCols())});o||(this.cellsToSetCache=[],(0,b.Bk)(r,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,b.Bk)(this.getAllEndpoints(),r=>{this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(r){let n=[];this.cellsToSetCache=[],(0,b.Bk)(r,(r,o,l)=>{`${r[2]||""}`!=`${r[3]}`&&(0,b.Bk)(this.getAllEndpoints(),(r,h)=>{this.hot.propToCol(l[o][1])===r.sourceColumn&&-1===n.indexOf(h)&&n.push(h)})}),(0,b.Bk)(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(r=>{let n=this.hot.toVisualRow(r.destinationRow);if(null!==n){let o=this.hot.getCellMeta(n,r.destinationColumn);o.readOnly=r.readOnly,o.className="columnSummaryResult"}})}refreshEndpoint(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}resetEndpointValue(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=r.alterRowOffset||0,l=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?l:0)),""])}setEndpointValue(r,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let h=this.hot.toVisualRow(r.destinationRow);if(null!==h){let o=this.hot.getCellMeta(h,r.destinationColumn);("init"===n||o.readOnly!==r.readOnly)&&(o.readOnly=r.readOnly,o.className="columnSummaryResult")}if((!0===r.roundFloat||Number.isInteger(r.roundFloat))&&!isNaN(r.result)){let n=r.roundFloat,o=0;Number.isInteger(n)&&(o=Math.min(Math.max(0,n),100)),r.result=r.result.toFixed(o)}o?this.hot.setDataAtCell(l,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([l,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}throwOutOfBoundsWarning(){(0,e2.ZK)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},t_=o(32836);function isNullishOrNaN(r){return null==r||isNaN(r)}function columnSummary_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let tR="columnSummary";var tP=new WeakSet;let ColumnSummary=class ColumnSummary extends BasePlugin{constructor(){var r,n;super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,tP),tP.add(this),(r="symbol"==typeof(n=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="endpoints","string"))?n:n+"")in this?Object.defineProperty(this,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[r]=null}static get PLUGIN_KEY(){return tR}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[tR]}enablePlugin(){var r=this;this.enabled||(this.settings=this.hot.getSettings()[tR],this.endpoints=new tb(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return columnSummary_assertClassBrand(tP,r,_onAfterInit).call(r,...o)}),this.addHook("afterChange",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return columnSummary_assertClassBrand(tP,r,_onAfterChange).call(r,...o)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return columnSummary_assertClassBrand(tP,r,_onAfterUpdateSettings).call(r,...o)}),this.addHook("beforeCreateRow",(r,n,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,o)),this.addHook("beforeCreateCol",(r,n,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,o)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return r.endpoints.resetSetupBeforeStructureAlteration("remove_row",...o)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return r.endpoints.resetSetupBeforeStructureAlteration("remove_col",...o)}),this.addHook("afterCreateRow",(r,n,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,o)),this.addHook("afterCreateCol",(r,n,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,o)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return r.endpoints.resetSetupAfterStructureAlteration("remove_row",...o)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return r.endpoints.resetSetupAfterStructureAlteration("remove_col",...o)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return columnSummary_assertClassBrand(tP,r,_onAfterRowMove).call(r,...o)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(r){switch(r.type.toLowerCase()){case"sum":r.result=this.calculateSum(r);break;case"min":case"max":r.result=this.calculateMinMax(r,r.type);break;case"count":r.result=this.countEntries(r);break;case"average":r.result=this.calculateAverage(r);break;case"custom":r.result=r.customFunction.call(this,r)}}calculateSum(r){let n=0;return(0,w._l)(r.ranges,o=>{n+=this.getPartialSum(o,r.sourceColumn)}),n}getPartialSum(r,n){let o=0,l=r[1]||r[0],h=null,d=0;do{if(null!==(h=isNullishOrNaN(h=this.getCellValue(l,n))?null:h)){let r=(`${h}`.split(".")[1]||[]).length||1;r>d&&(d=r)}o+=h||0,l-=1}while(l>=r[0]);return Math.round(o*10**d)/10**d}calculateMinMax(r,n){let o=null;return(0,w._l)(r.ranges,l=>{let h=this.getPartialMinMax(l,r.sourceColumn,n);if(null===o&&null!==h&&(o=h),null!==h)switch(n){case"min":o=Math.min(o,h);break;case"max":o=Math.max(o,h)}}),null===o?"Not enough data":o}getPartialMinMax(r,n,o){let l,h=null,d=r[1]||r[0];do{if(l=isNullishOrNaN(l=this.getCellValue(d,n))?null:l,null===h)h=l;else if(null!==l)switch(o){case"min":h=Math.min(h,l);break;case"max":h=Math.max(h,l)}d-=1}while(d>=r[0]);return h}countEmpty(r,n){let o;let l=0,h=r[1]||r[0];do null===(o=isNullishOrNaN(o=this.getCellValue(h,n))?null:o)&&(l+=1),h-=1;while(h>=r[0]);return l}countEntries(r){let n=0,o=r.ranges;return(0,w._l)(o,o=>{let l=void 0===o[1]?1:o[1]-o[0]+1,h=this.countEmpty(o,r.sourceColumn);n+=l,n-=h}),n}calculateAverage(r){let n=this.calculateSum(r),o=this.countEntries(r);return n/o}getCellValue(r,n){let o=this.hot.toVisualRow(r),l=this.hot.toVisualColumn(n),h=this.hot.getSourceDataAtCell(r,n),d="";if(null!==o&&null!==l&&(d=this.hot.getCellMeta(o,l).className||""),d.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof h&&(h=h.replace(/,/,".")),h=parseFloat(h)),isNaN(h)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw Error(t_.e`ColumnSummary plugin: cell at (${r}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return h}};function _onAfterInit(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(r){void 0!==r.columns&&this.endpoints.refreshCellMetas()}function _onAfterChange(r,n){r&&"ColumnSummary.reset"!==n&&"ColumnSummary.set"!==n&&"loadData"!==n&&this.endpoints.refreshChangedEndpoints(r)}function _onAfterRowMove(r,n){this.endpoints.resetSetupBeforeStructureAlteration("move_row",r[0],r.length,r,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",n,r.length,r,this.pluginName)}var tE=o(63437);function editorResizeObserver_classPrivateFieldInitSpec(r,n,o){editorResizeObserver_checkPrivateRedeclaration(r,n),n.set(r,o)}function editorResizeObserver_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function editorResizeObserver_classPrivateFieldGet(r,n){return r.get(editorResizeObserver_assertClassBrand(r,n))}function editorResizeObserver_classPrivateFieldSet(r,n,o){return r.set(editorResizeObserver_assertClassBrand(r,n),o),o}function editorResizeObserver_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var tT=new WeakMap,tM=new WeakMap,tI=new WeakMap,tO=new WeakSet;let EditorResizeObserver=class EditorResizeObserver{constructor(){editorResizeObserver_checkPrivateRedeclaration(this,tO),tO.add(this),editorResizeObserver_classPrivateFieldInitSpec(this,tT,!0),editorResizeObserver_classPrivateFieldInitSpec(this,tM,null),editorResizeObserver_classPrivateFieldInitSpec(this,tI,new ResizeObserver(r=>editorResizeObserver_assertClassBrand(tO,this,_onResize).call(this,r)))}setObservedElement(r){editorResizeObserver_classPrivateFieldSet(tM,this,r)}unobserve(){editorResizeObserver_classPrivateFieldGet(tI,this).unobserve(editorResizeObserver_classPrivateFieldGet(tM,this))}observe(){editorResizeObserver_classPrivateFieldSet(tT,this,!0),editorResizeObserver_classPrivateFieldGet(tI,this).observe(editorResizeObserver_classPrivateFieldGet(tM,this))}destroy(){editorResizeObserver_classPrivateFieldGet(tI,this).disconnect()}};function _onResize(r){if(editorResizeObserver_classPrivateFieldGet(tT,this)||!Array.isArray(r)||!r.length){editorResizeObserver_classPrivateFieldSet(tT,this,!1);return}r.forEach(r=>{let{borderBoxSize:n}=r,{inlineSize:o,blockSize:l}=n[0];this.runLocalHooks("resize",o,l)})}function commentEditor_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function commentEditor_classPrivateFieldGet(r,n){return r.get(commentEditor_assertClassBrand(r,n))}function commentEditor_classPrivateFieldSet(r,n,o){return r.set(commentEditor_assertClassBrand(r,n),o),o}function commentEditor_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}(0,w.jB)(EditorResizeObserver,tE.Z);var tx=new WeakMap,tA=new WeakMap,tF=new WeakMap,tk=new WeakMap,tH=new WeakMap,tN=new WeakMap,tD=new WeakMap;let CommentEditor=class CommentEditor{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(r,n){var o=this;commentEditor_classPrivateFieldInitSpec(this,tx,void 0),commentEditor_classPrivateFieldInitSpec(this,tA,!1),commentEditor_classPrivateFieldInitSpec(this,tF,null),commentEditor_classPrivateFieldInitSpec(this,tk,void 0),commentEditor_classPrivateFieldInitSpec(this,tH,void 0),commentEditor_classPrivateFieldInitSpec(this,tN,!0),commentEditor_classPrivateFieldInitSpec(this,tD,new EditorResizeObserver),commentEditor_classPrivateFieldSet(tx,this,r),commentEditor_classPrivateFieldSet(tA,this,n),commentEditor_classPrivateFieldSet(tk,this,this.createEditor()),commentEditor_classPrivateFieldSet(tH,this,commentEditor_classPrivateFieldGet(tk,this).style),commentEditor_classPrivateFieldGet(tD,this).setObservedElement(this.getInputElement()),commentEditor_classPrivateFieldGet(tD,this).addLocalHook("resize",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("resize",...n)}),this.hide()}setPosition(r,n){commentEditor_classPrivateFieldGet(tH,this).left=`${r}px`,commentEditor_classPrivateFieldGet(tH,this).top=`${n}px`}setSize(r,n){if(r&&n){let o=this.getInputElement();o.style.width=`${r}px`,o.style.height=`${n}px`}}getSize(){return{width:(0,h.iO)(this.getInputElement()),height:(0,h.Pb)(this.getInputElement())}}observeSize(){commentEditor_classPrivateFieldGet(tD,this).observe()}resetSize(){let r=this.getInputElement();r.style.width="",r.style.height=""}setReadOnlyState(r){let n=this.getInputElement();n.readOnly=r}show(){commentEditor_classPrivateFieldGet(tH,this).display="block",commentEditor_classPrivateFieldSet(tN,this,!1)}hide(){commentEditor_classPrivateFieldGet(tD,this).unobserve(),commentEditor_classPrivateFieldGet(tN,this)||(commentEditor_classPrivateFieldGet(tH,this).display="none"),commentEditor_classPrivateFieldSet(tN,this,!0)}isVisible(){return"block"===commentEditor_classPrivateFieldGet(tH,this).display}setValue(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.getInputElement().value=r||""}getValue(){return this.getInputElement().value}isFocused(){return commentEditor_classPrivateFieldGet(tx,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let r=commentEditor_classPrivateFieldGet(tx,this).createElement("div"),n=commentEditor_classPrivateFieldGet(tx,this).createElement("textarea");return r.style.display="none",commentEditor_classPrivateFieldSet(tF,this,commentEditor_classPrivateFieldGet(tx,this).createElement("div")),commentEditor_classPrivateFieldGet(tF,this).setAttribute("dir",commentEditor_classPrivateFieldGet(tA,this)?"rtl":"ltr"),(0,h.cn)(commentEditor_classPrivateFieldGet(tF,this),CommentEditor.CLASS_EDITOR_CONTAINER),commentEditor_classPrivateFieldGet(tx,this).body.appendChild(commentEditor_classPrivateFieldGet(tF,this)),(0,h.cn)(r,CommentEditor.CLASS_EDITOR),(0,h.cn)(n,CommentEditor.CLASS_INPUT),n.setAttribute("data-hot-input",!0),r.appendChild(n),commentEditor_classPrivateFieldGet(tF,this).appendChild(r),r}getInputElement(){return commentEditor_classPrivateFieldGet(tk,this).querySelector(`.${CommentEditor.CLASS_INPUT}`)}destroy(){let r=commentEditor_classPrivateFieldGet(tF,this)?commentEditor_classPrivateFieldGet(tF,this).parentNode:null;commentEditor_classPrivateFieldGet(tk,this).parentNode.removeChild(commentEditor_classPrivateFieldGet(tk,this)),commentEditor_classPrivateFieldSet(tk,this,null),commentEditor_classPrivateFieldSet(tH,this,null),commentEditor_classPrivateFieldGet(tD,this).destroy(),r&&r.removeChild(commentEditor_classPrivateFieldGet(tF,this))}};function displaySwitch_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}(0,w.jB)(CommentEditor,tE.Z);let DisplaySwitch=class DisplaySwitch{constructor(r){displaySwitch_defineProperty(this,"wasLastActionShow",!0),displaySwitch_defineProperty(this,"showDebounced",null),displaySwitch_defineProperty(this,"hidingTimer",null),this.updateDelay(r)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(r){this.wasLastActionShow=!0,this.showDebounced(r)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,e6.Ds)(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},r)}destroy(){this.clearLocalHooks()}};(0,w.jB)(DisplaySwitch,tE.Z);let tB="---------";function getAlignmentClasses(r,n){let o={};return(0,b.Bk)(r,r=>{r.forAll((r,l)=>{r>=0&&l>=0&&(o[r]||(o[r]=[]),o[r][l]=n(r,l))})}),o}function align(r,n,o,l,h){(0,b.Bk)(r,r=>{r.forAll((r,d)=>{r>=0&&d>=0&&function(r,n,o,l,h,d){let w=h(r,n),y=l;w.className&&(y="vertical"===o?function(r,n){if(-1!==r.indexOf(n))return r;let o=r.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${o} ${n}`}(w.className,l):function(r,n){if(-1!==r.indexOf(n))return r;let o=r.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${o} ${n}`}(w.className,l)),d(r,n,"className",y)}(r,d,n,o,l,h)})})}function markLabelAsSelected(r){return`<span class="selected">${String.fromCharCode(10003)}</span>${r}`}function checkSelectionConsistency(r,n){let o=!1;return Array.isArray(r)&&(0,b.Bk)(r,r=>(r.forAll((r,l)=>{if(r>=0&&l>=0&&n(r,l))return o=!0,!1}),o)),o}function getDocumentOffsetByElement(r,n){let o={top:0,left:0};if(n!==r.ownerDocument){let{frameElement:r}=n.defaultView,{top:l,left:h}=r.getBoundingClientRect();o.top=l,o.left=h}return o}function hasSelectionAClass(r,n){return checkSelectionConsistency(r.getSelectedRange(),(function(r,o){let l=this.getCellMeta(r,o).className;return l&&-1!==l.indexOf(n)}).bind(r))}function comments_classPrivateFieldInitSpec(r,n,o){comments_checkPrivateRedeclaration(r,n),n.set(r,o)}function comments_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function comments_classPrivateFieldSet(r,n,o){return r.set(comments_assertClassBrand(r,n),o),o}function comments_classPrivateFieldGet(r,n){return r.get(comments_assertClassBrand(r,n))}function comments_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let tL="comments",tV="comment",tG="value",tW="style",tz="readOnly",tj=`plugin:${tL}`;var tU=new WeakMap,t$=new WeakMap,tK=new WeakMap,tY=new WeakMap,tX=new WeakMap,tq=new WeakMap,tZ=new WeakSet;let Comments=class Comments extends BasePlugin{constructor(){var r,n,o;super(...arguments),comments_checkPrivateRedeclaration(this,tZ),tZ.add(this),n={},(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="range","string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,comments_classPrivateFieldInitSpec(this,tU,null),comments_classPrivateFieldInitSpec(this,t$,null),comments_classPrivateFieldInitSpec(this,tK,!1),comments_classPrivateFieldInitSpec(this,tY,!1),comments_classPrivateFieldInitSpec(this,tX,null),comments_classPrivateFieldInitSpec(this,tq,"")}static get PLUGIN_KEY(){return tL}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[tL]}enablePlugin(){var r=this;this.enabled||(comments_classPrivateFieldGet(tU,this)||(comments_classPrivateFieldSet(tU,this,new CommentEditor(this.hot.rootDocument,this.hot.isRtl())),comments_classPrivateFieldGet(tU,this).addLocalHook("resize",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return comments_assertClassBrand(tZ,r,_onEditorResize).call(r,...o)})),comments_classPrivateFieldGet(t$,this)||comments_classPrivateFieldSet(t$,this,new DisplaySwitch(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,o,l,h,d)=>comments_assertClassBrand(tZ,this,_onAfterRenderer).call(this,r,d)),this.addHook("afterScroll",()=>comments_assertClassBrand(tZ,this,_onAfterScroll).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>comments_assertClassBrand(tZ,this,_onAfterDocumentKeyDown).call(this,r)),comments_classPrivateFieldGet(t$,this).addLocalHook("hide",()=>this.hide()),comments_classPrivateFieldGet(t$,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){comments_classPrivateFieldGet(t$,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("grid"),o=r.addContext(tj);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{let n=this.hot.getSelectedRangeLast();comments_classPrivateFieldSet(tY,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(n),this.show(),this.focusEditor(),r.setActiveContextName(tj),this.hot._registerTimeout(()=>{comments_classPrivateFieldSet(tY,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight.isCell())&&!comments_classPrivateFieldGet(tU,this).isVisible()},group:tL}),o.addShortcut({keys:[["Escape"]],callback:()=>{comments_classPrivateFieldGet(tU,this).setValue(comments_classPrivateFieldGet(tq,this)),this.hide(),r.setActiveContextName("grid")},runOnlyIf:()=>comments_classPrivateFieldGet(tU,this).isVisible()&&comments_classPrivateFieldGet(tU,this).isFocused(),group:tL}),o.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),r.setActiveContextName("grid")},runOnlyIf:()=>comments_classPrivateFieldGet(tU,this).isVisible()&&comments_classPrivateFieldGet(tU,this).isFocused(),group:tL})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tL)}registerListeners(){let{rootDocument:r}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(r,"mouseover",r=>comments_assertClassBrand(tZ,this,_onMouseOver).call(this,r)),this.eventManager.addEventListener(r,"mousedown",r=>comments_assertClassBrand(tZ,this,_onMouseDown).call(this,r)),this.eventManager.addEventListener(r,"mouseup",()=>comments_assertClassBrand(tZ,this,comments_onMouseUp).call(this)),this.eventManager.addEventListener(n,"focus",()=>comments_assertClassBrand(tZ,this,_onEditorFocus).call(this)),this.eventManager.addEventListener(n,"blur",()=>comments_assertClassBrand(tZ,this,_onEditorBlur).call(this))}setRange(r){this.range=r}clearRange(){this.range={}}targetIsCellWithComment(r){let n=(0,h.oq)(r.target,"TD","TBODY");return!!(n&&(0,h.pv)(n,"htCommentCell")&&(0,h.oq)(n,[this.hot.rootElement]))}targetIsCommentTextArea(r){return this.getEditorInputElement()===r.target}setComment(r){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let n=comments_classPrivateFieldGet(tU,this).getValue(),o="";null!=r?o=r:null!=n&&(o=n);let l=this.range.from.row,h=this.range.from.col;this.updateCommentMeta(l,h,{[tG]:o}),this.hot.render()}setCommentAtCell(r,n,o){this.setRange({from:this.hot._createCellCoords(r,n)}),this.setComment(o)}removeComment(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,tV),r&&this.hot.render(),this.hide()}removeCommentAtCell(r,n){let o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.setRange({from:this.hot._createCellCoords(r,n)}),this.removeComment(o)}getComment(){let r=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(r,n,tG)}getCommentAtCell(r,n){return this.getCommentMeta(r,n,tG)}show(){var r;if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:n,col:o}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;let l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return comments_classPrivateFieldGet(t$,this).cancelHiding(),comments_classPrivateFieldGet(tU,this).setValue(null!==(r=l[tV]?l[tV][tG]:null)&&void 0!==r?r:""),comments_classPrivateFieldGet(tU,this).show(),this.refreshEditor(!0),!0}showAtCell(r,n){return this.setRange({from:this.hot._createCellCoords(r,n)}),this.show()}hide(){comments_classPrivateFieldGet(tU,this).hide()}refreshEditor(){var r,n;let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!o&&(!this.range.from||!comments_classPrivateFieldGet(tU,this).isVisible()))return;let{rowIndexMapper:l,columnIndexMapper:d}=this.hot,{row:w,col:y}=this.range.from,S=l.getRenderableFromVisualIndex(w),b=d.getRenderableFromVisualIndex(y),_=null===S;comments_classPrivateFieldGet(tU,this).setPosition(0,0),null===S&&(S=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,-1))),null===b&&(b=d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,-1)));let R=null===S,P=null===b;S=null!==(r=S)&&void 0!==r?r:0,b=null!==(n=b)&&void 0!==n?n:0;let{rootWindow:T,view:{_wt:I}}=this.hot,{wtTable:O}=I,k=I.getCell({row:S,col:b},!0),N=this.getCommentMeta(w,y,tW);N?comments_classPrivateFieldGet(tU,this).setSize(N.width,N.height):comments_classPrivateFieldGet(tU,this).resetSize();let L=P?0:O.getStretchedColumnWidth(b),j=_&&!R?(0,h.Pb)(k):0,{left:U,top:$,width:K,height:Y}=k.getBoundingClientRect(),{width:X,height:J}=comments_classPrivateFieldGet(tU,this).getSize(),{innerWidth:Q,innerHeight:ee}=this.hot.rootWindow,et=this.hot.rootDocument.documentElement,ei=U+T.scrollX+L,er=$+T.scrollY+j;this.hot.isRtl()&&(ei-=X+L),this.hot.isLtr()&&U+K+X>Q?ei=U+T.scrollX-X-1:this.hot.isRtl()&&ei<-(et.scrollWidth-et.clientWidth)&&(ei=U+T.scrollX+L+1),$+J>ee&&(er-=J-Y+1),comments_classPrivateFieldGet(tU,this).setPosition(ei,er),comments_classPrivateFieldGet(tU,this).setReadOnlyState(this.getCommentMeta(w,y,tz)),comments_classPrivateFieldGet(tU,this).observeSize()}focusEditor(){comments_classPrivateFieldGet(tU,this).focus()}updateCommentMeta(r,n,o){let l;let h=this.hot.getCellMeta(r,n)[tV];h?(l=(0,w.I8)(h),(0,w.ZB)(l,o)):l=o,this.hot.setCellMeta(r,n,tV,l)}getCommentMeta(r,n,o){let l=this.hot.getCellMeta(r,n);if(l[tV])return l[tV][o]}addToContextMenu(r){var n,o,l;r.items.push({name:tB},(n=this,{key:"commentsAddEdit",name(){var r;let o=null===(r=this.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return null!=o&&o.isCell()&&n.getCommentAtCell(o.row,o.col)?this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){let r=this.getSelectedRangeLast();n.setRange(r),n.show(),n.focusEditor()},disabled(){let r=this.getSelectedRangeLast();return!!(!r||r.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(o=this,{key:"commentsRemove",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){let r=this.getSelectedRangeLast();r.forAll((r,n)=>{r>=0&&n>=0&&o.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){let r=this.getSelectedRangeLast();return!!(!r||r.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(l=this,{key:"commentsReadOnly",name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT),n=checkSelectionConsistency(this.getSelectedRange(),(r,n)=>l.getCommentMeta(r,n,tz));return n?markLabelAsSelected(r):r},callback(){let r=this.getSelectedRangeLast();r.forAll((r,n)=>{if(r>=0&&n>=0){let o=!!l.getCommentMeta(r,n,tz);l.updateCommentMeta(r,n,{[tz]:!o})}})},disabled(){let r=this.getSelectedRangeLast();return!!(!r||r.highlight.isHeader()||!l.getCommentAtCell(r.highlight.row,r.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}))}getDisplayDelaySetting(){let r=this.hot.getSettings()[tL];if((0,w.Kn)(r))return r.displayDelay}getEditorInputElement(){return comments_classPrivateFieldGet(tU,this).getInputElement()}destroy(){var r,n;null===(r=comments_classPrivateFieldGet(tU,this))||void 0===r||r.destroy(),null===(n=comments_classPrivateFieldGet(t$,this))||void 0===n||n.destroy(),super.destroy()}};function _onMouseDown(r){if(this.hot.view&&this.hot.view._wt&&!comments_classPrivateFieldGet(tK,this)&&!this.targetIsCommentTextArea(r)){let n=(0,h.oq)(r.target,"TD","TBODY"),o=null;n&&(o=this.hot.getCoords(n)),(!n||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}function _onMouseOver(r){let{rootDocument:n}=this.hot;if(!(comments_classPrivateFieldGet(tK,this)||comments_classPrivateFieldGet(tU,this).isFocused()||(0,h.pv)(r.target,"wtBorder"))&&comments_classPrivateFieldGet(tX,this)!==r.target&&comments_classPrivateFieldGet(tU,this)){if(comments_classPrivateFieldSet(tX,this,n.elementFromPoint(r.clientX,r.clientY)),this.targetIsCellWithComment(r)){let n=this.hot._createCellRange(this.hot.getCoords(r.target));comments_classPrivateFieldGet(t$,this).show(n)}else(0,h.MO)(r.target,n)&&!this.targetIsCommentTextArea(r)&&comments_classPrivateFieldGet(t$,this).hide()}}function comments_onMouseUp(){comments_classPrivateFieldSet(tK,this,!1)}function _onAfterRenderer(r,n){n[tV]&&n[tV][tG]&&(0,h.cn)(r,n.commentedCellClassName)}function _onEditorBlur(){comments_classPrivateFieldSet(tq,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){comments_classPrivateFieldSet(tq,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(tj)}function _onEditorResize(r,n){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[tW]:{width:r,height:n}})}function _onAfterDocumentKeyDown(r){comments_classPrivateFieldGet(tU,this).isVisible()&&(0,d.mM)(r)}function _onAfterScroll(){comments_classPrivateFieldGet(tY,this)||this.hide()}function commandExecutor_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}o(95606);let CommandExecutor=class CommandExecutor{constructor(r){commandExecutor_defineProperty(this,"hot",void 0),commandExecutor_defineProperty(this,"commands",{}),commandExecutor_defineProperty(this,"commonCallback",null),this.hot=r}registerCommand(r,n){this.commands[r]=n}setCommonCallback(r){this.commonCallback=r}execute(r){let n;for(var o,l=arguments.length,h=Array(l>1?l-1:0),d=1;d<l;d++)h[d-1]=arguments[d];let y=r.split(":"),S=y[0],_=2===y.length?y[1]:null,R=this.commands[S];if(!R)throw Error(`Menu command '${S}' not exists.`);if(_&&R.submenu&&(o=R.submenu.items,(0,b.Bk)(o,r=>{let o=r.key?r.key.split(":"):null;if(Array.isArray(o)&&o[1]===_)return n=r,!1}),R=n),!0===R.disabled||"function"==typeof R.disabled&&!0===R.disabled.call(this.hot)||(0,w.nr)(R,"submenu"))return;let P=[];"function"==typeof R.callback&&P.push(R.callback),"function"==typeof this.commonCallback&&P.push(this.commonCallback),h.unshift(y.join(":")),(0,b.Bk)(P,r=>r.apply(this.hot,h))}};let tJ="alignment",tQ="clear_column",t0="col_left",t1="col_right",t2="make_read_only",t5="redo";var t4=o(30855);let t3="remove_col",t8="remove_row",t9="row_above",t7="row_below",t6="no_items",ie="undo",it=[t9,t7,t0,t1,tQ,t8,t3,ie,t5,t2,tJ,tB,t6],ii={[tB]:function(){return{name:tB}},[t6]:function(){return{key:t6,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}},[t9]:function(){return{key:t9,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){let r=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",r.row,1,"ContextMenu.rowAbove")},disabled(){let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){let r=this.countRows();return 0===r}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}},[t7]:function(){return{key:t7,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){let r=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",r.row,1,"ContextMenu.rowBelow")},disabled(){let r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader()&&r.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[t0]:function(){return{key:t0,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){let r=this.getSelectedRangeLast().getTopLeftCorner(),n=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(n,r.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){let r=this.countCols();return 0===r}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}},[t1]:function(){return{key:t1,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){let r=this.getSelectedRangeLast().getTopRightCorner(),n=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(n,r.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader()&&r.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[tQ]:function(){return{key:tQ,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(r,n){let o=n[0].start.col,l=n[0].end.col;this.countRows()&&this.populateFromArray(0,o,[[null]],Math.max(n[0].start.row,n[0].end.row),l,"ContextMenu.clearColumn")},disabled(){let r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader()&&r.highlight.col<0)||!this.selection.isSelectedByColumnHeader()}}},[t8]:function(){return{key:t8,name(){let r=this.getSelected(),n=0;if(r){if(r.length>1)n=1;else{let[o,,l]=r[0];o-l!=0&&(n=1)}}return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_REMOVE_ROW,n)},callback(){this.alter("remove_row",(0,t4.I8)(this),1,"ContextMenu.removeRow")},disabled(){let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.row<0)return!0;let n=this.countRows();return this.selection.isSelectedByCorner()?0===n:this.selection.isSelectedByColumnHeader()||0===n},hidden(){return!this.getSettings().allowRemoveRow}}},[t3]:function(){return{key:t3,name(){let r=this.getSelected(),n=0;if(r){if(r.length>1)n=1;else{let[,o,,l]=r[0];o-l!=0&&(n=1)}}return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_REMOVE_COLUMN,n)},callback(){this.alter("remove_col",(0,t4.X8)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader()&&r.highlight.col<0)return!0;let n=this.countCols();return this.selection.isSelectedByCorner()?0===n:this.selection.isSelectedByRowHeader()||0===n},hidden(){return!this.getSettings().allowRemoveColumn}}},[ie]:function(){return{key:ie,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){let r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[t5]:function(){return{key:t5,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){let r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[t2]:function(){return{key:t2,checkable:!0,ariaChecked(){let r=checkSelectionConsistency(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly);return r},ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_READ_ONLY)},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_READ_ONLY),n=checkSelectionConsistency(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly);return n&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=checkSelectionConsistency(r,(r,n)=>this.getCellMeta(r,n).readOnly);(0,b.Bk)(r,r=>{r.forAll((r,o)=>{r>=0&&o>=0&&this.setCellMeta(r,o,"readOnly",!n)})}),this.render()},disabled(){let r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader()||this.selection.isSelectedByCorner())||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}},[tJ]:function(){return{key:tJ,name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${tJ}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},ariaChecked(){return hasSelectionAClass(this,"htLeft")},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return hasSelectionAClass(this,"htLeft")&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=getAlignmentClasses(r,(r,n)=>this.getCellMeta(r,n).className),o="horizontal",l="htLeft";this.runHooks("beforeCellAlignment",n,r,o,l),align(r,o,l,(r,n)=>this.getCellMeta(r,n),(r,n,o,l)=>this.setCellMeta(r,n,o,l)),this.render()},disabled:!1},{key:`${tJ}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},ariaChecked(){return hasSelectionAClass(this,"htCenter")},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return hasSelectionAClass(this,"htCenter")&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=getAlignmentClasses(r,(r,n)=>this.getCellMeta(r,n).className),o="horizontal",l="htCenter";this.runHooks("beforeCellAlignment",n,r,o,l),align(r,o,l,(r,n)=>this.getCellMeta(r,n),(r,n,o,l)=>this.setCellMeta(r,n,o,l)),this.render()},disabled:!1},{key:`${tJ}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},ariaChecked(){return hasSelectionAClass(this,"htRight")},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return hasSelectionAClass(this,"htRight")&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=getAlignmentClasses(r,(r,n)=>this.getCellMeta(r,n).className),o="horizontal",l="htRight";this.runHooks("beforeCellAlignment",n,r,o,l),align(r,o,l,(r,n)=>this.getCellMeta(r,n),(r,n,o,l)=>this.setCellMeta(r,n,o,l)),this.render()},disabled:!1},{key:`${tJ}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},ariaChecked(){return hasSelectionAClass(this,"htJustify")},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return hasSelectionAClass(this,"htJustify")&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=getAlignmentClasses(r,(r,n)=>this.getCellMeta(r,n).className),o="horizontal",l="htJustify";this.runHooks("beforeCellAlignment",n,r,o,l),align(r,o,l,(r,n)=>this.getCellMeta(r,n),(r,n,o,l)=>this.setCellMeta(r,n,o,l)),this.render()},disabled:!1},{name:tB},{key:`${tJ}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},ariaChecked(){return hasSelectionAClass(this,"htTop")},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return hasSelectionAClass(this,"htTop")&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=getAlignmentClasses(r,(r,n)=>this.getCellMeta(r,n).className),o="vertical",l="htTop";this.runHooks("beforeCellAlignment",n,r,o,l),align(r,o,l,(r,n)=>this.getCellMeta(r,n),(r,n,o,l)=>this.setCellMeta(r,n,o,l)),this.render()},disabled:!1},{key:`${tJ}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},ariaChecked(){return hasSelectionAClass(this,"htMiddle")},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return hasSelectionAClass(this,"htMiddle")&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=getAlignmentClasses(r,(r,n)=>this.getCellMeta(r,n).className),o="vertical",l="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,l),align(r,o,l,(r,n)=>this.getCellMeta(r,n),(r,n,o,l)=>this.setCellMeta(r,n,o,l)),this.render()},disabled:!1},{key:`${tJ}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},ariaChecked(){return hasSelectionAClass(this,"htBottom")},name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return hasSelectionAClass(this,"htBottom")&&(r=markLabelAsSelected(r)),r},callback(){let r=this.getSelectedRange(),n=getAlignmentClasses(r,(r,n)=>this.getCellMeta(r,n).className),o="vertical",l="htBottom";this.runHooks("beforeCellAlignment",n,r,o,l),align(r,o,l,(r,n)=>this.getCellMeta(r,n),(r,n,o,l)=>this.setCellMeta(r,n,o,l)),this.render()},disabled:!1}]}}}};function predefinedItems(){let r={};return(0,w._l)(ii,(n,o)=>{r[o]=n()}),r}function itemsFactory_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let ItemsFactory=class ItemsFactory{constructor(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;itemsFactory_defineProperty(this,"hot",void 0),itemsFactory_defineProperty(this,"predefinedItems",predefinedItems()),itemsFactory_defineProperty(this,"defaultOrderPattern",void 0),this.hot=r,this.defaultOrderPattern=n}setPredefinedItems(r){let n={};this.defaultOrderPattern.length=0,(0,w._l)(r,(r,o)=>{let l="";r.name===tB?(n[tB]=r,l=tB):(isNaN(parseInt(o,10))?(r.key=void 0===r.key?o:r.key,n[o]=r):n[r.key]=r,l=r.key),this.defaultOrderPattern.push(l)}),this.predefinedItems=n}getItems(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=[],h=r;return h&&h.items?h=h.items:Array.isArray(h)||(h=n),(0,w.Kn)(h)?(0,w._l)(h,(r,n)=>{let h=o["string"==typeof r?r:n];h||(h=r),(0,w.Kn)(r)?(0,w.l7)(h,r):"string"==typeof h&&(h={name:h}),void 0===h.key&&(h.key=n),l.push(h)}):(0,b.Bk)(h,(r,n)=>{let h=o[r];!h&&it.indexOf(r)>=0||(h||(h={name:r,key:`${n}`}),(0,w.Kn)(r)&&(0,w.l7)(h,r),void 0===h.key&&(h.key=n),l.push(h))}),l}(r,this.defaultOrderPattern,this.predefinedItems)}};function cursor_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let Cursor=class Cursor{constructor(r,n){let o,l,h,d,w,y;cursor_defineProperty(this,"top",void 0),cursor_defineProperty(this,"topRelative",void 0),cursor_defineProperty(this,"left",void 0),cursor_defineProperty(this,"leftRelative",void 0),cursor_defineProperty(this,"scrollTop",void 0),cursor_defineProperty(this,"scrollLeft",void 0),cursor_defineProperty(this,"cellHeight",void 0),cursor_defineProperty(this,"cellWidth",void 0);let S=n.scrollY,b=n.scrollX;this.rootWindow=n,this.type=this.getSourceType(r),"literal"===this.type?(o=parseInt(r.top,10),h=parseInt(r.left,10),w=r.height||0,y=r.width||0,l=o,d=h,o+=S,h+=b):"event"===this.type&&(o=parseInt(r.pageY,10),h=parseInt(r.pageX,10),w=r.target.clientHeight,y=r.target.clientWidth,l=o-S,d=h-b),this.top=o,this.topRelative=l,this.left=h,this.leftRelative=d,this.scrollTop=S,this.scrollLeft=b,this.cellHeight=w,this.cellWidth=y}getSourceType(r){let n="literal";return r instanceof Event&&(n="event"),n}fitsAbove(r){return this.topRelative>=r.offsetHeight}fitsBelow(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}fitsOnRight(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}fitsOnLeft(r){return this.leftRelative>=r.offsetWidth}};function positioner_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function positioner_classPrivateFieldGet(r,n){return r.get(positioner_assertClassBrand(r,n))}function positioner_classPrivateFieldSet(r,n,o){return r.set(positioner_assertClassBrand(r,n),o),o}function positioner_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var ir=new WeakMap,is=new WeakMap,io=new WeakMap,il=new WeakMap,ia=new WeakMap;let Positioner=class Positioner{constructor(r){positioner_classPrivateFieldInitSpec(this,ir,void 0),positioner_classPrivateFieldInitSpec(this,is,void 0),positioner_classPrivateFieldInitSpec(this,io,void 0),positioner_classPrivateFieldInitSpec(this,il,!1),positioner_classPrivateFieldInitSpec(this,ia,{above:0,below:0,left:0,right:0}),positioner_classPrivateFieldSet(il,this,r)}setOffset(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return positioner_classPrivateFieldGet(ia,this)[r]=n,this}setElement(r){return positioner_classPrivateFieldSet(ir,this,r),this}setParentElement(r){return positioner_classPrivateFieldSet(is,this,r),this}updatePosition(r){positioner_classPrivateFieldSet(io,this,new Cursor(r,positioner_classPrivateFieldGet(ir,this).ownerDocument.defaultView)),positioner_classPrivateFieldGet(il,this)?(positioner_classPrivateFieldGet(io,this).fitsBelow(positioner_classPrivateFieldGet(ir,this))?this.setPositionBelowCursor():positioner_classPrivateFieldGet(io,this).fitsAbove(positioner_classPrivateFieldGet(ir,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===positioner_classPrivateFieldGet(ir,this).dir?positioner_classPrivateFieldGet(io,this).fitsOnLeft(positioner_classPrivateFieldGet(ir,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():positioner_classPrivateFieldGet(io,this).fitsOnRight(positioner_classPrivateFieldGet(ir,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let r=positioner_classPrivateFieldGet(ia,this).above+positioner_classPrivateFieldGet(io,this).top-positioner_classPrivateFieldGet(ir,this).offsetHeight;positioner_classPrivateFieldGet(is,this)&&(r=positioner_classPrivateFieldGet(io,this).top+positioner_classPrivateFieldGet(io,this).cellHeight-positioner_classPrivateFieldGet(ir,this).offsetHeight+3),positioner_classPrivateFieldGet(ir,this).style.top=`${r}px`}setPositionBelowCursor(){let r=positioner_classPrivateFieldGet(ia,this).below+positioner_classPrivateFieldGet(io,this).top+1;positioner_classPrivateFieldGet(is,this)&&(r=positioner_classPrivateFieldGet(io,this).top-1),positioner_classPrivateFieldGet(ir,this).style.top=`${r}px`}setPositionOnRightOfCursor(){let r=positioner_classPrivateFieldGet(io,this).left;if(positioner_classPrivateFieldGet(is,this)){let n=Number.parseInt(getComputedStyle(positioner_classPrivateFieldGet(is,this).querySelector(".htCore")).borderRightWidth,10);r+=positioner_classPrivateFieldGet(io,this).cellWidth+n}else r+=positioner_classPrivateFieldGet(ia,this).right;positioner_classPrivateFieldGet(ir,this).style.left=`${r}px`}setPositionOnLeftOfCursor(){let r=positioner_classPrivateFieldGet(ia,this).left+positioner_classPrivateFieldGet(io,this).left-positioner_classPrivateFieldGet(ir,this).offsetWidth;if(positioner_classPrivateFieldGet(is,this)){let n=Number.parseInt(getComputedStyle(positioner_classPrivateFieldGet(is,this).querySelector(".htCore")).borderLeftWidth,10);r-=n}positioner_classPrivateFieldGet(ir,this).style.left=`${r}px`}};function createPaginator(r){let{initialPage:n=-1,size:o=()=>0,onItemSelect:l=()=>{},onClear:h=()=>{}}=r,d=new Set,w=(0,ea.uZ)(n,-1,getSize()-1);function _updateState(r,n){let o=getSize()-1;if(r<0&&(r=o),r>o&&(r=0),d.has(r))return -1;d.add(r);let h=l(r,!1);return!1===h&&(r=_updateState(1===n?++r:--r,n)),r}function getSize(){return Math.max(o(),0)}return{setCurrentPage:function(r){r>-1&&r<getSize()&&!1!==l(r,!0)&&(w=r)},getCurrentPage:function(){return w},toFirstItem:function(){getSize()>0&&(d.clear(),w=_updateState(0,1))},toLastItem:function(){getSize()>0&&(d.clear(),w=_updateState(getSize()-1,-1))},toNextItem:function(){getSize()>0&&(d.clear(),w=_updateState(++w,1))},toPreviousItem:function(){getSize()>0&&(d.clear(),w=_updateState(--w,-1))},getSize,clear:function(){d.clear(),w=n,h()}}}function isItemSubMenu(r){return(0,w.nr)(r,"submenu")}function isItemSeparator(r){return RegExp(tB,"i").test(r.name)}function isItemDisabled(r,n){return!0===r.disabled||"function"==typeof r.disabled&&!0===r.disabled.call(n)}function isItemSelectionDisabled(r){return(0,w.nr)(r,"disableSelection")}function shiftSeparators(r,n){let o=r.slice(0);for(;0<o.length;)if(o[0].name===n)o.shift();else break;return o}let ih="menu";function menu_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function menu_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function menu_classPrivateFieldSet(r,n,o){return r.set(menu_assertClassBrand(r,n),o),o}function menu_classPrivateFieldGet(r,n){return r.get(menu_assertClassBrand(r,n))}function menu_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var id=new WeakMap,ic=new WeakMap,iu=new WeakMap;let Menu=class Menu{get tableBorderWidth(){return void 0===menu_classPrivateFieldGet(iu,this)&&this.hotMenu&&menu_classPrivateFieldSet(iu,this,parseInt((0,h.Dx)(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),menu_classPrivateFieldGet(iu,this)}constructor(r,n){var o=this;menu_defineProperty(this,"hot",void 0),menu_defineProperty(this,"options",void 0),menu_defineProperty(this,"eventManager",new ee.Z(this)),menu_defineProperty(this,"container",void 0),menu_defineProperty(this,"positioner",void 0),menu_defineProperty(this,"hotMenu",null),menu_defineProperty(this,"hotSubMenus",{}),menu_defineProperty(this,"parentMenu",void 0),menu_defineProperty(this,"menuItems",null),menu_defineProperty(this,"origOutsideClickDeselects",null),menu_classPrivateFieldInitSpec(this,id,void 0),menu_classPrivateFieldInitSpec(this,ic,void 0),menu_classPrivateFieldInitSpec(this,iu,void 0),this.hot=r,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.parentMenu.runLocalHooks("afterSelectionChange",...n)})}registerEvents(){let r=this.hot.rootWindow;for(;r;)this.eventManager.addEventListener(r.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(r.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(r.document,"contextmenu",r=>this.onDocumentContextMenu(r)),r=(0,h.f5)(r)}setMenuItems(r){this.menuItems=r}getNavigator(){return menu_classPrivateFieldGet(id,this)}getKeyboardShortcutsCtrl(){return menu_classPrivateFieldGet(ic,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){var r,n;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let o=(0,e6.Ds)(r=>this.openSubMenu(r),300),l=this.options.minWidth||215,w=!1,y=(0,b.w7)(this.menuItems,r=>{var n;return r.key===t6&&(w=!0),n=this.hot,!r.hidden||!("function"==typeof r.hidden&&r.hidden.call(n))});if(y.length<1&&!w)y.push(predefinedItems()[t6]);else if(0===y.length)return;y=function(r){let n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tB,l=r.slice(0);return(n=(l=shiftSeparators(l,o)).slice(0)).reverse(),(n=shiftSeparators(n,o)).reverse(),l=function(r){let n=[];return(0,b.Bk)(r,(r,o)=>{o>0?n[n.length-1].name!==r.name&&n.push(r):n.push(r)}),n}(l=n)}(y,tB);let S=!1,R={data:y,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:r=>(0,_.$K)(r)&&r<l?l:r,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(r=this.hot,(n,o,l,d,w,y)=>{let S=n.getSourceDataAtRow(l),b=r.rootDocument.createElement("div"),_="function"==typeof y?y.call(r):y,R="function"==typeof S.ariaLabel?S.ariaLabel.call(r):S.ariaLabel,P="function"==typeof S.ariaChecked?S.ariaChecked.call(r):S.ariaChecked;if((0,h.cS)(o),(0,h.cn)(b,"htItemWrapper"),r.getSettings().ariaTags){let n=!isItemDisabled(S,r)&&!isItemSelectionDisabled(S)&&!isItemSeparator(S);(0,h.P$)(o,[...!0===S.checkable?[(0,O.ys)(),(0,O.QK)(R),(0,O.Pn)(P)]:[(0,O.rQ)(),(0,O.QK)(_)],...n?[(0,O.Qk)(-1)]:[],...isItemDisabled(S,r)?[(0,O.gw)()]:[],...isItemSubMenu(S)?[(0,O.JV)(!1)]:[]])}o.className="",o.appendChild(b),isItemSeparator(S)?(0,h.cn)(o,"htSeparator"):"function"==typeof S.renderer?((0,h.cn)(o,"htCustomMenuRenderer"),o.appendChild(S.renderer(n,b,l,d,w,_))):(0,h.uS)(b,_),isItemDisabled(S,r)?(0,h.cn)(o,"htDisabled"):isItemSelectionDisabled(S)?(0,h.cn)(o,"htSelectionDisabled"):isItemSubMenu(S)&&(0,h.cn)(o,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(r,n)=>{menu_classPrivateFieldGet(id,this).setCurrentPage(n.row)},afterOnCellMouseOver:(r,n)=>{this.isAllSubMenusClosed()?o(n.row):this.openSubMenu(n.row)},rowHeights:r=>y[r].name===tB?1:void 0,afterOnCellContextMenu:r=>{r.preventDefault(),(0,T.uM)()&&S&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(r,n,o,l,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:r=>{this.hasSelectedItem()&&(S=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(r))},afterOnCellMouseUp:r=>{(!(0,T.uM)()||!(0,d.dO)(r))&&S&&this.hasSelectedItem()&&((0,T.K1)()||(0,T.L)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,R),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),menu_classPrivateFieldSet(id,this,(n=this.hotMenu,createPaginator({size:()=>n.countRows(),onItemSelect(r,o){let l=n.getCell(r,0);if(!l||(0,h.pv)(l,"htSeparator")||(0,h.pv)(l,"htDisabled")||(0,h.pv)(l,"htSelectionDisabled"))return!1;n.selectCell(r,0,...o?[r,0,!1,!1]:[])},onClear(){n.deselectCell()}}))),menu_classPrivateFieldSet(ic,this,function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[];function _addShortcuts(r,n){getContext(n).addShortcuts(r,{group:ih})}function addCustomShortcuts(r,n){let l=getContext(n);r.forEach(r=>{let{keys:n}=r;n.forEach(r=>l.removeShortcutsByKeys(r))}),o.push({shortcuts:r,contextName:n}),_addShortcuts(r,n)}function _getContextName(r){return r?`${ih}:${r}`:ih}function getContext(n){var o;let l=r.hotMenu.getShortcutManager(),h=_getContextName(n);return null!==(o=l.getContext(h))&&void 0!==o?o:l.addContext(h)}return _addShortcuts(function(r){let{hot:n,hotMenu:o}=r;return[{keys:[["Control/Meta","A"]],forwardToContext:n.getShortcutManager().getContext("grid"),callback:()=>r.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(o,l)=>{let h=n.getSettings(),d="function"==typeof h.tabMoves?h.tabMoves(o):h.tabMoves;l.includes("shift")?n.selection.transformStart(-d.row,-d.col):n.selection.transformStart(d.row,d.col),r.close(!0)}},{keys:[["Escape"]],callback:()=>r.close()},{keys:[["ArrowDown"]],callback:()=>r.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>r.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{let n=o.getSelectedLast();if(n){let o=r.openSubMenu(n[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{let n=o.getSelectedLast();n&&r.isSubMenu()&&(r.close(),r.isSubMenu()&&r.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>r.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>r.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{let l=o.getSelectedLast();l&&(o.getSourceDataAtRow(l[0]).submenu?r.openSubMenu(l[0]).getNavigator().toFirstItem():(r.executeCommand(n),r.close(!0)))}},{keys:[["PageUp"]],callback:()=>{let n=o.getSelectedLast();n?o.selection.transformStart(-o.countVisibleRows(),0):r.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{let n=o.getSelectedLast();n?o.selection.transformStart(o.countVisibleRows(),0):r.getNavigator().toLastItem()}}]}(r)),n.forEach(r=>{let{shortcuts:n,contextName:o}=r;addCustomShortcuts(n,o)}),{addCustomShortcuts,getCustomShortcuts:function(){return[...o]},getContext,listen:function(n){r.hotMenu.getShortcutManager().setActiveContextName(_getContextName(n))}}}(this)),menu_classPrivateFieldGet(ic,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened()){if(r&&this.isSubMenu())this.parentMenu.close();else if(menu_classPrivateFieldGet(id,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let r=this.parentMenu.hotMenu.getSelectedLast();if(r){let n=this.parentMenu.hotMenu.getCell(r[0],0);(0,h.P$)(n,[(0,O.JV)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(r){if(!this.hotMenu)return!1;let n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!(0,h.pv)(n,"htSubmenu"))return!1;let o=this.hotMenu.getSourceDataAtRow(r),l=new Menu(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return l.setMenuItems(o.submenu.items),l.open(),l.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=l,this.hot.getSettings().ariaTags&&(0,h.P$)(n,[(0,O.JV)(!0)]),l}closeSubMenu(r){let n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];if(o){o.destroy(),delete this.hotSubMenus[n.key];let l=this.hotMenu.getCell(r,0);this.hot.getSettings().ariaTags&&(0,h.P$)(l,[(0,O.JV)(!1)])}}closeAllSubMenus(){(0,b.Bk)(this.hotMenu.getData(),(r,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(r){if(!this.isOpened()||!this.hasSelectedItem())return;let n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),this.isCommandPassive(n))return;let o=this.hot.getSelectedRange(),l=o?(0,b.Sc)(o,r=>({start:r.getTopStartCorner(),end:r.getBottomEndCorner()})):[];this.runLocalHooks("executeCommand",n.key,l,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,l,r)}isCommandPassive(r){return!1===r.isCommand||isItemSeparator(r)||isItemDisabled(r,this.hot)||isItemSubMenu(r)}setOffset(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(r,n)}setPosition(r){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(r)}updateMenuDimensions(){let{wtTable:r}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,o=r.hider.style,l=r.holder.style,d=parseInt(o.width,10),w=(0,b.k$)(n,(r,n,o)=>{let l=this.hotMenu.getCell(o,0),d=l?(0,h.Pb)(this.hotMenu.getCell(o,0)):0;return r+(n.name===tB?1:d)},0);l.width=`${d+3}px`,l.height=`${w+3}px`,o.height=l.height}createContainer(){let r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=this.options.container.ownerDocument,l=n;return l&&((0,e6.mf)(l)&&(l=null===(l=l.call(this.hot))||(0,_.o8)(l)?"":l.toString()),l=l.replace(/[^A-z0-9]/g,"_"),l=`${this.options.className}Sub_${l}`,r=o.querySelector(`.${this.options.className}.${l}`)),r||(r=o.createElement("div"),(0,h.cn)(r,`htMenu ${this.options.className}`),l&&(0,h.cn)(r,l),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&(0,h.P$)(this.hotMenu.rootElement,[(0,O.tm)(),(0,O.Qk)(-1)])}onDocumentMouseDown(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,h.MO)(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,h.MO)(r.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(r){this.isOpened()&&(0,h.pv)(r.target,"htCore")&&(0,h.MO)(r.target,this.hotMenu.rootElement)&&r.preventDefault()}};function contextMenu_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function contextMenu_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}(0,w.jB)(Menu,tE.Z);let ig="contextMenu";K.Z.getSingleton().register("afterContextMenuDefaultOptions"),K.Z.getSingleton().register("beforeContextMenuShow"),K.Z.getSingleton().register("afterContextMenuShow"),K.Z.getSingleton().register("afterContextMenuHide"),K.Z.getSingleton().register("afterContextMenuExecute");var im=new WeakSet;let ContextMenu=class ContextMenu extends BasePlugin{constructor(){super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,im),im.add(this),contextMenu_defineProperty(this,"commandExecutor",new CommandExecutor(this.hot)),contextMenu_defineProperty(this,"itemsFactory",null),contextMenu_defineProperty(this,"menu",null)}static get PLUGIN_KEY(){return ig}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[t9,t7,tB,t0,t1,tB,t8,t3,tB,ie,t5,tB,t2,tB,tJ]}isEnabled(){return!!this.hot.getSettings()[ig]}enablePlugin(){var r=this;if(this.enabled)return;let n=this.hot.getSettings()[ig];"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>contextMenu_assertClassBrand(im,this,_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>contextMenu_assertClassBrand(im,this,_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterClose",()=>contextMenu_assertClassBrand(im,this,_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return r.executeCommand.call(r,...o)}),this.addHook("afterOnCellContextMenu",r=>contextMenu_assertClassBrand(im,this,_onAfterOnCellContextMenu).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:r}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let n=this.hot.getCell(r.row,r.col,!0).getBoundingClientRect(),o=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:n.left+o.left,top:n.top+o.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var r;let n=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:ig})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ig)}open(r){var n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(n=this.menu)&&void 0!==n&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();let l=this.menu.tableBorderWidth>0;l||(o.below+=1,o.right+=1,o.above-=1,o.left-=1),(0,w._l)(o,(r,n)=>{this.menu.setOffset(n,r)}),this.menu.setPosition(r)}close(){var r;null===(r=this.menu)||void 0===r||r.close(),this.itemsFactory=null}executeCommand(r){null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,o=Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];this.commandExecutor.execute(r,...o)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,ContextMenu.DEFAULT_ITEMS);let r=this.hot.getSettings()[ig],n={items:this.itemsFactory.getItems(r)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);let o=this.itemsFactory.getItems(r);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),(0,b.Bk)(o,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function _onAfterOnCellContextMenu(r){let n=this.hot.getSettings(),o=n.rowHeaders,l=n.colHeaders,d=r.target;if(this.close(),(0,h.pv)(d,"handsontableInput")||(r.preventDefault(),r.stopPropagation(),!(o||l)&&!("TD"===d.nodeName||"TD"===d.parentNode.nodeName)&&!((0,h.pv)(d,"current")&&(0,h.pv)(d,"wtBorder"))))return;let w=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:r.clientY+w.top,left:r.clientX+w.left})}function _onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:tB};var ip=o(90292);let ClipboardData=class ClipboardData{constructor(){this.data={}}setData(r,n){this.data[r]=n}getData(r){return this.data[r]||void 0}};let PasteEvent=class PasteEvent{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}};function copyableRanges_classPrivateFieldInitSpec(r,n,o){copyableRanges_checkPrivateRedeclaration(r,n),n.set(r,o)}function copyableRanges_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function copyableRanges_classPrivateFieldGet(r,n){return r.get(copyableRanges_assertClassBrand(r,n))}function copyableRanges_classPrivateFieldSet(r,n,o){return r.set(copyableRanges_assertClassBrand(r,n),o),o}function copyableRanges_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var iv=new WeakMap,iC=new WeakMap,iw=new WeakMap,iy=new WeakMap,iS=new WeakMap,ib=new WeakMap,i_=new WeakSet;let CopyableRangesFactory=class CopyableRangesFactory{constructor(r){let{countRows:n,countColumns:o,rowsLimit:l,columnsLimit:h,countColumnHeaders:d}=r;copyableRanges_checkPrivateRedeclaration(this,i_),i_.add(this),copyableRanges_classPrivateFieldInitSpec(this,iv,void 0),copyableRanges_classPrivateFieldInitSpec(this,iC,void 0),copyableRanges_classPrivateFieldInitSpec(this,iw,void 0),copyableRanges_classPrivateFieldInitSpec(this,iy,void 0),copyableRanges_classPrivateFieldInitSpec(this,iS,void 0),copyableRanges_classPrivateFieldInitSpec(this,ib,void 0),copyableRanges_classPrivateFieldSet(iC,this,n),copyableRanges_classPrivateFieldSet(iw,this,o),copyableRanges_classPrivateFieldSet(iy,this,l),copyableRanges_classPrivateFieldSet(iS,this,h),copyableRanges_classPrivateFieldSet(ib,this,d)}setSelectedRange(r){copyableRanges_classPrivateFieldSet(iv,this,r)}getCellsRange(){if(0===copyableRanges_classPrivateFieldGet(iC,this).call(this)||0===copyableRanges_classPrivateFieldGet(iw,this).call(this))return null;let{row:r,col:n}=copyableRanges_classPrivateFieldGet(iv,this).getTopStartCorner(),{row:o,col:l}=copyableRanges_classPrivateFieldGet(iv,this).getBottomEndCorner(),h=copyableRanges_assertClassBrand(i_,this,_trimRowsRange).call(this,r,o),d=copyableRanges_assertClassBrand(i_,this,_trimColumnsRange).call(this,n,l),w=o!==h||l!==d;return{isRangeTrimmed:w,startRow:r,startCol:n,endRow:h,endCol:d}}getMostBottomColumnHeadersRange(){if(0===copyableRanges_classPrivateFieldGet(iw,this).call(this)||0===copyableRanges_classPrivateFieldGet(ib,this).call(this))return null;let{col:r}=copyableRanges_classPrivateFieldGet(iv,this).getTopStartCorner(),{col:n}=copyableRanges_classPrivateFieldGet(iv,this).getBottomEndCorner(),o=copyableRanges_assertClassBrand(i_,this,_trimColumnsRange).call(this,r,n),l=n!==o;return{isRangeTrimmed:l,startRow:-1,startCol:r,endRow:-1,endCol:o}}getAllColumnHeadersRange(){if(0===copyableRanges_classPrivateFieldGet(iw,this).call(this)||0===copyableRanges_classPrivateFieldGet(ib,this).call(this))return null;let{col:r}=copyableRanges_classPrivateFieldGet(iv,this).getTopStartCorner(),{col:n}=copyableRanges_classPrivateFieldGet(iv,this).getBottomEndCorner(),o=copyableRanges_assertClassBrand(i_,this,_trimColumnsRange).call(this,r,n),l=n!==o;return{isRangeTrimmed:l,startRow:-copyableRanges_classPrivateFieldGet(ib,this).call(this),startCol:r,endRow:-1,endCol:o}}};function _trimColumnsRange(r,n){return Math.min(n,Math.max(r+copyableRanges_classPrivateFieldGet(iS,this).call(this)-1,r))}function _trimRowsRange(r,n){return Math.min(n,Math.max(r+copyableRanges_classPrivateFieldGet(iy,this).call(this)-1,r))}function normalizeRanges(r){let n=[],o=[];return(0,b.Bk)(r,r=>{let l=Math.min(r.startRow,r.endRow),h=Math.max(r.startRow,r.endRow);(0,ea.q4)(l,h,r=>{-1===n.indexOf(r)&&n.push(r)});let d=Math.min(r.startCol,r.endCol),w=Math.max(r.startCol,r.endCol);(0,ea.q4)(d,w,r=>{-1===o.indexOf(r)&&o.push(r)})}),{rows:n,columns:o}}var iR=o(84350);function copyPaste_classPrivateFieldInitSpec(r,n,o){copyPaste_checkPrivateRedeclaration(r,n),n.set(r,o)}function copyPaste_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function copyPaste_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function copyPaste_classPrivateFieldGet(r,n){return r.get(copyPaste_assertClassBrand(r,n))}function copyPaste_classPrivateFieldSet(r,n,o){return r.set(copyPaste_assertClassBrand(r,n),o),o}function copyPaste_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("afterCopyLimit"),K.Z.getSingleton().register("modifyCopyableRange"),K.Z.getSingleton().register("beforeCut"),K.Z.getSingleton().register("afterCut"),K.Z.getSingleton().register("beforePaste"),K.Z.getSingleton().register("afterPaste"),K.Z.getSingleton().register("beforeCopy"),K.Z.getSingleton().register("afterCopy");let iP="copyPaste",iE=["fragmentSelection"],iT='<meta name="generator" content="Handsontable"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>';var iM=new WeakMap,iI=new WeakMap,iO=new WeakMap,ix=new WeakMap,iA=new WeakMap,iF=new WeakMap,ik=new WeakMap,iH=new WeakMap,iN=new WeakSet;let CopyPaste=class CopyPaste extends BasePlugin{constructor(){super(...arguments),copyPaste_checkPrivateRedeclaration(this,iN),iN.add(this),copyPaste_defineProperty(this,"columnsLimit",1/0),copyPaste_defineProperty(this,"rowsLimit",1/0),copyPaste_defineProperty(this,"pasteMode","overwrite"),copyPaste_defineProperty(this,"uiContainer",this.hot.rootDocument.body),copyPaste_classPrivateFieldInitSpec(this,iM,!1),copyPaste_classPrivateFieldInitSpec(this,iI,!1),copyPaste_classPrivateFieldInitSpec(this,iO,!1),copyPaste_classPrivateFieldInitSpec(this,ix,"cells-only"),copyPaste_classPrivateFieldInitSpec(this,iA,!1),copyPaste_classPrivateFieldInitSpec(this,iF,!1),copyPaste_classPrivateFieldInitSpec(this,ik,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),copyPaste_classPrivateFieldInitSpec(this,iH,!1),copyPaste_defineProperty(this,"copyableRanges",[])}static get PLUGIN_KEY(){return iP}static get SETTING_KEYS(){return[iP,...iE]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[iP]}enablePlugin(){var r,n,o=this;if(this.enabled)return;let{[iP]:l}=this.hot.getSettings();"object"==typeof l&&(this.pasteMode=null!==(r=l.pasteMode)&&void 0!==r?r:this.pasteMode,this.rowsLimit=isNaN(l.rowsLimit)?this.rowsLimit:l.rowsLimit,this.columnsLimit=isNaN(l.columnsLimit)?this.columnsLimit:l.columnsLimit,copyPaste_classPrivateFieldSet(iM,this,!!l.copyColumnHeaders),copyPaste_classPrivateFieldSet(iI,this,!!l.copyColumnGroupHeaders),copyPaste_classPrivateFieldSet(iO,this,!!l.copyColumnHeadersOnly),this.uiContainer=null!==(n=l.uiContainer)&&void 0!==n?n:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",r=>copyPaste_assertClassBrand(iN,this,_onAfterContextMenuDefaultOptions).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return copyPaste_assertClassBrand(iN,o,_onAfterSelection).call(o,...n)}),this.addHook("afterSelectionEnd",()=>copyPaste_assertClassBrand(iN,this,_onAfterSelectionEnd).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return o.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return o.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return o.onPaste(...arguments)}),(0,T.G6)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return copyPaste_assertClassBrand(iN,o,_onSafariMouseEnter).call(o,...n)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return copyPaste_assertClassBrand(iN,o,_onSafariMouseLeave).call(o,...n)}),this.addHook("afterSelection",()=>copyPaste_assertClassBrand(iN,this,_onSafariAfterSelection).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";copyPaste_classPrivateFieldSet(ix,this,r),copyPaste_classPrivateFieldSet(iA,this,!0),copyPaste_assertClassBrand(iN,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){copyPaste_classPrivateFieldSet(iF,this,!0),copyPaste_assertClassBrand(iN,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(r){return(0,ip.P)(this.getRangedData(r))}getRangedData(r){let n=[],{rows:o,columns:l}=normalizeRanges(r);return(0,b.Bk)(o,r=>{let o=[];(0,b.Bk)(l,n=>{r<0?o.push(this.hot.getColHeader(n,r)):o.push(this.hot.getCopyableData(r,n))}),n.push(o)}),n}paste(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(!r&&!n)return;let o=new PasteEvent;r&&o.clipboardData.setData("text/plain",r),n&&o.clipboardData.setData("text/html",n),this.onPaste(o)}setCopyableText(){let r=this.hot.getSelectedRangeLast();if(!r)return;if(r.isSingleHeader()){this.copyableRanges=[];return}copyPaste_classPrivateFieldGet(ik,this).setSelectedRange(r);let n=new Map([["headers",null],["cells",null]]);"column-headers-only"===copyPaste_classPrivateFieldGet(ix,this)?n.set("headers",copyPaste_classPrivateFieldGet(ik,this).getMostBottomColumnHeadersRange()):("with-column-headers"===copyPaste_classPrivateFieldGet(ix,this)?n.set("headers",copyPaste_classPrivateFieldGet(ik,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===copyPaste_classPrivateFieldGet(ix,this)&&n.set("headers",copyPaste_classPrivateFieldGet(ik,this).getAllColumnHeadersRange()),n.set("cells",copyPaste_classPrivateFieldGet(ik,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>null!==r).map(r=>{let{startRow:n,startCol:o,endRow:l,endCol:h}=r;return{startRow:n,startCol:o,endRow:l,endCol:h}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let o=n.get("cells");if(null!==o&&o.isRangeTrimmed){let{startRow:r,startCol:n,endRow:l,endCol:h}=o;this.hot.runHooks("afterCopyLimit",l-r+1,h-n+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var r;return null===(r=this.hot.getActiveEditor())||void 0===r?void 0:r.isOpened()}populateValues(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!r.length)return;let o=r.length,l=r[0].length,h=[],{row:d,col:w}=n.getTopStartCorner(),{row:y,col:S}=n.getBottomEndCorner(),b=d,_=w,R=d,P=w;for(;h.length<o||b<=y;){let{skipRowOnPaste:n,visualRow:y}=this.hot.getCellMeta(b,w);if(b=y+1,!0===n)continue;R=y,_=w;let T=[],I=h.length%o;for(;T.length<l||_<=S;){let{skipColumnOnPaste:n,visualCol:o}=this.hot.getCellMeta(d,_);if(_=o+1,!0===n)continue;P=o;let h=T.length%l;T.push(r[I][h])}h.push(T)}return copyPaste_classPrivateFieldSet(iH,this,!0),this.hot.populateFromArray(d,w,h,void 0,void 0,"CopyPaste.paste",this.pasteMode),[d,w,R,P]}onCopy(r){var n,o;let l=this.hot.getFocusManager().getRefocusElement(),h=null===(n=r.target)||void 0===n?void 0:n.hasAttribute("data-hot-input"),d=null===(o=this.hot.getSelectedRangeLast())||void 0===o?void 0:o.highlight,w=d?this.hot.getCell(d.row,d.col,!0):null;if(!this.hot.isListening()&&!copyPaste_classPrivateFieldGet(iA,this)||this.isEditorOpened()||r.target instanceof HTMLElement&&(h&&r.target!==l||!h&&r.target!==this.hot.rootDocument.body&&w!==r.target))return;r.preventDefault(),this.setCopyableText(),copyPaste_classPrivateFieldSet(iA,this,!1);let y=this.getRangedData(this.copyableRanges),S=copyPaste_assertClassBrand(iN,this,_countCopiedHeaders).call(this,this.copyableRanges),b=!!this.hot.runHooks("beforeCopy",y,this.copyableRanges,S);if(b){let n=(0,ip.P)(y);if(r&&r.clipboardData){let o=(0,iR.bt)(y,this.hot.rootDocument);r.clipboardData.setData("text/plain",n),r.clipboardData.setData("text/html",[iT,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",y,this.copyableRanges,S)}copyPaste_classPrivateFieldSet(ix,this,"cells-only")}onCut(r){var n,o;let l=this.hot.getFocusManager().getRefocusElement(),h=null===(n=r.target)||void 0===n?void 0:n.hasAttribute("data-hot-input"),d=null===(o=this.hot.getSelectedRangeLast())||void 0===o?void 0:o.highlight,w=d?this.hot.getCell(d.row,d.col,!0):null;if(!this.hot.isListening()&&!copyPaste_classPrivateFieldGet(iF,this)||this.isEditorOpened()||r.target instanceof HTMLElement&&(h&&r.target!==l||!h&&r.target!==this.hot.rootDocument.body&&w!==r.target))return;r.preventDefault(),this.setCopyableText(),copyPaste_classPrivateFieldSet(iF,this,!1);let y=this.getRangedData(this.copyableRanges),S=!!this.hot.runHooks("beforeCut",y,this.copyableRanges);if(S){let n=(0,ip.P)(y);if(r&&r.clipboardData){let o=(0,iR.bt)(y,this.hot.rootDocument);r.clipboardData.setData("text/plain",n),r.clipboardData.setData("text/html",[iT,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",y,this.copyableRanges)}}onPaste(r){var n,o;let l;let h=this.hot.getFocusManager().getRefocusElement(),d=null===(n=r.target)||void 0===n?void 0:n.hasAttribute("data-hot-input"),w=null===(o=this.hot.getSelectedRangeLast())||void 0===o?void 0:o.highlight,y=w?this.hot.getCell(w.row,w.col,!0):null;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||r.target instanceof HTMLElement&&(d&&r.target!==h||!d&&r.target!==this.hot.rootDocument.body&&y!==r.target))return;if(r.preventDefault(),r&&void 0!==r.clipboardData){let n=(0,R.Nw)(r.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n)){let r=(0,iR.BU)(n,this.hot.rootDocument);l=r.data}else l=r.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(l=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof l&&(l=(0,ip.Q)(l)),void 0===l||l&&0===l.length||!1===this.hot.runHooks("beforePaste",l,this.copyableRanges))return;let[S,b,_,P]=this.populateValues(l);this.hot.selectCell(S,b,Math.min(this.hot.countRows()-1,_),Math.min(this.hot.countCols()-1,P)),this.hot.runHooks("afterPaste",l,this.copyableRanges)}destroy(){super.destroy()}};function _ensureClipboardEventsGetTriggered(r){if((0,T.G6)()){let n=this.hot.getSelectedRangeLast();if(n){let{row:o,col:l}=n.highlight,d=this.hot.getCell(o,l,!0);d&&(0,h.lq)(d,()=>{this.hot.rootDocument.execCommand(r)})}}else this.hot.rootDocument.execCommand(r)}function _countCopiedHeaders(r){let{rows:n}=normalizeRanges(r),o=0;for(let r=0;r<n.length&&!(n[r]>=0);r++)o+=1;return{columnHeadersCount:o}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){let r=this.hot.getSelectedRangeLast();if(r){let{row:n,col:o}=r.highlight,l=this.hot.getCell(n,o,!0);l&&(0,h.l2)(l)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){let r=this.hot.getSelectedRangeLast();if(r){let{row:n,col:o}=r.highlight,l=this.hot.getCell(n,o,!0);null!=l&&l.hasAttribute("contenteditable")&&(0,h.yY)(l)}}}function _onAfterContextMenuDefaultOptions(r){var n,o,l,h,d;r.items.push({name:"---------"},(n=this,{key:"copy",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_COPY)},callback(){n.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1})),copyPaste_classPrivateFieldGet(iM,this)&&r.items.push((o=this,{key:"copy_with_column_headers",name(){let r=this.getSelectedRangeLast(),n=r?(0,ea.uZ)(r.getWidth()-1,0,1):0;return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,n)},callback(){o.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1})),copyPaste_classPrivateFieldGet(iI,this)&&r.items.push((l=this,{key:"copy_with_column_group_headers",name(){let r=this.getSelectedRangeLast(),n=r?(0,ea.uZ)(r.getWidth()-1,0,1):0;return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,n)},callback(){l.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1})),copyPaste_classPrivateFieldGet(iO,this)&&r.items.push((h=this,{key:"copy_column_headers_only",name(){let r=this.getSelectedRangeLast(),n=r?(0,ea.uZ)(r.getWidth()-1,0,1):0;return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,n)},callback(){h.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1})),r.items.push((d=this,{key:"cut",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_CUT)},callback(){d.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let r=this.getSelectedRangeLast();if(!r||r.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1}))}function _onAfterSelection(r,n,o,l,h){copyPaste_classPrivateFieldGet(iH,this)&&(h.value=!0),copyPaste_classPrivateFieldSet(iH,this,!1)}function _onAfterSelectionEnd(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){copyPaste_assertClassBrand(iN,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){copyPaste_assertClassBrand(iN,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){copyPaste_assertClassBrand(iN,this,_removeContentEditableFromHighlightedCell).call(this)}function createId(r,n){return`border_row${r}col${n}`}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function normalizeBorder(r){var n,o;return((0,_.$K)(r.start)||(0,_.$K)(r.left))&&(r.start=null!==(n=r.start)&&void 0!==n?n:r.left),((0,_.$K)(r.end)||(0,_.$K)(r.right))&&(r.end=null!==(o=r.end)&&void 0!==o?o:r.right),delete r.left,delete r.right,r}function denormalizeBorder(r){return(0,_.$K)(r.start)&&(r.left=r.start),(0,_.$K)(r.end)&&(r.right=r.end),r}function createEmptyBorders(r,n){return{id:createId(r,n),border:{width:1,color:"#000",cornerVisible:!1},row:r,col:n,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function checkSelectionBorders(r,n){let o=!1;return(0,b.Bk)(r.getSelectedRange(),l=>{l.forAll((l,h)=>{if(l<0||h<0)return;let d=r.getCellMeta(l,h).borders;if(d&&(!n||!(0,w.nr)(d[n],"hide")||!1===d[n].hide))return o=!0,!1})}),o}function markSelected(r){return`<span class="selected">${String.fromCharCode(10003)}</span>${r}`}let iD=new Map([["left","start"],["right","end"]]);function customBorders_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let iB="customBorders";var iL=new WeakSet;let CustomBorders=class CustomBorders extends BasePlugin{constructor(){var r,n,o;super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,iL),iL.add(this),n=[],(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="savedBorders","string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n}static get PLUGIN_KEY(){return iB}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[iB]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",r=>customBorders_assertClassBrand(iL,this,customBorders_onAfterContextMenuDefaultOptions).call(this,r)),this.addHook("init",()=>customBorders_assertClassBrand(iL,this,customBorders_onAfterInit).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(r,n){let o=["top","bottom","start","end"],l=null;n&&(this.checkSettingsCohesion([n]),o=Object.keys(n),l=normalizeBorder(n));let h=(0,t4.AV)(r),d=(0,t4.S5)(h,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,b.Bk)(r,r=>{d(r).forAll((r,n)=>{(0,b.Bk)(o,o=>{var h;this.prepareBorderFromCustomAdded(r,n,l,null!==(h=iD.get(o))&&void 0!==h?h:o)})})}),this.hot.view.render()}getBorders(r){if(!Array.isArray(r))return this.savedBorders;let n=(0,t4.AV)(r),o=(0,t4.S5)(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),l=[];return(0,b.Bk)(r,r=>{o(r).forAll((r,n)=>{(0,b.Bk)(this.savedBorders,o=>{o.row===r&&o.col===n&&l.push(denormalizeBorder(o))})})}),l}clearBorders(r){r?this.setBorders(r):((0,b.Bk)(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(r,n){let o=this.checkSavedBorders(r);o||this.savedBorders.push(r);let l=this.hot._createCellRange(this.hot._createCellCoords(r.row,r.col)),h=this.checkCustomSelections(r,l,n);h||this.hot.selection.highlight.addCustomSelection({border:r,visualCellRange:l})}prepareBorderFromCustomAdded(r,n,o,l){let h=this.hot.countRows(),d=this.hot.countCols();if(r>=h||n>=d)return;let y=createEmptyBorders(r,n);if(o){var S;S=y,(0,w.nr)(o,"border")&&o.border&&(S.border=o.border),(0,w.nr)(o,"top")&&(0,_.$K)(o.top)&&(o.top?(0,w.Kn)(o.top)||(o.top=createDefaultCustomBorder()):o.top=createSingleEmptyBorder(),S.top=o.top),(0,w.nr)(o,"bottom")&&(0,_.$K)(o.bottom)&&(o.bottom?(0,w.Kn)(o.bottom)||(o.bottom=createDefaultCustomBorder()):o.bottom=createSingleEmptyBorder(),S.bottom=o.bottom),(0,w.nr)(o,"start")&&(0,_.$K)(o.start)&&(o.start?(0,w.Kn)(o.start)||(o.start=createDefaultCustomBorder()):o.start=createSingleEmptyBorder(),S.start=o.start),(0,w.nr)(o,"end")&&(0,_.$K)(o.end)&&(o.end?(0,w.Kn)(o.end)||(o.end=createDefaultCustomBorder()):o.end=createSingleEmptyBorder(),S.end=o.end),y=S,(0,b.Bk)(this.hot.selection.highlight.customSelections,r=>{if(y.id===r.settings.id)return Object.assign(r.settings,o),y.id=r.settings.id,y.top=r.settings.top,y.bottom=r.settings.bottom,y.start=r.settings.start,y.end=r.settings.end,!1})}this.hot.setCellMeta(r,n,"borders",denormalizeBorder(y)),this.insertBorderIntoSettings(y,l)}prepareBorderFromCustomAddedRange(r,n){let o=Math.min(r.to.row,this.hot.countRows()-1),l=Math.min(r.to.col,this.hot.countCols()-1);(0,ea.q4)(r.from.row,o,o=>{(0,ea.q4)(r.from.col,l,l=>{let h=createEmptyBorders(o,l),d=0;o===r.from.row&&(0,w.nr)(n,"top")&&(d+=1,h.top=n.top),o===r.to.row&&(0,w.nr)(n,"bottom")&&(d+=1,h.bottom=n.bottom),l===r.from.col&&(0,w.nr)(n,"start")&&(d+=1,h.start=n.start),l===r.to.col&&(0,w.nr)(n,"end")&&(d+=1,h.end=n.end),d>0&&(this.hot.setCellMeta(o,l,"borders",denormalizeBorder(h)),this.insertBorderIntoSettings(h))})})}removeAllBorders(r,n){let o=createId(r,n);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(r,n,"borders")}setBorder(r,n,o,l){let h=this.hot.getCellMeta(r,n).borders;if(h=h&&void 0!==h.border?normalizeBorder(h):createEmptyBorders(r,n),l){h[o]=createSingleEmptyBorder();let d=this.countHide(h);if(4===d)this.removeAllBorders(r,n);else{let d=this.checkCustomSelectionsFromContextMenu(h,o,l);d||this.insertBorderIntoSettings(h),this.hot.setCellMeta(r,n,"borders",denormalizeBorder(h))}}else{h[o]=createDefaultCustomBorder();let d=this.checkCustomSelectionsFromContextMenu(h,o,l);d||this.insertBorderIntoSettings(h),this.hot.setCellMeta(r,n,"borders",denormalizeBorder(h))}}prepareBorder(r,n,o){(0,b.Bk)(r,r=>{let{start:l,end:h}=r;if(l.row===h.row&&l.col===h.col)"noBorders"===n?this.removeAllBorders(l.row,l.col):this.setBorder(l.row,l.col,n,o);else switch(n){case"noBorders":(0,ea.q4)(l.col,h.col,r=>{(0,ea.q4)(l.row,h.row,n=>{this.removeAllBorders(n,r)})});break;case"top":(0,ea.q4)(l.col,h.col,r=>{this.setBorder(l.row,r,n,o)});break;case"bottom":(0,ea.q4)(l.col,h.col,r=>{this.setBorder(h.row,r,n,o)});break;case"start":(0,ea.q4)(l.row,h.row,r=>{this.setBorder(r,l.col,n,o)});break;case"end":(0,ea.q4)(l.row,h.row,r=>{this.setBorder(r,h.col,n,o)})}})}createCustomBorders(r){(0,b.Bk)(r,r=>{let n=normalizeBorder(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(r){let{top:n,bottom:o,start:l,end:h}=r,d=[n,o,l,h];return(0,b.k$)(d,(r,n)=>{let o=r;return n&&n.hide&&(o+=1),o},0)}clearBordersFromSelectionSettings(r){let n=(0,b.Sc)(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(r);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){(0,b.Bk)(this.hot.selection.highlight.customSelections,(r,n)=>{if(null===r.cellRange)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){(0,b.Bk)(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange()})}spliceBorder(r){let n=(0,b.Sc)(this.savedBorders,r=>r.id).indexOf(r);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(r){let n=!1,o=this.countHide(r);return 4===o?(this.spliceBorder(r.id),n=!0):(0,b.Bk)(this.savedBorders,(o,l)=>{if(r.id===o.id)return this.savedBorders[l]=r,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(r,n,o){let l=!1;return(0,b.Bk)(this.hot.selection.highlight.customSelections,h=>{if(r.id===h.settings.id){let r=this.hot.view._wt.selectionManager.getBorderInstances(h);return(0,b.Bk)(r,r=>{r.toggleHiddenClass(n,o)}),l=!0,!1}}),l}checkCustomSelections(r,n,o){let l=this.countHide(r),h=!1;return 4===l?(this.removeAllBorders(r.row,r.col),h=!0):(0,b.Bk)(this.hot.selection.highlight.customSelections,l=>{if(r.id===l.settings.id){if(l.visualCellRange=n,l.commit(),o){let n=this.hot.view._wt.selectionManager.getBorderInstances(l);(0,b.Bk)(n,n=>{n.changeBorderStyle(o,r)})}return h=!0,!1}}),h}changeBorderSettings(){let r=this.hot.getSettings()[iB];if(Array.isArray(r)){let n=(0,w.I8)(r);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else void 0!==r&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(r){let n=r.some(r=>(0,_.$K)(r.left)||(0,_.$K)(r.right)),o=r.some(r=>(0,_.$K)(r.start)||(0,_.$K)(r.end));if(n&&o)throw Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}};function customBorders_onAfterContextMenuDefaultOptions(r){var n,o,l;this.hot.getSettings()[iB]&&r.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_BORDERS)},disabled(){let r=this.getSelectedRangeLast();return!!(!r||r.isSingleHeader())||this.selection.isSelectedByCorner()},submenu:{items:[(n=this,{key:"borders:top",name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_BORDERS_TOP),n=checkSelectionBorders(this,"top");return n&&(r=markSelected(r)),r},callback(r,o){let l=checkSelectionBorders(this,"top");n.prepareBorder(o,"top",l)}}),function(r){let n=r.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_BORDERS_RIGHT),o=checkSelectionBorders(this,n);return o&&(r=markSelected(r)),r},callback(o,l){let h=checkSelectionBorders(this,n);r.prepareBorder(l,n,h)}}}(this),(o=this,{key:"borders:bottom",name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_BORDERS_BOTTOM),n=checkSelectionBorders(this,"bottom");return n&&(r=markSelected(r)),r},callback(r,n){let l=checkSelectionBorders(this,"bottom");o.prepareBorder(n,"bottom",l)}}),function(r){let n=r.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_BORDERS_LEFT),o=checkSelectionBorders(this,n);return o&&(r=markSelected(r)),r},callback(o,l){let h=checkSelectionBorders(this,n);r.prepareBorder(l,n,h)}}}(this),(l=this,{key:"borders:no_borders",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(r,n){l.prepareBorder(n,"noBorders")},disabled(){return!checkSelectionBorders(this)}})]}})}function customBorders_onAfterInit(){this.changeBorderSettings()}function dragToScroll_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function dragToScroll_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let iV="dragToScroll";var iG=new WeakSet;let DragToScroll=class DragToScroll extends BasePlugin{constructor(){super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,iG),iG.add(this),dragToScroll_defineProperty(this,"boundaries",null),dragToScroll_defineProperty(this,"callback",null),dragToScroll_defineProperty(this,"listening",!1)}static get PLUGIN_KEY(){return iV}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[iV]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",r=>dragToScroll_assertClassBrand(iG,this,_setupListening).call(this,r)),this.addHook("afterOnCellCornerMouseDown",r=>dragToScroll_assertClassBrand(iG,this,_setupListening).call(this,r)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=r}setCallback(r){this.callback=r}check(r,n){let o=0,l=0;n<this.boundaries.top?l=n-this.boundaries.top:n>this.boundaries.bottom&&(l=n-this.boundaries.bottom),r<this.boundaries.left?o=r-this.boundaries.left:r>this.boundaries.right&&(o=r-this.boundaries.right),this.callback(o,l)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:r}=this.hot,n=r;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=(0,h.f5)(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(r){this.isListening()&&this.check(r.clientX,r.clientY)}destroy(){super.destroy()}};function _setupListening(r){if((0,d.dO)(r))return;let n=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(n!==this.hot.rootWindow?n.getBoundingClientRect():void 0),this.setCallback((r,o)=>{var l,h;let d=null!==(l=n.scrollLeft)&&void 0!==l?l:n.scrollX,w=null!==(h=n.scrollTop)&&void 0!==h?h:n.scrollY;n.scroll(d+50*Math.sign(r),w+20*Math.sign(o))}),this.listen()}function dropdownMenu_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function dropdownMenu_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function dropdownMenu_classPrivateFieldSet(r,n,o){return r.set(dropdownMenu_assertClassBrand(r,n),o),o}function dropdownMenu_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("afterDropdownMenuDefaultOptions"),K.Z.getSingleton().register("beforeDropdownMenuShow"),K.Z.getSingleton().register("afterDropdownMenuShow"),K.Z.getSingleton().register("afterDropdownMenuHide"),K.Z.getSingleton().register("afterDropdownMenuExecute");let iW="dropdownMenu",iz="changeType";var ij=new WeakMap,iU=new WeakSet;let DropdownMenu=class DropdownMenu extends BasePlugin{static get PLUGIN_KEY(){return iW}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[t0,t1,tB,t3,tB,tQ,tB,t2,tB,tJ]}constructor(r){super(r),dropdownMenu_checkPrivateRedeclaration(this,iU),iU.add(this),dropdownMenu_defineProperty(this,"commandExecutor",new CommandExecutor(this.hot)),dropdownMenu_defineProperty(this,"itemsFactory",null),dropdownMenu_defineProperty(this,"menu",null),dropdownMenu_checkPrivateRedeclaration(this,ij),ij.set(this,!1),this.hot.addHook("afterGetColHeader",(r,n)=>dropdownMenu_assertClassBrand(iU,this,dropdownMenu_onAfterGetColHeader).call(this,r,n))}isEnabled(){return this.hot.getSettings()[iW]}enablePlugin(){var r=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,DropdownMenu.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return dropdownMenu_assertClassBrand(iU,r,dropdownMenu_onBeforeOnCellMouseDown).call(r,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return dropdownMenu_assertClassBrand(iU,r,_onBeforeViewportScrollHorizontally).call(r,...o)});let n=this.hot.getSettings()[iW],o={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);let l=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",l),this.menu.setMenuItems(l),this.menu.addLocalHook("beforeOpen",()=>dropdownMenu_assertClassBrand(iU,this,dropdownMenu_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>dropdownMenu_assertClassBrand(iU,this,dropdownMenu_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterSubmenuOpen",r=>dropdownMenu_assertClassBrand(iU,this,_onSubMenuAfterOpen).call(this,r)),this.menu.addLocalHook("afterClose",()=>dropdownMenu_assertClassBrand(iU,this,dropdownMenu_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return r.executeCommand.call(r,...o)}),(0,b.Bk)(l,r=>this.commandExecutor.registerCommand(r.key,r))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let r=this.hot.getShortcutManager().getContext("grid"),callback=()=>{let{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&-1===r.row||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);let{from:n}=this.hot.getSelectedRangeLast(),o=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),l=this.hot.getCell(-1,n.col,!0).querySelector(`.${iz}`),h=l.getBoundingClientRect();this.open({left:h.left+o.left,top:h.top+l.offsetHeight+o.top},{left:h.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};r.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback,runOnlyIf:()=>{var r;let n=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:iW},{keys:[["Shift","Alt","ArrowDown"]],callback,runOnlyIf:()=>{var r;let n=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isCell()&&!this.menu.isOpened()},group:iW}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iW)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",r=>dropdownMenu_assertClassBrand(iU,this,_onTableClick).call(this,r))}open(r){var n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(n=this.menu)&&void 0!==n&&n.isOpened()||(this.menu.open(),(0,w._l)(o,(r,n)=>{this.menu.setOffset(n,r)}),this.menu.setPosition(r))}close(){var r;null===(r=this.menu)||void 0===r||r.close()}executeCommand(r){for(var n=arguments.length,o=Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];this.commandExecutor.execute(r,...o)}setListening(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.menu.isOpened()&&(r?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function _addCustomShortcuts(r){r.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(r){if((0,h.pv)(r.target,iz)){let n=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),o=r.target.getBoundingClientRect();r.stopPropagation(),dropdownMenu_classPrivateFieldSet(ij,this,!1),this.open({left:o.left+n.left,top:o.top+r.target.offsetHeight+n.top},{left:o.width,right:0,above:0,below:3})}}function dropdownMenu_onAfterGetColHeader(r,n){let o=n.parentNode;if(!o)return;let l=o.parentNode.childNodes,d=Array.prototype.indexOf.call(l,o);if(r<0||d!==l.length-1)return;let w=n.querySelector(`.${iz}`);if(this.enabled&&w)return;if(!this.enabled){w&&w.parentNode.removeChild(w);return}let y=this.hot.rootDocument.createElement("button");y.className=iz,y.type="button",y.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,h.P$)(y,[(0,O.cV)(),(0,O.QK)(" ")]),(0,h.P$)(n,[(0,O.fv)("menu")])),y.onclick=function(){return!1},n.firstChild.insertBefore(y,n.firstChild.firstChild)}function dropdownMenu_onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}function dropdownMenu_onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),dropdownMenu_assertClassBrand(iU,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(r){dropdownMenu_assertClassBrand(iU,this,_addCustomShortcuts).call(this,r)}function dropdownMenu_onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally(r){return ij.get(dropdownMenu_assertClassBrand(ij,this))?null:r}function dropdownMenu_onBeforeOnCellMouseDown(r){(0,h.pv)(r.target,iz)&&dropdownMenu_classPrivateFieldSet(ij,this,!0)}function dataProvider_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}DropdownMenu.SEPARATOR={name:tB};var i$=class{constructor(r){dataProvider_defineProperty(this,"hot",void 0),dataProvider_defineProperty(this,"options",{}),this.hot=r}setOptions(r){this.options=r}getData(){let{startRow:r,startCol:n,endRow:o,endCol:l}=this._getDataRange(),h=this.options,d=[];return(0,ea.q4)(r,o,r=>{let o=[];!h.exportHiddenRows&&this._isHiddenRow(r)||((0,ea.q4)(n,l,n=>{!h.exportHiddenColumns&&this._isHiddenColumn(n)||o.push(this.hot.getDataAtCell(r,n))}),d.push(o))}),d}getRowHeaders(){let r=[];if(this.options.rowHeaders){let{startRow:n,endRow:o}=this._getDataRange(),l=this.hot.getRowHeader();(0,ea.q4)(n,o,n=>{!this.options.exportHiddenRows&&this._isHiddenRow(n)||r.push(l[n])})}return r}getColumnHeaders(){let r=[];if(this.options.columnHeaders){let{startCol:n,endCol:o}=this._getDataRange(),l=this.hot.getColHeader();(0,ea.q4)(n,o,n=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(n)||r.push(l[n])})}return r}_getDataRange(){let r=this.hot.countCols()-1,n=this.hot.countRows()-1,[o=0,l=0,h=n,d=r]=this.options.range;return o=Math.max(o,0),{startRow:o,startCol:l=Math.max(l,0),endRow:h=Math.min(h,n),endCol:d=Math.min(d,r)}}_isHiddenRow(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}_isHiddenColumn(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}};function _base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let BaseType=class BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(r,n){_base_defineProperty(this,"dataProvider",void 0),_base_defineProperty(this,"options",void 0),this.dataProvider=r,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(r){let n=(0,w.d9)(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=(0,w.l7)((0,w.d9)(BaseType.DEFAULT_OPTIONS),n),(n=(0,w.l7)(n,r)).filename=(0,R.ng)(n.filename,{YYYY:o.getFullYear(),MM:`${o.getMonth()+1}`.padStart(2,"0"),DD:`${o.getDate()}`.padStart(2,"0")}),n}};var iK=BaseType,iY=class extends iK{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){let r=this.options,n=this.dataProvider.getData(),o=this.dataProvider.getColumnHeaders(),l=o.length>0,h=this.dataProvider.getRowHeaders(),d=h.length>0,w=r.bom?String.fromCharCode(65279):"";return l&&(o=(0,b.Sc)(o,r=>this._escapeCell(r,!0)),d&&(w+=r.columnDelimiter),w+=o.join(r.columnDelimiter)+r.rowDelimiter),(0,b.Bk)(n,(n,o)=>{o>0&&(w+=r.rowDelimiter),d&&(w+=this._escapeCell(h[o])+r.columnDelimiter),w+=n.map(r=>this._escapeCell(r)).join(r.columnDelimiter)}),w}_escapeCell(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=(0,_.Pz)(r);return""!==o&&(n||o.indexOf("\r")>=0||o.indexOf('"')>=0||o.indexOf("\n")>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(RegExp('"',"g"),'""'),o=`"${o}"`),o}};let iX={csv:iY};let ExportFile=class ExportFile extends BasePlugin{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(r,n).export()}exportAsBlob(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(r,n))}downloadFile(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{rootDocument:o,rootWindow:l}=this.hot,h=this._createTypeFormatter(r,n),d=this._createBlob(h),w=l.URL||l.webkitURL,y=o.createElement("a"),S=`${h.options.filename}.${h.options.fileExtension}`;if(void 0!==y.download){let r=w.createObjectURL(d);y.style.display="none",y.setAttribute("href",r),y.setAttribute("download",S),o.body.appendChild(y),y.dispatchEvent(new MouseEvent("click")),o.body.removeChild(y),setTimeout(()=>{w.revokeObjectURL(r)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(d,S)}_createTypeFormatter(r){var n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!iX[r])throw Error(`Export format type "${r}" is not supported.`);return n=new i$(this.hot),"function"==typeof iX[r]?new iX[r](n,o):null}_createBlob(r){let n=null;return"undefined"!=typeof Blob&&(n=new Blob([r.export()],{type:`${r.options.mimeType};charset=${r.options.encoding}`})),n}};function component_base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}o(21767);let BaseComponent=class BaseComponent{constructor(r,n){let{id:o,stateless:l=!0}=n;component_base_defineProperty(this,"hot",void 0),component_base_defineProperty(this,"id",void 0),component_base_defineProperty(this,"elements",[]),component_base_defineProperty(this,"hidden",!1),component_base_defineProperty(this,"stateId",""),component_base_defineProperty(this,"state",void 0),this.hot=r,this.id=o,this.stateId=`Filters.component.${this.id}`,this.state=l?null:this.hot.columnIndexMapper.registerMap(this.stateId,new tt.A)}getElements(){return this.elements}reset(){(0,b.Bk)(this.elements,r=>r.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(r){this.state&&this.setState(this.state.getValueAtIndex(r))}setState(){throw Error("The state setting logic is not implemented")}saveState(r){this.state&&this.state.setValueAtIndex(r,this.getState())}getState(){throw Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,b.Bk)(this.elements,r=>r.destroy()),this.state=null,this.elements=null,this.hot=null}};(0,w.jB)(BaseComponent,tE.Z);let iq={};function getCondition(r,n){if(!iq[r])throw Error(`Filter condition "${r}" does not exist.`);let{condition:o,descriptor:l}=iq[r],h=n;return l.inputValuesDecorator&&(h=l.inputValuesDecorator(h)),function(r){return o.apply(r.meta.instance,[].concat([r],[h]))}}function getConditionDescriptor(r){if(!iq[r])throw Error(`Filter condition "${r}" does not exist.`);return iq[r].descriptor}function registerCondition(r,n,o){o.key=r,iq[r]={condition:n,descriptor:o}}let iZ="none";registerCondition(iZ,function(){return!0},{name:et.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});let iJ="empty";registerCondition(iJ,function(r){return(0,_.xb)(r.value)},{name:et.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});let iQ="not_empty";registerCondition(iQ,function(r,n){return!getCondition(iJ,n)(r)},{name:et.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0}),registerCondition("eq",function(r,n){let[o]=n;return(0,_.Pz)(r.value).toLocaleLowerCase(r.meta.locale)===(0,_.Pz)(o)},{name:et.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0}),registerCondition("neq",function(r,n){return!getCondition("eq",n)(r)},{name:et.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0}),registerCondition("gt",function(r,n){let[o]=n,l=o;return"numeric"===r.meta.type&&(l=parseFloat(l,10)),r.value>l},{name:et.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0}),registerCondition("gte",function(r,n){let[o]=n,l=o;return"numeric"===r.meta.type&&(l=parseFloat(l,10)),r.value>=l},{name:et.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0}),registerCondition("lt",function(r,n){let[o]=n,l=o;return"numeric"===r.meta.type&&(l=parseFloat(l,10)),r.value<l},{name:et.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0}),registerCondition("lte",function(r,n){let[o]=n,l=o;return"numeric"===r.meta.type&&(l=parseFloat(l,10)),r.value<=l},{name:et.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});let i0="date_after";registerCondition(i0,function(r,n){let[o]=n,l=L(r.value,r.meta.dateFormat),h=L(o,r.meta.dateFormat);return!!(l.isValid()&&h.isValid())&&l.diff(h)>=0},{name:et.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});let i1="date_before";registerCondition(i1,function(r,n){let[o]=n,l=L(r.value,r.meta.dateFormat),h=L(o,r.meta.dateFormat);return!!(l.isValid()&&h.isValid())&&0>=l.diff(h)},{name:et.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});let i2="between";registerCondition(i2,function(r,n){let[o,l]=n,h=o,d=l;if("numeric"===r.meta.type){let r=parseFloat(h,10),n=parseFloat(d,10);h=Math.min(r,n),d=Math.max(r,n)}else if("date"===r.meta.type){let n=getCondition(i1,[d]),o=getCondition(i0,[h]);return n(r)&&o(r)}return r.value>=h&&r.value<=d},{name:et.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});let i5="not_between";registerCondition(i5,function(r,n){return!getCondition(i2,n)(r)},{name:et.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});let i4="begins_with";registerCondition(i4,function(r,n){let[o]=n;return(0,_.Pz)(r.value).toLocaleLowerCase(r.meta.locale).startsWith((0,_.Pz)(o))},{name:et.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});let i3="ends_with";registerCondition(i3,function(r,n){let[o]=n;return(0,_.Pz)(r.value).toLocaleLowerCase(r.meta.locale).endsWith((0,_.Pz)(o))},{name:et.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});let i8="contains";registerCondition(i8,function(r,n){let[o]=n;return(0,_.Pz)(r.value).toLocaleLowerCase(r.meta.locale).indexOf((0,_.Pz)(o))>=0},{name:et.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});let i9="not_contains";registerCondition(i9,function(r,n){return!getCondition(i8,n)(r)},{name:et.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});let i7="date_tomorrow";registerCondition(i7,function(r){let n=L(r.value,r.meta.dateFormat);return!!n.isValid()&&n.isSame(L().subtract(-1,"days").startOf("day"),"d")},{name:et.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});let i6="date_today";registerCondition(i6,function(r){let n=L(r.value,r.meta.dateFormat);return!!n.isValid()&&n.isSame(L().startOf("day"),"d")},{name:et.FILTERS_CONDITIONS_TODAY,inputsCount:0});let re="date_yesterday";registerCondition(re,function(r){let n=L(r.value,r.meta.dateFormat);return!!n.isValid()&&n.isSame(L().subtract(1,"days").startOf("day"),"d")},{name:et.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});let rt="text",ri={numeric:[iZ,tB,iJ,iQ,tB,"eq","neq",tB,"gt","gte","lt","lte",i2,i5],[rt]:[iZ,tB,iJ,iQ,tB,"eq","neq",tB,i4,i3,tB,i8,i9],date:[iZ,tB,iJ,iQ,tB,"eq","neq",tB,i1,i0,i2,tB,i7,i6,re]};function ui_base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let rr="built",rn="building",rs=["click","input","keydown","keypress","keyup","focus","blur","change"];let BaseUI=class BaseUI{static get DEFAULTS(){return(0,w.d9)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(r,n){ui_base_defineProperty(this,"hot",void 0),ui_base_defineProperty(this,"eventManager",new ee.Z(this)),ui_base_defineProperty(this,"options",void 0),ui_base_defineProperty(this,"_element",void 0),ui_base_defineProperty(this,"buildState",void 0),this.hot=r,this.options=(0,w.l7)(BaseUI.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(r){this.options.value=r,this.update()}getValue(){return this.options.value}get element(){return this.buildState===rn||(this.buildState===rr?this.update():(this.buildState=rn,this.build(),this.buildState=rr)),this._element}isBuilt(){return this.buildState===rr}translateIfPossible(r){return"string"==typeof r&&r.startsWith(et.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(r):r}build(){let registerEvent=(r,n)=>{this.eventManager.addEventListener(r,n,r=>this.runLocalHooks(n,r,this))};if(this.buildState||(this.buildState=rn),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,h.cn)(this._element,this.options.className),this.options.children.length)(0,b.Bk)(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){let r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),(0,w._l)(this.options,(n,o)=>{void 0!==r[o]&&"className"!==o&&"tagName"!==o&&"children"!==o&&(r[o]=this.translateIfPossible(n))}),this._element.appendChild(r),(0,b.Bk)(rs,n=>registerEvent(r,n))}else(0,b.Bk)(rs,r=>registerEvent(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};function input_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function input_classPrivateFieldGet(r,n){return r.get(input_assertClassBrand(r,n))}function input_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}(0,w.jB)(BaseUI,tE.Z);var ro=new WeakMap,rl=new WeakSet;let InputUI=class InputUI extends BaseUI{static get DEFAULTS(){return(0,w.d9)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(r,n){super(r,(0,w.l7)(InputUI.DEFAULTS,n)),input_checkPrivateRedeclaration(this,rl),rl.add(this),input_checkPrivateRedeclaration(this,ro),ro.set(this,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",r=>input_assertClassBrand(rl,this,_onKeyup).call(this,r))}build(){var r;super.build();let n=this.hot.rootDocument.createElement("div");r=this._element.firstChild,ro.set(input_assertClassBrand(ro,this),r),(0,h.cn)(this._element,"htUIInput"),(0,h.cn)(n,"htUIInputIcon"),this._element.appendChild(n),this.update()}update(){this.isBuilt()&&(input_classPrivateFieldGet(ro,this).type=this.options.type,input_classPrivateFieldGet(ro,this).placeholder=this.translateIfPossible(this.options.placeholder),input_classPrivateFieldGet(ro,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&input_classPrivateFieldGet(ro,this).focus()}};function _onKeyup(r){this.options.value=r.target.value}function select_classPrivateFieldInitSpec(r,n,o){select_checkPrivateRedeclaration(r,n),n.set(r,o)}function select_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function select_classPrivateFieldSet(r,n,o){return r.set(select_assertClassBrand(r,n),o),o}function select_classPrivateFieldGet(r,n){return r.get(select_assertClassBrand(r,n))}function select_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var ra=new WeakMap,rh=new WeakMap,rd=new WeakMap,rc=new WeakMap,ru=new WeakMap,rg=new WeakSet;let SelectUI=class SelectUI extends BaseUI{static get DEFAULTS(){return(0,w.d9)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(r,n){super(r,(0,w.l7)(SelectUI.DEFAULTS,n)),select_checkPrivateRedeclaration(this,rg),rg.add(this),select_classPrivateFieldInitSpec(this,ra,null),select_classPrivateFieldInitSpec(this,rh,[]),select_classPrivateFieldInitSpec(this,rd,void 0),select_classPrivateFieldInitSpec(this,rc,void 0),select_classPrivateFieldInitSpec(this,ru,void 0),this.registerHooks()}getMenu(){return select_classPrivateFieldGet(ra,this)}registerHooks(){this.addLocalHook("click",()=>select_assertClassBrand(rg,this,_onClick).call(this))}setItems(r){select_classPrivateFieldSet(rh,this,this.translateNames(r)),select_classPrivateFieldGet(ra,this)&&select_classPrivateFieldGet(ra,this).setMenuItems(select_classPrivateFieldGet(rh,this))}translateNames(r){return(0,b.Bk)(r,r=>{r.name=this.translateIfPossible(r.name)}),r}build(){super.build(),select_classPrivateFieldSet(ra,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),select_classPrivateFieldGet(ra,this).setMenuItems(select_classPrivateFieldGet(rh,this));let r=new BaseUI(this.hot,{className:"htUISelectCaption"}),n=new BaseUI(this.hot,{className:"htUISelectDropdown"});select_classPrivateFieldSet(rd,this,r),select_classPrivateFieldSet(rc,this,r.element),select_classPrivateFieldSet(ru,this,n),this.hot.getSettings().ariaTags&&((0,h.P$)(n.element,[(0,O.cV)()]),(0,h.P$)(this._element,[(0,O.a6)()])),(0,b.Bk)([r,n],r=>this._element.appendChild(r.element)),select_classPrivateFieldGet(ra,this).addLocalHook("select",r=>select_assertClassBrand(rg,this,_onMenuSelect).call(this,r)),select_classPrivateFieldGet(ra,this).addLocalHook("afterClose",()=>select_assertClassBrand(rg,this,_onMenuClosed).call(this)),this.update()}update(){let r;this.isBuilt()&&(r=this.options.value?this.options.value.name:select_classPrivateFieldGet(ra,this).hot.getTranslatedPhrase(et.FILTERS_CONDITIONS_NONE),select_classPrivateFieldGet(rc,this).textContent=r,super.update())}openOptions(){let r=this.element.getBoundingClientRect();select_classPrivateFieldGet(ra,this)&&(select_classPrivateFieldGet(ra,this).open(),select_classPrivateFieldGet(ra,this).setPosition({left:this.hot.isLtr()?r.left-5:r.left-31,top:r.top-1,width:r.width,height:r.height}),select_classPrivateFieldGet(ra,this).getNavigator().toFirstItem(),select_classPrivateFieldGet(ra,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){select_classPrivateFieldGet(ra,this)&&select_classPrivateFieldGet(ra,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){select_classPrivateFieldGet(ra,this)&&(select_classPrivateFieldGet(ra,this).destroy(),select_classPrivateFieldSet(ra,this,null)),select_classPrivateFieldGet(rd,this)&&select_classPrivateFieldGet(rd,this).destroy(),select_classPrivateFieldGet(ru,this)&&select_classPrivateFieldGet(ru,this).destroy(),super.destroy()}};function _onMenuSelect(r){r.name!==tB&&(this.options.value=r,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}function condition_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function condition_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var rf=new WeakSet;let ConditionComponent=class ConditionComponent extends BaseComponent{constructor(r,n){super(r,{id:n.id,stateless:!1}),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,rf),rf.add(this),condition_defineProperty(this,"name",""),condition_defineProperty(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:et.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:et.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",r=>condition_assertClassBrand(rf,this,_onConditionSelect).call(this,r)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",r=>this.runLocalHooks("selectTabKeydown",r)),(0,b.Bk)(this.getInputElements(),r=>{r.addLocalHook("keydown",r=>condition_assertClassBrand(rf,this,_onInputKeyDown).call(this,r))})}setState(r){if(this.reset(),!r)return;let n=(0,w.d9)(r.command);n.name.startsWith(et.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),(0,b.Bk)(r.args,(r,o)=>{if(o>n.inputsCount-1)return!1;let l=this.getInputElement(o);l.setValue(r),l[n.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout(()=>l.focus(),10)})}getState(){let r=this.getSelectElement().getValue()||getConditionDescriptor(iZ),n=[];return(0,b.Bk)(this.getInputElements(),(o,l)=>{r.inputsCount>l&&n.push(o.getValue())}),{command:r,args:n}}updateState(r,n){let o=r?getConditionDescriptor(r.name):getConditionDescriptor(iZ);this.state.setValueAtIndex(n,{command:o,args:r?r.args:[]}),r||(0,b.Bk)(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(r=>r instanceof SelectUI)[0]}getInputElement(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[r]}getInputElements(){return this.elements.filter(r=>r instanceof InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(r,n,o,l,d,w)=>{(0,h.cn)(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,h.cn)(n.parentNode,"border");let y=this.hot.rootDocument.createElement("div");return(0,h.cn)(y,"htFiltersMenuLabel"),y.textContent=w,n.appendChild(y),n.parentElement.hasAttribute("ghost-table")||(0,b.Bk)(this.elements,r=>n.appendChild(r.element)),n}}}reset(){let r=this.hot.getPlugin("filters").getSelectedColumn(),n=[getConditionDescriptor(iZ)];if(null!==r){let{visualIndex:o}=r;n=function(r){let n=[],o=r;return ri[o]||(o=rt),(0,b.Bk)(ri[o],r=>{let o;o=r===tB?{name:tB}:(0,w.d9)(getConditionDescriptor(r)),n.push(o)}),n}(this.hot.getDataType(0,o,this.hot.countRows(),o))}(0,b.Bk)(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}};function _onConditionSelect(r){(0,b.Bk)(this.getInputElements(),(n,o)=>{n[r.inputsCount>o?"show":"hide"](),0===o&&this.hot._registerTimeout(()=>n.focus(),10)}),this.runLocalHooks("change",r)}function _onInputKeyDown(r){(0,P.ot)(r.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,d.mM)(r))}let rm={};function registerOperation(r,n,o){rm[r]={name:n,func:o}}let rp="conjunction",rv=et.FILTERS_LABELS_CONJUNCTION;registerOperation(rp,rv,function(r,n){return r.every(r=>r.func(n))});let rC="disjunction",rw=et.FILTERS_LABELS_DISJUNCTION;registerOperation(rC,rw,function(r,n){return r.some(r=>r.func(n))});let ry="disjunctionWithExtraCondition",rS=et.FILTERS_LABELS_DISJUNCTION;function radioInput_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function radioInput_classPrivateFieldGet(r,n){return r.get(radioInput_assertClassBrand(r,n))}function radioInput_classPrivateFieldSet(r,n,o){return r.set(radioInput_assertClassBrand(r,n),o),o}function radioInput_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}registerOperation(ry,rS,function(r,n){if(r.length<3)throw Error("Operation doesn't work on less then three conditions.");return r.slice(0,r.length-1).some(r=>r.func(n))&&r[r.length-1].func(n)});var rb=new WeakMap,r_=new WeakMap;let RadioInputUI=class RadioInputUI extends BaseUI{static get DEFAULTS(){return(0,w.d9)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(r,n){super(r,(0,w.l7)(RadioInputUI.DEFAULTS,n)),radioInput_classPrivateFieldInitSpec(this,rb,void 0),radioInput_classPrivateFieldInitSpec(this,r_,void 0)}build(){super.build();let r=this.hot.rootDocument.createElement("label");r.textContent=this.translateIfPossible(this.options.label.textContent),r.htmlFor=this.translateIfPossible(this.options.label.htmlFor),radioInput_classPrivateFieldSet(r_,this,r),radioInput_classPrivateFieldSet(rb,this,this._element.firstChild),radioInput_classPrivateFieldGet(rb,this).checked=this.options.checked,this._element.appendChild(r),this.update()}update(){this.isBuilt()&&(radioInput_classPrivateFieldGet(r_,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&radioInput_classPrivateFieldGet(rb,this).checked}setChecked(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isBuilt()&&(radioInput_classPrivateFieldGet(rb,this).checked=r)}focus(){this.isBuilt()&&radioInput_classPrivateFieldGet(rb,this).focus()}};var rR=new WeakSet;let OperatorsComponent=class OperatorsComponent extends BaseComponent{constructor(r,n){var o,l;super(r,{id:n.id,stateless:!1}),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,rR),rR.add(this),(o="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(o="name","string"))?l:l+"")in this?Object.defineProperty(this,o,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[o]="",this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(r,n)=>((0,h.cn)(n.parentNode,"htFiltersMenuOperators"),(0,b.Bk)(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){let r=[rp,rC];(0,b.Bk)(r,n=>{let o=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:n,textContent:rm[n].name},value:n,checked:n===r[0],id:n});o.addLocalHook("change",r=>(function(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")})(rR,this,_onRadioInputChange).call(this,r)),this.elements.push(o)})}setChecked(r){if(this.elements.length<r)throw Error(t_.e`Radio button with index ${r} doesn't exist.`);(0,b.Bk)(this.elements,(n,o)=>{n.setChecked(o===r)})}getActiveOperationId(){let r=this.elements.find(r=>r instanceof RadioInputUI&&r.isChecked());return r?r.getValue():rp}getState(){return this.getActiveOperationId()}setState(r){this.reset(),r&&this.getActiveOperationId()!==r&&(0,b.Bk)(this.elements,n=>{n.setChecked(n.getValue()===r)})}updateState(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rp,n=arguments.length>1?arguments[1]:void 0,o=r;o===ry&&(o=rC),this.state.setValueAtIndex(n,o)}reset(){this.setChecked(0)}};function _onRadioInputChange(r){this.setState(r.target.value)}(0,eI.sx)();let rP=new Set([1]).has(1),rE=rP&&"function"==typeof Array.from;function createArrayAssertion(r){let n=r;return rP&&(n=new Set(n)),function(r){return rP?n.has(r):!!~n.indexOf(r)}}function toEmptyString(r){return null==r?"":r}function unifyColumnValues(r){let n=r;return(n=rE?Array.from(new Set(n)):(0,b.uW)(n)).sort((r,n)=>"number"==typeof r&&"number"==typeof n?r-n:r===n?0:r>n?1:-1)}function intersectValues(r,n,o,l){let h;let d=[],w=r===n;return w||(h=createArrayAssertion(n)),(0,b.Bk)(r,r=>{let n,y=!1;(w||h(r))&&(y=!0);let S={checked:y,value:r,visualValue:(""===(n=r)&&(n=`(${o})`),n)};l&&l(S),d.push(S)}),d}var rT=o(77628);function link_classPrivateFieldGet(r,n){return r.get(link_assertClassBrand(r,n))}function link_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var rM=new WeakMap;let LinkUI=class LinkUI extends BaseUI{static get DEFAULTS(){return(0,w.d9)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(r,n){super(r,(0,w.l7)(LinkUI.DEFAULTS,n)),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,rM),rM.set(this,void 0)}build(){var r;super.build(),r=this._element.firstChild,rM.set(link_assertClassBrand(rM,this),r)}update(){this.isBuilt()&&(link_classPrivateFieldGet(rM,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&link_classPrivateFieldGet(rM,this).focus()}activate(){link_classPrivateFieldGet(rM,this).click()}};function multipleSelect_classPrivateFieldInitSpec(r,n,o){multipleSelect_checkPrivateRedeclaration(r,n),n.set(r,o)}function multipleSelect_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function multipleSelect_classPrivateFieldGet(r,n){return r.get(multipleSelect_assertClassBrand(r,n))}function multipleSelect_classPrivateFieldSet(r,n,o){return r.set(multipleSelect_assertClassBrand(r,n),o),o}function multipleSelect_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let rI="multipleSelect.itemBox";var rO=new WeakMap,rx=new WeakMap,rA=new WeakMap,rF=new WeakMap,rk=new WeakMap,rH=new WeakMap,rN=new WeakSet;let MultipleSelectUI=class MultipleSelectUI extends BaseUI{static get DEFAULTS(){return(0,w.d9)({className:"htUIMultipleSelect",value:[]})}constructor(r,n){super(r,(0,w.l7)(MultipleSelectUI.DEFAULTS,n)),multipleSelect_checkPrivateRedeclaration(this,rN),rN.add(this),multipleSelect_classPrivateFieldInitSpec(this,rO,[]),multipleSelect_classPrivateFieldInitSpec(this,rx,void 0),multipleSelect_classPrivateFieldInitSpec(this,rA,void 0),multipleSelect_classPrivateFieldInitSpec(this,rF,void 0),multipleSelect_classPrivateFieldInitSpec(this,rk,void 0),multipleSelect_classPrivateFieldInitSpec(this,rH,void 0),multipleSelect_classPrivateFieldSet(rF,this,new InputUI(this.hot,{placeholder:et.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),multipleSelect_classPrivateFieldSet(rk,this,new LinkUI(this.hot,{textContent:et.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),multipleSelect_classPrivateFieldSet(rH,this,new LinkUI(this.hot,{textContent:et.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return multipleSelect_classPrivateFieldGet(rx,this)}registerHooks(){multipleSelect_classPrivateFieldGet(rF,this).addLocalHook("keydown",r=>multipleSelect_assertClassBrand(rN,this,multipleSelect_onInputKeyDown).call(this,r)),multipleSelect_classPrivateFieldGet(rF,this).addLocalHook("input",r=>multipleSelect_assertClassBrand(rN,this,_onInput).call(this,r)),multipleSelect_classPrivateFieldGet(rk,this).addLocalHook("click",r=>multipleSelect_assertClassBrand(rN,this,_onSelectAllClick).call(this,r)),multipleSelect_classPrivateFieldGet(rH,this).addLocalHook("click",r=>multipleSelect_assertClassBrand(rN,this,_onClearAllClick).call(this,r))}setItems(r){var n;multipleSelect_classPrivateFieldSet(rO,this,r),null===(n=multipleSelect_classPrivateFieldGet(rx,this))||void 0===n||n.loadData(multipleSelect_classPrivateFieldGet(rO,this))}setLocale(r){multipleSelect_classPrivateFieldSet(rA,this,r)}getLocale(){return multipleSelect_classPrivateFieldGet(rA,this)}getItems(){return[...multipleSelect_classPrivateFieldGet(rO,this)]}getValue(){return function(r){let n=[];return r.forEach(r=>{r.checked&&n.push(r.value)}),n}(multipleSelect_classPrivateFieldGet(rO,this))}getSearchInputElement(){return multipleSelect_classPrivateFieldGet(rF,this)}getSelectAllElement(){return multipleSelect_classPrivateFieldGet(rk,this)}getClearAllElement(){return multipleSelect_classPrivateFieldGet(rH,this)}isSelectedAllValues(){return multipleSelect_classPrivateFieldGet(rO,this).length===this.getValue().length}build(){super.build();let{rootDocument:r}=this.hot,n=r.createElement("div"),o=new BaseUI(this.hot,{className:"htUISelectionControls",children:[multipleSelect_classPrivateFieldGet(rk,this),multipleSelect_classPrivateFieldGet(rH,this)]});this._element.appendChild(multipleSelect_classPrivateFieldGet(rF,this).element),this._element.appendChild(o.element),this._element.appendChild(n);let hotInitializer=n=>{var o;if(!this._element)return;null===(o=multipleSelect_classPrivateFieldGet(rx,this))||void 0===o||o.destroy(),(0,h.cn)(n,"htUIMultipleSelectHot"),multipleSelect_classPrivateFieldSet(rx,this,new this.hot.constructor(n,{data:multipleSelect_classPrivateFieldGet(rO,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(r,n,o,l,h,d)=>{r.title=d.instance.getDataAtRowProp(n,d.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{multipleSelect_classPrivateFieldGet(rx,this).listen()},colWidths:()=>multipleSelect_classPrivateFieldGet(rx,this).container.scrollWidth-(0,h.np)(r),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),multipleSelect_classPrivateFieldGet(rx,this).init();let l=multipleSelect_classPrivateFieldGet(rx,this).getShortcutManager(),d=l.getContext("grid");d.removeShortcutsByKeys(["Tab"]),d.removeShortcutsByKeys(["Shift","Tab"]),d.addShortcut({keys:[["Escape"]],callback:r=>{this.runLocalHooks("keydown",r,this)},group:rI}),d.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:r=>{multipleSelect_classPrivateFieldGet(rx,this).deselectCell(),this.runLocalHooks("keydown",r,this),this.runLocalHooks("listTabKeydown",r,this)},group:rI})};hotInitializer(n),this.hot._registerTimeout(()=>hotInitializer(n),100)}focus(){this.isBuilt()&&multipleSelect_classPrivateFieldGet(rx,this).listen()}reset(){multipleSelect_classPrivateFieldGet(rF,this).reset(),multipleSelect_classPrivateFieldGet(rk,this).reset(),multipleSelect_classPrivateFieldGet(rH,this).reset()}update(){this.isBuilt()&&(multipleSelect_classPrivateFieldGet(rx,this).loadData(function(r,n){let o=createArrayAssertion(n);return r.map(r=>(r.checked=o(r.value),r))}(multipleSelect_classPrivateFieldGet(rO,this),this.options.value)),super.update())}destroy(){var r;null===(r=multipleSelect_classPrivateFieldGet(rx,this))||void 0===r||r.destroy(),multipleSelect_classPrivateFieldGet(rF,this).destroy(),multipleSelect_classPrivateFieldGet(rH,this).destroy(),multipleSelect_classPrivateFieldGet(rk,this).destroy(),multipleSelect_classPrivateFieldSet(rF,this,null),multipleSelect_classPrivateFieldSet(rH,this,null),multipleSelect_classPrivateFieldSet(rk,this,null),multipleSelect_classPrivateFieldSet(rx,this,null),multipleSelect_classPrivateFieldSet(rO,this,null),super.destroy()}};function _onInput(r){let n;let o=r.target.value.toLocaleLowerCase(this.getLocale());n=""===o?[...multipleSelect_classPrivateFieldGet(rO,this)]:multipleSelect_classPrivateFieldGet(rO,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(o)>=0),multipleSelect_classPrivateFieldGet(rx,this).loadData(n)}function multipleSelect_onInputKeyDown(r){this.runLocalHooks("keydown",r,this);let n=(0,e6.r$)(P.ot,r.keyCode);n("ARROW_DOWN")&&(r.preventDefault(),(0,d.mM)(r),multipleSelect_classPrivateFieldGet(rx,this).listen(),multipleSelect_classPrivateFieldGet(rx,this).selectCell(0,0))}function _onSelectAllClick(r){let n=[];r.preventDefault(),multipleSelect_classPrivateFieldGet(rx,this).getSourceData().forEach((r,o)=>{r.checked=!0,n.push((0,rT.ec)(r,o)[0])}),multipleSelect_classPrivateFieldGet(rx,this).setSourceDataAtCell(n)}function _onClearAllClick(r){let n=[];r.preventDefault(),multipleSelect_classPrivateFieldGet(rx,this).getSourceData().forEach((r,o)=>{r.checked=!1,n.push((0,rT.ec)(r,o)[0])}),multipleSelect_classPrivateFieldGet(rx,this).setSourceDataAtCell(n)}let rD="by_value";function value_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}registerCondition(rD,function(r,n){let[o]=n;return o(r.value)},{name:"By value",inputsCount:0,inputValuesDecorator(r){let[n]=r;return[createArrayAssertion(n)]},showOperators:!1});var rB=new WeakSet;let ValueComponent=class ValueComponent extends BaseComponent{constructor(r,n){var o,l;super(r,{id:n.id,stateless:!1}),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,rB),rB.add(this),(o="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(o="name","string"))?l:l+"")in this?Object.defineProperty(this,o,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[o]="",this.name=n.name,this.elements.push(new MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",r=>value_assertClassBrand(rB,this,value_onInputKeyDown).call(this,r)).addLocalHook("listTabKeydown",r=>this.runLocalHooks("listTabKeydown",r)),this.hot.addHook("modifyFiltersMultiSelectValue",(r,n)=>value_assertClassBrand(rB,this,_onModifyDisplayedValue).call(this,r,n))}getElements(){let r=this.getMultipleSelectElement();return[r.getSearchInputElement(),r.getSelectAllElement(),r.getClearAllElement(),this.getMultipleSelectElement()]}setState(r){if(this.reset(),r&&r.command.key===rD){let n=this.getMultipleSelectElement();n.setItems(r.itemsSnapshot),n.setValue(r.args[0]),n.setLocale(r.locale)}}getState(){let r=this.getMultipleSelectElement(),n=r.getItems();return{command:{key:r.isSelectedAllValues()||!n.length?iZ:rD},args:[r.getValue()],itemsSnapshot:n}}updateState(r){let updateColumnState=(n,o,l,h,d)=>{let[w]=(0,b.w7)(o,r=>r.name===rD),y={},S=this.hot.getTranslatedPhrase(et.FILTERS_VALUES_BLANK_CELLS);if(w){let o=h(n,d),_=(0,b.Sc)(o,r=>r.value),R=new Map(o.map(r=>[r.value,this.hot.getCellMeta(r.meta.visualRow,r.meta.visualCol)])),P=unifyColumnValues(_);l&&(w.args[0]=l);let T=[],I=intersectValues(P,w.args[0],S,r=>{r.checked&&T.push(r.value),value_assertClassBrand(rB,this,_triggerModifyMultipleSelectionValueHook).call(this,r,R)}),O=r.editedConditionStack.column;y.locale=this.hot.getCellMeta(0,O).locale,y.args=[T],y.command=getConditionDescriptor(rD),y.itemsSnapshot=I}else y.args=[],y.command=getConditionDescriptor(iZ);this.state.setValueAtIndex(n,y)};updateColumnState(r.editedConditionStack.column,r.editedConditionStack.conditions,r.conditionArgsChange,r.filteredRowsFactory),r.dependentConditionStacks.length&&updateColumnState(r.dependentConditionStacks[0].column,r.dependentConditionStacks[0].conditions,r.conditionArgsChange,r.filteredRowsFactory,r.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(r=>r instanceof MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(r,n,o,l,d,w)=>{(0,h.cn)(n.parentNode,"htFiltersMenuValue");let y=this.hot.rootDocument.createElement("div");return(0,h.cn)(y,"htFiltersMenuLabel"),y.textContent=w,n.appendChild(y),n.parentElement.hasAttribute("ghost-table")||(0,b.Bk)(this.elements,r=>n.appendChild(r.element)),n}}}reset(){let r=this.hot.getTranslatedPhrase(et.FILTERS_VALUES_BLANK_CELLS),n=this._getColumnVisibleValues(),o=n.map(r=>r.value),l=new Map(n.map(r=>[r.value,r.meta])),h=unifyColumnValues(o),d=intersectValues(h,h,r,r=>{value_assertClassBrand(rB,this,_triggerModifyMultipleSelectionValueHook).call(this,r,l)});this.getMultipleSelectElement().setItems(d),super.reset(),this.getMultipleSelectElement().setValue(h);let w=this.hot.getPlugin("filters").getSelectedColumn();null!==w&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,w.visualIndex).locale)}_getColumnVisibleValues(){let r=this.hot.getPlugin("filters").getSelectedColumn();return null===r?[]:(0,b.Sc)(this.hot.getDataAtCol(r.visualIndex),(n,o)=>({value:toEmptyString(n),meta:this.hot.getCellMeta(o,r.visualIndex)}))}};function value_onInputKeyDown(r){(0,P.ot)(r.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,d.mM)(r))}function _triggerModifyMultipleSelectionValueHook(r,n){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(r.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",r.visualValue,n.get(r.value)))}function _onModifyDisplayedValue(r,n){return"numeric"===n.type?getRenderedValue(r,n):r}var rL=new WeakSet;let ActionBarComponent=class ActionBarComponent extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(r,n){var o,l;super(r,{id:n.id,stateless:!0}),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,rL),rL.add(this),(o="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(o="name","string"))?l:l+"")in this?Object.defineProperty(this,o,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[o]="",this.name=n.name,this.elements.push(new InputUI(this.hot,{type:"button",value:et.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ActionBarComponent.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:et.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ActionBarComponent.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,b.Bk)(this.elements,r=>{r.addLocalHook("click",(r,n)=>(function(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")})(rL,this,_onButtonClick).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(r,n)=>((0,h.cn)(n.parentNode,"htFiltersMenuActionBar"),(0,b.Bk)(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}};function _onButtonClick(r,n){n.options.identifier===ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}function conditionCollection_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let rV="ConditionCollection.filteringStates";let ConditionCollection=class ConditionCollection{constructor(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];conditionCollection_defineProperty(this,"hot",void 0),conditionCollection_defineProperty(this,"isMapRegistrable",void 0),conditionCollection_defineProperty(this,"filteringStates",new tt.A),conditionCollection_defineProperty(this,"previousConditionStack",null),this.hot=r,this.isMapRegistrable=n,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(rV,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(r,n){var o;let l=this.filteringStates.getValueAtIndex(n),h=null!==(o=null==l?void 0:l.conditions)&&void 0!==o?o:[],d=null==l?void 0:l.operation;return this.isMatchInConditions(h,r,d)}isMatchInConditions(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rp;return!r.length||(function(r){if(!rm[r])throw Error(`Operation with id "${r}" does not exist.`);let n=rm[r].func;return function(r,o){return n(r,o)}})(o)(r,n)}addCondition(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rp,l=arguments.length>3?arguments[3]:void 0,h=this.hot.getCellMeta(0,r).locale,d=(0,b.Sc)(n.args,r=>"string"==typeof r?r.toLocaleLowerCase(h):r),w=n.name||n.command.key;null===this.previousConditionStack&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",r);let y=this.getOperation(r);if(y){if(y!==o)throw Error(t_.e`The column of index ${r} has been already applied with a \`${y}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,_.o8)(rm[o]))throw Error(t_.e`Unexpected operation named \`${o}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let S=this.getConditions(r);0===S.length?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:w,args:d,func:getCondition(w,d)}]},l):S.push({name:w,args:d,func:getCondition(w,d)}),this.runLocalHooks("afterAdd",r)}getConditions(r){var n,o;return null!==(n=null===(o=this.filteringStates.getValueAtIndex(r))||void 0===o?void 0:o.conditions)&&void 0!==n?n:[]}getOperation(r){var n;return null===(n=this.filteringStates.getValueAtIndex(r))||void 0===n?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(r=>{let[n]=r;return n})}getColumnStackPosition(r){return this.getFilteredColumns().indexOf(r)}exportAllConditions(){return(0,b.k$)(this.filteringStates.getEntries(),(r,n)=>{let[o,{operation:l,conditions:h}]=n;return r.push({column:o,operation:l,conditions:(0,b.Sc)(h,r=>{let{name:n,args:o}=r;return{name:n,args:o}})}),r},[])}importAllConditions(r){this.clean(),(0,b.Bk)(r,r=>{(0,b.Bk)(r.conditions,n=>this.addCondition(r.column,n))})}removeConditions(r){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(r,n){let o=this.getConditions(r);return n?o.some(r=>r.name===n):o.length>0}setPreviousConditionStack(r){this.previousConditionStack=r}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(rV),this.filteringStates=null,this.clearLocalHooks()}};function dataFilter_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}(0,w.jB)(ConditionCollection,tE.Z);var rG=class{constructor(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];dataFilter_defineProperty(this,"conditionCollection",void 0),dataFilter_defineProperty(this,"columnDataFactory",void 0),this.conditionCollection=r,this.columnDataFactory=n}filter(){let r=[];return(0,b.Bk)(this.conditionCollection.getFilteredColumns(),(n,o)=>{let l=this.columnDataFactory(n);o&&(l=this._getIntersectData(l,r)),r=this.filterByColumn(n,l)}),r}filterByColumn(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[];return(0,b.Bk)(n,n=>{void 0!==n&&this.conditionCollection.isMatch(n,r)&&o.push(n)}),o}_getIntersectData(r,n){let o=[];return(0,b.Bk)(n,n=>{let l=n.meta.visualRow;void 0!==r[l]&&(o[l]=r[l])}),o}};function conditionUpdateObserver_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function conditionUpdateObserver_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var rW=new WeakSet;let ConditionUpdateObserver=class ConditionUpdateObserver{constructor(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,rW),rW.add(this),conditionUpdateObserver_defineProperty(this,"hot",void 0),conditionUpdateObserver_defineProperty(this,"conditionCollection",void 0),conditionUpdateObserver_defineProperty(this,"columnDataFactory",void 0),conditionUpdateObserver_defineProperty(this,"changes",[]),conditionUpdateObserver_defineProperty(this,"grouping",!1),conditionUpdateObserver_defineProperty(this,"latestEditedColumnPosition",-1),conditionUpdateObserver_defineProperty(this,"latestOrderStack",[]),this.hot=r,this.conditionCollection=n,this.columnDataFactory=o,this.conditionCollection.addLocalHook("beforeRemove",r=>conditionUpdateObserver_assertClassBrand(rW,this,_onConditionBeforeModify).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>conditionUpdateObserver_assertClassBrand(rW,this,_onConditionBeforeClean).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>conditionUpdateObserver_assertClassBrand(rW,this,_onConditionAfterClean).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,b.Bk)(this.changes,r=>{this.updateStatesAtColumn(r)}),this.changes.length=0}updateStatesAtColumn(r,n){var o=this;if(this.grouping){-1===this.changes.indexOf(r)&&this.changes.push(r);return}let l=this.conditionCollection.exportAllConditions(),h=this.conditionCollection.getColumnStackPosition(r);-1===h&&(h=this.latestEditedColumnPosition);let d=l.slice(0,h),w=l.slice(h);w.length&&w[0].column===r&&w.shift();let y=(0,e6.WA)(function(r,n){let l,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],d=new ConditionCollection(o.hot,!1),w=[].concat(r,h);d.importAllConditions(w);let y=o.columnDataFactory(n);l=d.isEmpty()?y:new rG(d,r=>o.columnDataFactory(r)).filter(),l=(0,b.Sc)(l,r=>r.meta.visualRow);let S=createArrayAssertion(l);return d.destroy(),(0,b.w7)(y,r=>S(r.meta.visualRow))})(d),S=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:S},dependentConditionStacks:w,filteredRowsFactory:y,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),(0,w._l)(this,(r,n)=>{this[n]=null})}};function _onConditionBeforeModify(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){(0,b.Bk)(this.latestOrderStack,r=>{this.updateStatesAtColumn(r)})}(0,w.jB)(ConditionUpdateObserver,tE.Z);let rz="filters";var rj=o(96592);function filters_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function filters_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function filters_classPrivateFieldGet(r,n){return r.get(filters_assertClassBrand(r,n))}function filters_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let rU="filters";var r$=new WeakMap,rK=new WeakSet;let Filters=class Filters extends BasePlugin{static get PLUGIN_KEY(){return rU}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(r){super(r),filters_checkPrivateRedeclaration(this,rK),rK.add(this),filters_defineProperty(this,"dropdownMenuPlugin",null),filters_defineProperty(this,"conditionCollection",null),filters_defineProperty(this,"conditionUpdateObserver",null),filters_defineProperty(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),filters_defineProperty(this,"filtersRowsMap",null),filters_checkPrivateRedeclaration(this,r$),r$.set(this,void 0),this.hot.addHook("afterGetColHeader",(r,n)=>filters_assertClassBrand(rK,this,filters_onAfterGetColHeader).call(this,r,n))}isEnabled(){return!!this.hot.getSettings()[rU]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new rj.n),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let r=this.hot.getSettings().dropdownMenu,n=r&&r.uiContainer||this.hot.rootDocument.body,addConfirmationHooks=r=>(r.addLocalHook("accept",()=>filters_assertClassBrand(rK,this,_onActionBarSubmit).call(this,"accept")),r.addLocalHook("cancel",()=>filters_assertClassBrand(rK,this,_onActionBarSubmit).call(this,"cancel")),r.addLocalHook("change",n=>filters_assertClassBrand(rK,this,_onComponentChange).call(this,r,n)),r);if(!this.components.get("filter_by_condition")){let r=new ConditionComponent(this.hot,{id:"filter_by_condition",name:()=>`${this.hot.getTranslatedPhrase(et.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,addSeparator:!1,menuContainer:n});r.addLocalHook("afterClose",()=>filters_assertClassBrand(rK,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition",addConfirmationHooks(r))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let r=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});r.addLocalHook("afterClose",()=>filters_assertClassBrand(rK,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition2",addConfirmationHooks(r))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",addConfirmationHooks(new ValueComponent(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(et.FILTERS_DIVS_FILTER_BY_VALUE)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",addConfirmationHooks(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ConditionCollection(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ConditionUpdateObserver(this.hot,this.conditionCollection,r=>this.getDataMapAtColumn(r)),this.conditionUpdateObserver.addLocalHook("update",r=>filters_assertClassBrand(rK,this,_updateComponents).call(this,r))),this.components.forEach(r=>r.show()),this.addHook("afterDropdownMenuDefaultOptions",r=>filters_assertClassBrand(rK,this,_onAfterDropdownMenuDefaultOptions).call(this,r)),this.addHook("afterDropdownMenuShow",()=>filters_assertClassBrand(rK,this,_onAfterDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuHide",()=>filters_assertClassBrand(rK,this,_onAfterDropdownMenuHide).call(this)),this.addHook("afterChange",r=>filters_assertClassBrand(rK,this,filters_onAfterChange).call(this,r)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!filters_classPrivateFieldGet(r$,this)&&this.dropdownMenuPlugin.enabled){var o;let r=this.dropdownMenuPlugin.menu,n=[{focus:()=>{let n=r.getNavigator(),o=filters_classPrivateFieldGet(r$,this).getLastMenuPage();r.focus(),o>0?n.setCurrentPage(o):n.toFirstItem()}},...Array.from(this.components).map(r=>{let[,n]=r;return n.getElements()}).flat()];o=function(r,n){let o=-1,l=function(r){let n=createPaginator({initialPage:0,size:()=>r.length,onItemSelect:(n,o)=>{let l=r[n];return l instanceof MultipleSelectUI?o:(!l.element||!!(0,h.pn)(l.element))&&void l.focus()}});return n}(n),updateNavigatorPosition=o=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(rz),l.setCurrentPage(n.indexOf(o))};function addKeyboardShortcuts(h){let d=r.getKeyboardShortcutsCtrl(),w=h.getKeyboardShortcutsCtrl();l.clear(),w.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(rz),callback:()=>{h.isSubMenu()&&h.close(),d.listen(rz)}}]),h.isSubMenu()||d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{let h=r.getNavigator();h.getCurrentPage()>-1&&(o=h.getCurrentPage()),h.clear(),n.shiftKey?l.toPreviousItem():l.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:r=>{let o=n[l.getCurrentPage()];o instanceof SelectUI&&(o.openOptions(),r.preventDefault()),o instanceof LinkUI&&(o.activate(),r.preventDefault()),o instanceof BaseUI||r.preventDefault()}}],rz)}return n.forEach(r=>{r instanceof BaseUI&&(r.addLocalHook("click",updateNavigatorPosition(r)),r.addLocalHook("focus",updateNavigatorPosition(r)),r.addLocalHook("afterClose",updateNavigatorPosition(r)))}),r.addLocalHook("afterSelectionChange",r=>{r.key.startsWith("filter_")||l.clear()}),r.addLocalHook("afterSubmenuOpen",addKeyboardShortcuts),r.addLocalHook("afterOpen",addKeyboardShortcuts),{...l,listen:function(){r.focus(),r.getKeyboardShortcutsCtrl().listen(rz)},getLastMenuPage:function(){return o}}}(r,n),r$.set(filters_assertClassBrand(r$,this),o);let forwardToFocusNavigation=r=>{filters_classPrivateFieldGet(r$,this).listen(),r.preventDefault(),(0,P.ot)(r.keyCode,"TAB")&&(r.shiftKey?filters_classPrivateFieldGet(r$,this).toPreviousItem():filters_classPrivateFieldGet(r$,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",forwardToFocusNavigation),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",forwardToFocusNavigation)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var r;null!==(r=this.dropdownMenuPlugin)&&void 0!==r&&r.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let r=this.hot.getSelected();this.clearConditions(),this.filter(),r&&this.hot.selectCells(r)},group:rU})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rU)}addCondition(r,n,o){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rp,h=this.hot.toPhysicalColumn(r);this.conditionCollection.addCondition(h,{command:{key:n},args:o},l)}removeConditions(r){let n=this.hot.toPhysicalColumn(r);this.conditionCollection.removeConditions(n)}clearConditions(r){if(void 0===r)this.conditionCollection.clean();else{let n=this.hot.toPhysicalColumn(r);this.conditionCollection.removeConditions(n)}}filter(){let{navigableHeaders:r}=this.hot.getSettings(),n=this._createDataFilter(),o=!this.conditionCollection.isEmpty(),l=[],h=this.conditionCollection.exportAllConditions(),d=this.hot.runHooks("beforeFilter",h,this.conditionCollection.previousConditionStack);if(!1!==d){if(o){let o=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),l=(0,b.Sc)(n.filter(),r=>r.meta.visualRow);let r=createArrayAssertion(l);(0,ea.q4)(this.hot.countSourceRows()-1,n=>{r(n)||o.push(n)}),(0,b.Bk)(o,r=>{this.filtersRowsMap.setValueAtIndex(r,!0)})},!0),r||l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear()}this.hot.runHooks("afterFilter",h),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(r?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var r;let n=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(r){let n=this.hot.toVisualColumn(r),o=[];return(0,b.Bk)(this.hot.getSourceDataAtCol(n),(r,l)=>{var h;let{row:d,col:w,visualCol:y,visualRow:S,type:b,instance:_,dateFormat:R,locale:P}=this.hot.getCellMeta(l,n),T=null!==(h=this.hot.getDataAtCell(this.hot.toVisualRow(l),n))&&void 0!==h?h:r;o.push({meta:{row:d,col:w,visualCol:y,visualRow:S,type:b,instance:_,dateFormat:R,locale:P},value:toEmptyString(T)})}),o}updateValueComponentCondition(r){let n=this.hot.getDataAtCol(r),o=unifyColumnValues(n);this.conditionUpdateObserver.updateStatesAtColumn(r,o)}restoreComponents(r){var n;let o=null===(n=this.getSelectedColumn())||void 0===n?void 0:n.physicalIndex;r.forEach(r=>{r.isHidden()||r.restoreState(o)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(r,n,o,l){let h=r;return h===rC&&n.command.key!==iZ&&o.command.key!==iZ&&l.command.key!==iZ?h=ry:l.command.key!==iZ&&(n.command.key===iZ||o.command.key===iZ)&&(h=rp),h}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let r=this.components.get("filter_by_condition"),{command:n}=r.getState(),o=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...o):this.hideComponents(...o)}_createDataFilter(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new rG(r,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){let r=[];if(!this.dropdownMenuPlugin)return r;let n=this.dropdownMenuPlugin.menu;for(var o=arguments.length,l=Array(o),h=0;h<o;h++)l[h]=arguments[h];return(0,b.Bk)(l,o=>{(0,b.Bk)(n.menuItems,(n,l)=>{n.key===o.getMenuItemDescriptor().key&&r.push(l)})}),r}changeComponentsVisibility(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.dropdownMenuPlugin)return;let n=this.dropdownMenuPlugin.menu,o=n.hotMenu,l=o.getPlugin("hiddenRows");for(var h=arguments.length,d=Array(h>1?h-1:0),w=1;w<h;w++)d[w-1]=arguments[w];let y=this.getIndexesOfComponents(...d);r?l.showRows(y):l.hideRows(y),o.render()}hideComponents(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((r,n)=>{null!==r&&(r.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}};function filters_onAfterChange(r){r&&(0,b.Bk)(r,r=>{let[,n]=r,o=this.hot.propToCol(n);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)})}function _onAfterDropdownMenuShow(){let r=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),r.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onAfterDropdownMenuDefaultOptions(r){r.items.push({name:tB}),this.components.forEach(n=>{r.items.push(n.getMenuItemDescriptor())})}function _onActionBarSubmit(r){var n,o;if("accept"===r){let r=this.getSelectedColumn();if(null===r){null===(o=this.dropdownMenuPlugin)||void 0===o||o.close();return}let{physicalIndex:n}=r,l=this.components.get("filter_by_condition").getState(),h=this.components.get("filter_by_condition2").getState(),d=this.components.get("filter_by_value").getState(),w=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),l,h,d);this.conditionUpdateObserver.groupChanges();let y=this.conditionCollection.getColumnStackPosition(n);-1===y&&(y=void 0),this.conditionCollection.removeConditions(n),l.command.key!==iZ&&(this.conditionCollection.addCondition(n,l,w,y),h.command.key!==iZ&&this.conditionCollection.addCondition(n,h,w,y)),d.command.key!==iZ&&this.conditionCollection.addCondition(n,d,w,y),this.conditionUpdateObserver.flush(),this.components.forEach(r=>r.saveState(n)),this.filtersRowsMap.clear(),this.filter()}null===(n=this.dropdownMenuPlugin)||void 0===n||n.close()}function _onComponentChange(r,n){this.updateDependentComponentsVisibility(),r.constructor!==ConditionComponent||n.inputsCount||this.setListeningDropdownMenu()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function filters_onAfterGetColHeader(r,n){let o=this.hot.toPhysicalColumn(r);this.enabled&&this.conditionCollection.hasConditions(o)?(0,h.cn)(n,"htFiltersActive"):(0,h.IV)(n,"htFiltersActive")}function _updateComponents(r){var n;if(!(null!==(n=this.dropdownMenuPlugin)&&void 0!==n&&n.enabled))return;let{editedConditionStack:{conditions:o,column:l}}=r,h=o.filter(r=>r.name===rD),d=o.filter(r=>r.name!==rD);if(h.length>=2||d.length>=3)(0,e2.ZK)(t_.e`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let n=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(d[0],l),this.components.get("filter_by_condition2").updateState(d[1],l),this.components.get("filter_operators").updateState(n,l),this.components.get("filter_by_value").updateState(r)}}o(92648);let rY="internal-use-in-handsontable",rX={licenseKey:rY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(r){var n;return{maxColumns:r.maxColumns,maxRows:r.maxRows,language:null===(n=r[nr])||void 0===n||null===(n=n.language)||void 0===n?void 0:n.langCode}}function cleanEngineSettings(r){return Object.keys(r).reduce((n,o)=>("hyperformula"!==o&&(n[o]=r[o]),n),{})}function getEngineRelationshipRegistry(){let r="engine_relationship",n=(0,tn.Z)(nr);return n.hasItem(r)||n.register(r,new Map),n.getItem(r)}function getSharedEngineUsageRegistry(){let r="shared_engine_usage",n=(0,tn.Z)(nr);return n.hasItem(r)||n.register(r,new Map),n.getItem(r)}function getRegisteredHotInstances(r){var n;let o=getEngineRelationshipRegistry(),l=0===o.size?[]:Array.from(null!==(n=o.get(r))&&void 0!==n?n:[]);return new Map(l.map(r=>[r.getPlugin("formulas").sheetId,r]))}function unregisterEngine(r,n){if(r){let o=getEngineRelationshipRegistry(),l=o.get(r),h=getSharedEngineUsageRegistry(),d=h.get(r);l&&l.includes(n)&&(l.splice(l.indexOf(n),1),0===l.length&&o.delete(r)),d&&d.includes(n.guid)&&(d.splice(d.indexOf(n.guid),1),0===d.length&&(h.delete(r),r.destroy()))}}let rq="DD/MM/YYYY";function isEscapedFormulaExpression(r){return"string"==typeof r&&"'"===r.charAt(0)&&"="===r.charAt(1)}function utils_isDate(r,n){return"string"==typeof r&&"date"===n}function isDateValid(r,n){return L(r,n,!0).isValid()}function getDateInHfFormat(r,n){return L(r,n,!0).format(rq)}function getDateFromExcelDate(r,n){let o=new Date(Date.UTC(0,0,r+-1));return L(o).format(n)}function getMoves(r,n,o){let l=function(r,n){let o=[];return r.forEach(r=>{let l={from:r,to:n};o.forEach(r=>{let n=r.from>r.to,o=r.to<=l.from,h=r.from>l.from;h&&o&&n&&(l.from+=1)}),l.from>=n&&(n+=1),o.push(l)}),o}(r,function(r,n,o){let l=Array.from(Array(o).keys()).filter(n=>!1===r.includes(n));if(0===n){var h;return null!==(h=l[n])&&void 0!==h?h:0}return l[n-1]+1}(r,n,o));return l.forEach((r,n)=>{let o=l.slice(n+1);o.forEach(n=>{let o=n.from<n.to;n.from>r.from&&o&&(n.from-=1)})}),l}function axisSyncer_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function axisSyncer_classPrivateFieldGet(r,n){return r.get(axisSyncer_assertClassBrand(r,n))}function axisSyncer_classPrivateFieldSet(r,n,o){return r.set(axisSyncer_assertClassBrand(r,n),o),o}function axisSyncer_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var rZ=new WeakMap,rJ=new WeakMap,rQ=new WeakMap,r0=new WeakMap,r1=new WeakMap,r2=new WeakMap,r5=new WeakMap,r4=class{constructor(r,n,o){axisSyncer_classPrivateFieldInitSpec(this,rZ,void 0),axisSyncer_classPrivateFieldInitSpec(this,rJ,void 0),axisSyncer_classPrivateFieldInitSpec(this,rQ,void 0),axisSyncer_classPrivateFieldInitSpec(this,r0,[]),axisSyncer_classPrivateFieldInitSpec(this,r1,[]),axisSyncer_classPrivateFieldInitSpec(this,r2,void 0),axisSyncer_classPrivateFieldInitSpec(this,r5,[]),axisSyncer_classPrivateFieldSet(rZ,this,r),axisSyncer_classPrivateFieldSet(rJ,this,n),axisSyncer_classPrivateFieldSet(rQ,this,o)}setRemovedHfIndexes(r){return axisSyncer_classPrivateFieldSet(r5,this,r.map(r=>{let n=axisSyncer_classPrivateFieldGet(rJ,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),axisSyncer_classPrivateFieldGet(r5,this)}getRemovedHfIndexes(){return axisSyncer_classPrivateFieldGet(r5,this)}getHfIndexFromVisualIndex(r){let n=axisSyncer_classPrivateFieldGet(rJ,this).getIndexesSequence(),o=axisSyncer_classPrivateFieldGet(rJ,this).getNotTrimmedIndexes();return n.indexOf(o[r])}syncMoves(r){let n=`move${(0,R.ct)(axisSyncer_classPrivateFieldGet(rZ,this))}s`;axisSyncer_classPrivateFieldGet(rQ,this).getEngine().batch(()=>{r.forEach(r=>{let o=r.from!==r.to,l=r.from+1!==r.to;o&&l&&axisSyncer_classPrivateFieldGet(rQ,this).getEngine()[n](axisSyncer_classPrivateFieldGet(rQ,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(r,n,o){!1!==o&&(axisSyncer_classPrivateFieldSet(r1,this,r.map(r=>this.getHfIndexFromVisualIndex(r))),axisSyncer_classPrivateFieldSet(r2,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(r,n){if(axisSyncer_classPrivateFieldGet(rQ,this).isPerformingUndoRedo()||!1===r||!1===n)return;let o=getMoves(axisSyncer_classPrivateFieldGet(r1,this),axisSyncer_classPrivateFieldGet(r2,this),axisSyncer_classPrivateFieldGet(rJ,this).getNumberOfIndexes());null===axisSyncer_classPrivateFieldGet(rQ,this).getSheetId()?axisSyncer_classPrivateFieldGet(rQ,this).getPostponeAction(()=>this.syncMoves(o)):this.syncMoves(o)}getIndexesChangeSyncMethod(){let r=`set${(0,R.ct)(axisSyncer_classPrivateFieldGet(rZ,this))}Order`;return n=>{if(axisSyncer_classPrivateFieldGet(rQ,this).isPerformingUndoRedo())return;let o=axisSyncer_classPrivateFieldGet(rJ,this).getIndexesSequence();if("update"===n&&o.length>0){let n;let l=axisSyncer_classPrivateFieldGet(r0,this).map(r=>o.indexOf(r)),h=axisSyncer_classPrivateFieldGet(rQ,this).getEngine().getSheetDimensions(axisSyncer_classPrivateFieldGet(rQ,this).getSheetId());n="row"===axisSyncer_classPrivateFieldGet(rZ,this)?h.height:h.width;let d=l.length;for(let r=d;r<n;r+=1)l.push(r);axisSyncer_classPrivateFieldGet(rQ,this).getEngine()[r](axisSyncer_classPrivateFieldGet(rQ,this).getSheetId(),l)}axisSyncer_classPrivateFieldSet(r0,this,o)}}init(){axisSyncer_classPrivateFieldSet(r0,this,axisSyncer_classPrivateFieldGet(rJ,this).getIndexesSequence())}};function indexSyncer_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function indexSyncer_classPrivateFieldGet(r,n){return r.get(indexSyncer_assertClassBrand(r,n))}function indexSyncer_classPrivateFieldSet(r,n,o){return r.set(indexSyncer_assertClassBrand(r,n),o),o}function indexSyncer_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var r3=new WeakMap,r8=new WeakMap,r9=new WeakMap,r7=new WeakMap,r6=new WeakMap,ne=new WeakMap,nt=new WeakMap,ni=class{constructor(r,n,o){indexSyncer_classPrivateFieldInitSpec(this,r3,void 0),indexSyncer_classPrivateFieldInitSpec(this,r8,void 0),indexSyncer_classPrivateFieldInitSpec(this,r9,void 0),indexSyncer_classPrivateFieldInitSpec(this,r7,!1),indexSyncer_classPrivateFieldInitSpec(this,r6,!1),indexSyncer_classPrivateFieldInitSpec(this,ne,null),indexSyncer_classPrivateFieldInitSpec(this,nt,null),indexSyncer_classPrivateFieldSet(r3,this,new r4("row",r,this)),indexSyncer_classPrivateFieldSet(r8,this,new r4("column",n,this)),indexSyncer_classPrivateFieldSet(r9,this,o)}getForAxis(r){return"row"===r?indexSyncer_classPrivateFieldGet(r3,this):indexSyncer_classPrivateFieldGet(r8,this)}setPerformUndo(r){indexSyncer_classPrivateFieldSet(r7,this,r)}setPerformRedo(r){indexSyncer_classPrivateFieldSet(r6,this,r)}isPerformingUndoRedo(){return indexSyncer_classPrivateFieldGet(r7,this)||indexSyncer_classPrivateFieldGet(r6,this)}getSheetId(){return indexSyncer_classPrivateFieldGet(nt,this)}getEngine(){return indexSyncer_classPrivateFieldGet(ne,this)}getPostponeAction(){return indexSyncer_classPrivateFieldGet(r9,this)}setupSyncEndpoint(r,n){indexSyncer_classPrivateFieldSet(ne,this,r),indexSyncer_classPrivateFieldSet(nt,this,n),indexSyncer_classPrivateFieldGet(r3,this).init(),indexSyncer_classPrivateFieldGet(r8,this).init()}};function formulas_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function formulas_classPrivateFieldInitSpec(r,n,o){formulas_checkPrivateRedeclaration(r,n),n.set(r,o)}function formulas_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function formulas_classPrivateFieldSet(r,n,o){return r.set(formulas_assertClassBrand(r,n),o),o}function formulas_classPrivateFieldGet(r,n){return r.get(formulas_assertClassBrand(r,n))}function formulas_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let nr="formulas",nn=["maxRows","maxColumns","language"];K.Z.getSingleton().register("afterNamedExpressionAdded"),K.Z.getSingleton().register("afterNamedExpressionRemoved"),K.Z.getSingleton().register("afterSheetAdded"),K.Z.getSingleton().register("afterSheetRemoved"),K.Z.getSingleton().register("afterSheetRenamed"),K.Z.getSingleton().register("afterFormulasValuesUpdate");let isBlockedSource=r=>"UndoRedo.undo"===r||"UndoRedo.redo"===r||"auto"===r;var ns=new WeakMap,no=new WeakMap,nl=new WeakMap,na=new WeakSet;let Formulas=class Formulas extends BasePlugin{constructor(){var r;super(...arguments),r=this,formulas_checkPrivateRedeclaration(this,na),na.add(this),formulas_classPrivateFieldInitSpec(this,ns,!1),formulas_classPrivateFieldInitSpec(this,no,!1),formulas_classPrivateFieldInitSpec(this,nl,[["valuesUpdated",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,r,_onEngineValuesUpdated).call(r,...o)}],["namedExpressionAdded",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,r,_onEngineNamedExpressionsAdded).call(r,...o)}],["namedExpressionRemoved",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,r,_onEngineNamedExpressionsRemoved).call(r,...o)}],["sheetAdded",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,r,_onEngineSheetAdded).call(r,...o)}],["sheetRenamed",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,r,_onEngineSheetRenamed).call(r,...o)}],["sheetRemoved",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,r,_onEngineSheetRemoved).call(r,...o)}]]),formulas_defineProperty(this,"staticRegister",(0,tn.Z)("formulas")),formulas_defineProperty(this,"engine",null),formulas_defineProperty(this,"sheetName",null),formulas_defineProperty(this,"indexSyncer",null),formulas_defineProperty(this,"rowAxisSyncer",null),formulas_defineProperty(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return nr}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[nr,...nn]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[nr]}enablePlugin(){var r,n=this;if(!this.enabled){if(this.engine=null!==(r=function(r){let n=r.getSettings(),o=n[nr],l=null==o?void 0:o.engine;if(!0===o||(0,_.o8)(l))return null;if("function"==typeof l.hyperformula||"function"==typeof l){var h;return function(r,n,o){var l,h;let d=n[nr],w=function(r){var n;let o=r[nr],l=cleanEngineSettings(null!=o&&null!==(n=o.engine)&&void 0!==n&&n.hyperformula?o.engine:{}),h=getEngineSettingsOverrides(r);return{...rX,...l,...h}}(n),y=getEngineRelationshipRegistry(),S=getSharedEngineUsageRegistry();(l=d.functions)&&l.forEach(n=>{let{name:o,plugin:l,translations:h}=n;try{r.registerFunction(o,l,h)}catch(r){(0,e2.ZK)(r.message)}}),function(r,n){if(n){let{langCode:o}=n;try{r.registerLanguage(o,n)}catch(r){(0,e2.ZK)(r.message)}}}(r,d.language);let b=r.buildEmpty(w);return y.set(b,[o]),S.set(b,[o.guid]),(h=d.namedExpressions)&&(b.suspendEvaluation(),h.forEach(r=>{let{name:n,expression:o,scope:l,options:h}=r;try{b.addNamedExpression(n,o,l,h)}catch(r){(0,e2.ZK)(r.message)}}),b.resumeEvaluation()),b.on("sheetAdded",()=>{b.rebuildAndRecalculate()}),b.on("sheetRemoved",()=>{b.rebuildAndRecalculate()}),b}(null!==(h=l.hyperformula)&&void 0!==h?h:l,n,r)}if("object"==typeof l&&(0,_.o8)(l.hyperformula)){let n=getEngineRelationshipRegistry(),o=getSharedEngineUsageRegistry().get(l);return n.has(l)||n.set(l,[]),n.get(l).push(r),o&&o.push(r.guid),l.getConfig().licenseKey||l.updateConfig({licenseKey:rY}),(l.getConfig().leapYear1900!==rX.leapYear1900||!1===(0,w.Z1)(l.getConfig().nullDate,rX.nullDate))&&(0,e2.ZK)(t_.e`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),l}return null}(this.hot))&&void 0!==r?r:this.engine,!this.engine){(0,e2.ZK)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){let r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==r&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeLoadData).call(n,...o)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,formulas_onAfterLoadData).call(n,...o)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeLoadData).call(n,...o)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,formulas_onAfterLoadData).call(n,...o)}),this.addHook("modifyData",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onModifyData).call(n,...o)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onModifySourceData).call(n,...o)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeValidate).call(n,...o)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterSetSourceDataAtCell).call(n,...o)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterSetDataAtCell).call(n,...o)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterSetDataAtCell).call(n,...o)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeCreateRow).call(n,...o)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeCreateCol).call(n,...o)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterCreateRow).call(n,...o)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterCreateCol).call(n,...o)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeRemoveRow).call(n,...o)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeRemoveCol).call(n,...o)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterRemoveRow).call(n,...o)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterRemoveCol).call(n,...o)}),this.indexSyncer=new ni(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,n,o,l)=>{this.rowAxisSyncer.storeMovesInformation(r,n,l)}),this.hot.addHook("beforeColumnMove",(r,n,o,l)=>{this.columnAxisSyncer.storeMovesInformation(r,n,l)}),this.hot.addHook("afterRowMove",(r,n,o,l,h)=>{this.rowAxisSyncer.calculateAndSyncMoves(l,h)}),this.hot.addHook("afterColumnMove",(r,n,o,l,h)=>{this.columnAxisSyncer.calculateAndSyncMoves(l,h)}),this.hot.addHook("beforeColumnFreeze",(r,n)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,n)}),this.hot.addHook("afterColumnFreeze",(r,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,n)}),this.hot.addHook("beforeColumnUnfreeze",(r,n)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,n)}),this.hot.addHook("afterColumnUnfreeze",(r,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,n)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterCellMetaReset).call(n,...o)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onAfterDetachChild).call(n,...o)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return formulas_assertClassBrand(na,n,_onBeforeAutofill).call(n,...o)}),formulas_classPrivateFieldGet(nl,this).forEach(r=>{let[n,o]=r;return this.engine.on(n,o)}),super.enablePlugin()}}disablePlugin(){formulas_classPrivateFieldGet(nl,this).forEach(r=>{let[n,o]=r;return this.engine.off(n,o)}),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(r){var n;let o=function(r){var n;let o=r[nr],l=cleanEngineSettings(null!=o&&null!==(n=o.engine)&&void 0!==n&&n.hyperformula?o.engine:{}),h=getEngineSettingsOverrides(r);return{...l,...h}}(this.hot.getSettings());n=this.engine.getConfig(),Object.keys(o).some(r=>void 0!==o[r]&&o[r]!==n[r])&&this.engine.updateConfig(o);let l=this.hot.getSettings()[nr];if((0,_.$K)(l)&&(0,_.$K)(l.sheetName)&&l.sheetName!==this.sheetName&&this.switchSheet(l.sheetName),!r.data&&null===this.sheetName){let r=this.hot.getSettings()[nr].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=r?r:void 0,this.hot.getSourceDataArray())}super.updatePlugin(r)}destroy(){formulas_classPrivateFieldGet(nl,this).forEach(r=>{var n;let[o,l]=r;return null===(n=this.engine)||void 0===n?void 0:n.off(o,l)}),formulas_classPrivateFieldSet(nl,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(r,n){if((0,_.$K)(n)&&!(0,rT.Jr)(n))return(0,e2.ZK)("The provided data should be an array of arrays."),!1;if(null!=r&&this.engine.doesSheetExist(r))return(0,e2.ZK)("Sheet with the provided name already exists."),!1;try{let o=this.engine.addSheet(null!=r?r:void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(o),n),o}catch(r){return(0,e2.ZK)(r.message),!1}}switchSheet(r){if(!this.engine.doesSheetExist(r)){(0,e2.vU)(`The sheet named \`${r}\` does not exist, switch aborted.`);return}this.sheetName=r;let n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${(0,R.ct)(nr)}.switchSheet`)}getCellType(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(r),h=this.hot.toPhysicalColumn(n);return null!==l&&null!==h?this.engine.getCellType({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new Set;r.forEach(r=>{var n;let l=null==r||null===(n=r.address)||void 0===n?void 0:n.sheet;void 0===l||o.has(l)||o.add(l)}),getRegisteredHotInstances(this.engine).forEach((r,l)=>{if((n||l!==this.sheetId)&&o.has(l)){var h;r.render(),null===(h=r.view)||void 0===h||h.adjustElementsSize()}})}validateDependentCells(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],stringifyAddress=r=>{var n;let{row:o,col:l,sheet:h}=null!==(n=null==r?void 0:r.address)&&void 0!==n?n:{};return(0,_.$K)(h)?`${h}:${o}x${l}`:""},o=new Set(n.map(r=>stringifyAddress(r)));r.forEach(r=>{var n,l;let{row:h,col:d}=null!==(n=r.address)&&void 0!==n?n:{};if(!1===(0,_.$K)(h)||!1===(0,_.$K)(d)||h>=this.hot.countRows()||d>=this.hot.countCols())return;let w=null==r||null===(l=r.address)||void 0===l?void 0:l.sheet,y=stringifyAddress(r);if(void 0!==w&&!o.has(y)){let r=getRegisteredHotInstances(this.engine).get(w);if(!r)return;r.validateCell(r.getDataAtCell(h,d),r.getCellMeta(h,d),()=>{})}})}syncChangeWithEngine(r,n,o){let l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){(0,e2.ZK)(`Not possible to set cell data at ${JSON.stringify(l)}`);return}let h=this.hot.getCellMeta(r,n);if(utils_isDate(o,h.type)){if(isDateValid(o,h.dateFormat))o=getDateInHfFormat(o,h.dateFormat);else{var d;!1===("string"==typeof(d=o)&&d.startsWith("="))&&(o=`'${o}`)}}return this.engine.setCellContents(l,o)}};function _onBeforeValidate(r,n,o){let l=this.hot.propToCol(o);if(this.isFormulaCellType(n,l)){let r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},o=this.hot.getCellMeta(n,l),h=this.engine.getCellValue(r);return"date"===o.type&&(0,ea.kE)(h)&&(h=getDateFromExcelDate(h,o.dateFormat)),"object"==typeof h&&null!==h?h.value:h}return r}function _onBeforeAutofill(r,n,o){let{row:l,col:h}=n.getTopStartCorner(),{row:d,col:w}=n.getBottomEndCorner(),{row:y,col:S}=o.getTopStartCorner(),{row:b,col:_}=o.getBottomEndCorner(),R={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(w),sheet:this.sheetId}},P={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(y),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(b),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(_),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(P))return!1;let T=this.engine.getFillRangeData(R,P),{row:I,col:O}=R.start,{row:k,col:N}=R.end,j=k-I+1,U=N-O+1;for(let r=0;r<T.length;r+=1)for(let n=0;n<T[r].length;n+=1){let o=T[r][n],l=I+r%j,h=O+n%U,d=this.hot.getCellMeta(l,h);if(utils_isDate(o,d.type)){if(o.startsWith("'"))T[r][n]=o.slice(1);else if(!1===this.isFormulaCellType(l,h,this.sheetId)){var $;T[r][n]=($=d.dateFormat,L(o,rq,!0).format($))}}}return T}function _onBeforeLoadData(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";o.includes((0,R.ct)(nr))||formulas_classPrivateFieldSet(no,this,(0,_.o8)(this.hot.getSettings().data))}function _onAfterCellMetaReset(){let r=this.hot.getSourceDataArray(),n=!1;r.forEach((o,l)=>{o.forEach((o,h)=>{let d=this.hot.getCellMeta(l,h),w=d.dateFormat;utils_isDate(o,d.type)&&(n=!0,isDateValid(o,w)?r[l][h]=getDateInHfFormat(o,w):!1===this.isFormulaCellType(l,h)&&(r[l][h]=`'${o}`))})}),!0===n&&(formulas_classPrivateFieldSet(ns,this,!0),this.engine.setSheetContent(this.sheetId,r),formulas_classPrivateFieldSet(ns,this,!1))}function formulas_onAfterLoadData(r,n){var o,l;let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!h.includes((0,R.ct)(nr))){if(this.sheetName=(o=this.engine,l=this.hot.getSettings()[nr].sheetName,((0,_.o8)(l)||!o.doesSheetExist(l))&&(l=o.addSheet(l)),l),formulas_classPrivateFieldGet(no,this))this.switchSheet(this.sheetName);else{let r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){formulas_classPrivateFieldSet(ns,this,!0);let n=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(n),formulas_classPrivateFieldSet(ns,this,!1)}}}}function _onModifyData(r,n,o,l){if("get"!==l||formulas_classPrivateFieldGet(ns,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let h=this.hot.toVisualRow(r);if(null===h||null===n)return;let d=this.isFormulaCellType(h,n);if(!d){let r=this.getCellType(h,n);if("ARRAY"!==r){if(isEscapedFormulaExpression(o.value)){var w;o.value=isEscapedFormulaExpression(w=o.value)?w.substr(1):w}return}}let y={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},S=this.engine.getCellValue(y),b=this.hot.getCellsMeta().find(r=>r.visualRow===h&&r.visualCol===n);void 0===b&&(b={}),"date"===b.type&&(0,ea.kE)(S)&&(S=getDateFromExcelDate(S,b.dateFormat));let _="object"==typeof S&&null!==S?S.value:S;o.value=_}function _onModifySourceData(r,n,o,l){if("get"!==l||formulas_classPrivateFieldGet(ns,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let h=this.hot.toVisualRow(r),d=this.hot.propToCol(n);if(null===h||null===d)return;let w=this.isFormulaCellType(h,d);if(!w){let r=this.getCellType(h,d);if("ARRAY"!==r)return}let y=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===y.width&&0===y.height)return;let S={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};o.value=this.engine.getCellSerialized(S)}function _onAfterSetDataAtCell(r,n){if(isBlockedSource(n))return;let o=[],l=[],h=this.engine.batch(()=>{r.forEach(r=>{let[n,h,,d]=r,w=this.hot.propToCol(h),y=this.hot.toPhysicalRow(n),S=this.hot.toPhysicalColumn(w),b={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(w),sheet:this.sheetId};null!==y&&null!==S?this.syncChangeWithEngine(n,w,d):o.push([n,w,d]),l.push({address:b})})});o.length&&this.hot.addHookOnce("afterChange",()=>{let r=this.engine.batch(()=>{o.forEach(r=>{let[n,o,l]=r;this.syncChangeWithEngine(n,o,l)})});this.renderDependentSheets(r,!0)}),this.renderDependentSheets(h),this.validateDependentCells(h,l)}function _onAfterSetSourceDataAtCell(r,n){if(isBlockedSource(n))return;let o=[],l=[];r.forEach(r=>{let[n,h,,d]=r,w=this.hot.propToCol(h);if(!(0,ea.kE)(w))return;let y={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(w),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(y)){(0,e2.ZK)(`Not possible to set source cell data at ${JSON.stringify(y)}`);return}l.push({address:y}),o.push(...this.engine.setCellContents(y,d))}),this.renderDependentSheets(o),this.validateDependentCells(o,l)}function _onBeforeCreateRow(r,n){let o=this.rowAxisSyncer.getHfIndexFromVisualIndex(r);if(r>=this.hot.countRows()&&(o=r),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[o,n]))return!1}function _onBeforeCreateCol(r,n){let o=this.columnAxisSyncer.getHfIndexFromVisualIndex(r);if(r>=this.hot.countCols()&&(o=r),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[o,n]))return!1}function _onBeforeRemoveRow(r,n,o){let l=this.rowAxisSyncer.setRemovedHfIndexes(o),h=l.every(r=>this.engine.isItPossibleToRemoveRows(this.sheetId,[r,1]));return!1!==h&&void 0}function _onBeforeRemoveCol(r,n,o){let l=this.columnAxisSyncer.setRemovedHfIndexes(o),h=l.every(r=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[r,1]));return!1!==h&&void 0}function _onAfterCreateRow(r,n,o){if(isBlockedSource(o))return;let l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(r),n]);this.renderDependentSheets(l)}function _onAfterCreateCol(r,n,o){if(isBlockedSource(o))return;let l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(r),n]);this.renderDependentSheets(l)}function _onAfterRemoveRow(r,n,o,l){if(isBlockedSource(l))return;let h=this.rowAxisSyncer.getRemovedHfIndexes().sort((r,n)=>n-r),d=this.engine.batch(()=>{h.forEach(r=>{this.engine.removeRows(this.sheetId,[r,1])})});this.renderDependentSheets(d)}function _onAfterRemoveCol(r,n,o,l){if(isBlockedSource(l))return;let h=this.columnAxisSyncer.getRemovedHfIndexes().sort((r,n)=>n-r),d=this.engine.batch(()=>{h.forEach(r=>{this.engine.removeColumns(this.sheetId,[r,1])})});this.renderDependentSheets(d)}function _onAfterDetachChild(r,n,o){var l;formulas_classPrivateFieldSet(ns,this,!0);let h=this.hot.getSourceDataArray(o,0,o+((null===(l=n.__children)||void 0===l?void 0:l.length)||0),this.hot.countSourceCols());formulas_classPrivateFieldSet(ns,this,!1),h.forEach((r,n)=>{r.forEach((r,l)=>{this.engine.setCellContents({col:l,row:o+n,sheet:this.sheetId},[[r]])})})}function _onEngineValuesUpdated(r){this.hot.runHooks("afterFormulasValuesUpdate",r)}function _onEngineNamedExpressionsAdded(r,n){this.hot.runHooks("afterNamedExpressionAdded",r,n)}function _onEngineNamedExpressionsRemoved(r,n){this.hot.runHooks("afterNamedExpressionRemoved",r,n)}function _onEngineSheetAdded(r){this.hot.runHooks("afterSheetAdded",r)}function _onEngineSheetRenamed(r,n){this.sheetName=n,this.hot.runHooks("afterSheetRenamed",r,n)}function _onEngineSheetRemoved(r,n){this.hot.runHooks("afterSheetRemoved",r,n)}var nh=o(27392);function hiddenColumns_classPrivateFieldInitSpec(r,n,o){hiddenColumns_checkPrivateRedeclaration(r,n),n.set(r,o)}function hiddenColumns_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function hiddenColumns_classPrivateFieldGet(r,n){return r.get(hiddenColumns_assertClassBrand(r,n))}function hiddenColumns_classPrivateFieldSet(r,n,o){return r.set(hiddenColumns_assertClassBrand(r,n),o),o}function hiddenColumns_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("beforeHideColumns"),K.Z.getSingleton().register("afterHideColumns"),K.Z.getSingleton().register("beforeUnhideColumns"),K.Z.getSingleton().register("afterUnhideColumns");let nd="hiddenColumns";var nc=new WeakMap,nu=new WeakMap,ng=new WeakSet;let HiddenColumns=class HiddenColumns extends BasePlugin{constructor(){super(...arguments),hiddenColumns_checkPrivateRedeclaration(this,ng),ng.add(this),hiddenColumns_classPrivateFieldInitSpec(this,nc,{}),hiddenColumns_classPrivateFieldInitSpec(this,nu,null)}static get PLUGIN_KEY(){return nd}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[nd]}enablePlugin(){var r=this;if(this.enabled)return;let n=this.hot.getSettings()[nd];(0,w.Kn)(n)&&(hiddenColumns_classPrivateFieldSet(nc,this,n),(0,_.o8)(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),hiddenColumns_classPrivateFieldSet(nu,this,new nh.o),hiddenColumns_classPrivateFieldGet(nu,this).addLocalHook("init",()=>hiddenColumns_assertClassBrand(ng,this,_onMapInit).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,hiddenColumns_classPrivateFieldGet(nu,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return hiddenColumns_assertClassBrand(ng,r,hiddenColumns_onAfterContextMenuDefaultOptions).call(r,...o)}),this.addHook("afterGetCellMeta",(r,n,o)=>hiddenColumns_assertClassBrand(ng,this,_onAfterGetCellMeta).call(this,r,n,o)),this.addHook("modifyColWidth",(r,n)=>hiddenColumns_assertClassBrand(ng,this,_onModifyColWidth).call(this,r,n),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return hiddenColumns_assertClassBrand(ng,r,hiddenColumns_onAfterGetColHeader).call(r,...o)}),this.addHook("modifyCopyableRange",r=>hiddenColumns_assertClassBrand(ng,this,_onModifyCopyableRange).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),hiddenColumns_classPrivateFieldSet(nc,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(r){let n=this.getHiddenColumns(),o=this.isValidConfig(r),l=n,h=hiddenColumns_classPrivateFieldGet(nu,this).getValues().slice(),d=r.length>0;if(o&&d){let n=r.map(r=>this.hot.toPhysicalColumn(r));(0,b.Bk)(n,r=>{h[r]=!1}),l=(0,b.k$)(h,(r,n,o)=>(n&&r.push(this.hot.toVisualColumn(o)),r),[])}let w=this.hot.runHooks("beforeUnhideColumns",n,l,o&&d);!1!==w&&(o&&d&&hiddenColumns_classPrivateFieldGet(nu,this).setValues(h),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,l,o&&d,o&&l.length<n.length))}showColumn(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.showColumns(n)}hideColumns(r){let n=this.getHiddenColumns(),o=this.isValidConfig(r),l=n;o&&(l=Array.from(new Set(n.concat(r))));let h=this.hot.runHooks("beforeHideColumns",n,l,o);!1!==h&&(o&&this.hot.batchExecution(()=>{(0,b.Bk)(r,r=>{hiddenColumns_classPrivateFieldGet(nu,this).setValueAtIndex(this.hot.toPhysicalColumn(r),!0)})},!0),this.hot.runHooks("afterHideColumns",n,l,o,o&&l.length>n.length))}hideColumn(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.hideColumns(n)}getHiddenColumns(){return(0,b.Sc)(hiddenColumns_classPrivateFieldGet(nu,this).getHiddenIndexes(),r=>this.hot.toVisualColumn(r))}isHidden(r){return hiddenColumns_classPrivateFieldGet(nu,this).getValueAtIndex(this.hot.toPhysicalColumn(r))||!1}isValidConfig(r){let n=this.hot.countCols();return!!Array.isArray(r)&&r.length>0&&r.every(r=>Number.isInteger(r)&&r>=0&&r<n)}resetCellsMeta(){(0,b.Bk)(this.hot.getCellsMeta(),r=>{r&&(r.skipColumnOnPaste=!1)})}destroy(){hiddenColumns_classPrivateFieldSet(nc,this,null),hiddenColumns_classPrivateFieldSet(nu,this,null),super.destroy()}};function _onModifyColWidth(r,n){return this.isHidden(n)?0:hiddenColumns_classPrivateFieldGet(nc,this).indicators&&(this.isHidden(n+1)||this.isHidden(n-1))&&"number"==typeof r&&this.hot.hasColHeaders()?r+15:void 0}function _onAfterGetCellMeta(r,n,o){if(!1===hiddenColumns_classPrivateFieldGet(nc,this).copyPasteEnabled&&this.isHidden(n)&&(o.skipColumnOnPaste=!0),this.isHidden(n-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenColumn")&&(o.className+=" afterHiddenColumn");else if(o.className){let r=o.className.split(" ");if(r.length>0){let n=r.indexOf("afterHiddenColumn");n>-1&&r.splice(n,1),o.className=r.join(" ")}}}function _onModifyCopyableRange(r){if(hiddenColumns_classPrivateFieldGet(nc,this).copyPasteEnabled)return r;let n=[],pushRange=(r,o,l,h)=>{n.push({startRow:r,endRow:o,startCol:l,endCol:h})};return(0,b.Bk)(r,r=>{let n=!0,o=0;(0,ea.q4)(r.startCol,r.endCol,l=>{this.isHidden(l)?(n||pushRange(r.startRow,r.endRow,o,l-1),n=!0):(n&&(o=l),l===r.endCol&&pushRange(r.startRow,r.endRow,o,l),n=!1)})}),n}function hiddenColumns_onAfterGetColHeader(r,n){if(!hiddenColumns_classPrivateFieldGet(nc,this).indicators||r<0)return;let o=[];r>=1&&this.isHidden(r-1)&&o.push("afterHiddenColumn"),r<this.hot.countCols()-1&&this.isHidden(r+1)&&o.push("beforeHiddenColumn"),(0,h.cn)(n,o)}function hiddenColumns_onAfterContextMenuDefaultOptions(r){var n;r.items.push({name:tB},(n=this,{key:"hidden_columns_hide",name(){let r=this.getSelectedLast(),n=0;if(Array.isArray(r)){let[,o,,l]=r;o-l!=0&&(n=1)}return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_HIDE_COLUMN,n)},callback(){let{from:r,to:o}=this.getSelectedRangeLast(),l=Math.max(Math.min(r.col,o.col),0),h=Math.max(r.col,o.col),d=[];for(let r=l;r<=h;r+=1)d.push(r);n.hideColumns(d);let w=d[d.length-1],y=this.columnIndexMapper.getNearestNotHiddenIndex(w,1,!0);Number.isInteger(y)&&y>=0?this.selectColumns(y):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(r){let n=[];return{key:"hidden_columns_show",name(){let r=n.length>1?1:0;return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_SHOW_COLUMN,r)},callback(){var o,l;if(0===n.length)return;let h=n[0],d=n[n.length-1];h=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(h-1,-1))&&void 0!==o?o:0,d=null!==(l=this.columnIndexMapper.getNearestNotHiddenIndex(d+1,1))&&void 0!==l?l:this.countCols()-1,r.showColumns(n),this.render(),this.view.adjustElementsSize();let w=d-h+1===this.countCols();w||this.selectColumns(h,d)},disabled:!1,hidden(){let o=(0,b.Sc)(r.getHiddenColumns(),r=>this.toPhysicalColumn(r));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;n.length=0;let l=this.getSelectedRangeLast(),h=l.getTopStartCorner().col,d=l.getBottomEndCorner().col,w=this.columnIndexMapper,y=w.getRenderableFromVisualIndex(h),S=w.getRenderableFromVisualIndex(d),_=w.getNotTrimmedIndexes(),R=[];if(h!==d){let r=d-h+1;if(r>S-y+1){let r=_.slice(h,d+1);R.push(...r.filter(r=>o.includes(r)))}}else if(0===y&&y<h)R.push(..._.slice(0,h));else if(null===y)R.push(..._.slice(0,this.countCols()));else{let r=this.countCols()-1,n=w.getRenderableFromVisualIndex(w.getNearestNotHiddenIndex(r,-1));S===n&&r>d&&R.push(..._.slice(d+1))}return(0,b.Bk)(R,r=>{n.push(this.toVisualColumn(r))}),0===n.length}}}(this))}function _onMapInit(){Array.isArray(hiddenColumns_classPrivateFieldGet(nc,this).columns)&&this.hideColumns(hiddenColumns_classPrivateFieldGet(nc,this).columns)}function hiddenRows_classPrivateFieldInitSpec(r,n,o){hiddenRows_checkPrivateRedeclaration(r,n),n.set(r,o)}function hiddenRows_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function hiddenRows_classPrivateFieldGet(r,n){return r.get(hiddenRows_assertClassBrand(r,n))}function hiddenRows_classPrivateFieldSet(r,n,o){return r.set(hiddenRows_assertClassBrand(r,n),o),o}function hiddenRows_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("beforeHideRows"),K.Z.getSingleton().register("afterHideRows"),K.Z.getSingleton().register("beforeUnhideRows"),K.Z.getSingleton().register("afterUnhideRows");let nf="hiddenRows";var nm=new WeakMap,np=new WeakMap,nv=new WeakSet;let HiddenRows=class HiddenRows extends BasePlugin{constructor(){super(...arguments),hiddenRows_checkPrivateRedeclaration(this,nv),nv.add(this),hiddenRows_classPrivateFieldInitSpec(this,nm,{}),hiddenRows_classPrivateFieldInitSpec(this,np,null)}static get PLUGIN_KEY(){return nf}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[nf]}enablePlugin(){var r=this;if(this.enabled)return;let n=this.hot.getSettings()[nf];(0,w.Kn)(n)&&(hiddenRows_classPrivateFieldSet(nm,this,n),(0,_.o8)(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),hiddenRows_classPrivateFieldSet(np,this,new nh.o),hiddenRows_classPrivateFieldGet(np,this).addLocalHook("init",()=>hiddenRows_assertClassBrand(nv,this,hiddenRows_onMapInit).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,hiddenRows_classPrivateFieldGet(np,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return hiddenRows_assertClassBrand(nv,r,hiddenRows_onAfterContextMenuDefaultOptions).call(r,...o)}),this.addHook("afterGetCellMeta",(r,n,o)=>hiddenRows_assertClassBrand(nv,this,hiddenRows_onAfterGetCellMeta).call(this,r,n,o)),this.addHook("modifyRowHeight",(r,n)=>hiddenRows_assertClassBrand(nv,this,_onModifyRowHeight).call(this,r,n)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return hiddenRows_assertClassBrand(nv,r,_onAfterGetRowHeader).call(r,...o)}),this.addHook("modifyCopyableRange",r=>hiddenRows_assertClassBrand(nv,this,hiddenRows_onModifyCopyableRange).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),hiddenRows_classPrivateFieldSet(nm,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(r){let n=this.getHiddenRows(),o=this.isValidConfig(r),l=n,h=hiddenRows_classPrivateFieldGet(np,this).getValues().slice(),d=r.length>0;if(o&&d){let n=r.map(r=>this.hot.toPhysicalRow(r));(0,b.Bk)(n,r=>{h[r]=!1}),l=(0,b.k$)(h,(r,n,o)=>(n&&r.push(this.hot.toVisualRow(o)),r),[])}let w=this.hot.runHooks("beforeUnhideRows",n,l,o&&d);!1!==w&&(o&&d&&hiddenRows_classPrivateFieldGet(np,this).setValues(h),this.hot.runHooks("afterUnhideRows",n,l,o&&d,o&&l.length<n.length))}showRow(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.showRows(n)}hideRows(r){let n=this.getHiddenRows(),o=this.isValidConfig(r),l=n;o&&(l=Array.from(new Set(n.concat(r))));let h=this.hot.runHooks("beforeHideRows",n,l,o);!1!==h&&(o&&this.hot.batchExecution(()=>{(0,b.Bk)(r,r=>{hiddenRows_classPrivateFieldGet(np,this).setValueAtIndex(this.hot.toPhysicalRow(r),!0)})},!0),this.hot.runHooks("afterHideRows",n,l,o,o&&l.length>n.length))}hideRow(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.hideRows(n)}getHiddenRows(){return(0,b.Sc)(hiddenRows_classPrivateFieldGet(np,this).getHiddenIndexes(),r=>this.hot.toVisualRow(r))}isHidden(r){return hiddenRows_classPrivateFieldGet(np,this).getValueAtIndex(this.hot.toPhysicalRow(r))||!1}isValidConfig(r){let n=this.hot.countRows();return!!Array.isArray(r)&&r.length>0&&r.every(r=>Number.isInteger(r)&&r>=0&&r<n)}resetCellsMeta(){(0,b.Bk)(this.hot.getCellsMeta(),r=>{r&&(r.skipRowOnPaste=!1)})}destroy(){hiddenRows_classPrivateFieldSet(nm,this,null),hiddenRows_classPrivateFieldSet(np,this,null),super.destroy()}};function _onModifyRowHeight(r,n){return this.isHidden(n)?0:r}function hiddenRows_onAfterGetCellMeta(r,n,o){if(!1===hiddenRows_classPrivateFieldGet(nm,this).copyPasteEnabled&&this.isHidden(r)&&(o.skipRowOnPaste=!0),this.isHidden(r-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenRow")&&(o.className+=" afterHiddenRow");else if(o.className){let r=o.className.split(" ");if(r.length>0){let n=r.indexOf("afterHiddenRow");n>-1&&r.splice(n,1),o.className=r.join(" ")}}}function hiddenRows_onModifyCopyableRange(r){if(hiddenRows_classPrivateFieldGet(nm,this).copyPasteEnabled)return r;let n=[],pushRange=(r,o,l,h)=>{n.push({startRow:r,endRow:o,startCol:l,endCol:h})};return(0,b.Bk)(r,r=>{let n=!0,o=0;(0,ea.q4)(r.startRow,r.endRow,l=>{this.isHidden(l)?(n||pushRange(o,l-1,r.startCol,r.endCol),n=!0):(n&&(o=l),l===r.endRow&&pushRange(o,l,r.startCol,r.endCol),n=!1)})}),n}function _onAfterGetRowHeader(r,n){if(!hiddenRows_classPrivateFieldGet(nm,this).indicators||r<0)return;let o=[];r>=1&&this.isHidden(r-1)&&o.push("afterHiddenRow"),r<this.hot.countRows()-1&&this.isHidden(r+1)&&o.push("beforeHiddenRow"),(0,h.cn)(n,o)}function hiddenRows_onAfterContextMenuDefaultOptions(r){var n;r.items.push({name:tB},(n=this,{key:"hidden_rows_hide",name(){let r=this.getSelectedLast(),n=0;if(Array.isArray(r)){let[o,,l]=r;o-l!=0&&(n=1)}return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_HIDE_ROW,n)},callback(){let{from:r,to:o}=this.getSelectedRangeLast(),l=Math.max(Math.min(r.row,o.row),0),h=Math.max(r.row,o.row),d=[];for(let r=l;r<=h;r+=1)d.push(r);n.hideRows(d);let w=d[d.length-1],y=this.rowIndexMapper.getNearestNotHiddenIndex(w,1,!0);Number.isInteger(y)&&y>=0?this.selectRows(y):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(r){let n=[];return{key:"hidden_rows_show",name(){let r=n.length>1?1:0;return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_SHOW_ROW,r)},callback(){var o,l;if(0===n.length)return;let h=n[0],d=n[n.length-1];h=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(h-1,-1))&&void 0!==o?o:0,d=null!==(l=this.rowIndexMapper.getNearestNotHiddenIndex(d+1,1))&&void 0!==l?l:this.countRows()-1,r.showRows(n),this.render(),this.view.adjustElementsSize();let w=d-h+1===this.countRows();w||this.selectRows(h,d)},disabled:!1,hidden(){let o=(0,b.Sc)(r.getHiddenRows(),r=>this.toPhysicalRow(r));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;n.length=0;let l=this.getSelectedRangeLast(),h=l.getTopStartCorner().row,d=l.getBottomEndCorner().row,w=this.rowIndexMapper,y=w.getRenderableFromVisualIndex(h),S=w.getRenderableFromVisualIndex(d),_=w.getNotTrimmedIndexes(),R=[];if(h!==d){let r=d-h+1;if(r>S-y+1){let r=_.slice(h,d+1);R.push(...r.filter(r=>o.includes(r)))}}else if(0===y&&y<h)R.push(..._.slice(0,h));else if(null===y)R.push(..._.slice(0,this.countRows()));else{let r=this.countRows()-1,n=w.getRenderableFromVisualIndex(w.getNearestNotHiddenIndex(r,-1));S===n&&r>d&&R.push(..._.slice(d+1))}return(0,b.Bk)(R,r=>{n.push(this.toVisualRow(r))}),0===n.length}}}(this))}function hiddenRows_onMapInit(){Array.isArray(hiddenRows_classPrivateFieldGet(nm,this).rows)&&this.hideRows(hiddenRows_classPrivateFieldGet(nm,this).rows)}function manualColumnFreeze_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function manualColumnFreeze_classPrivateFieldGet(r,n){return r.get(manualColumnFreeze_assertClassBrand(r,n))}function manualColumnFreeze_classPrivateFieldSet(r,n,o){return r.set(manualColumnFreeze_assertClassBrand(r,n),o),o}function manualColumnFreeze_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("beforeColumnFreeze"),K.Z.getSingleton().register("afterColumnFreeze"),K.Z.getSingleton().register("beforeColumnUnfreeze"),K.Z.getSingleton().register("afterColumnUnfreeze");let nC="manualColumnFreeze";var nw=new WeakMap,ny=new WeakSet;let ManualColumnFreeze=class ManualColumnFreeze extends BasePlugin{constructor(){super(...arguments),manualColumnFreeze_checkPrivateRedeclaration(this,ny),ny.add(this),manualColumnFreeze_checkPrivateRedeclaration(this,nw),nw.set(this,!1)}static get PLUGIN_KEY(){return nC}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[nC]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",r=>manualColumnFreeze_assertClassBrand(ny,this,_addContextMenuEntry).call(this,r)),this.addHook("beforeColumnMove",(r,n)=>manualColumnFreeze_assertClassBrand(ny,this,_onBeforeColumnMove).call(this,r,n)),super.enablePlugin())}disablePlugin(){manualColumnFreeze_classPrivateFieldSet(nw,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(r){let n=this.hot.getSettings(),o=n.fixedColumnsStart<this.hot.countCols()&&r>n.fixedColumnsStart-1;manualColumnFreeze_classPrivateFieldGet(nw,this)||manualColumnFreeze_classPrivateFieldSet(nw,this,!0);let l=this.hot.runHooks("beforeColumnFreeze",r,o);!1!==l&&(o&&(this.hot.columnIndexMapper.moveIndexes(r,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",r,o))}unfreezeColumn(r){let n=this.hot.getSettings(),o=n.fixedColumnsStart>0&&r<=n.fixedColumnsStart-1;manualColumnFreeze_classPrivateFieldGet(nw,this)||manualColumnFreeze_classPrivateFieldSet(nw,this,!0);let l=this.hot.runHooks("beforeColumnUnfreeze",r,o);!1!==l&&(o&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(r,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",r,o))}};function _addContextMenuEntry(r){var n,o;r.items.push({name:"---------"},(n=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(r,o){let[{start:{col:l}}]=o;n.freezeColumn(l),this.render(),this.view.adjustElementsSize()},hidden(){let r=this.getSelectedRange(),n=!1;return void 0===r?n=!0:r.length>1?n=!0:(r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}),(o=this,{key:"unfreeze_column",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(r,n){let[{start:{col:l}}]=n;o.unfreezeColumn(l),this.render(),this.view.adjustElementsSize()},hidden(){let r=this.getSelectedRange(),n=!1;return void 0===r?n=!0:r.length>1?n=!0:(r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}))}function _onBeforeColumnMove(r,n){if(manualColumnFreeze_classPrivateFieldGet(nw,this)){let o=this.hot.getSettings().fixedColumnsStart;if(n<o||r.some(r=>r<o))return!1}}function manualColumnMove_ui_base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var nS=class{constructor(r){manualColumnMove_ui_base_defineProperty(this,"hot",void 0),manualColumnMove_ui_base_defineProperty(this,"_element",null),manualColumnMove_ui_base_defineProperty(this,"state",0),manualColumnMove_ui_base_defineProperty(this,"inlineProperty",void 0),this.hot=r,this.inlineProperty=r.isRtl()?"right":"left"}appendTo(r){r.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(r,n){(0,ea.kE)(r)&&(this._element.style.top=r+"px"),(0,ea.kE)(n)&&(this._element.style[this.inlineProperty]=n+"px")}getPosition(){let r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}setSize(r,n){(0,ea.kE)(r)&&(this._element.style.width=r+"px"),(0,ea.kE)(n)&&(this._element.style.height=n+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(r,n){(0,ea.kE)(r)&&(this._element.style.marginTop=r+"px"),(0,ea.kE)(n)&&(this._element.style[`margin${(0,R.ct)(this.inlineProperty)}`]=n+"px")}getOffset(){let r=this._element.style,n=`margin${(0,R.ct)(this.inlineProperty)}`;return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}},nb=class extends nS{build(){super.build(),(0,h.cn)(this._element,"ht__manualColumnMove--backlight")}},n_=class extends nS{build(){super.build(),(0,h.cn)(this._element,"ht__manualColumnMove--guideline")}};function manualColumnMove_classPrivateFieldInitSpec(r,n,o){manualColumnMove_checkPrivateRedeclaration(r,n),n.set(r,o)}function manualColumnMove_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function manualColumnMove_classPrivateFieldSet(r,n,o){return r.set(manualColumnMove_assertClassBrand(r,n),o),o}function manualColumnMove_classPrivateFieldGet(r,n){return r.get(manualColumnMove_assertClassBrand(r,n))}function manualColumnMove_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("beforeColumnMove"),K.Z.getSingleton().register("afterColumnMove");let nR="manualColumnMove",nP="ht__manualColumnMove",nE="show-ui",nT="on-moving--columns",nM="after-selection--columns";var nI=new WeakMap,nO=new WeakMap,nx=new WeakMap,nA=new WeakMap,nF=new WeakMap,nk=new WeakMap,nH=new WeakMap,nN=new WeakMap,nD=new WeakMap,nB=new WeakMap,nL=new WeakMap,nV=new WeakSet;let ManualColumnMove=class ManualColumnMove extends BasePlugin{constructor(){super(...arguments),manualColumnMove_checkPrivateRedeclaration(this,nV),nV.add(this),manualColumnMove_classPrivateFieldInitSpec(this,nI,new nb(this.hot)),manualColumnMove_classPrivateFieldInitSpec(this,nO,new n_(this.hot)),manualColumnMove_classPrivateFieldInitSpec(this,nx,[]),manualColumnMove_classPrivateFieldInitSpec(this,nA,0),manualColumnMove_classPrivateFieldInitSpec(this,nF,!1),manualColumnMove_classPrivateFieldInitSpec(this,nk,{}),manualColumnMove_classPrivateFieldInitSpec(this,nH,void 0),manualColumnMove_classPrivateFieldInitSpec(this,nN,void 0),manualColumnMove_classPrivateFieldInitSpec(this,nD,void 0),manualColumnMove_classPrivateFieldInitSpec(this,nB,void 0),manualColumnMove_classPrivateFieldInitSpec(this,nL,void 0)}static get PLUGIN_KEY(){return nR}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[nR]}enablePlugin(){var r=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return manualColumnMove_assertClassBrand(nV,r,manualColumnMove_onBeforeOnCellMouseDown).call(r,...o)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return manualColumnMove_assertClassBrand(nV,r,_onBeforeOnCellMouseOver).call(r,...o)}),this.addHook("afterScrollVertically",()=>manualColumnMove_assertClassBrand(nV,this,_onAfterScrollVertically).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return manualColumnMove_assertClassBrand(nV,r,manualColumnMove_onAfterLoadData).call(r,...o)}),this.buildPluginUI(),this.registerEvents(),(0,h.cn)(this.hot.rootElement,nP),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,h.IV)(this.hot.rootElement,nP),this.unregisterEvents(),manualColumnMove_classPrivateFieldGet(nI,this).destroy(),manualColumnMove_classPrivateFieldGet(nO,this).destroy(),super.disablePlugin()}moveColumn(r,n){return this.moveColumns([r],n)}moveColumns(r,n){let o=manualColumnMove_classPrivateFieldGet(nH,this),l=this.isMovePossible(r,n),h=this.hot.runHooks("beforeColumnMove",r,n,o,l);if(manualColumnMove_classPrivateFieldSet(nH,this,void 0),!1===h)return;l&&this.hot.columnIndexMapper.moveIndexes(r,n);let d=l&&this.isColumnOrderChanged(r,n);return this.hot.runHooks("afterColumnMove",r,n,o,l,d),d}dragColumn(r,n){return this.dragColumns([r],n)}dragColumns(r,n){let o=this.countFinalIndex(r,n);return manualColumnMove_classPrivateFieldSet(nH,this,n),this.moveColumns(r,o)}isMovePossible(r,n){let o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=r.length+n>o,h=r.some(r=>r<0),d=r.some(r=>r>=o);return!l&&!(n<0)&&!h&&!d}isColumnOrderChanged(r,n){return r.some((r,o)=>r-o!==n)}countFinalIndex(r,n){let o=(0,b.k$)(r,(r,o)=>(o<n&&(r+=1),r),0);return n-o}getColumnsWidth(r,n){let o=this.hot.columnIndexMapper,l=0;for(let h=r;h<=n;h+=1){let r=o.getRenderableFromVisualIndex(h);h<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==r&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r)||0)}return l}moveBySettingsOrLoad(){let r=this.hot.getSettings()[nR];if(Array.isArray(r))this.moveColumns(r,0);else if(void 0!==r){let r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(r){return r<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let r={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",r),r.value?r.value:[]}prepareColumnsToMoving(r,n){let o=[];return(0,ea.q4)(r,n,r=>{o.push(r)}),o}refreshPositions(){let r=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(manualColumnMove_classPrivateFieldGet(nN,this))&&r>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1)});let n=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,l="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,d=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,manualColumnMove_classPrivateFieldGet(nN,this)-1),w=n.hider.offsetWidth,y=n.TBODY.offsetLeft,S=manualColumnMove_classPrivateFieldGet(nI,this).getOffset().start,b=manualColumnMove_classPrivateFieldGet(nI,this).getSize().width,_=0,R=0;if(this.hot.isRtl()){let r=this.hot.rootWindow,n=(0,h.iO)(this.hot.rootElement),d=r.innerWidth-manualColumnMove_classPrivateFieldGet(nD,this)-n;R=r.innerWidth-manualColumnMove_classPrivateFieldGet(nk,this).eventPageX-d-(void 0===o.scrollX?l:0)}else R=manualColumnMove_classPrivateFieldGet(nk,this).eventPageX-(manualColumnMove_classPrivateFieldGet(nD,this)-(void 0===o.scrollX?l:0));if(manualColumnMove_classPrivateFieldGet(nB,this)&&(_=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(manualColumnMove_classPrivateFieldGet(nN,this))&&(d+=l),d+=_,0>manualColumnMove_classPrivateFieldGet(nN,this))manualColumnMove_classPrivateFieldGet(nL,this)>0?manualColumnMove_classPrivateFieldGet(nk,this).col=0:manualColumnMove_classPrivateFieldGet(nk,this).col=r>0?r-1:r;else if(manualColumnMove_classPrivateFieldGet(nk,this).TD.offsetWidth/2+d<=R){let r=manualColumnMove_classPrivateFieldGet(nN,this)>=manualColumnMove_classPrivateFieldGet(nA,this)?manualColumnMove_classPrivateFieldGet(nA,this)-1:manualColumnMove_classPrivateFieldGet(nN,this);manualColumnMove_classPrivateFieldGet(nk,this).col=r+1,d+=manualColumnMove_classPrivateFieldGet(nk,this).TD.offsetWidth}else manualColumnMove_classPrivateFieldGet(nk,this).col=manualColumnMove_classPrivateFieldGet(nN,this);let P=R,T=d;R+b+S>=w?P=w-b-S:R+S<y+_&&(P=y+_+Math.abs(S)),d>=w-1?T=w-1:0===T?T=1:void 0!==o.scrollX&&manualColumnMove_classPrivateFieldGet(nN,this)<manualColumnMove_classPrivateFieldGet(nL,this)&&(T-=manualColumnMove_classPrivateFieldGet(nD,this)<=o.scrollX?manualColumnMove_classPrivateFieldGet(nD,this):0),manualColumnMove_classPrivateFieldGet(nI,this).setPosition(null,P),manualColumnMove_classPrivateFieldGet(nO,this).setPosition(null,T)}registerEvents(){let{documentElement:r}=this.hot.rootDocument;this.eventManager.addEventListener(r,"mousemove",r=>manualColumnMove_assertClassBrand(nV,this,manualColumnMove_onMouseMove).call(this,r)),this.eventManager.addEventListener(r,"mouseup",()=>manualColumnMove_assertClassBrand(nV,this,manualColumnMove_onMouseUp).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){manualColumnMove_classPrivateFieldGet(nI,this).build(),manualColumnMove_classPrivateFieldGet(nO,this).build()}destroy(){manualColumnMove_classPrivateFieldGet(nI,this).destroy(),manualColumnMove_classPrivateFieldGet(nO,this).destroy(),super.destroy()}};function manualColumnMove_onBeforeOnCellMouseDown(r,n,o,l){let w=this.hot.view._wt.wtTable,y=this.hot.selection.isSelectedByColumnHeader(),S=this.hot.getSelectedRangeLast(),b=(0,h.pv)(r.target,"sortAction");if(!S||!y||manualColumnMove_classPrivateFieldGet(nF,this)||0!==r.button||b){manualColumnMove_classPrivateFieldSet(nF,this,!1),manualColumnMove_classPrivateFieldGet(nx,this).length=0,(0,h.IV)(this.hot.rootElement,[nT,nE]);return}let _=manualColumnMove_classPrivateFieldGet(nO,this).isBuilt()&&!manualColumnMove_classPrivateFieldGet(nO,this).isAppended(),R=manualColumnMove_classPrivateFieldGet(nI,this).isBuilt()&&!manualColumnMove_classPrivateFieldGet(nI,this).isAppended();_&&R&&(manualColumnMove_classPrivateFieldGet(nO,this).appendTo(w.hider),manualColumnMove_classPrivateFieldGet(nI,this).appendTo(w.hider));let{from:P,to:T}=S,I=Math.min(P.col,T.col),O=Math.max(P.col,T.col);if(n.row<0&&n.col>=I&&n.col<=O){l.column=!0,manualColumnMove_classPrivateFieldSet(nF,this,!0);let y=o.firstChild?(0,d.Zb)(r,o.firstChild).x:r.offsetX;manualColumnMove_classPrivateFieldGet(nk,this).eventPageX=r.pageX,manualColumnMove_classPrivateFieldSet(nN,this,n.col),manualColumnMove_classPrivateFieldGet(nk,this).TD=o,manualColumnMove_classPrivateFieldGet(nk,this).col=n.col,manualColumnMove_classPrivateFieldSet(nx,this,this.prepareColumnsToMoving(I,O)),manualColumnMove_classPrivateFieldSet(nB,this,!!this.hot.getSettings().rowHeaders),manualColumnMove_classPrivateFieldSet(nA,this,this.hot.countCols()),manualColumnMove_classPrivateFieldSet(nL,this,this.hot.getSettings().fixedColumnsStart),manualColumnMove_classPrivateFieldSet(nD,this,(0,h.cv)(this.hot.rootElement).left);let S=manualColumnMove_classPrivateFieldGet(nB,this)?-1:0,b=w.holder.scrollTop+w.getColumnHeaderHeight(0)+1,_=n.col<manualColumnMove_classPrivateFieldGet(nL,this),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),P=Math.abs(y-(this.hot.isRtl()?o.offsetWidth:0)),T=this.getColumnsWidth(I,n.col-1)+P,k=this.getColumnsWidth(S,I-1)+(_?R:0)+T;manualColumnMove_classPrivateFieldGet(nI,this).setPosition(b,k),manualColumnMove_classPrivateFieldGet(nI,this).setSize(this.getColumnsWidth(I,O),w.hider.offsetHeight-b),manualColumnMove_classPrivateFieldGet(nI,this).setOffset(null,-T),(0,h.cn)(this.hot.rootElement,nT)}else(0,h.IV)(this.hot.rootElement,nM),manualColumnMove_classPrivateFieldSet(nF,this,!1),manualColumnMove_classPrivateFieldGet(nx,this).length=0}function manualColumnMove_onMouseMove(r){manualColumnMove_classPrivateFieldGet(nF,this)&&(manualColumnMove_classPrivateFieldGet(nk,this).eventPageX=r.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver(r,n,o,l){let d=this.hot.getSelectedRangeLast();d&&manualColumnMove_classPrivateFieldGet(nF,this)&&(manualColumnMove_classPrivateFieldGet(nx,this).indexOf(n.col)>-1?(0,h.IV)(this.hot.rootElement,nE):(0,h.cn)(this.hot.rootElement,nE),l.row=!0,l.column=!0,l.cell=!0,manualColumnMove_classPrivateFieldSet(nN,this,n.col),manualColumnMove_classPrivateFieldGet(nk,this).TD=o)}function manualColumnMove_onMouseUp(){let r=manualColumnMove_classPrivateFieldGet(nk,this).col,n=manualColumnMove_classPrivateFieldGet(nx,this).length;if(manualColumnMove_classPrivateFieldSet(nN,this,void 0),manualColumnMove_classPrivateFieldSet(nF,this,!1),(0,h.IV)(this.hot.rootElement,[nT,nE,nM]),this.hot.selection.isSelectedByColumnHeader()&&(0,h.cn)(this.hot.rootElement,nM),n<1||void 0===r)return;let o=manualColumnMove_classPrivateFieldGet(nx,this)[0],l=this.hot.toPhysicalColumn(o),d=this.dragColumns(manualColumnMove_classPrivateFieldGet(nx,this),r);if(manualColumnMove_classPrivateFieldGet(nx,this).length=0,!0===d){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let r=this.hot.toVisualColumn(l),o=r+n-1;this.hot.selectColumns(r,o)}}function _onAfterScrollVertically(){let r=this.hot.view._wt.wtTable,n=r.getColumnHeaderHeight(0)+1,o=r.holder.scrollTop,l=n+o;manualColumnMove_classPrivateFieldGet(nI,this).setPosition(l),manualColumnMove_classPrivateFieldGet(nI,this).setSize(null,r.hider.offsetHeight-l)}function manualColumnMove_onAfterLoadData(){this.moveBySettingsOrLoad()}function manualColumnResize_classPrivateFieldInitSpec(r,n,o){manualColumnResize_checkPrivateRedeclaration(r,n),n.set(r,o)}function manualColumnResize_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function manualColumnResize_classPrivateFieldSet(r,n,o){return r.set(manualColumnResize_assertClassBrand(r,n),o),o}function manualColumnResize_classPrivateFieldGet(r,n){return r.get(manualColumnResize_assertClassBrand(r,n))}function manualColumnResize_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let nG="manualColumnResize",nW="manualColumnWidths";var nz=new WeakMap,nj=new WeakMap,nU=new WeakMap,n$=new WeakMap,nK=new WeakMap,nY=new WeakMap,nX=new WeakMap,nq=new WeakMap,nZ=new WeakMap,nJ=new WeakMap,nQ=new WeakMap,n0=new WeakMap,n1=new WeakMap,n2=new WeakMap,n5=new WeakMap,n4=new WeakMap,n3=new WeakSet;let ManualColumnResize=class ManualColumnResize extends BasePlugin{static get PLUGIN_KEY(){return nG}static get PLUGIN_PRIORITY(){return 130}constructor(r){super(r),manualColumnResize_checkPrivateRedeclaration(this,n3),n3.add(this),manualColumnResize_classPrivateFieldInitSpec(this,nz,null),manualColumnResize_classPrivateFieldInitSpec(this,nj,null),manualColumnResize_classPrivateFieldInitSpec(this,nU,[]),manualColumnResize_classPrivateFieldInitSpec(this,n$,null),manualColumnResize_classPrivateFieldInitSpec(this,nK,null),manualColumnResize_classPrivateFieldInitSpec(this,nY,null),manualColumnResize_classPrivateFieldInitSpec(this,nX,null),manualColumnResize_classPrivateFieldInitSpec(this,nq,null),manualColumnResize_classPrivateFieldInitSpec(this,nZ,this.hot.rootDocument.createElement("DIV")),manualColumnResize_classPrivateFieldInitSpec(this,nJ,this.hot.rootDocument.createElement("DIV")),manualColumnResize_classPrivateFieldInitSpec(this,nQ,null),manualColumnResize_classPrivateFieldInitSpec(this,n0,!1),manualColumnResize_classPrivateFieldInitSpec(this,n1,0),manualColumnResize_classPrivateFieldInitSpec(this,n2,null),manualColumnResize_classPrivateFieldInitSpec(this,n5,void 0),manualColumnResize_classPrivateFieldInitSpec(this,n4,void 0),(0,h.cn)(manualColumnResize_classPrivateFieldGet(nZ,this),"manualColumnResizer"),(0,h.cn)(manualColumnResize_classPrivateFieldGet(nJ,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[nG]}enablePlugin(){this.enabled||(manualColumnResize_classPrivateFieldSet(n5,this,new eA.L),manualColumnResize_classPrivateFieldGet(n5,this).addLocalHook("init",()=>manualColumnResize_assertClassBrand(n3,this,manualColumnResize_onMapInit).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,manualColumnResize_classPrivateFieldGet(n5,this)),this.addHook("modifyColWidth",(r,n)=>manualColumnResize_assertClassBrand(n3,this,manualColumnResize_onModifyColWidth).call(this,r,n),1),this.addHook("beforeStretchingColumnWidth",(r,n)=>manualColumnResize_assertClassBrand(n3,this,_onBeforeStretchingColumnWidth).call(this,r,n)),this.addHook("beforeColumnResize",(r,n,o)=>manualColumnResize_assertClassBrand(n3,this,manualColumnResize_onBeforeColumnResize).call(this,r,n,o)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){manualColumnResize_classPrivateFieldSet(n4,this,manualColumnResize_classPrivateFieldGet(n5,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",nW,manualColumnResize_classPrivateFieldGet(n5,this).getValues())}loadManualColumnWidths(){let r={};return this.hot.runHooks("persistentStateLoad",nW,r),r.value}setManualSize(r,n){let o=Math.max(n,20),l=this.hot.toPhysicalColumn(r);return manualColumnResize_classPrivateFieldGet(n5,this).setValueAtIndex(l,o),o}clearManualSize(r){let n=this.hot.toPhysicalColumn(r);manualColumnResize_classPrivateFieldGet(n5,this).setValueAtIndex(n,null)}setupHandlePosition(r){let n;if(!r.parentNode)return;manualColumnResize_classPrivateFieldSet(nz,this,r);let{_wt:o}=this.hot.view,l=o.wtTable.getCoords(manualColumnResize_classPrivateFieldGet(nz,this)),d=l.col;if(d<0)return;let w=(0,h.Pb)(manualColumnResize_classPrivateFieldGet(nz,this)),y=manualColumnResize_classPrivateFieldGet(nz,this).getBoundingClientRect(),S=d<o.getSetting("fixedColumnsStart");S&&(n=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(manualColumnResize_classPrivateFieldGet(nz,this),l.row,l.col)),n||(n=o.wtOverlays.topOverlay.getRelativeCellPosition(manualColumnResize_classPrivateFieldGet(nz,this),l.row,l.col)),manualColumnResize_classPrivateFieldSet(nj,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)),manualColumnResize_classPrivateFieldSet(nU,this,[]);let _=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&_){let r=this.hot.getSelectedRange();(0,b.Bk)(r,r=>{let n=r.getTopStartCorner().col,o=r.getBottomEndCorner().col;(0,ea.q4)(n,o,r=>{manualColumnResize_classPrivateFieldGet(nU,this).includes(r)||manualColumnResize_classPrivateFieldGet(nU,this).push(r)})})}manualColumnResize_classPrivateFieldGet(nU,this).includes(manualColumnResize_classPrivateFieldGet(nj,this))||manualColumnResize_classPrivateFieldSet(nU,this,[manualColumnResize_classPrivateFieldGet(nj,this)]),manualColumnResize_classPrivateFieldSet(nq,this,n.start-6),manualColumnResize_classPrivateFieldSet(nX,this,parseInt(y.width,10)),manualColumnResize_classPrivateFieldGet(nZ,this).style.top=`${n.top}px`,manualColumnResize_classPrivateFieldGet(nZ,this).style[this.inlineDir]=`${manualColumnResize_classPrivateFieldGet(nq,this)+manualColumnResize_classPrivateFieldGet(nX,this)}px`,manualColumnResize_classPrivateFieldGet(nZ,this).style.height=`${w}px`,this.hot.rootElement.appendChild(manualColumnResize_classPrivateFieldGet(nZ,this))}refreshHandlePosition(){manualColumnResize_classPrivateFieldGet(nZ,this).style[this.inlineDir]=`${manualColumnResize_classPrivateFieldGet(nq,this)+manualColumnResize_classPrivateFieldGet(n$,this)}px`}setupGuidePosition(){let r=parseInt((0,h.Pb)(manualColumnResize_classPrivateFieldGet(nZ,this)),10),n=parseInt(manualColumnResize_classPrivateFieldGet(nZ,this).style.top,10)+r,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,h.cn)(manualColumnResize_classPrivateFieldGet(nZ,this),"active"),(0,h.cn)(manualColumnResize_classPrivateFieldGet(nJ,this),"active"),manualColumnResize_classPrivateFieldGet(nJ,this).style.top=`${n}px`,this.refreshGuidePosition(),manualColumnResize_classPrivateFieldGet(nJ,this).style.height=`${o-r}px`,this.hot.rootElement.appendChild(manualColumnResize_classPrivateFieldGet(nJ,this))}refreshGuidePosition(){manualColumnResize_classPrivateFieldGet(nJ,this).style[this.inlineDir]=manualColumnResize_classPrivateFieldGet(nZ,this).style[this.inlineDir]}hideHandleAndGuide(){(0,h.IV)(manualColumnResize_classPrivateFieldGet(nZ,this),"active"),(0,h.IV)(manualColumnResize_classPrivateFieldGet(nJ,this),"active")}checkIfColumnHeader(r){let n=(0,h.oq)(r,["THEAD"],this.hot.rootElement),{topOverlay:o,topInlineStartCornerOverlay:l}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.THEAD,l.clone.wtTable.THEAD].includes(n)}getClosestTHParent(r){return"TABLE"!==r.tagName?"TH"===r.tagName?r:this.getClosestTHParent(r.parentNode):null}afterMouseDownTimeout(){let render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},resize=(r,n)=>{let o=this.hot.runHooks("beforeColumnResize",manualColumnResize_classPrivateFieldGet(nK,this),r,!0);void 0!==o&&manualColumnResize_classPrivateFieldSet(nK,this,o),"all"===this.hot.getSettings().stretchH?this.clearManualSize(r):this.setManualSize(r,manualColumnResize_classPrivateFieldGet(nK,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",manualColumnResize_classPrivateFieldGet(nK,this),r,!0),n&&render()};if(manualColumnResize_classPrivateFieldGet(n1,this)>=2){let r=manualColumnResize_classPrivateFieldGet(nU,this).length;r>1?((0,b.Bk)(manualColumnResize_classPrivateFieldGet(nU,this),r=>{resize(r)}),render()):(0,b.Bk)(manualColumnResize_classPrivateFieldGet(nU,this),r=>{resize(r,!0)})}manualColumnResize_classPrivateFieldSet(n1,this,0),manualColumnResize_classPrivateFieldSet(n2,this,null)}bindEvents(){let{rootWindow:r,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>manualColumnResize_assertClassBrand(n3,this,manualColumnResize_onMouseOver).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>manualColumnResize_assertClassBrand(n3,this,manualColumnResize_onMouseDown).call(this,r)),this.eventManager.addEventListener(r,"mousemove",r=>manualColumnResize_assertClassBrand(n3,this,manualColumnResize_onMouseMove).call(this,r)),this.eventManager.addEventListener(r,"mouseup",()=>manualColumnResize_assertClassBrand(n3,this,manualColumnResize_onMouseUp).call(this)),this.eventManager.addEventListener(manualColumnResize_classPrivateFieldGet(nZ,this),"contextmenu",()=>manualColumnResize_assertClassBrand(n3,this,_onContextMenu).call(this))}destroy(){super.destroy()}};function manualColumnResize_onMapInit(){let r=this.hot.getSettings()[nG],n=this.loadManualColumnWidths();void 0!==n?this.hot.batchExecution(()=>{n.forEach((r,n)=>{manualColumnResize_classPrivateFieldGet(n5,this).setValueAtIndex(n,r)})},!0):Array.isArray(r)?(this.hot.batchExecution(()=>{r.forEach((r,n)=>{manualColumnResize_classPrivateFieldGet(n5,this).setValueAtIndex(n,r)})},!0),manualColumnResize_classPrivateFieldSet(n4,this,r)):!0===r&&Array.isArray(manualColumnResize_classPrivateFieldGet(n4,this))&&this.hot.batchExecution(()=>{manualColumnResize_classPrivateFieldGet(n4,this).forEach((r,n)=>{manualColumnResize_classPrivateFieldGet(n5,this).setValueAtIndex(n,r)})},!0)}function manualColumnResize_onMouseOver(r){if(!(0,h.z4)(r.target)&&!0!==manualColumnResize_classPrivateFieldGet(n0,this)&&this.checkIfColumnHeader(r.target)){let n=this.getClosestTHParent(r.target);if(!n)return;let o=n.getAttribute("colspan");n&&(null===o||"1"===o)&&!manualColumnResize_classPrivateFieldGet(nQ,this)&&this.setupHandlePosition(n)}}function manualColumnResize_onMouseDown(r){r.target.parentNode===this.hot.rootElement&&(0,h.pv)(r.target,"manualColumnResizer")&&(this.setupHandlePosition(manualColumnResize_classPrivateFieldGet(nz,this)),this.setupGuidePosition(),manualColumnResize_classPrivateFieldSet(nQ,this,!0),null===manualColumnResize_classPrivateFieldGet(n2,this)&&(manualColumnResize_classPrivateFieldSet(n2,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(manualColumnResize_classPrivateFieldGet(n2,this))),manualColumnResize_classPrivateFieldSet(n1,this,manualColumnResize_classPrivateFieldGet(n1,this)+1),this.startX=r.pageX,manualColumnResize_classPrivateFieldSet(nK,this,manualColumnResize_classPrivateFieldGet(nX,this)))}function manualColumnResize_onMouseMove(r){if(manualColumnResize_classPrivateFieldGet(nQ,this)){let n=(r.pageX-this.startX)*this.hot.getDirectionFactor();manualColumnResize_classPrivateFieldSet(n$,this,manualColumnResize_classPrivateFieldGet(nX,this)+n),(0,b.Bk)(manualColumnResize_classPrivateFieldGet(nU,this),r=>{manualColumnResize_classPrivateFieldSet(nK,this,this.setManualSize(r,manualColumnResize_classPrivateFieldGet(n$,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function manualColumnResize_onMouseUp(){let render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},resize=(r,n)=>{this.hot.runHooks("beforeColumnResize",manualColumnResize_classPrivateFieldGet(nK,this),r,!1),n&&render(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",manualColumnResize_classPrivateFieldGet(nK,this),r,!1)};if(manualColumnResize_classPrivateFieldGet(nQ,this)){if(this.hideHandleAndGuide(),manualColumnResize_classPrivateFieldSet(nQ,this,!1),manualColumnResize_classPrivateFieldGet(nK,this)!==manualColumnResize_classPrivateFieldGet(nX,this)){let r=manualColumnResize_classPrivateFieldGet(nU,this).length;r>1?((0,b.Bk)(manualColumnResize_classPrivateFieldGet(nU,this),r=>{resize(r)}),render()):(0,b.Bk)(manualColumnResize_classPrivateFieldGet(nU,this),r=>{resize(r,!0)})}this.setupHandlePosition(manualColumnResize_classPrivateFieldGet(nz,this))}}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(manualColumnResize_classPrivateFieldGet(nZ,this)),this.hot.rootElement.removeChild(manualColumnResize_classPrivateFieldGet(nJ,this)),manualColumnResize_classPrivateFieldSet(nQ,this,!1),manualColumnResize_classPrivateFieldSet(n0,this,!0),this.hot._registerImmediate(()=>{manualColumnResize_classPrivateFieldSet(n0,this,!1)})}function manualColumnResize_onModifyColWidth(r,n){let o=r;if(this.enabled){let r=this.hot.toPhysicalColumn(n),l=manualColumnResize_classPrivateFieldGet(n5,this).getValueAtIndex(r);this.hot.getSettings()[nG]&&l&&(o=l)}return o}function _onBeforeStretchingColumnWidth(r,n){let o=manualColumnResize_classPrivateFieldGet(n5,this).getValueAtIndex(n);return null===o&&(o=r),o}function manualColumnResize_onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function manualRowMove_ui_base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var n8=class{constructor(r){manualRowMove_ui_base_defineProperty(this,"hot",void 0),manualRowMove_ui_base_defineProperty(this,"_element",null),manualRowMove_ui_base_defineProperty(this,"state",0),this.hot=r}appendTo(r){r.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(r,n){void 0!==r&&(this._element.style.top=r+"px"),void 0!==n&&(this._element.style.left=n+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(r,n){r&&(this._element.style.width=r+"px"),n&&(this._element.style.height=n+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(r,n){r&&(this._element.style.marginTop=r+"px"),n&&(this._element.style.marginLeft=n+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},n9=class extends n8{build(){super.build(),(0,h.cn)(this._element,"ht__manualRowMove--backlight")}},n7=class extends n8{build(){super.build(),(0,h.cn)(this._element,"ht__manualRowMove--guideline")}};function manualRowMove_classPrivateFieldInitSpec(r,n,o){manualRowMove_checkPrivateRedeclaration(r,n),n.set(r,o)}function manualRowMove_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function manualRowMove_classPrivateFieldSet(r,n,o){return r.set(manualRowMove_assertClassBrand(r,n),o),o}function manualRowMove_classPrivateFieldGet(r,n){return r.get(manualRowMove_assertClassBrand(r,n))}function manualRowMove_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("beforeRowMove"),K.Z.getSingleton().register("afterRowMove");let n6="manualRowMove",se="ht__manualRowMove",st="show-ui",si="on-moving--rows",sr="after-selection--rows";var sn=new WeakMap,ss=new WeakMap,so=new WeakMap,sl=new WeakMap,sa=new WeakMap,sh=new WeakMap,sd=new WeakSet;let ManualRowMove=class ManualRowMove extends BasePlugin{constructor(){super(...arguments),manualRowMove_checkPrivateRedeclaration(this,sd),sd.add(this),manualRowMove_classPrivateFieldInitSpec(this,sn,new n9(this.hot)),manualRowMove_classPrivateFieldInitSpec(this,ss,new n7(this.hot)),manualRowMove_classPrivateFieldInitSpec(this,so,[]),manualRowMove_classPrivateFieldInitSpec(this,sl,void 0),manualRowMove_classPrivateFieldInitSpec(this,sa,{}),manualRowMove_classPrivateFieldInitSpec(this,sh,void 0)}static get PLUGIN_KEY(){return n6}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[n6]}enablePlugin(){var r=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return manualRowMove_assertClassBrand(sd,r,manualRowMove_onBeforeOnCellMouseDown).call(r,...o)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return manualRowMove_assertClassBrand(sd,r,manualRowMove_onBeforeOnCellMouseOver).call(r,...o)}),this.addHook("afterScrollHorizontally",()=>manualRowMove_assertClassBrand(sd,this,_onAfterScrollHorizontally).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return manualRowMove_assertClassBrand(sd,r,manualRowMove_onAfterLoadData).call(r,...o)}),this.buildPluginUI(),this.registerEvents(),(0,h.cn)(this.hot.rootElement,se),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,h.IV)(this.hot.rootElement,se),this.unregisterEvents(),manualRowMove_classPrivateFieldGet(sn,this).destroy(),manualRowMove_classPrivateFieldGet(ss,this).destroy(),super.disablePlugin()}moveRow(r,n){return this.moveRows([r],n)}moveRows(r,n){let o=manualRowMove_classPrivateFieldGet(sh,this),l=this.isMovePossible(r,n),h=this.hot.runHooks("beforeRowMove",r,n,o,l);if(manualRowMove_classPrivateFieldSet(sh,this,void 0),!1===h)return;l&&this.hot.rowIndexMapper.moveIndexes(r,n);let d=l&&this.isRowOrderChanged(r,n);return this.hot.runHooks("afterRowMove",r,n,o,l,d),d}dragRow(r,n){return this.dragRows([r],n)}dragRows(r,n){let o=this.countFinalIndex(r,n);return manualRowMove_classPrivateFieldSet(sh,this,n),this.moveRows(r,o)}isMovePossible(r,n){let o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=r.length+n>o,h=r.some(r=>r<0),d=r.some(r=>r>=o);return!l&&!(n<0)&&!h&&!d}isRowOrderChanged(r,n){return r.some((r,o)=>r-o!==n)}countFinalIndex(r,n){let o=(0,b.k$)(r,(r,o)=>(o<n&&(r+=1),r),0);return n-o}getRowsHeight(r,n){let o=this.hot.rowIndexMapper,l=0;for(let h=r;h<=n;h++){let r=o.getRenderableFromVisualIndex(h);null!==r&&(l+=this.hot.view._wt.wtTable.getRowHeight(r)||23)}return l}moveBySettingsOrLoad(){let r=this.hot.getSettings()[n6];if(Array.isArray(r))this.moveRows(r,0);else if(void 0!==r){let r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(r){return r<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(r){return r>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let r={};return this.hot.runHooks("persistentStateLoad","manualRowMove",r),r.value?r.value:[]}prepareRowsToMoving(){let r=this.hot.getSelectedRangeLast(),n=[];if(!r)return n;let{from:o,to:l}=r,h=Math.min(o.row,l.row),d=Math.max(o.row,l.row);return(0,ea.q4)(h,d,r=>{n.push(r)}),n}refreshPositions(){let r=manualRowMove_classPrivateFieldGet(sa,this).coords,n=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(r.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(r.row)&&o<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);let d=this.hot.view._wt.wtTable,w=manualRowMove_classPrivateFieldGet(sa,this).TD,y=this.hot.rootElement,S=(0,h.cv)(y),b=(0,h.$g)(y),_=d.holder.scrollTop,R=this.hot.rootWindow!==b?b.scrollTop:0,P=S.top-R,T=manualRowMove_classPrivateFieldGet(sa,this).eventPageY-P+_,I=d.hider.offsetHeight,O=d.TBODY.offsetTop,k=manualRowMove_classPrivateFieldGet(sn,this).getOffset().top,N=manualRowMove_classPrivateFieldGet(sn,this).getSize().height,L=w.offsetHeight/2,j=w.offsetHeight,U=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,r.row-1),$=T>=U+L;this.isFixedRowTop(r.row)&&(U+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),r.row<0?manualRowMove_classPrivateFieldGet(sa,this).row=n>0?n-1:n:$?(manualRowMove_classPrivateFieldGet(sa,this).row=r.row+1,U+=0===r.row?j-1:j):manualRowMove_classPrivateFieldGet(sa,this).row=r.row;let K=T,Y=U;T+N+k>=I?K=I-N-k:T+k<O&&(K=O+Math.abs(k)),U>=I-1&&(Y=I-1),manualRowMove_classPrivateFieldGet(sn,this).setPosition(K),manualRowMove_classPrivateFieldGet(ss,this).setPosition(Y)}registerEvents(){let{documentElement:r}=this.hot.rootDocument;this.eventManager.addEventListener(r,"mousemove",r=>manualRowMove_assertClassBrand(sd,this,manualRowMove_onMouseMove).call(this,r)),this.eventManager.addEventListener(r,"mouseup",()=>manualRowMove_assertClassBrand(sd,this,manualRowMove_onMouseUp).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){manualRowMove_classPrivateFieldGet(sn,this).build(),manualRowMove_classPrivateFieldGet(ss,this).build()}destroy(){manualRowMove_classPrivateFieldGet(sn,this).destroy(),manualRowMove_classPrivateFieldGet(ss,this).destroy(),super.destroy()}};function manualRowMove_onBeforeOnCellMouseDown(r,n,o,l){let{wtTable:d,wtViewport:w}=this.hot.view._wt,y=this.hot.selection.isSelectedByRowHeader(),S=this.hot.getSelectedRangeLast();if(!S||!y||manualRowMove_classPrivateFieldGet(sl,this)||0!==r.button){manualRowMove_classPrivateFieldSet(sl,this,!1),manualRowMove_classPrivateFieldGet(so,this).length=0,(0,h.IV)(this.hot.rootElement,[si,st]);return}let b=manualRowMove_classPrivateFieldGet(ss,this).isBuilt()&&!manualRowMove_classPrivateFieldGet(ss,this).isAppended(),_=manualRowMove_classPrivateFieldGet(sn,this).isBuilt()&&!manualRowMove_classPrivateFieldGet(sn,this).isAppended();b&&_&&(manualRowMove_classPrivateFieldGet(ss,this).appendTo(d.hider),manualRowMove_classPrivateFieldGet(sn,this).appendTo(d.hider));let{from:R,to:P}=S,T=Math.min(R.row,P.row),I=Math.max(R.row,P.row);if(n.col<0&&n.row>=T&&n.row<=I){l.row=!0,manualRowMove_classPrivateFieldSet(sl,this,!0),manualRowMove_classPrivateFieldGet(sa,this).eventPageY=r.pageY,manualRowMove_classPrivateFieldGet(sa,this).coords=n,manualRowMove_classPrivateFieldGet(sa,this).TD=o,manualRowMove_classPrivateFieldSet(so,this,this.prepareRowsToMoving());let y=d.holder.scrollLeft+w.getRowHeaderWidth(),S=this.getRowsHeight(T,n.row-1)+r.offsetY;manualRowMove_classPrivateFieldGet(sn,this).setPosition(null,y),manualRowMove_classPrivateFieldGet(sn,this).setSize(d.hider.offsetWidth-y,this.getRowsHeight(T,I)),manualRowMove_classPrivateFieldGet(sn,this).setOffset(-S,null),(0,h.cn)(this.hot.rootElement,si),this.refreshPositions()}else(0,h.IV)(this.hot.rootElement,sr),manualRowMove_classPrivateFieldSet(sl,this,!1),manualRowMove_classPrivateFieldGet(so,this).length=0}function manualRowMove_onMouseMove(r){manualRowMove_classPrivateFieldGet(sl,this)&&(manualRowMove_classPrivateFieldGet(sa,this).eventPageY=r.pageY,this.refreshPositions())}function manualRowMove_onBeforeOnCellMouseOver(r,n,o,l){let d=this.hot.getSelectedRangeLast();d&&manualRowMove_classPrivateFieldGet(sl,this)&&(manualRowMove_classPrivateFieldGet(so,this).indexOf(n.row)>-1?(0,h.IV)(this.hot.rootElement,st):(0,h.cn)(this.hot.rootElement,st),l.row=!0,l.column=!0,l.cell=!0,manualRowMove_classPrivateFieldGet(sa,this).coords=n,manualRowMove_classPrivateFieldGet(sa,this).TD=o)}function manualRowMove_onMouseUp(){let r=manualRowMove_classPrivateFieldGet(sa,this).row,n=manualRowMove_classPrivateFieldGet(so,this).length;if(manualRowMove_classPrivateFieldSet(sl,this,!1),(0,h.IV)(this.hot.rootElement,[si,st,sr]),this.hot.selection.isSelectedByRowHeader()&&(0,h.cn)(this.hot.rootElement,sr),n<1||void 0===r)return;let o=manualRowMove_classPrivateFieldGet(so,this)[0],l=this.hot.toPhysicalRow(o),d=this.dragRows(manualRowMove_classPrivateFieldGet(so,this),r);if(manualRowMove_classPrivateFieldGet(so,this).length=0,!0===d){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let r=this.hot.toVisualRow(l),o=r+n-1;this.hot.selectRows(r,o)}}function _onAfterScrollHorizontally(){let r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=r.holder.scrollLeft,l=n+o;manualRowMove_classPrivateFieldGet(sn,this).setPosition(null,l),manualRowMove_classPrivateFieldGet(sn,this).setSize(r.hider.offsetWidth-l)}function manualRowMove_onAfterLoadData(){this.moveBySettingsOrLoad()}var sc=o(3391);function manualRowResize_classPrivateFieldInitSpec(r,n,o){manualRowResize_checkPrivateRedeclaration(r,n),n.set(r,o)}function manualRowResize_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function manualRowResize_classPrivateFieldSet(r,n,o){return r.set(manualRowResize_assertClassBrand(r,n),o),o}function manualRowResize_classPrivateFieldGet(r,n){return r.get(manualRowResize_assertClassBrand(r,n))}function manualRowResize_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let su="manualRowResize",sg="manualRowHeights";var sf=new WeakMap,sm=new WeakMap,sp=new WeakMap,sv=new WeakMap,sC=new WeakMap,sw=new WeakMap,sy=new WeakMap,sS=new WeakMap,sb=new WeakMap,s_=new WeakMap,sR=new WeakMap,sP=new WeakMap,sE=new WeakMap,sT=new WeakMap,sM=new WeakMap,sI=new WeakMap,sO=new WeakSet;let ManualRowResize=class ManualRowResize extends BasePlugin{static get PLUGIN_KEY(){return su}static get PLUGIN_PRIORITY(){return 30}constructor(r){super(r),manualRowResize_checkPrivateRedeclaration(this,sO),sO.add(this),manualRowResize_classPrivateFieldInitSpec(this,sf,null),manualRowResize_classPrivateFieldInitSpec(this,sm,null),manualRowResize_classPrivateFieldInitSpec(this,sp,[]),manualRowResize_classPrivateFieldInitSpec(this,sv,null),manualRowResize_classPrivateFieldInitSpec(this,sC,null),manualRowResize_classPrivateFieldInitSpec(this,sw,null),manualRowResize_classPrivateFieldInitSpec(this,sy,null),manualRowResize_classPrivateFieldInitSpec(this,sS,null),manualRowResize_classPrivateFieldInitSpec(this,sb,this.hot.rootDocument.createElement("DIV")),manualRowResize_classPrivateFieldInitSpec(this,s_,this.hot.rootDocument.createElement("DIV")),manualRowResize_classPrivateFieldInitSpec(this,sR,!1),manualRowResize_classPrivateFieldInitSpec(this,sP,!1),manualRowResize_classPrivateFieldInitSpec(this,sE,0),manualRowResize_classPrivateFieldInitSpec(this,sT,null),manualRowResize_classPrivateFieldInitSpec(this,sM,void 0),manualRowResize_classPrivateFieldInitSpec(this,sI,void 0),(0,h.cn)(manualRowResize_classPrivateFieldGet(sb,this),"manualRowResizer"),(0,h.cn)(manualRowResize_classPrivateFieldGet(s_,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[su]}enablePlugin(){this.enabled||(manualRowResize_classPrivateFieldSet(sM,this,new eA.L),manualRowResize_classPrivateFieldGet(sM,this).addLocalHook("init",()=>manualRowResize_assertClassBrand(sO,this,manualRowResize_onMapInit).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,manualRowResize_classPrivateFieldGet(sM,this)),this.addHook("modifyRowHeight",(r,n)=>manualRowResize_assertClassBrand(sO,this,manualRowResize_onModifyRowHeight).call(this,r,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){manualRowResize_classPrivateFieldSet(sI,this,manualRowResize_classPrivateFieldGet(sM,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",sg,manualRowResize_classPrivateFieldGet(sM,this).getValues())}loadManualRowHeights(){let r={};return this.hot.runHooks("persistentStateLoad",sg,r),r.value}setManualSize(r,n){let o=this.hot.toPhysicalRow(r),l=Math.max(n,sc.R);return manualRowResize_classPrivateFieldGet(sM,this).setValueAtIndex(o,l),l}getLastDesiredRowHeight(){return manualRowResize_classPrivateFieldGet(sv,this)}setupHandlePosition(r){let n;manualRowResize_classPrivateFieldSet(sf,this,r);let{view:o}=this.hot,{_wt:l}=o,d=l.wtTable.getCoords(manualRowResize_classPrivateFieldGet(sf,this)),w=d.row;if(w<0)return;let y=(0,h.iO)(manualRowResize_classPrivateFieldGet(sf,this)),S=manualRowResize_classPrivateFieldGet(sf,this).getBoundingClientRect(),_=w<l.getSetting("fixedRowsTop"),R=w>=o.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom");_?n=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(manualRowResize_classPrivateFieldGet(sf,this),d.row,d.col):R&&(n=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(manualRowResize_classPrivateFieldGet(sf,this),d.row,d.col)),n||(n=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(manualRowResize_classPrivateFieldGet(sf,this),d.row,d.col)),manualRowResize_classPrivateFieldSet(sm,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(w)),manualRowResize_classPrivateFieldSet(sp,this,[]);let P=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&P){let r=this.hot.getSelectedRange();(0,b.Bk)(r,r=>{let n=r.getTopStartCorner().row,o=r.getBottomStartCorner().row;(0,ea.q4)(n,o,r=>{manualRowResize_classPrivateFieldGet(sp,this).includes(r)||manualRowResize_classPrivateFieldGet(sp,this).push(r)})})}manualRowResize_classPrivateFieldGet(sp,this).includes(manualRowResize_classPrivateFieldGet(sm,this))||manualRowResize_classPrivateFieldSet(sp,this,[manualRowResize_classPrivateFieldGet(sm,this)]),manualRowResize_classPrivateFieldSet(sS,this,n.top-6),manualRowResize_classPrivateFieldSet(sy,this,parseInt(S.height,10)),manualRowResize_classPrivateFieldGet(sb,this).style.top=`${manualRowResize_classPrivateFieldGet(sS,this)+manualRowResize_classPrivateFieldGet(sy,this)}px`,manualRowResize_classPrivateFieldGet(sb,this).style[this.inlineDir]=`${n.start}px`,manualRowResize_classPrivateFieldGet(sb,this).style.width=`${y}px`,this.hot.rootElement.appendChild(manualRowResize_classPrivateFieldGet(sb,this))}refreshHandlePosition(){manualRowResize_classPrivateFieldGet(sb,this).style.top=`${manualRowResize_classPrivateFieldGet(sS,this)+manualRowResize_classPrivateFieldGet(sv,this)}px`}setupGuidePosition(){let r=parseInt((0,h.iO)(manualRowResize_classPrivateFieldGet(sb,this)),10),n=parseInt(manualRowResize_classPrivateFieldGet(sb,this).style[this.inlineDir],10)+r,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,h.cn)(manualRowResize_classPrivateFieldGet(sb,this),"active"),(0,h.cn)(manualRowResize_classPrivateFieldGet(s_,this),"active"),manualRowResize_classPrivateFieldGet(s_,this).style.top=manualRowResize_classPrivateFieldGet(sb,this).style.top,manualRowResize_classPrivateFieldGet(s_,this).style[this.inlineDir]=`${n}px`,manualRowResize_classPrivateFieldGet(s_,this).style.width=`${o-r}px`,this.hot.rootElement.appendChild(manualRowResize_classPrivateFieldGet(s_,this))}refreshGuidePosition(){manualRowResize_classPrivateFieldGet(s_,this).style.top=manualRowResize_classPrivateFieldGet(sb,this).style.top}hideHandleAndGuide(){(0,h.IV)(manualRowResize_classPrivateFieldGet(sb,this),"active"),(0,h.IV)(manualRowResize_classPrivateFieldGet(s_,this),"active")}checkIfRowHeader(r){let n=(0,h.oq)(r,["TBODY"],this.hot.rootElement),{inlineStartOverlay:o,topInlineStartCornerOverlay:l,bottomInlineStartCornerOverlay:d}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.TBODY,l.clone.wtTable.TBODY,d.clone.wtTable.TBODY].includes(n)}getClosestTHParent(r){return"TABLE"!==r.tagName?"TH"===r.tagName?r:this.getClosestTHParent(r.parentNode):null}getActualRowHeight(r){let n=this.hot.view._wt.wtTable.getRowHeight(r);return void 0!==n&&manualRowResize_classPrivateFieldGet(sC,this)<n?n:manualRowResize_classPrivateFieldGet(sC,this)}afterMouseDownTimeout(){let render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},resize=(r,n)=>{let o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);void 0!==o&&manualRowResize_classPrivateFieldSet(sC,this,o),this.setManualSize(r,manualRowResize_classPrivateFieldGet(sC,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),n&&render()};if(manualRowResize_classPrivateFieldGet(sE,this)>=2){let r=manualRowResize_classPrivateFieldGet(sp,this).length;r>1?((0,b.Bk)(manualRowResize_classPrivateFieldGet(sp,this),r=>{resize(r)}),render()):(0,b.Bk)(manualRowResize_classPrivateFieldGet(sp,this),r=>{resize(r,!0)})}manualRowResize_classPrivateFieldSet(sE,this,0),manualRowResize_classPrivateFieldSet(sT,this,null)}bindEvents(){let{rootElement:r,rootWindow:n}=this.hot;this.eventManager.addEventListener(r,"mouseover",r=>manualRowResize_assertClassBrand(sO,this,manualRowResize_onMouseOver).call(this,r)),this.eventManager.addEventListener(r,"mousedown",r=>manualRowResize_assertClassBrand(sO,this,manualRowResize_onMouseDown).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>manualRowResize_assertClassBrand(sO,this,manualRowResize_onMouseMove).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>manualRowResize_assertClassBrand(sO,this,manualRowResize_onMouseUp).call(this)),this.eventManager.addEventListener(manualRowResize_classPrivateFieldGet(sb,this),"contextmenu",()=>manualRowResize_assertClassBrand(sO,this,manualRowResize_onContextMenu).call(this))}destroy(){super.destroy()}};function manualRowResize_onMouseOver(r){if(!(0,h.z4)(r.target)&&!0!==manualRowResize_classPrivateFieldGet(sP,this)&&this.checkIfRowHeader(r.target)){let n=this.getClosestTHParent(r.target);n&&!manualRowResize_classPrivateFieldGet(sR,this)&&this.setupHandlePosition(n)}}function manualRowResize_onMouseDown(r){(0,h.pv)(r.target,"manualRowResizer")&&(this.setupHandlePosition(manualRowResize_classPrivateFieldGet(sf,this)),this.setupGuidePosition(),manualRowResize_classPrivateFieldSet(sR,this,!0),null===manualRowResize_classPrivateFieldGet(sT,this)&&(manualRowResize_classPrivateFieldSet(sT,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(manualRowResize_classPrivateFieldGet(sT,this))),manualRowResize_classPrivateFieldSet(sE,this,manualRowResize_classPrivateFieldGet(sE,this)+1),manualRowResize_classPrivateFieldSet(sw,this,r.pageY),manualRowResize_classPrivateFieldSet(sC,this,manualRowResize_classPrivateFieldGet(sy,this)))}function manualRowResize_onMouseMove(r){manualRowResize_classPrivateFieldGet(sR,this)&&(manualRowResize_classPrivateFieldSet(sv,this,manualRowResize_classPrivateFieldGet(sy,this)+(r.pageY-manualRowResize_classPrivateFieldGet(sw,this))),(0,b.Bk)(manualRowResize_classPrivateFieldGet(sp,this),r=>{manualRowResize_classPrivateFieldSet(sC,this,this.setManualSize(r,manualRowResize_classPrivateFieldGet(sv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function manualRowResize_onMouseUp(){let render=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},runHooks=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&render(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};if(manualRowResize_classPrivateFieldGet(sR,this)){if(this.hideHandleAndGuide(),manualRowResize_classPrivateFieldSet(sR,this,!1),manualRowResize_classPrivateFieldGet(sC,this)!==manualRowResize_classPrivateFieldGet(sy,this)){let r=manualRowResize_classPrivateFieldGet(sp,this).length;r>1?((0,b.Bk)(manualRowResize_classPrivateFieldGet(sp,this),r=>{runHooks(r)}),render()):(0,b.Bk)(manualRowResize_classPrivateFieldGet(sp,this),r=>{runHooks(r,!0)})}this.setupHandlePosition(manualRowResize_classPrivateFieldGet(sf,this))}}function manualRowResize_onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(manualRowResize_classPrivateFieldGet(sb,this)),this.hot.rootElement.removeChild(manualRowResize_classPrivateFieldGet(s_,this)),manualRowResize_classPrivateFieldSet(sR,this,!1),manualRowResize_classPrivateFieldSet(sP,this,!0),this.hot._registerImmediate(()=>{manualRowResize_classPrivateFieldSet(sP,this,!1)})}function manualRowResize_onModifyRowHeight(r,n){let o=r;if(this.enabled){let r=this.hot.toPhysicalRow(n),l=manualRowResize_classPrivateFieldGet(sM,this).getValueAtIndex(r);this.hot.getSettings()[su]&&l&&(o=l)}return o}function manualRowResize_onMapInit(){let r=this.hot.getSettings()[su],n=this.loadManualRowHeights();this.hot.batchExecution(()=>{void 0!==n?n.forEach((r,n)=>{manualRowResize_classPrivateFieldGet(sM,this).setValueAtIndex(n,r)}):Array.isArray(r)?(r.forEach((r,n)=>{manualRowResize_classPrivateFieldGet(sM,this).setValueAtIndex(n,r)}),manualRowResize_classPrivateFieldSet(sI,this,r)):!0===r&&Array.isArray(manualRowResize_classPrivateFieldGet(sI,this))&&manualRowResize_classPrivateFieldGet(sI,this).forEach((r,n)=>{manualRowResize_classPrivateFieldGet(sM,this).setValueAtIndex(n,r)})},!0)}function cellCoords_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function cellCoords_classPrivateFieldSet(r,n,o){return r.set(cellCoords_assertClassBrand(r,n),o),o}function cellCoords_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}o(79328);var sx=new WeakMap,sA=class{constructor(r,n,o,l,h,d){cellCoords_defineProperty(this,"row",void 0),cellCoords_defineProperty(this,"col",void 0),cellCoords_defineProperty(this,"rowspan",void 0),cellCoords_defineProperty(this,"colspan",void 0),cellCoords_defineProperty(this,"removed",!1),cellCoords_defineProperty(this,"cellCoordsFactory",void 0),cellCoords_defineProperty(this,"cellRangeFactory",void 0),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,sx),sx.set(this,null),this.row=r,this.col=n,this.rowspan=o,this.colspan=l,this.cellCoordsFactory=h,this.cellRangeFactory=d}static NEGATIVE_VALUES_WARNING(r){let{row:n,col:o,rowspan:l,colspan:h}=r;return t_.e`The merged cell declared with {row: ${n}, col: ${o},\x20
      rowspan: ${l}, colspan: ${h}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(r){let{row:n,col:o}=r;return t_.e`The merged cell declared at [${n}, ${o}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(r){let{row:n,col:o}=r;return t_.e`The merged cell declared at [${n}, ${o}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(r){let{row:n,col:o}=r;return t_.e`The merged cell declared at [${n}, ${o}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(r){let{row:n,col:o,rowspan:l,colspan:h}=r;return n<0||o<0||l<0||h<0}static isSingleCell(r){let{rowspan:n,colspan:o}=r;return 1===o&&1===n}static containsZeroSpan(r){let{rowspan:n,colspan:o}=r;return 0===o||0===n}static isOutOfBounds(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}normalize(r){let n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col),cellCoords_classPrivateFieldSet(sx,this,null)}includes(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}includesHorizontally(r){return this.col<=r&&this.col+this.colspan-1>=r}includesVertically(r){return this.row<=r&&this.row+this.rowspan-1>=r}shift(r,n){let o=r[0]||r[1],l=n+Math.abs(r[0]||r[1])-1,h=r[0]?"colspan":"rowspan",d=r[0]?"col":"row",w=Math.min(n,l),y=Math.max(n,l),S=this[d],b=this[d]+this[h]-1;if(S>=n&&(this[d]+=o),o>0)n<=b&&n>S&&(this[h]+=o);else if(o<0){if(w<=S&&y>=b)return this.removed=!0,cellCoords_classPrivateFieldSet(sx,this,null),!1;if(S>=w&&S<=y){let r=y-S+1;this[d]-=Math.abs(o)-r+o,this[h]-=r}else S<=w&&b>=y?this[h]+=o:S<=w&&b>=w&&b<y&&(this[h]-=b-w+1)}return cellCoords_classPrivateFieldSet(sx,this,null),!0}isFarther(r,n){return!r||("down"===n?r.row+r.rowspan-1<this.row+this.rowspan-1:"up"===n?r.row>this.row:"right"===n?r.col+r.colspan-1<this.col+this.colspan-1:"left"===n?r.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return sx.get(cellCoords_assertClassBrand(sx,this))||cellCoords_classPrivateFieldSet(sx,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),sx.get(cellCoords_assertClassBrand(sx,this))}};function cellsCollection_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function cellsCollection_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var sF=new WeakSet;let MergedCellsCollection=class MergedCellsCollection{constructor(r){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,sF),sF.add(this),cellsCollection_defineProperty(this,"plugin",void 0),cellsCollection_defineProperty(this,"mergedCells",[]),cellsCollection_defineProperty(this,"mergedCellsMatrix",new Map),cellsCollection_defineProperty(this,"hot",void 0),this.plugin=r,this.hot=r.hot}static IS_OVERLAPPING_WARNING(r){let{row:n,col:o}=r;return t_.e`The merged cell declared at [${n}, ${o}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(r,n){var o;return!!this.mergedCellsMatrix.has(r)&&null!==(o=this.mergedCellsMatrix.get(r).get(n))&&void 0!==o&&o}getByRange(r){let n=!1;return(0,b.Bk)(this.mergedCells,o=>!(o.row<=r.from.row)||!(o.row+o.rowspan-1>=r.to.row)||!(o.col<=r.from.col)||!(o.col+o.colspan-1>=r.to.col)||(n=o)),n}filterOverlappingMergeCells(r){let n=new Set;this.mergedCells.forEach(r=>{let{row:o,col:l,colspan:h,rowspan:d}=r;for(let r=o;r<o+d;r++)for(let o=l;o<l+h;o++)n.add(`r${r},c${o}`)});let o=r.filter(r=>{let{row:o,col:l,colspan:h,rowspan:d}=r,w=new Set,y=!1;for(let S=o;S<o+d;S++){for(let o=l;o<l+h;o++){let l=`r${S},c${o}`;if(n.has(l)){(0,e2.ZK)(MergedCellsCollection.IS_OVERLAPPING_WARNING(r)),y=!0;break}w.add(l)}if(y)break}return y||n.add(...w),!y});return o}getWithinRange(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{row:o,col:l}=r.getTopStartCorner(),{row:h,col:d}=r.getBottomEndCorner(),w=[];for(let r=o;r<=h;r++)for(let o=l;o<=d;o++){let l=this.get(r,o);l&&(n||!n&&l.row===r&&l.col===o)&&w.push(l)}return w}add(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=r.row,l=r.col,h=r.rowspan,d=r.colspan,w=new sA(o,l,h,d,this.hot._createCellCoords,this.hot._createCellRange),y=this.get(o,l),S=!n&&this.isOverlapping(w);return y||S?((0,e2.ZK)(MergedCellsCollection.IS_OVERLAPPING_WARNING(w)),!1):(this.hot&&w.normalize(this.hot),this.mergedCells.push(w),cellsCollection_assertClassBrand(sF,this,_addMergedCellToMatrix).call(this,w),w)}remove(r,n){let o=this.get(r,n),l=o?this.mergedCells.indexOf(o):-1;return!!o&&-1!==l&&(this.mergedCells.splice(l,1),cellsCollection_assertClassBrand(sF,this,_removeMergedCellFromMatrix).call(this,o),o)}clear(){(0,b.Bk)(this.mergedCells,r=>{let{row:n,col:o,rowspan:l,colspan:h}=r;(0,ea.q4)(n,n+l,r=>{(0,ea.q4)(o,o+h,n=>{let o=this.hot.getCell(r,n);o&&(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(r){let n=r.getRange();for(let r=0;r<this.mergedCells.length;r++){let o=this.mergedCells[r],l=o.getRange();if(l.overlaps(n))return!0}return!1}isFirstRenderableMergedCell(r,n){let o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}getFirstRenderableCoords(r,n){let o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);let l=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),h=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(l,h)}getStartMostColumnIndex(r,n){let o=cellsCollection_assertClassBrand(sF,this,_getNonIntersectingIndexes).call(this,r,"col",-1),l=n;for(let r=0;r<o.length;r++)if(o[r]<=n){l=o[r];break}return l}getEndMostColumnIndex(r,n){let o=cellsCollection_assertClassBrand(sF,this,_getNonIntersectingIndexes).call(this,r,"col",1),l=n;for(let r=0;r<o.length;r++)if(o[r]>=n){l=o[r];break}return l}getTopMostRowIndex(r,n){let o=cellsCollection_assertClassBrand(sF,this,_getNonIntersectingIndexes).call(this,r,"row",-1),l=n;for(let r=0;r<o.length;r++)if(o[r]<=n){l=o[r];break}return l}getBottomMostRowIndex(r,n){let o=cellsCollection_assertClassBrand(sF,this,_getNonIntersectingIndexes).call(this,r,"row",1),l=n;for(let r=0;r<o.length;r++)if(o[r]>=n){l=o[r];break}return l}shiftCollections(r,n,o){let l=[0,0];switch(r){case"right":l[0]+=o;break;case"left":l[0]-=o;break;case"down":l[1]+=o;break;case"up":l[1]-=o}let h=[];this.mergedCells.forEach(r=>{r.shift(l,n),r.removed&&h.push(r)}),h.forEach(r=>{this.mergedCells.splice(this.mergedCells.indexOf(r),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(r=>{cellsCollection_assertClassBrand(sF,this,_addMergedCellToMatrix).call(this,r)})}};function _getNonIntersectingIndexes(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=new Map,h=1===o?r.getTopStartCorner():r.getBottomEndCorner(),d=1===o?r.getBottomEndCorner():r.getTopStartCorner();for(let r=h.row;1===o?r<=d.row:r>=d.row;r+=o)for(let w=h.col;1===o?w<=d.col:w>=d.col;w+=o){let h="row"===n?r:w,d=this.get(r,w),y=h;d&&(y=1===o?d[n]+d[`${n}span`]-1:d[n]),l.has(h)||l.set(h,new Set),l.get(h).add(y)}return Array.from(new Set(Array.from(l.entries()).filter(r=>{let[,n]=r;return 1===n.size}).flatMap(r=>{let[,n]=r;return Array.from(n)})))}function _addMergedCellToMatrix(r){for(let n=r.row;n<r.row+r.rowspan;n++)for(let o=r.col;o<r.col+r.colspan;o++)this.mergedCellsMatrix.has(n)||this.mergedCellsMatrix.set(n,new Map),this.mergedCellsMatrix.get(n).set(o,r)}function _removeMergedCellFromMatrix(r){for(let n=r.row;n<r.row+r.rowspan;n++)for(let o=r.col;o<r.col+r.colspan;o++)this.mergedCellsMatrix.get(n).delete(o)}function calculations_autofill_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var sk=class{constructor(r){calculations_autofill_defineProperty(this,"plugin",void 0),calculations_autofill_defineProperty(this,"mergedCellsCollection",void 0),calculations_autofill_defineProperty(this,"currentFillData",null),this.plugin=r,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(r){if(r[0]===r[2]&&r[1]===r[3]){let n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}getDirection(r,n){return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?"down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?"up":n[1]===r[1]&&n[2]===r[2]?"right":"left"}snapDragArea(r,n,o,l){let h=n.slice(0),d=this.getAutofillSize(r,n,o),[w,y,S,b]=r,_=["up","down"].indexOf(o)>-1,R=_?S-w+1:b-y+1,P=Math.floor(d/R)*R,T=d-P,I=this.getFarthestCollection(r,n,o,l);if(I){if("down"===o){let r=I.row+I.rowspan-w-T,n=h[2]+r;n>=this.plugin.hot.countRows()?h[2]-=T:h[2]+=T?r:0}else if("right"===o){let r=I.col+I.colspan-y-T,n=h[3]+r;n>=this.plugin.hot.countCols()?h[3]-=T:h[3]+=T?r:0}else if("up"===o){let r=S-T-I.row+1,n=h[0]+r;n<0?h[0]+=T:h[0]-=T?r:0}else if("left"===o){let r=b-T-I.col+1,n=h[1]+r;n<0?h[1]+=T:h[1]-=T?r:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:l,fillSize:d,dragArea:h,cycleLength:R}),h}updateCurrentFillCache(r){this.currentFillData||(this.currentFillData={}),(0,w.l7)(this.currentFillData,r)}getAutofillSize(r,n,o){let[l,h,d,w]=r,[y,S,b,_]=n;switch(o){case"up":return l-y;case"down":return b-d;case"left":return h-S;case"right":return _-w;default:return null}}getDragArea(r,n,o){let[l,h,d,w]=r,[y,S,b,_]=n;switch(o){case"up":return[y,S,l-1,w];case"down":return[d+1,h,b,w];case"left":return[y,S,d,h-1];case"right":return[l,w+1,b,_];default:return null}}getFarthestCollection(r,n,o,l){let[h,d,w,y]=r,S=["up","down"].indexOf(o)>-1,_=S?w:y,R=S?h:d,P=this.getAutofillSize(r,n,o),T=S?w-h+1:y-d+1,I=P-Math.floor(P/T)*T,O=null,k=null,N=null;switch(o){case"up":O="includesVertically",N=_-I+1;break;case"left":O="includesHorizontally",N=_-I+1;break;case"down":O="includesVertically",N=R+I-1;break;case"right":O="includesHorizontally",N=R+I-1}return(0,b.Bk)(l,r=>{r[O](N)&&r.isFarther(k,o)&&(k=r)}),k}recreateAfterDataPopulation(r){if(!this.currentFillData)return;let n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,l=this.currentFillData.dragDirection,inBounds=(r,o)=>{switch(l){case"up":return r.row-o>=n.from.row;case"down":return r.row+r.rowspan-1+o<=n.to.row;case"left":return r.col-o>=n.from.column;case"right":return r.col+r.colspan-1+o<=n.to.column;default:return null}},h=0,d=null,w=1;do for(let r=0;r<o.length;r+=1){if(inBounds(d=o[r],h=w*this.currentFillData.cycleLength))switch(l){case"up":this.plugin.mergedCellsCollection.add({row:d.row-h,rowspan:d.rowspan,col:d.col,colspan:d.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:d.row+h,rowspan:d.rowspan,col:d.col,colspan:d.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:d.row,rowspan:d.rowspan,col:d.col-h,colspan:d.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:d.row,rowspan:d.rowspan,col:d.col+h,colspan:d.colspan})}r===o.length-1&&(w+=1)}while(inBounds(d,h));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(r){let n={min:null,max:null},o={min:null,max:null};return(0,b.Bk)(r,r=>{let l=r[0],h=this.plugin.hot.propToCol(r[1]);(null===n.min||l<n.min)&&(n.min=l),(null===n.max||l>n.max)&&(n.max=l),(null===o.min||h<o.min)&&(o.min=h),(null===o.max||h>o.max)&&(o.max=h)}),{from:{row:n.min,column:o.min},to:{row:n.max,column:o.max}}}dragAreaOverlapsCollections(r,n,o){let l=this.getDragArea(r,n,o),[h,d,w,y]=l,S=this.plugin.hot._createCellCoords(h,d),b=this.plugin.hot._createCellCoords(w,y),_=this.plugin.hot._createCellRange(S,S,b);return this.mergedCellsCollection.getWithinRange(_,!0).length>0}};function selection_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var sH=class{constructor(r){selection_defineProperty(this,"plugin",void 0),selection_defineProperty(this,"hot",void 0),selection_defineProperty(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=r,this.hot=r.hot}getSelectedMergedCellClassName(r,n,o,l){let h=Math.min(o[0],o[2]),d=Math.min(o[1],o[3]),w=Math.max(o[0],o[2]),y=Math.max(o[1],o[3]);if(void 0===l)return;let S=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(!S)return;let b=this.plugin.mergedCellsCollection.get(r,n);if(!b)return;let _=b.getLastRow(),R=b.getLastColumn(),P=h<=b.row&&d<=b.col&&w>=_&&y>=R;return P?`${this.fullySelectedMergedCellClassName}-${l}`:this.isMergeCellFullySelected(b,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(r,n){let o=[];if(!n||!r)return!1;for(let n=0;n<r.rowspan;n+=1)for(let l=0;l<r.colspan;l+=1)o.push(this.hot._createCellCoords(r.row+n,r.col+l));for(let r=0;r<o.length;r+=1){let l=[];for(let h=0;h<n.length;h+=1)l[h]=n[h].includes(o[r]);if(!l.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let r=[];for(let n=0;n<=7;n+=1)r.push(`${this.fullySelectedMergedCellClassName}-${n}`);return r.push(`${this.fullySelectedMergedCellClassName}-multiple`),r}};function linkedList_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let NodeStructure=class NodeStructure{constructor(r){linkedList_defineProperty(this,"data",void 0),linkedList_defineProperty(this,"next",null),linkedList_defineProperty(this,"prev",null),this.data=r}};var sN=class{constructor(){linkedList_defineProperty(this,"first",null),linkedList_defineProperty(this,"last",null)}push(r){let n=new NodeStructure(r);if(null===this.first)this.first=n,this.last=n;else{let r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(r){let n=new NodeStructure(r);if(null===this.first)this.first=n,this.last=n;else{let r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(r){let n=this.first;for(;n;){let o=r(n);if(n===this.last||!0===o)break;n=n.next}}remove(r){let n,o;if(null===this.first)return!1;let l=this.first;for(;l;){if(l.data===r)return n=l.next,o=l.prev,n&&(n.prev=o),o&&(o.next=n),l===this.first&&(this.first=n),l===this.last&&(this.last=o),!0;l=l.next}return!1}hasCycle(){let r=this.first,n=this.first;for(;;){if(null===r||null===(r=r.next))return!1;if((r=r.next)===(n=n.next))return!0}}pop(){if(null===this.last)return null;let r=this.last;return this.last=this.last.prev,r}shift(){if(null===this.first)return null;let r=this.first;return this.first=this.first.next,r}recursiveReverse(){if(!this.first)return;!function inverse(r,n){n&&(inverse(n,n.next),n.next=r)}(this.first,this.first.next),this.first.next=null;let r=this.first;this.first=this.last,this.last=r}reverse(){let r;if(!this.first||!this.first.next)return;let n=this.first.next,o=this.first;for(;n;)r=n.next,n.next=o,o.prev=n,o=n,n=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=o,this.last=r}};function focusOrder_classPrivateFieldInitSpec(r,n,o){focusOrder_checkPrivateRedeclaration(r,n),n.set(r,o)}function focusOrder_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function focusOrder_classPrivateFieldGet(r,n){return r.get(focusOrder_assertClassBrand(r,n))}function focusOrder_classPrivateFieldSet(r,n,o){return r.set(focusOrder_assertClassBrand(r,n),o),o}function focusOrder_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var sD=new WeakMap,sB=new WeakMap,sL=new WeakMap,sV=new WeakMap,sG=new WeakMap,sW=new WeakMap,sz=new WeakMap,sj=new WeakSet;let FocusOrder=class FocusOrder{constructor(r){let{mergedCellsGetter:n,rowIndexMapper:o,columnIndexMapper:l}=r;focusOrder_checkPrivateRedeclaration(this,sj),sj.add(this),focusOrder_classPrivateFieldInitSpec(this,sD,new sN),focusOrder_classPrivateFieldInitSpec(this,sB,new sN),focusOrder_classPrivateFieldInitSpec(this,sL,null),focusOrder_classPrivateFieldInitSpec(this,sV,null),focusOrder_classPrivateFieldInitSpec(this,sG,null),focusOrder_classPrivateFieldInitSpec(this,sW,null),focusOrder_classPrivateFieldInitSpec(this,sz,null),focusOrder_classPrivateFieldSet(sG,this,n),focusOrder_classPrivateFieldSet(sW,this,o),focusOrder_classPrivateFieldSet(sz,this,l)}getCurrentVerticalNode(){return focusOrder_classPrivateFieldGet(sV,this).data}getFirstVerticalNode(){return focusOrder_classPrivateFieldGet(sB,this).first.data}getNextVerticalNode(){return focusOrder_classPrivateFieldGet(sV,this).next.data}getPrevVerticalNode(){return focusOrder_classPrivateFieldGet(sV,this).prev.data}getCurrentHorizontalNode(){return focusOrder_classPrivateFieldGet(sL,this).data}getFirstHorizontalNode(){return focusOrder_classPrivateFieldGet(sD,this).first.data}getNextHorizontalNode(){return focusOrder_classPrivateFieldGet(sL,this).next.data}getPrevHorizontalNode(){return focusOrder_classPrivateFieldGet(sL,this).prev.data}setPrevNodeAsActive(){focusOrder_classPrivateFieldSet(sV,this,focusOrder_classPrivateFieldGet(sV,this).prev),focusOrder_classPrivateFieldSet(sL,this,focusOrder_classPrivateFieldGet(sL,this).prev)}setNextNodeAsActive(){focusOrder_classPrivateFieldSet(sV,this,focusOrder_classPrivateFieldGet(sV,this).next),focusOrder_classPrivateFieldSet(sL,this,focusOrder_classPrivateFieldGet(sL,this).next)}buildFocusOrder(r){let n=r.getTopStartCorner(),o=r.getBottomEndCorner(),l=new WeakSet;focusOrder_classPrivateFieldSet(sD,this,new sN);for(let h=n.row;h<=o.row;h++)if(!focusOrder_classPrivateFieldGet(sW,this).isHidden(h))for(let d=n.col;d<=o.col;d++){if(focusOrder_classPrivateFieldGet(sz,this).isHidden(d))continue;let n=focusOrder_assertClassBrand(sj,this,_pushOrderNode).call(this,r,focusOrder_classPrivateFieldGet(sD,this),l,h,d);n&&focusOrder_classPrivateFieldSet(sL,this,n)}focusOrder_classPrivateFieldGet(sD,this).first&&(focusOrder_classPrivateFieldGet(sD,this).first.prev=focusOrder_classPrivateFieldGet(sD,this).last,focusOrder_classPrivateFieldGet(sD,this).last.next=focusOrder_classPrivateFieldGet(sD,this).first);let h=new WeakSet;focusOrder_classPrivateFieldSet(sB,this,new sN);for(let l=n.col;l<=o.col;l++)if(!focusOrder_classPrivateFieldGet(sz,this).isHidden(l))for(let d=n.row;d<=o.row;d++){if(focusOrder_classPrivateFieldGet(sW,this).isHidden(d))continue;let n=focusOrder_assertClassBrand(sj,this,_pushOrderNode).call(this,r,focusOrder_classPrivateFieldGet(sB,this),h,d,l);n&&focusOrder_classPrivateFieldSet(sV,this,n)}focusOrder_classPrivateFieldGet(sB,this).first&&(focusOrder_classPrivateFieldGet(sB,this).first.prev=focusOrder_classPrivateFieldGet(sB,this).last,focusOrder_classPrivateFieldGet(sB,this).last.next=focusOrder_classPrivateFieldGet(sB,this).first)}setActiveNode(r,n){return focusOrder_classPrivateFieldGet(sD,this).inorder(o=>{let{rowStart:l,rowEnd:h,colStart:d,colEnd:w}=o.data;if(r>=l&&r<=h&&n>=d&&n<=w)return focusOrder_classPrivateFieldSet(sL,this,o),!1}),focusOrder_classPrivateFieldGet(sB,this).inorder(o=>{let{rowStart:l,rowEnd:h,colStart:d,colEnd:w}=o.data;if(r>=l&&r<=h&&n>=d&&n<=w)return focusOrder_classPrivateFieldSet(sV,this,o),!1}),this}};function _pushOrderNode(r,n,o,l,h){let d=r.getTopStartCorner(),w=r.getBottomEndCorner(),y=r.highlight.clone().normalize(),S=focusOrder_classPrivateFieldGet(sG,this).call(this,l,h);if(S&&o.has(S))return null;let b={colStart:h,colEnd:h,rowStart:l,rowEnd:l};if(S){if(o.add(S),S.row<d.row||S.row+S.rowspan-1>w.row||S.col<d.col||S.col+S.colspan-1>w.col)return null;b.colStart=S.col,b.colEnd=S.col+S.colspan-1,b.rowStart=S.row,b.rowEnd=S.row+S.rowspan-1}let _=n.push(b);return l===y.row&&h===y.col||S&&y.row>=S.row&&y.row<=S.row+S.rowspan-1&&y.col>=S.col&&y.col<=S.col+S.colspan-1?_:null}function mergeCells_classPrivateFieldInitSpec(r,n,o){mergeCells_checkPrivateRedeclaration(r,n),n.set(r,o)}function mergeCells_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function mergeCells_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function mergeCells_classPrivateFieldSet(r,n,o){return r.set(mergeCells_assertClassBrand(r,n),o),o}function mergeCells_classPrivateFieldGet(r,n){return r.get(mergeCells_assertClassBrand(r,n))}function mergeCells_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}K.Z.getSingleton().register("beforeMergeCells"),K.Z.getSingleton().register("afterMergeCells"),K.Z.getSingleton().register("beforeUnmergeCells"),K.Z.getSingleton().register("afterUnmergeCells");let sU="mergeCells";var s$=new WeakMap,sK=new WeakMap,sY=new WeakMap,sX=new WeakMap,sq=new WeakSet;let MergeCells=class MergeCells extends BasePlugin{constructor(){super(...arguments),mergeCells_checkPrivateRedeclaration(this,sq),sq.add(this),mergeCells_defineProperty(this,"mergedCellsCollection",null),mergeCells_defineProperty(this,"autofillCalculations",null),mergeCells_defineProperty(this,"selectionCalculations",null),mergeCells_classPrivateFieldInitSpec(this,s$,null),mergeCells_classPrivateFieldInitSpec(this,sK,{row:0,col:0}),mergeCells_classPrivateFieldInitSpec(this,sY,new FocusOrder({mergedCellsGetter:(r,n)=>this.mergedCellsCollection.get(r,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),mergeCells_classPrivateFieldInitSpec(this,sX,function(r){let{hot:n}=r,{rowIndexMapper:o,columnIndexMapper:l}=n;return{before:function(){},after:function(n,h,d){let y=r.mergedCellsCollection.get(h,d);if(!(0,w.Kn)(y)){n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="";return}let{row:S,col:b,colspan:_,rowspan:R}=y,[P,T]=r.translateMergedCellToRenderable(S,R,b,_),I=o.getRenderableFromVisualIndex(h),O=l.getRenderableFromVisualIndex(d),k=o.getNearestNotHiddenIndex(S,1),N=l.getNearestNotHiddenIndex(b,1),L=Math.min(R,P-I+1),j=Math.min(_,T-O+1);k===h&&N===d?(n.setAttribute("rowspan",L),n.setAttribute("colspan",j)):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none")}}}(this))}static get PLUGIN_KEY(){return sU}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[sU]}enablePlugin(){var r=this;this.enabled||(this.mergedCellsCollection=new MergedCellsCollection(this),this.autofillCalculations=new sk(this),this.selectionCalculations=new sH(this),this.addHook("afterInit",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterInit).call(r,...o)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onModifyTransformFocus).call(r,...o)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onModifyTransformStart).call(r,...o)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onModifyTransformEnd).call(r,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onBeforeSelectionHighlightSet).call(r,...o)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onBeforeSetRangeStart).call(r,...o)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onBeforeSetRangeStart).call(r,...o)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onBeforeSelectionFocusSet).call(r,...o)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onAfterSelectionFocusSet).call(r,...o)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterSelectionEnd).call(r,...o)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onModifyGetCellCoords).call(r,...o)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onAfterIsMultipleSelection).call(r,...o)}),this.addHook("afterRenderer",function(){return mergeCells_classPrivateFieldGet(sX,r).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_addMergeActionsToContextMenu).call(r,...o)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterGetCellMeta).call(r,...o)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onAfterViewportRowCalculatorOverride).call(r,...o)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onAfterViewportColumnCalculatorOverride).call(r,...o)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onModifyAutofillRange).call(r,...o)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterCreateCol).call(r,...o)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterRemoveCol).call(r,...o)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterCreateRow).call(r,...o)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterRemoveRow).call(r,...o)}),this.addHook("afterChange",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,mergeCells_onAfterChange).call(r,...o)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onBeforeDrawAreaBorders).call(r,...o)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onAfterDrawSelection).call(r,...o)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onBeforeRemoveCellClassNames).call(r,...o)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onBeforeBeginEditing).call(r,...o)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return mergeCells_assertClassBrand(sq,r,_onModifyRowHeightByOverlayName).call(r,...o)}),this.addHook("beforeUndoStackChange",(r,n)=>{if("MergeCells"===n)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){let r=this.hot.getSettings()[sU];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(r),super.updatePlugin()}ifChromeForceRepaint(){if(!(0,T.i7)())return;let r=[],n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{let{row:o,rowspan:l}=r;for(let r=o+1;r<o+l;r++)n.push(r)}),(n=[...new Set(n)]).forEach(n=>{let o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(r=>(null==r?void 0:r.name)==="master"?r:r.clone.wtTable).forEach(n=>{let l=n.getRow(o);l&&(l.style.background=(0,h.C2)(l,"backgroundColor").replace(")",", 0.99)"),r.push(l))})}),this.hot._registerTimeout(()=>{r.forEach(r=>{r.style.background=(0,h.C2)(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(r){return!!r&&(sA.containsNegativeValues(r)?((0,e2.ZK)(sA.NEGATIVE_VALUES_WARNING(r)),!1):sA.isOutOfBounds(r,this.hot.countRows(),this.hot.countCols())?((0,e2.ZK)(sA.IS_OUT_OF_BOUNDS_WARNING(r)),!1):sA.isSingleCell(r)?((0,e2.ZK)(sA.IS_SINGLE_CELL(r)),!1):!sA.containsZeroSpan(r)||((0,e2.ZK)(sA.ZERO_SPAN_WARNING(r)),!1))}generateFromSettings(r){if(!Array.isArray(r))return;let n=r.filter(r=>this.validateSetting(r)),o=this.mergedCellsCollection.filterOverlappingMergeCells(n),l=[];o.forEach(r=>{let{row:n,col:o,rowspan:h,colspan:d}=r,w=this.hot._createCellCoords(n,o),y=this.hot._createCellCoords(n+h-1,o+d-1),S=this.hot._createCellRange(w,w,y);this.mergeRange(S,!0,!0);for(let r=n;r<n+h;r++)for(let h=o;h<o+d;h++)(r!==n||h!==o)&&l.push([r,h,null])}),0!==l.length&&this.hot.setDataAtCell(l,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!n||this.validateSetting(r)}mergeSelection(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!r)return;r.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:n,to:o}=r;this.unmergeRange(r,!0),this.mergeRange(r),this.hot.selectCell(n.row,n.col,o.row,o.col,!1)}unmergeSelection(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!r)return;let{from:n,to:o}=r;this.unmergeRange(r,!0),this.hot.selectCell(n.row,n.col,o.row,o.col,!1)}mergeRange(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=r.getTopStartCorner(),h=r.getBottomEndCorner(),d={row:l.row,col:l.col,rowspan:h.row-l.row+1,colspan:h.col-l.col+1},w=[],y=null;if(!this.canMergeRange(d,n))return!1;this.hot.runHooks("beforeMergeCells",r,n),(0,ea.q4)(0,d.rowspan-1,r=>{(0,ea.q4)(0,d.colspan-1,n=>{let o=null;w[r]||(w[r]=[]),0===r&&0===n?o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(d.row),this.hot.toPhysicalColumn(d.col)):this.hot.setCellMeta(d.row+r,d.col+n,"hidden",!0),w[r][n]=o})}),this.hot.setCellMeta(d.row,d.col,"spanned",!0);let S=this.mergedCellsCollection.add(d,n);return!S||(o?y=[d.row,d.col,w]:this.hot.populateFromArray(d.row,d.col,w,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",r,d,n),y)}unmergeRange(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.mergedCellsCollection.getWithinRange(r);0!==o.length&&(this.hot.runHooks("beforeUnmergeCells",r,n),(0,b.Bk)(o,r=>{this.mergedCellsCollection.remove(r.row,r.col),(0,ea.q4)(0,r.rowspan-1,n=>{(0,ea.q4)(0,r.colspan-1,o=>{this.hot.removeCellMeta(r.row+n,r.col+o,"hidden"),this.hot.removeCellMeta(r.row+n,r.col+o,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",r,n),this.hot.render())}toggleMerge(r){let n=this.mergedCellsCollection.get(r.from.row,r.from.col),o=n.row===r.from.row&&n.col===r.from.col&&n.row+n.rowspan-1===r.to.row&&n.col+n.colspan-1===r.to.col;o?this.unmergeRange(r):this.mergeSelection(r)}merge(r,n,o,l){let h=this.hot._createCellCoords(r,n),d=this.hot._createCellCoords(o,l);this.mergeRange(this.hot._createCellRange(h,h,d))}unmerge(r,n,o,l){let h=this.hot._createCellCoords(r,n),d=this.hot._createCellCoords(o,l);this.unmergeRange(this.hot._createCellRange(h,h,d))}registerShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("grid");n.addShortcut({keys:[["Control","m"]],callback:()=>{let r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:sU})}unregisterShortcuts(){let r=this.hot.getShortcutManager(),n=r.getContext("grid");n.removeShortcutsByGroup(sU)}modifyViewportRowStart(r,n){let o=this.hot.rowIndexMapper,l=o.getVisualFromRenderableIndex(r.startRow);for(let h=0;h<n;h+=1){let d=this.mergedCellsCollection.get(l,h);if((0,w.Kn)(d)){let l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(d.row,1));if(l<r.startRow){r.startRow=l,this.modifyViewportRowStart(r,n);return}}}}modifyViewportRowEnd(r,n){let o=this.hot.rowIndexMapper,l=o.getVisualFromRenderableIndex(r.endRow);for(let h=0;h<n;h+=1){let d=this.mergedCellsCollection.get(l,h);if((0,w.Kn)(d)){let l=d.row+d.rowspan-1,h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1));if(h>r.endRow){r.endRow=h,this.modifyViewportRowEnd(r,n);return}}}}modifyViewportColumnStart(r,n){let o=this.hot.columnIndexMapper,l=o.getVisualFromRenderableIndex(r.startColumn);for(let h=0;h<n;h+=1){let d=this.mergedCellsCollection.get(h,l);if((0,w.Kn)(d)){let l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(d.col,1));if(l<r.startColumn){r.startColumn=l,this.modifyViewportColumnStart(r,n);return}}}}modifyViewportColumnEnd(r,n){let o=this.hot.columnIndexMapper,l=o.getVisualFromRenderableIndex(r.endColumn);for(let h=0;h<n;h+=1){let d=this.mergedCellsCollection.get(h,l);if((0,w.Kn)(d)){let l=d.col+d.colspan-1,h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1));if(h>r.endColumn){r.endColumn=h,this.modifyViewportColumnEnd(r,n);return}}}}translateMergedCellToRenderable(r,n,o,l){let h,d;let{rowIndexMapper:w,columnIndexMapper:y}=this.hot;h=0===n?w.getNearestNotHiddenIndex(r,1):w.getNearestNotHiddenIndex(r+n-1,-1),d=0===l?y.getNearestNotHiddenIndex(o,1):y.getNearestNotHiddenIndex(o+l-1,-1);let S=r>=0?w.getRenderableFromVisualIndex(h):r,b=o>=0?y.getRenderableFromVisualIndex(d):o;return[S,b]}};function mergeCells_onAfterInit(){this.generateFromSettings(this.hot.getSettings()[sU]),this.hot.render()}function _onAfterIsMultipleSelection(r){if(r){let r=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),o=n.getTopStartCorner(),l=n.getBottomEndCorner();for(let n=0;n<r.length;n+=1)if(o.row===r[n].row&&o.col===r[n].col&&l.row===r[n].row+r[n].rowspan-1&&l.col===r[n].col+r[n].colspan-1)return!1}return r}function _onModifyTransformFocus(r){mergeCells_classPrivateFieldGet(sK,this).row=r.row,mergeCells_classPrivateFieldGet(sK,this).col=r.col}function _onModifyTransformStart(r){let n=this.hot.getSelectedRangeLast(),{highlight:o}=n,{columnIndexMapper:l,rowIndexMapper:h}=this.hot;mergeCells_classPrivateFieldGet(s$,this)&&(null!==h.getRenderableFromVisualIndex(mergeCells_classPrivateFieldGet(s$,this).row)&&(o.row=mergeCells_classPrivateFieldGet(s$,this).row),null!==l.getRenderableFromVisualIndex(mergeCells_classPrivateFieldGet(s$,this).col)&&(o.col=mergeCells_classPrivateFieldGet(s$,this).col),mergeCells_classPrivateFieldSet(s$,this,null));let d=this.mergedCellsCollection.get(o.row,o.col);if(!d)return;let w=d.col,y=d.col+d.colspan-1;if(r.col<0){let n=o.col>=w&&o.col<=y?w-1:y,h=l.getNearestNotHiddenIndex(n,-1);null===h?r.col=-this.hot.view.countRenderableColumnsInRange(0,o.col):r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,o.col)-1,1)}else if(r.col>0){let n=o.col>=w&&o.col<=y?y+1:w,h=l.getNearestNotHiddenIndex(n,1);null===h?r.col=this.hot.view.countRenderableColumnsInRange(o.col,this.hot.countCols()):r.col=Math.max(this.hot.view.countRenderableColumnsInRange(o.col,h)-1,1)}let S=d.row,b=d.row+d.rowspan-1;if(r.row<0){let n=o.row>=S&&o.row<=b?S-1:b,l=h.getNearestNotHiddenIndex(n,-1);null===l?r.row=-this.hot.view.countRenderableRowsInRange(0,o.row):r.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,o.row)-1,1)}else if(r.row>0){let n=o.row>=S&&o.row<=b?b+1:S,l=h.getNearestNotHiddenIndex(n,1);null===l?r.row=this.hot.view.countRenderableRowsInRange(o.row,this.hot.countRows()):r.row=Math.max(this.hot.view.countRenderableRowsInRange(o.row,l)-1,1)}}function _onModifyTransformEnd(r){let n=this.hot.getSelectedRangeLast(),o=n.clone(),{to:l}=n,{columnIndexMapper:h,rowIndexMapper:d}=this.hot,expandCloneRange=(r,n)=>{o.expand(this.hot._createCellCoords(r,n));for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)o.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange())};if(r.col<0){let d=this.mergedCellsCollection.getStartMostColumnIndex(n,l.col)+r.col;expandCloneRange(l.row,d),"E-W"===n.getHorizontalDirection()&&"E-W"===o.getHorizontalDirection()&&(d=o.getTopStartCorner().col);let w=h.getNearestNotHiddenIndex(d,1);null!==w&&(r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(w,l.col)-1,1))}else if(r.col>0){let d=this.mergedCellsCollection.getEndMostColumnIndex(n,l.col)+r.col;expandCloneRange(l.row,d),"W-E"===n.getHorizontalDirection()&&"W-E"===o.getHorizontalDirection()&&(d=o.getBottomEndCorner().col);let w=h.getNearestNotHiddenIndex(d,-1);null!==w&&(r.col=Math.max(this.hot.view.countRenderableColumnsInRange(l.col,w)-1,1))}if(r.row<0){let h=this.mergedCellsCollection.getTopMostRowIndex(n,l.row)+r.row;expandCloneRange(h,l.col),"S-N"===n.getVerticalDirection()&&"S-N"===o.getVerticalDirection()&&(h=o.getTopStartCorner().row);let w=d.getNearestNotHiddenIndex(h,1);null!==w&&(r.row=-Math.max(this.hot.view.countRenderableRowsInRange(w,l.row)-1,1))}else if(r.row>0){let h=this.mergedCellsCollection.getBottomMostRowIndex(n,l.row)+r.row;expandCloneRange(h,l.col),"N-S"===n.getVerticalDirection()&&"N-S"===o.getVerticalDirection()&&(h=o.getBottomStartCorner().row);let w=d.getNearestNotHiddenIndex(h,-1);null!==w&&(r.row=Math.max(this.hot.view.countRenderableRowsInRange(l.row,w)-1,1))}}function _onBeforeSelectionHighlightSet(){let r=this.hot.getSelectedRangeLast(),{highlight:n}=r;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){mergeCells_classPrivateFieldSet(s$,this,n.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);let o=this.mergedCellsCollection.get(n.row,n.col);mergeCells_classPrivateFieldSet(s$,this,n.clone()),o&&n.assign(o)}function _onModifyGetCellCoords(r,n){if(r<0||n<0)return;let o=this.mergedCellsCollection.get(r,n);if(!o)return;let{row:l,col:h,colspan:d,rowspan:w}=o;return[l,h,l+w-1,h+d-1]}function _addMergeActionsToContextMenu(r){var n;r.items.push({name:"---------"},(n=this,{key:"mergeCells",name(){let r=this.getSelectedLast();if(r){let o=n.mergedCellsCollection.get(r[0],r[1]);if(o.row===r[0]&&o.col===r[1]&&o.row+o.rowspan-1===r[2]&&o.col+o.colspan-1===r[3])return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){let r=this.getSelectedRangeLast();if(!r)return;r.setDirection(this.isRtl()?"NE-SW":"NW-SE");let{from:o,to:l}=r;n.toggleMerge(r),this.selectCell(o.row,o.col,l.row,l.col,!1)},disabled(){let r=this.getSelectedLast();if(!r)return!0;let n=sA.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}))}function _onBeforeSetRangeStart(){mergeCells_classPrivateFieldSet(s$,this,null)}function _onBeforeSelectionFocusSet(){if(mergeCells_classPrivateFieldGet(s$,this).isCell())return;let r=this.hot.getSelectedRangeLast(),n=r.getVerticalDirection(),o=r.getHorizontalDirection(),l=mergeCells_classPrivateFieldGet(s$,this).clone().normalize();mergeCells_classPrivateFieldGet(sY,this).setActiveNode(l.row,l.col),mergeCells_classPrivateFieldGet(sK,this).row>0||mergeCells_classPrivateFieldGet(sK,this).col>0?mergeCells_classPrivateFieldGet(sY,this).setPrevNodeAsActive():("E-W"===o&&mergeCells_classPrivateFieldGet(sK,this).col<0||"S-N"===n&&mergeCells_classPrivateFieldGet(sK,this).row<0)&&mergeCells_classPrivateFieldGet(sY,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(r,n){let o=this.hot.getSelectedRangeLast(),{columnIndexMapper:l,rowIndexMapper:h}=this.hot,d=null,w=null;if(mergeCells_classPrivateFieldGet(sK,this).col<0){let{rowEnd:r,colEnd:n}=mergeCells_classPrivateFieldGet(sY,this).getPrevHorizontalNode();w=l.getNearestNotHiddenIndex(n,-1),d=h.getNearestNotHiddenIndex(r,-1)}else if(mergeCells_classPrivateFieldGet(sK,this).col>0){let{rowStart:r,colStart:n}=mergeCells_classPrivateFieldGet(sY,this).getNextHorizontalNode();w=l.getNearestNotHiddenIndex(n,1),d=h.getNearestNotHiddenIndex(r,1)}else if(mergeCells_classPrivateFieldGet(sK,this).row<0){let{rowEnd:r,colEnd:n}=mergeCells_classPrivateFieldGet(sY,this).getPrevVerticalNode();w=l.getNearestNotHiddenIndex(n,-1),d=h.getNearestNotHiddenIndex(r,-1)}else if(mergeCells_classPrivateFieldGet(sK,this).row>0){let{rowStart:r,colStart:n}=mergeCells_classPrivateFieldGet(sY,this).getNextVerticalNode();w=l.getNearestNotHiddenIndex(n,1),d=h.getNearestNotHiddenIndex(r,1)}if(null!==d||null!==w){let l=this.hot._createCellCoords(d,w),h=this.mergedCellsCollection.get(l.row,l.col),y=this.hot.selection.highlight.getFocus();r=l.row,n=l.col,h?o.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):o.highlight.assign(l),y.clear(),y.add(l).commit()}mergeCells_classPrivateFieldGet(sY,this).setActiveNode(r,n),mergeCells_classPrivateFieldSet(sK,this,{row:0,col:0})}function mergeCells_onAfterSelectionEnd(){let r=this.hot.getSelectedRangeLast();r.isHeader()||mergeCells_classPrivateFieldGet(sY,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function mergeCells_onAfterGetCellMeta(r,n,o){let l=this.mergedCellsCollection.get(r,n);l&&(l.row!==r||l.col!==n?o.copyable=!1:(o.rowspan=l.rowspan,o.colspan=l.colspan))}function _onAfterViewportRowCalculatorOverride(r){let n=this.hot.countCols();this.modifyViewportRowStart(r,n),this.modifyViewportRowEnd(r,n)}function _onAfterViewportColumnCalculatorOverride(r){let n=this.hot.countRows();this.modifyViewportColumnStart(r,n),this.modifyViewportColumnEnd(r,n)}function _onModifyAutofillRange(r,n){this.autofillCalculations.correctSelectionAreaSize(n);let o=this.autofillCalculations.getDirection(n,r),l=r;if(this.autofillCalculations.dragAreaOverlapsCollections(n,l,o))return n;let h=this.hot._createCellCoords(n[0],n[1]),d=this.hot._createCellCoords(n[2],n[3]),w=this.hot._createCellRange(h,h,d),y=this.mergedCellsCollection.getWithinRange(w);return 0===y.length?l:l=this.autofillCalculations.snapDragArea(n,l,o,y)}function mergeCells_onAfterCreateCol(r,n){this.mergedCellsCollection.shiftCollections("right",r,n)}function mergeCells_onAfterRemoveCol(r,n){this.mergedCellsCollection.shiftCollections("left",r,n)}function mergeCells_onAfterCreateRow(r,n,o){"auto"!==o&&this.mergedCellsCollection.shiftCollections("down",r,n)}function mergeCells_onAfterRemoveRow(r,n){this.mergedCellsCollection.shiftCollections("up",r,n)}function mergeCells_onAfterChange(r,n){"Autofill.fill"===n&&this.autofillCalculations.recreateAfterDataPopulation(r)}function _onBeforeDrawAreaBorders(r,n){if(n&&"area"===n){let n=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(n);(0,b.Bk)(o,o=>{n.getBottomEndCorner().row===o.getLastRow()&&n.getBottomEndCorner().col===o.getLastColumn()&&(r[2]=o.row,r[3]=o.col)})}}function _onAfterDrawSelection(r,n,o,l){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(r,n,o,l)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(r,n,o,l){if(!(l instanceof MouseEvent))return;let h=this.hot.getSelectedRangeLast(),d=this.mergedCellsCollection.getByRange(h);if(!d)return;let w=this.hot._createCellCoords(d.row,d.col),y=this.hot._createCellCoords(d.row+d.rowspan-1,d.col+d.colspan-1);return 0===this.hot.selection.getLayerLevel()&&h.isEqual(this.hot._createCellRange(w,w,y))}function _onModifyRowHeightByOverlayName(r,n,o){let l,h;if(this.hot.getSettings().rowHeaders||"bottom"===o||"bottom_inline_start_corner"===o)return r;if("master"===o)l=this.hot.view.getFirstRenderedVisibleColumn(),h=this.hot.view.getLastRenderedVisibleColumn();else{let r=this.hot.view.getOverlayByName(o);l=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r.clone.wtTable.getFirstRenderedColumn()),h=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r.clone.wtTable.getLastRenderedColumn())}let d=this.mergedCellsCollection.get(n,l);if(!d)return r;let w=this.hot._createCellCoords(n,l),y=this.hot._createCellCoords(n,h),S=this.hot._createCellRange(w,w,y),b=this.mergedCellsCollection.getWithinRange(S),_=b.reduce((r,n)=>{let{rowspan:o}=n;return Math.max(r,o)},1),R=0;return b.length>1&&b[0].rowspan<_&&(R=_-b[0].rowspan),b.forEach(l=>{var h;let{rowspan:d}=l,w=0;w="top"===o||"top_inline_start_corner"===o?Math.min(_,this.hot.view.countNotHiddenFixedRowsTop()-n):d-R,r=Math.max(null!==(h=r)&&void 0!==h?h:0,mergeCells_assertClassBrand(sq,this,_sumCellsHeights).call(this,n,w))}),r}function _sumCellsHeights(r,n){let o=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),l=this.hot.getPlugin("autoRowSize"),h=0;for(let w=r;w<r+n;w++)if(!this.hot.rowIndexMapper.isHidden(w)){var d;h+=null!==(d=null==l?void 0:l.getRowHeight(w))&&void 0!==d?d:o}return h}function warnAboutPluginsConflict(){(0,e2.ZK)(t_.e`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}let sZ="sort",sJ="multiColumnSorting",sQ="columnSorting";ta(sJ,function(r,n){return function(o,l){let[,...h]=o,[,...d]=l;return function getCompareResult(o){let l=r[o],w=n[o],y=h[o],S=d[o],b=w.multiColumnSorting,_=b.compareFunctionFactory?b.compareFunctionFactory:getCompareFunctionFactory(w.type),R=_(l,w,b)(y,S);if(R===td){let r=o+1;if(void 0!==n[r])return getCompareResult(r)}return R}(0)}});let MultiColumnSorting=class MultiColumnSorting extends ColumnSorting{constructor(){var r,n;super(...arguments),(r="symbol"==typeof(n=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="pluginKey","string"))?n:n+"")in this?Object.defineProperty(this,r,{value:sJ,enumerable:!0,configurable:!0,writable:!0}):this[r]=sJ}static get PLUGIN_KEY(){return sJ}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sQ]&&(warnAboutPluginsConflict(),this.hot.getPlugin(sQ).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{let{highlight:r}=this.hot.getSelectedRangeLast();return -1===r.row&&r.col>=0&&this.sort(this.getNextSortConfig(r.col,ty)),!1},runOnlyIf:()=>{var r,n;let o=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return o&&(null===(n=this.hot.getSelectedRangeLast())||void 0===n?void 0:n.isSingle())&&this.hot.selection.isCellVisible(o)&&o.isHeader()},relativeToGroup:y.I,position:"before",group:sJ})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sJ)}sort(r){super.sort(r)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(r){return super.getSortConfig(r)}setSortConfig(r){super.setSortConfig(r)}getNormalizedSortConfigs(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(r)?r:[r]}updateHeaderClasses(r){for(var n=arguments.length,o=Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];super.updateHeaderClasses(r,...o),(0,h.IV)(r,function(r){let n=r.className.split(" "),o=RegExp(`^${sZ}-[0-9]{1,2}$`);return n.filter(r=>o.test(r))}(r)),!1!==this.enabled&&(0,h.cn)(r,function(r,n,o){let l=[];return!1===o||r.isColumnSorted(n)&&r.getNumberOfSortedColumns()>1&&l.push(`${sZ}-${r.getIndexOfColumnInSortQueue(n)+1}`),l}(...o))}onUpdateSettings(r){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sQ]&&warnAboutPluginsConflict(),super.onUpdateSettings(r)}onAfterOnCellMouseDown(r,n){!1!==wasHeaderClickedProperly(n.row,n.col,r)&&this.wasClickableHeaderClicked(r,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,ty))):this.sort(this.getColumnNextConfig(n.col)))}};function multipleSelectionHandles_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let MultipleSelectionHandles=class MultipleSelectionHandles extends BasePlugin{constructor(){super(...arguments),multipleSelectionHandles_defineProperty(this,"dragged",[]),multipleSelectionHandles_defineProperty(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return(0,T.K1)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){let r=this,{rootElement:n}=this.hot;function removeFromDragged(n){if(1===r.dragged.length)return r.dragged.splice(0,r.dragged.length),!0;let o=r.dragged.indexOf(n);if(-1===o)return!1;0===o?r.dragged=r.dragged.slice(0,1):1===o&&(r.dragged=r.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",n=>{let o;return(0,h.pv)(n.target,"topSelectionHandle-HitArea")?(o=r.hot.getSelectedRangeLast(),r.dragged.push("top"),r.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},n.preventDefault(),!1):(0,h.pv)(n.target,"bottomSelectionHandle-HitArea")?(o=r.hot.getSelectedRangeLast(),r.dragged.push("bottom"),r.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(n,"touchend",n=>(0,h.pv)(n.target,"topSelectionHandle-HitArea")?(removeFromDragged.call(r,"top"),r.touchStartRange=void 0,n.preventDefault(),!1):(0,h.pv)(n.target,"bottomSelectionHandle-HitArea")?(removeFromDragged.call(r,"bottom"),r.touchStartRange=void 0,n.preventDefault(),!1):void 0),this.eventManager.addEventListener(n,"touchmove",n=>{let o,l,h,d,w,y;let{rootDocument:S}=this.hot;if(0===r.dragged.length)return;let b=S.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);b&&b!==r.lastSetCell&&(("TD"===b.nodeName||"TH"===b.nodeName)&&(-1===(o=r.hot.getCoords(b)).col&&(o.col=0),h=(l=r.hot.getSelectedRangeLast()).getWidth(),d=l.getHeight(),w=l.getDirection(),1===h&&1===d&&r.hot.selection.setRangeEnd(o),null!==(y=r.getCurrentRangeCoords(l,o,r.touchStartRange.direction,w,r.dragged[0])).start&&r.hot.selection.setRangeStart(y.start),r.hot.selection.setRangeEnd(y.end),r.lastSetCell=b),n.preventDefault())})}getCurrentRangeCoords(r,n,o,l,h){let d=r.getTopStartCorner(),w=r.getBottomEndCorner(),y=r.getBottomStartCorner(),S=r.getTopEndCorner(),b={start:null,end:null};switch(o){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":b="top"===h?{start:this.hot._createCellCoords(n.row,r.highlight.col),end:this.hot._createCellCoords(y.row,n.col)}:{start:this.hot._createCellCoords(r.highlight.row,n.col),end:this.hot._createCellCoords(n.row,d.col)};break;case"SE-NW":"bottom"===h&&(b={start:this.hot._createCellCoords(w.row,n.col),end:this.hot._createCellCoords(n.row,d.col)})}break;case"NW-SE":switch(l){case"NE-SW":"top"===h?b={start:n,end:y}:b.end=n;break;case"NW-SE":"top"===h?b={start:n,end:w}:b.end=n;break;case"SE-NW":"top"===h?b={start:n,end:d}:b.end=n;break;case"SW-NE":"top"===h?b={start:n,end:S}:b.end=n}break;case"SW-NE":switch(l){case"NW-SE":b="bottom"===h?{start:this.hot._createCellCoords(n.row,d.col),end:this.hot._createCellCoords(y.row,n.col)}:{start:this.hot._createCellCoords(d.row,n.col),end:this.hot._createCellCoords(n.row,w.col)};break;case"SW-NE":b="top"===h?{start:this.hot._createCellCoords(r.highlight.row,n.col),end:this.hot._createCellCoords(n.row,w.col)}:{start:this.hot._createCellCoords(n.row,d.col),end:this.hot._createCellCoords(d.row,n.col)};break;case"SE-NW":"bottom"===h?b={start:this.hot._createCellCoords(n.row,S.col),end:this.hot._createCellCoords(d.row,n.col)}:"top"===h&&(b={start:y,end:n})}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":"top"===h&&(b.end=n);break;case"SE-NW":"top"===h?b.end=n:b={start:n,end:d}}}return b}isDragged(){return this.dragged.length>0}};var s0=o(58352);function createDefaultHeaderSettings(){let{label:r="",colspan:n=1,origColspan:o=1,collapsible:l=!1,crossHiddenColumns:h=[],isCollapsed:d=!1,isHidden:w=!1,isRoot:y=!1,isPlaceholder:S=!1,headerClassNames:b=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:r,colspan:n,origColspan:o,collapsible:l,isCollapsed:d,crossHiddenColumns:h,isHidden:w,isRoot:y,isPlaceholder:S,headerClassNames:b}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}function sourceSettings_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function sourceSettings_classPrivateFieldGet(r,n){return r.get(sourceSettings_assertClassBrand(r,n))}function sourceSettings_classPrivateFieldSet(r,n,o){return r.set(sourceSettings_assertClassBrand(r,n),o),o}function sourceSettings_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let s1=["label","collapsible"];var s2=new WeakMap,s5=new WeakMap,s3=new WeakMap;let SourceSettings=class SourceSettings{constructor(){sourceSettings_classPrivateFieldInitSpec(this,s2,[]),sourceSettings_classPrivateFieldInitSpec(this,s5,0),sourceSettings_classPrivateFieldInitSpec(this,s3,1/0)}setColumnsLimit(r){sourceSettings_classPrivateFieldSet(s3,this,r)}setData(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];sourceSettings_classPrivateFieldSet(s2,this,function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,o=[];if(0===n)return o;(0,b.Bk)(r,r=>{let l=[],h=0;o.push(l),(0,b.Bk)(r,r=>{let o=createDefaultHeaderSettings();if((0,w.Kn)(r)){let{label:n,colspan:l,headerClassName:h}=r;o.label=(0,_.Pz)(n),"number"==typeof l&&l>1&&(o.colspan=l,o.origColspan=l),"string"==typeof h&&(o.headerClassNames=[...h.split(" ")])}else o.label=(0,_.Pz)(r);h+=o.origColspan;let d=!1;if(h>=n&&(o.colspan=o.origColspan-(h-n),o.origColspan=o.colspan,d=!0),l.push(o),o.colspan>1)for(let r=0;r<o.colspan-1;r++)l.push(createPlaceholderHeaderSettings());return!d})});let l=Math.max(...(0,b.Sc)(o,r=>r.length));return(0,b.Bk)(o,r=>{if(r.length<l){let n=(0,b.Sc)(Array(l-r.length),()=>createDefaultHeaderSettings());r.splice(r.length,0,...n)}}),o}(r,sourceSettings_classPrivateFieldGet(s3,this))),sourceSettings_classPrivateFieldSet(s5,this,sourceSettings_classPrivateFieldGet(s2,this).length)}getData(){return sourceSettings_classPrivateFieldGet(s2,this)}mergeWith(r){(0,b.Bk)(r,r=>{let{row:n,col:o,...l}=r,h=this.getHeaderSettings(n,o);null!==h&&(0,w.l7)(h,l,s1)})}map(r){(0,b.Bk)(sourceSettings_classPrivateFieldGet(s2,this),n=>{(0,b.Bk)(n,n=>{let o=r({...n});(0,w.Kn)(o)&&(0,w.l7)(n,o,s1)})})}getHeaderSettings(r,n){var o;if(r>=sourceSettings_classPrivateFieldGet(s5,this)||r<0)return null;let l=sourceSettings_classPrivateFieldGet(s2,this)[r];return!1===Array.isArray(l)||n>=l.length?null:null!==(o=l[n])&&void 0!==o?o:null}getHeadersSettings(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=[];if(r>=sourceSettings_classPrivateFieldGet(s5,this)||r<0)return l;let h=sourceSettings_classPrivateFieldGet(s2,this)[r],d=0;for(let r=n;r<h.length;r++){let n=h[r];if(n.isPlaceholder)throw Error("The first column settings cannot overlap the other header layers");if(d+=n.colspan,l.push(n),n.colspan>1&&(r+=n.colspan-1),d===o)break;if(d>o)throw Error("The last column settings cannot overlap the other header layers")}return l}getLayersCount(){return sourceSettings_classPrivateFieldGet(s5,this)}getColumnsCount(){return sourceSettings_classPrivateFieldGet(s5,this)>0?sourceSettings_classPrivateFieldGet(s2,this)[0].length:0}clear(){sourceSettings_classPrivateFieldSet(s2,this,[]),sourceSettings_classPrivateFieldSet(s5,this,0)}};function tree_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let s8="DF-pre-order",s9=new Map([[s8,function depthFirstPreOrder(r,n){let o=r.call(n,this);for(let l=0;l<this.childs.length;l++){if(!1===o)return!1;o=depthFirstPreOrder.call(this.childs[l],r,n)}return o}],["DF-post-order",function depthFirstPostOrder(r,n){for(let o=0;o<this.childs.length;o++){let l=depthFirstPostOrder.call(this.childs[o],r,n);if(!1===l)return!1}return r.call(n,this)}],["BF",function(r,n){let o=[this];!function process(){if(0===o.length)return;let l=o.shift();o.push(...l.childs),!1!==r.call(n,l)&&process()}()}]]);let TreeNode=class TreeNode{constructor(r){tree_defineProperty(this,"data",{}),tree_defineProperty(this,"parent",null),tree_defineProperty(this,"childs",[]),this.data=r}addChild(r){r.parent=this,this.childs.push(r)}cloneTree(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new TreeNode({...r.data});for(let o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}replaceTreeWith(r){this.data={...r.data},this.childs=[];for(let n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}walkDown(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!s9.has(n))throw Error(`Traversal strategy "${n}" does not exist`);s9.get(n).call(this,r,this)}walkUp(r){let n=this,process=o=>{let l=r.call(n,o);!1!==l&&null!==o.parent&&process(o.parent)};process(this)}};function headersTree_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function headersTree_classPrivateFieldGet(r,n){return r.get(headersTree_assertClassBrand(r,n))}function headersTree_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var s7=new WeakMap,s6=new WeakMap,oe=new WeakMap;let HeadersTree=class HeadersTree{constructor(r){headersTree_classPrivateFieldInitSpec(this,s7,new Map),headersTree_classPrivateFieldInitSpec(this,s6,new Map),headersTree_classPrivateFieldInitSpec(this,oe,null),oe.set(headersTree_assertClassBrand(oe,this),r)}getRoots(){return Array.from(headersTree_classPrivateFieldGet(s7,this).values())}getRootByColumn(r){let n;return headersTree_classPrivateFieldGet(s6,this).has(r)&&(n=headersTree_classPrivateFieldGet(s7,this).get(headersTree_classPrivateFieldGet(s6,this).get(r))),n}getNode(r,n){let o;let l=this.getRootByColumn(n);if(!l)return;let h=n-headersTree_classPrivateFieldGet(s6,this).get(n),d=0;return l.walkDown(l=>{let{data:{origColspan:w,headerLevel:y}}=l;if(r===y){if(h>=d&&h<=d+w-1)return(o=l).data.isRoot=n===o.data.columnIndex,!1;d+=w}}),o}rebuildTreeIndex(){let r=0;headersTree_classPrivateFieldGet(s6,this).clear(),(0,b.Bk)(headersTree_classPrivateFieldGet(s7,this),n=>{let[,{data:{colspan:o}}]=n;for(let n=r;n<r+o;n++)headersTree_classPrivateFieldGet(s6,this).set(n,r);r+=o})}buildTree(){this.clear();let r=headersTree_classPrivateFieldGet(oe,this).getColumnsCount(),n=0;for(;n<r;){let r=headersTree_classPrivateFieldGet(oe,this).getHeaderSettings(0,n),o=new TreeNode;headersTree_classPrivateFieldGet(s7,this).set(n,o),this.buildLeaves(o,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(r,n,o){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,h=headersTree_classPrivateFieldGet(oe,this).getHeadersSettings(o,n,l);o+=1,(0,b.Bk)(h,l=>{let h;let d={...l,headerLevel:o-1,columnIndex:n};1===o?(r.data=d,h=r):(h=new TreeNode(d),r.addChild(h)),o<headersTree_classPrivateFieldGet(oe,this).getLayersCount()&&this.buildLeaves(h,n,o,l.origColspan),n+=l.origColspan})}clear(){headersTree_classPrivateFieldGet(s7,this).clear(),headersTree_classPrivateFieldGet(s6,this).clear()}};function traverseHiddenNodeColumnIndexes(r,n){r.walkDown(r=>{let{data:o,childs:l}=r;if(!o.isHidden&&(n(o.columnIndex),0===l.length))for(let r=1;r<o.colspan;r++)n(o.columnIndex+r)})}function getFirstChildProperty(r,n){let{childs:o}=r;if(0!==o.length)return o[0].data[n]}function isNodeReflectsFirstChildColspan(r){return getFirstChildProperty(r,"origColspan")===r.data.origColspan}function expandNode(r){let{data:n,childs:o}=r;if(!n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};let l=isNodeReflectsFirstChildColspan(r);if(l)return expandNode(o[0]);n.isCollapsed=!1;let h=o.slice(1),d=new Set,w=0;if(h.length>0)(0,b.Bk)(h,r=>{r.replaceTreeWith(r.data.clonedTree),r.data.clonedTree=null;let n=r.data;w+=n.colspan,traverseHiddenNodeColumnIndexes(r,r=>{d.add(r)})});else{let{colspan:r,origColspan:o,columnIndex:l}=n;w=o-r;for(let r=1;r<o;r++)d.add(l+r)}return r.walkUp(r=>{let{data:n}=r;n.colspan+=w,n.colspan>=n.origColspan?(n.colspan=n.origColspan,n.isCollapsed=!1):isNodeReflectsFirstChildColspan(r)&&(n.isCollapsed=getFirstChildProperty(r,"isCollapsed"))}),{rollbackModification:()=>collapseNode(r),affectedColumns:Array.from(d),colspanCompensation:w}}function collapseNode(r){var n;let{data:o,childs:l}=r;if(o.isCollapsed||o.isHidden||o.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};let h=isNodeReflectsFirstChildColspan(r);if(h)return collapseNode(l[0]);o.isCollapsed=!0;let d=l.slice(1),w=new Set;if(d.length>0)(0,b.Bk)(d,r=>{traverseHiddenNodeColumnIndexes(r,r=>{w.add(r)}),r.data.clonedTree=r.cloneTree(),r.walkDown(r=>{let{data:n}=r;n.isHidden=!0})});else{let{origColspan:r,columnIndex:n}=o;for(let o=1;o<r;o++){let r=n+o;w.add(r)}}let y=o.colspan-(null!==(n=getFirstChildProperty(r,"colspan"))&&void 0!==n?n:1);return r.walkUp(r=>{let{data:n}=r;n.colspan-=y,n.colspan<=1?(n.colspan=1,n.isCollapsed=!0):isNodeReflectsFirstChildColspan(r)&&(n.isCollapsed=getFirstChildProperty(r,"isCollapsed"))}),{rollbackModification:()=>expandNode(r),affectedColumns:Array.from(w),colspanCompensation:y}}let ot=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",function(r,n){if(!Number.isInteger(n))throw Error("The passed gridColumnIndex argument has invalid type.");if(r.childs.length>0)throw Error(t_.e`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:o}=r.data;if(o.includes(n))return;let l=!1;r.walkUp(r=>{let{data:{collapsible:n}}=r;if(n)return l=!0,!1}),l||r.walkUp(r=>{let{data:o}=r;o.crossHiddenColumns.push(n),o.colspan>1?o.colspan-=1:o.isHidden=!0})}],["show-column",function(r,n){if(!Number.isInteger(n))throw Error("The passed gridColumnIndex argument has invalid type.");if(r.childs.length>0)throw Error(t_.e`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:o}=r.data;if(!o.includes(n))return;let l=!1;r.walkUp(r=>{let{data:{collapsible:n}}=r;if(n)return l=!0,!1}),l||r.walkUp(r=>{let{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(n),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}]]);function generateMatrix(r){let n=[];return(0,b.Bk)(r,r=>{r.walkDown(r=>{let o;let l=r.data,{origColspan:h,columnIndex:d,headerLevel:w,crossHiddenColumns:y}=l,S=(Array.isArray(n[w])?o=n[w]:(o=[],n[w]=o),o),b=!1;for(let r=d;r<d+h;r++){let n=y.includes(r);if(n||b)S.push(createPlaceholderHeaderSettings(l));else{let r=function(r){let{crossHiddenColumns:n,...o}=createDefaultHeaderSettings(r);return o}(l);r.isRoot=!0,S.push(r),b=!0}}})}),n}function stateManager_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function stateManager_classPrivateFieldSet(r,n,o){return r.set(stateManager_assertClassBrand(r,n),o),o}function stateManager_classPrivateFieldGet(r,n){return r.get(stateManager_assertClassBrand(r,n))}function stateManager_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var oi=new WeakMap,or=new WeakMap,on=new WeakMap;let StateManager=class StateManager{constructor(){stateManager_classPrivateFieldInitSpec(this,oi,new SourceSettings),stateManager_classPrivateFieldInitSpec(this,or,new HeadersTree(stateManager_classPrivateFieldGet(oi,this))),stateManager_classPrivateFieldInitSpec(this,on,[[]])}setState(r){stateManager_classPrivateFieldGet(oi,this).setData(r);let n=!1;try{stateManager_classPrivateFieldGet(or,this).buildTree()}catch(r){stateManager_classPrivateFieldGet(or,this).clear(),stateManager_classPrivateFieldGet(oi,this).clear(),n=!0}return stateManager_classPrivateFieldSet(on,this,generateMatrix(stateManager_classPrivateFieldGet(or,this).getRoots())),n}setColumnsLimit(r){stateManager_classPrivateFieldGet(oi,this).setColumnsLimit(r)}mergeStateWith(r){let n=(0,b.Sc)(r,r=>{let{row:n,...o}=r;return{row:n<0?this.rowCoordsToLevel(n):n,...o}});stateManager_classPrivateFieldGet(oi,this).mergeWith(n),stateManager_classPrivateFieldGet(or,this).buildTree(),stateManager_classPrivateFieldSet(on,this,generateMatrix(stateManager_classPrivateFieldGet(or,this).getRoots()))}mapState(r){stateManager_classPrivateFieldGet(oi,this).map(r),stateManager_classPrivateFieldGet(or,this).buildTree(),stateManager_classPrivateFieldSet(on,this,generateMatrix(stateManager_classPrivateFieldGet(or,this).getRoots()))}mapNodes(r){return(0,b.k$)(stateManager_classPrivateFieldGet(or,this).getRoots(),(n,o)=>(o.walkDown(o=>{let l=r(o.data);void 0!==l&&n.push(l)}),n),[])}triggerNodeModification(r,n,o){let l;n<0&&(n=this.rowCoordsToLevel(n));let h=stateManager_classPrivateFieldGet(or,this).getNode(n,o);return h&&(l=function(r,n,o){if(!ot.has(r))throw Error(`The node modifier action ("${r}") does not exist.`);return ot.get(r)(n,o)}(r,h,o),stateManager_classPrivateFieldSet(on,this,generateMatrix(stateManager_classPrivateFieldGet(or,this).getRoots()))),l}triggerColumnModification(r,n){return this.triggerNodeModification(r,-1,n)}rowCoordsToLevel(r){if(r>=0)return null;let n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(r){if(r<0)return null;let n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(r,n){var o,l;return(r<0&&(r=this.rowCoordsToLevel(r)),null===r||r>=this.getLayersCount())?null:null!==(o=null===(l=stateManager_classPrivateFieldGet(on,this)[r])||void 0===l?void 0:l[n])&&void 0!==o?o:null}getHeaderTreeNodeData(r,n){let o=this.getHeaderTreeNode(r,n);return o?{...o.data}:null}getHeaderTreeNode(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),null===r||r>=this.getLayersCount())return null;let o=stateManager_classPrivateFieldGet(or,this).getNode(r,n);return o||null}findTopMostEntireHeaderLevel(r){var n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,l=o-r+1,h=!1,d=null;for(let n=r;n<=o;n++){let w=stateManager_classPrivateFieldGet(or,this).getRootByColumn(n);if(!w)break;h=!0,w.walkDown(n=>{let{columnIndex:h,headerLevel:w,origColspan:y,isHidden:S}=n.data;!S&&y<=l&&h>=r&&h+y-1<=o&&(null===d||w<d)&&(d=w)},s8)}return h&&null===d?-1:this.levelToRowCoords(null!==(n=d)&&void 0!==n?n:0)}findLeftMostColumnIndex(r,n){var o,l;let{isRoot:h}=null!==(o=this.getHeaderSettings(r,n))&&void 0!==o?o:{isRoot:!0};if(h)return n;let d=n-1;for(;d>=0;){let{isRoot:n}=null!==(l=this.getHeaderSettings(r,d))&&void 0!==l?l:{isRoot:!0};if(n)break;d-=1}return d}findRightMostColumnIndex(r,n){var o,l;let{isRoot:h,origColspan:d}=null!==(o=this.getHeaderSettings(r,n))&&void 0!==o?o:{isRoot:!0,origColspan:1};if(h)return n+d-1;let w=n+1;for(;w<this.getColumnsCount();){let{isRoot:n}=null!==(l=this.getHeaderSettings(r,w))&&void 0!==l?l:{isRoot:!0};if(n)break;w+=1}return w-1}getLayersCount(){return stateManager_classPrivateFieldGet(oi,this).getLayersCount()}getColumnsCount(){return stateManager_classPrivateFieldGet(oi,this).getColumnsCount()}clear(){stateManager_classPrivateFieldSet(on,this,[]),stateManager_classPrivateFieldGet(oi,this).clear(),stateManager_classPrivateFieldGet(or,this).clear()}};function utils_ghostTable_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var os=class{constructor(r,n){utils_ghostTable_defineProperty(this,"hot",void 0),utils_ghostTable_defineProperty(this,"nestedHeaderSettingsGetter",void 0),utils_ghostTable_defineProperty(this,"layersCount",0),utils_ghostTable_defineProperty(this,"container",void 0),utils_ghostTable_defineProperty(this,"widthsMap",void 0),this.hot=r,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(r){return this.layersCount=r,this}getWidth(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(let o=0;o<n;o++){let n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),l=this.hot.toPhysicalColumn(n);this.widthsMap.setValueAtIndex(l,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(r){let{rootDocument:n,columnIndexMapper:o}=this.hot,l=n.createDocumentFragment(),d=n.createElement("table"),w=!!this.hot.getSettings().dropdownMenu,y=o.getRenderableIndexesLength();for(let r=0;r<this.layersCount;r++){let l=n.createElement("tr");for(let d=0;d<y;d++){let y=o.getVisualFromRenderableIndex(d);null===y&&(y=d);let S=n.createElement("th"),b=this.nestedHeaderSettingsGetter(r,y);if(b&&(!b.isPlaceholder||b.isHidden)){let r=b.label;w&&(r+='<button class="changeType"></button>'),(0,h.uS)(S,r),S.colSpan=b.colspan,l.appendChild(S)}}d.appendChild(l)}l.appendChild(d),r.appendChild(l)}clear(){this.widthsMap.clear(),this.container=null}};function nestedHeaders_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function nestedHeaders_classPrivateFieldInitSpec(r,n,o){nestedHeaders_checkPrivateRedeclaration(r,n),n.set(r,o)}function nestedHeaders_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function nestedHeaders_classPrivateFieldSet(r,n,o){return r.set(nestedHeaders_assertClassBrand(r,n),o),o}function nestedHeaders_classPrivateFieldGet(r,n){return r.get(nestedHeaders_assertClassBrand(r,n))}function nestedHeaders_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let oo="nestedHeaders";var ol=new WeakMap,oa=new WeakMap,oh=new WeakMap,od=new WeakMap,oc=new WeakSet;let NestedHeaders=class NestedHeaders extends BasePlugin{constructor(){super(...arguments),nestedHeaders_checkPrivateRedeclaration(this,oc),oc.add(this),nestedHeaders_classPrivateFieldInitSpec(this,ol,new StateManager),nestedHeaders_classPrivateFieldInitSpec(this,oa,null),nestedHeaders_classPrivateFieldInitSpec(this,oh,null),nestedHeaders_classPrivateFieldInitSpec(this,od,!1),nestedHeaders_defineProperty(this,"ghostTable",new os(this.hot,(r,n)=>this.getHeaderSettings(r,n))),nestedHeaders_defineProperty(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return oo}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[oo]}enablePlugin(){var r=this;if(this.enabled)return;let{nestedHeaders:n}=this.hot.getSettings();Array.isArray(n)&&Array.isArray(n[0])||(0,e2.ZK)(t_.e`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>nestedHeaders_assertClassBrand(oc,this,nestedHeaders_onInit).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onAfterLoadData).call(r,...o)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onBeforeOnCellMouseDown).call(r,...o)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,_onAfterOnCellMouseDown).call(r,...o)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onBeforeOnCellMouseOver).call(r,...o)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,_onBeforeOnCellMouseUp).call(r,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onBeforeSelectionHighlightSet).call(r,...o)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onModifyTransformStart).call(r,...o)}),this.addHook("afterSelection",()=>nestedHeaders_assertClassBrand(oc,this,_updateFocusHighlightPosition).call(this)),this.addHook("afterSelectionFocusSet",()=>nestedHeaders_assertClassBrand(oc,this,_updateFocusHighlightPosition).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onBeforeViewportScrollHorizontally).call(r,...o)}),this.addHook("afterGetColumnHeaderRenderers",r=>nestedHeaders_assertClassBrand(oc,this,_onAfterGetColumnHeaderRenderers).call(this,r)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onModifyColWidth).call(r,...o)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,_onModifyColumnHeaderValue).call(r,...o)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,_onBeforeHighlightingColumnHeader).call(r,...o)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,_onBeforeCopy).call(r,...o)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,_onBeforeSelectColumns).call(r,...o)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,nestedHeaders_onAfterViewportColumnCalculatorOverride).call(r,...o)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedHeaders_assertClassBrand(oc,r,_onModifyFocusedElement).call(r,...o)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>nestedHeaders_assertClassBrand(oc,this,_updateFocusHighlightPosition).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>nestedHeaders_assertClassBrand(oc,this,_updateFocusHighlightPosition).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:r}=this.hot.getSettings();nestedHeaders_classPrivateFieldGet(ol,this).setColumnsLimit(this.hot.countCols()),Array.isArray(r)&&(this.detectedOverlappedHeaders=nestedHeaders_classPrivateFieldGet(ol,this).setState(r)),this.detectedOverlappedHeaders&&(0,e2.ZK)(t_.e`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{nestedHeaders_classPrivateFieldGet(ol,this).triggerColumnModification(!0===r?"hide-column":"show-column",n)}),!nestedHeaders_classPrivateFieldGet(oa,this)&&this.enabled&&nestedHeaders_classPrivateFieldSet(oa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(r=>{let{op:n,index:o,newValue:l}=r;"replace"===n&&nestedHeaders_classPrivateFieldGet(ol,this).triggerColumnModification(!0===l?"hide-column":"show-column",o)}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),nestedHeaders_classPrivateFieldGet(ol,this).clear(),nestedHeaders_classPrivateFieldGet(oa,this).unsubscribe(),nestedHeaders_classPrivateFieldSet(oa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return nestedHeaders_classPrivateFieldGet(ol,this)}getLayersCount(){return nestedHeaders_classPrivateFieldGet(ol,this).getLayersCount()}getHeaderSettings(r,n){return nestedHeaders_classPrivateFieldGet(ol,this).getHeaderSettings(r,n)}clearColspans(){if(!this.hot.view)return;let{_wt:r}=this.hot.view,n=r.getSetting("columnHeaders").length,o=r.wtTable.THEAD,l=r.wtOverlays.topOverlay.clone.wtTable.THEAD,d=r.wtOverlays.topInlineStartCornerOverlay?r.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<n;r++){let n=o.childNodes[r];if(!n)break;let w=l.childNodes[r],y=d?d.childNodes[r]:null;for(let r=0,o=n.childNodes.length;r<o;r++)n.childNodes[r].removeAttribute("colspan"),(0,h.IV)(n.childNodes[r],"hiddenHeader"),w&&w.childNodes[r]&&(w.childNodes[r].removeAttribute("colspan"),(0,h.IV)(w.childNodes[r],"hiddenHeader")),d&&y&&y.childNodes[r]&&(y.childNodes[r].removeAttribute("colspan"),(0,h.IV)(y.childNodes[r],"hiddenHeader"))}}headerRendererFactory(r){var n=this;let o=this.hot.view._wt.getSetting("fixedColumnsStart");return(l,d)=>{var w,y,S;let{columnIndexMapper:b,view:_}=this.hot,R=b.getVisualFromRenderableIndex(l);null===R&&(R=l),d.removeAttribute("colspan"),(0,h.IV)(d,"hiddenHeader");let{colspan:P,isHidden:T,isPlaceholder:I,headerClassNames:O}=null!==(w=nestedHeaders_classPrivateFieldGet(ol,this).getHeaderSettings(r,R))&&void 0!==w?w:{label:""};if(I||T)(0,h.cn)(d,"hiddenHeader");else if(P>1){let{wtOverlays:r}=_._wt,n=null===(y=r.topInlineStartCornerOverlay)||void 0===y?void 0:y.clone.wtTable.THEAD.contains(d),h=null===(S=r.inlineStartOverlay)||void 0===S?void 0:S.clone.wtTable.THEAD.contains(d),w=n||h?Math.min(P,o-l):P;w>1&&d.setAttribute("colspan",w)}if(this.hot.view.appendColHeader(R,d,function(){return n.getColumnHeaderValue(...arguments)},r),!I&&!T){let r=d.querySelector("div.relative");r&&O&&O.length>0&&((0,h.IV)(r,this.hot.getColumnMeta(R).headerClassName),(0,h.cn)(r,O))}}}getColumnHeaderValue(r,n){var o;let{isHidden:l,isPlaceholder:h}=null!==(o=nestedHeaders_classPrivateFieldGet(ol,this).getHeaderSettings(n,r))&&void 0!==o?o:{};return h||l?"":this.hot.getColHeader(r,n)}destroy(){nestedHeaders_classPrivateFieldSet(ol,this,null),null!==nestedHeaders_classPrivateFieldGet(oa,this)&&(nestedHeaders_classPrivateFieldGet(oa,this).unsubscribe(),nestedHeaders_classPrivateFieldSet(oa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(r){if(!(r.row>=0)&&!(r.col<0))return nestedHeaders_classPrivateFieldGet(ol,this).getHeaderTreeNodeData(r.row,r.col)}};function _updateFocusHighlightPosition(){var r;let n=null===(r=this.hot)||void 0===r?void 0:r.getSelectedRangeLast();if(!n)return;let{highlight:o}=n,l=o.isHeader()&&o.col>=0;if(l){let r=nestedHeaders_classPrivateFieldGet(ol,this).findLeftMostColumnIndex(o.row,o.col),n=this.hot.selection.highlight.getFocus();n.visualCellRange.highlight.col=r,n.visualCellRange.from.col=r,n.visualCellRange.to.col=r,n.commit()}}function nestedHeaders_onBeforeViewportScrollHorizontally(r){let n=this.hot.getSelectedRangeLast();if(!n)return r;let{highlight:o}=n,l=o.isHeader()&&o.col>=0;if(!l)return r;let h=this.hot.view.getFirstFullyVisibleColumn(),d=this.hot.view.getLastFullyVisibleColumn(),w=nestedHeaders_classPrivateFieldGet(ol,this).findLeftMostColumnIndex(o.row,o.col),y=nestedHeaders_classPrivateFieldGet(ol,this).findRightMostColumnIndex(o.row,o.col);return w<h&&y>d?r:w<h?w:y}function _onBeforeHighlightingColumnHeader(r,n,o){let l=nestedHeaders_classPrivateFieldGet(ol,this).getHeaderTreeNodeData(n,r);if(!l)return r;let{columnCursor:h,selectionType:d,selectionWidth:w}=o,{isRoot:y,colspan:S}=nestedHeaders_classPrivateFieldGet(ol,this).getHeaderSettings(n,r);if(d===s0.Nc){if(!y)return l.columnIndex}else if(d===s0.CD&&(S>w-h||!y))return null;return r}function _onBeforeCopy(r,n,o){let{columnHeadersCount:l}=o;if(0!==l)for(let o=0;o<n.length;o++){let{startRow:l,startCol:d,endRow:w,endCol:y}=n[o],S=w-l+1,b=d-y+1;if(l>=0||1===b)break;for(let n=d;n<=y;n++)for(let o=l;o<=w;o++){var h;let l=S+o,w=n-d;if(0===w)continue;let y=null===(h=nestedHeaders_classPrivateFieldGet(ol,this).getHeaderTreeNodeData(o,n))||void 0===h?void 0:h.isRoot;!1===y&&(r[l][w]="")}}}function nestedHeaders_onBeforeOnCellMouseDown(r,n,o,l){let h=this._getHeaderTreeNodeDataByCoords(n);h&&(l.column=!0)}function _onAfterOnCellMouseDown(r,n){let o=this._getHeaderTreeNodeDataByCoords(n);if(!o)return;nestedHeaders_classPrivateFieldSet(oh,this,n.clone()),nestedHeaders_classPrivateFieldSet(od,this,!0);let{selection:l}=this.hot,h=l.isSelected()?l.getSelectedRange().current():null,w=[],{columnIndex:y,origColspan:S}=o,b=!l.inInSelection(n);r.shiftKey&&h?n.col<h.from.col?w.push(h.getTopEndCorner().col,y,n.row):n.col>h.from.col?w.push(h.getTopStartCorner().col,y+S-1,n.row):w.push(y,y+S-1,n.row):((0,d.pW)(r)||(0,d.dO)(r)&&b||(0,d.z6)(r))&&w.push(y,y+S-1,n.row),l.selectColumns(...w)}function nestedHeaders_onBeforeOnCellMouseOver(r,n,o,l){if(!this.hot.view.isMouseDown())return;let h=this._getHeaderTreeNodeDataByCoords(n);if(!h)return;let{columnIndex:d,origColspan:w}=h,y=this.hot.getSelectedRangeLast(),S=y.getTopStartCorner(),b=y.getBottomEndCorner(),{from:_}=y;l.column=!0,l.cell=!0;let R=[],P=(0,ea.uZ)(n.row,-1/0,-1);n.col<_.col?R.push(b.col,d,P):n.col>_.col?R.push(S.col,d+w-1,P):R.push(d,d+w-1,P),this.hot.selection.selectColumns(...R)}function _onBeforeOnCellMouseUp(){nestedHeaders_classPrivateFieldSet(od,this,!1)}function nestedHeaders_onBeforeSelectionHighlightSet(){let{navigableHeaders:r}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!nestedHeaders_classPrivateFieldGet(od,this)||!r)return;let n=this.hot.getSelectedRangeLast(),o=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,{columnIndex:h,origColspan:d}=nestedHeaders_classPrivateFieldGet(ol,this).getHeaderTreeNodeData(nestedHeaders_classPrivateFieldGet(oh,this).row,nestedHeaders_classPrivateFieldGet(oh,this).col);if(n.setHighlight(nestedHeaders_classPrivateFieldGet(oh,this)),d>n.getWidth()||h<o||h+d-1>l){let r=nestedHeaders_classPrivateFieldGet(ol,this).findTopMostEntireHeaderLevel((0,ea.uZ)(o,h,h+d-1),(0,ea.uZ)(l,h,h+d-1));n.highlight.row=r,n.highlight.col=n.from.col}}function nestedHeaders_onModifyTransformStart(r){let{highlight:n}=this.hot.getSelectedRangeLast(),o=this.hot._createCellCoords(n.row+r.row,n.col+r.col),l=o.isHeader()&&o.col>=0;if(!l)return;let h=nestedHeaders_classPrivateFieldGet(ol,this).findLeftMostColumnIndex(o.row,o.col),d=nestedHeaders_classPrivateFieldGet(ol,this).findRightMostColumnIndex(o.row,o.col);if(r.col<0){let o=n.col>=h&&n.col<=d?h-1:d,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);null===l?r.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):r.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,n.col)-1,1)}else if(r.col>0){let o=n.col>=h&&n.col<=d?d+1:h,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);null===l?r.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):r.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,l)-1,1)}}function _onBeforeSelectColumns(r,n){let o=r.row,l=this._getHeaderTreeNodeDataByCoords({row:o,col:r.col}),h=this._getHeaderTreeNodeDataByCoords({row:o,col:n.col});n.col<r.col?(l&&(r.col=l.columnIndex+l.origColspan-1),h&&(n.col=h.columnIndex)):n.col>=r.col&&(l&&(r.col=l.columnIndex),h&&(n.col=h.columnIndex+h.origColspan-1))}function _onAfterGetColumnHeaderRenderers(r){r.length=0;for(let n=0;n<nestedHeaders_classPrivateFieldGet(ol,this).getLayersCount();n++)r.push(this.headerRendererFactory(n))}function nestedHeaders_onAfterViewportColumnCalculatorOverride(r){let n=nestedHeaders_classPrivateFieldGet(ol,this).getLayersCount(),o=r.startColumn,l=!!n;for(let h=0;h<n;h++){let n=nestedHeaders_classPrivateFieldGet(ol,this).findLeftMostColumnIndex(h,r.startColumn),d=this.hot.columnIndexMapper.getRenderableFromVisualIndex(n);if(n>=0&&(l=!1),(0,ea.kE)(d)&&d<r.startColumn){o=d;break}}r.startColumn=l?nestedHeaders_classPrivateFieldGet(ol,this).getHeaderTreeNodeData(0,o).columnIndex:o}function nestedHeaders_onModifyColWidth(r,n){let o=this.ghostTable.getWidth(n);return r>o?r:o}function _onModifyColumnHeaderValue(r,n,o){var l;let{label:h}=null!==(l=nestedHeaders_classPrivateFieldGet(ol,this).getHeaderTreeNodeData(o,n))&&void 0!==l?l:{label:""};return h}function _onModifyFocusedElement(r,n){if(r<0)return this.hot.getCell(r,nestedHeaders_classPrivateFieldGet(ol,this).findLeftMostColumnIndex(r,n),!0)}function nestedHeaders_onInit(){this.updatePlugin()}function nestedHeaders_onAfterLoadData(r,n){n||this.updatePlugin()}function dataManager_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var ou=class{constructor(r,n){dataManager_defineProperty(this,"hot",void 0),dataManager_defineProperty(this,"data",null),dataManager_defineProperty(this,"plugin",void 0),dataManager_defineProperty(this,"parentReference",new WeakMap),dataManager_defineProperty(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=r}setData(r){this.data=r}getData(){return this.data}getRawSourceData(){let r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}updateWithData(r){this.setData(r),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,ea.q4)(0,this.data.length-1,r=>{this.cacheNode(this.data[r],0,null)})}cacheNode(r,n,o){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&(0,b.Bk)(r.__children,o=>{this.cacheNode(o,n+1,r)})}getDataObject(r){return null==r?null:this.cache.rows[r]}readTreeNodes(r,n,o,l){let h=!1,d=n;if(isNaN(d)&&d.end)return d;let w=r;return(w||(w={__children:this.data},h=!0,d-=1),null!=o&&d===o)?{result:w,end:!0}:null!=l&&w===l?{result:d,end:!0}:(d+=1,w.__children&&(0,b.Bk)(w.__children,r=>{if(this.parentReference.set(r,h?null:w),isNaN(d=this.readTreeNodes(r,d,o,l))&&d.end)return!1}),d)}mockParent(){let r=this.mockNode();return r.__children=this.data,r}mockNode(){let r={};return(0,w._l)(this.data[0],(n,o)=>{r[o]=null}),r}getRowIndex(r){return null==r?null:this.cache.nodeInfo.get(r).row}getRowIndexWithinParent(r){let n=null;n=isNaN(r)?r:this.getDataObject(r);let o=this.getRowParent(r);return null==o?this.data.indexOf(n):o.__children.indexOf(n)}countAllRows(){let r={__children:this.data};return this.countChildren(r)}countChildren(r){let n=0,o=r;return(isNaN(o)||(o=this.getDataObject(o)),o&&o.__children)?((0,b.Bk)(o.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n):0}getRowParent(r){let n;return n=isNaN(r)?r:this.getDataObject(r),this.getRowObjectParent(n)}getRowObjectParent(r){return r&&"object"==typeof r?this.cache.nodeInfo.get(r).parent:null}getRowLevel(r){let n=null;return(n=isNaN(r)?r:this.getDataObject(r))?this.getRowObjectLevel(n):null}getRowObjectLevel(r){return null==r?null:this.cache.nodeInfo.get(r).level}hasChildren(r){let n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(r){return null!==this.getRowParent(r)}getChild(r,n){var o;return(null===(o=r.__children)||void 0===o?void 0:o[n])||null}isRowHighestLevel(r){return!this.isChild(r)}isParent(r){var n;let o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&(null===(n=o.__children)||void 0===n?void 0:n.length)!==0}addChild(r,n){let o=n;this.hot.runHooks("beforeAddChild",r,o);let l=null;r&&(l=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",l+this.countChildren(r)+1,1);let h=r;r||(h=this.mockParent()),h.__children||(h.__children=[]),o||(o=this.mockNode()),h.__children.push(o),this.rewriteCache();let d=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(d,1),this.hot.runHooks("afterCreateRow",d,1),this.hot.runHooks("afterAddChild",r,o)}addChildAtIndex(r,n,o){let l,h=o;if(h||(h=this.mockNode()),this.hot.runHooks("beforeAddChild",r,h,n),r){let o=this.getRowIndex(r),d=o+n+1;this.hot.runHooks("beforeCreateRow",d,1),r.__children.splice(n,null,h),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(d,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",d,1),l=d}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),l=this.getRowIndex(this.data[n]);h=this.getDataObject(l),this.hot.runHooks("afterAddChild",r,h,n)}addSibling(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",o=this.translateTrimmedRow(r),l=this.getRowParent(o),h=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(l,h+1,null);break;case"above":this.addChildAtIndex(l,h,null)}}detachFromParent(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=null,l=[];Array.isArray(r)?((0,ea.q4)(r[0],r[2],r=>{let n=this.translateTrimmedRow(r);l.push(this.getDataObject(n))}),(0,ea.q4)(0,l.length-2,r=>{this.detachFromParent(l[r],!1)}),o=l[l.length-1]):o=r;let h=this.getRowIndex(o),d=this.countChildren(o),w=this.getRowIndexWithinParent(o),y=this.getRowParent(o),S=this.getRowParent(y),b=this.getRowIndex(S),_=null;if(this.hot.runHooks("beforeDetachChild",y,o),null!=w){let r=Array.from(Array(h+d+1).keys()).splice(-1*(d+1));if(this.hot.runHooks("beforeRemoveRow",h,d+1,r,this.plugin.pluginName),y.__children.splice(w,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",h,d+1,r,this.plugin.pluginName),S){_=b+this.countChildren(S);let r=this.getChild(S,this.countChildren(S)-1),n=this.getRowIndex(r);this.hot.runHooks("beforeCreateRow",n+1,d+1,this.plugin.pluginName),S.__children.push(o)}else _=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",_-2,d+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",_-2,d+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",y,o,this.getRowIndex(o)),n&&this.hot.render()}filterData(r,n,o){let l=[];(0,b.Bk)(o,r=>{l.push(this.getDataObject(r))}),(0,b.Bk)(l,r=>{let n=this.getRowIndexWithinParent(r),o=this.getRowParent(r);null===o?this.data.splice(n,1):o.__children.splice(n,1)}),this.rewriteCache()}spliceData(r,n,o){let l=this.getDataObject(r-1),h=null,d=r;l&&l.__children&&0===l.__children.length?(h=l,d=0):r<this.countAllRows()&&(h=this.getRowParent(r),d=this.getRowIndexWithinParent(r)),h?o?h.__children.splice(d,n,...o):h.__children.splice(d,n):o?this.data.splice(d,n,...o):this.data.splice(d,n),this.rewriteCache()}syncRowWithRawSource(r){let n=r,o=null;do null!==(o=this.getRowParent(o))&&(n=o);while(null!==o);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(r,n,o,l){let h=n===this.hot.countRows(),d=this.getRowParent(r),w=this.getRowIndexWithinParent(r),y=d.__children.slice(w,w+1),S=r>n,b=h?this.getRowParent(n-1):this.getRowParent(n);null==b&&(b=this.getRowParent(n-1)),null==b&&(b=this.getDataObject(n-1)),b?b.__children||(b.__children=[]):(b=this.getDataObject(n)).__children=[];let _=h||o||l?b.__children.length:this.getRowIndexWithinParent(n),R=d===b;b.__children.splice(_,0,y[0]),d.__children.splice(w+(S&&R?1:0),1),this.syncRowWithRawSource(d),R||this.syncRowWithRawSource(b)}translateTrimmedRow(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}untranslateTrimmedRow(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}};function nestedRows_ui_base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var og=class{constructor(r,n){nestedRows_ui_base_defineProperty(this,"hot",void 0),nestedRows_ui_base_defineProperty(this,"plugin",void 0),this.hot=n,this.plugin=r}};let HeadersUI=class HeadersUI extends og{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(r,n){super(r,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(r,n){let o=this.hot.toPhysicalRow(r),l=this.dataManager.getRowLevel(o),d=this.dataManager.getDataObject(o),w=n.getElementsByTagName("DIV")[0],y=w.querySelector("span.rowHeader"),S=w.querySelectorAll('[class^="ht_nesting"]'),_=this.hot.getSettings().ariaTags;if((0,b.Bk)(S,r=>{r&&w.removeChild(r)}),(0,h.cn)(n,HeadersUI.CSS_CLASSES.indicatorContainer),l){let{rootDocument:r}=this.hot,n=y.cloneNode(!0);w.innerHTML="",(0,ea.q4)(0,l-1,()=>{let n=r.createElement("SPAN");(0,h.cn)(n,HeadersUI.CSS_CLASSES.emptyIndicator),w.appendChild(n)}),w.appendChild(n)}if(this.dataManager.hasChildren(d)){let r=this.hot.rootDocument.createElement("DIV");_&&(0,h.P$)(r,[(0,O.cV)()]),(0,h.cn)(n,HeadersUI.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?((0,h.cn)(r,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.expandButton}`),_&&(0,h.P$)(n,[(0,O.JV)(!1)])):((0,h.cn)(r,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.collapseButton}`),_&&(0,h.P$)(n,[(0,O.JV)(!0)])),w.appendChild(r)}}updateRowHeaderWidth(r){let n=r;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}};var of=class extends og{constructor(r,n){var o;super(r,n),o=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,r)},shiftStash:function(r,n){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==n&&(n=1/0),(0,b.Bk)(o.lastCollapsedRows,(h,d)=>{h>=r&&h<n&&(o.lastCollapsedRows[d]=h+l)})},applyStash:function(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,r),o.lastCollapsedRows=void 0},trimStash:(r,n)=>{(0,ea.q4)(r,r+n-1,r=>{let n=this.lastCollapsedRows.indexOf(r);n>-1&&this.lastCollapsedRows.splice(n,1)})}}}collapseChildren(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=[],h=null,d=null,w=null;return isNaN(r)?(h=r,d=this.dataManager.getRowIndex(h)):(h=this.dataManager.getDataObject(r),d=r),this.dataManager.hasChildren(h)&&(0,b.Bk)(h.__children,r=>{l.push(this.dataManager.getRowIndex(r))}),w=this.collapseRows(l,!0,!1),o&&this.trimRows(w),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(d)&&this.collapsedRows.push(d),w}collapseMultipleChildren(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=[];(0,b.Bk)(r,r=>{l.push(...this.collapseChildren(r,!1,!1))}),o&&this.trimRows(l),n&&this.renderAndAdjust()}collapseRow(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.collapseRows([r],n)}collapseRows(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=[];return(0,b.Bk)(r,r=>{l.push(r),n&&this.collapseChildRows(r,l)}),o&&this.trimRows(l),l}collapseChildRows(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(r)){let o=this.dataManager.getDataObject(r);(0,b.Bk)(o.__children,r=>{let o=this.dataManager.getRowIndex(r);n.push(o),this.collapseChildRows(o,n)})}o&&this.trimRows(n)}expandRow(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.expandRows([r],n)}expandRows(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=[];return(0,b.Bk)(r,r=>{l.push(r),n&&this.expandChildRows(r,l)}),o&&this.untrimRows(l),l}expandChildRows(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(r)){let o=this.dataManager.getDataObject(r);(0,b.Bk)(o.__children,r=>{if(!this.isAnyParentCollapsed(r)){let o=this.dataManager.getRowIndex(r);n.push(o),this.expandChildRows(o,n)}})}o&&this.untrimRows(n)}expandChildren(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=[],h=null,d=null,w=null;return isNaN(r)?(h=r,d=this.dataManager.getRowIndex(r)):(h=this.dataManager.getDataObject(r),d=r),this.collapsedRows.splice(this.collapsedRows.indexOf(d),1),this.dataManager.hasChildren(h)&&(0,b.Bk)(h.__children,r=>{let n=this.dataManager.getRowIndex(r);l.push(n)}),w=this.expandRows(l,!0,!1),o&&this.untrimRows(w),n&&this.renderAndAdjust(),w}expandMultipleChildren(r){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=[];(0,b.Bk)(r,r=>{l.push(...this.expandChildren(r,!1,!1))}),o&&this.untrimRows(l),n&&this.renderAndAdjust()}collapseAll(){let r=this.dataManager.getData(),n=[];(0,b.Bk)(r,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){let r=this.dataManager.getData(),n=[];(0,b.Bk)(r,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(r){this.hot.batchExecution(()=>{(0,b.Bk)(r,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(r){this.hot.batchExecution(()=>{(0,b.Bk)(r,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(r){let n=isNaN(r)?r:this.dataManager.getDataObject(r),o=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&(0,b.Bk)(n.__children,r=>{let n=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(n))return o=!1,!1}),o}isAnyParentCollapsed(r){let n=r;for(;null!==n;){n=this.dataManager.getRowParent(n);let r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(r,n){if(n.col>=0)return;let o=this.translateTrimmedRow(n.row);(0,h.pv)(r.target,HeadersUI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),(0,d.mM)(r))}translateTrimmedRow(r){return this.hot.toPhysicalRow(r)}untranslateTrimmedRow(r){return this.hot.toVisualRow(r)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}},om=new WeakMap,op=class extends og{constructor(){var r,n,o;super(...arguments),r="dataManager",n=this.plugin.dataManager,(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r,"string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,om),om.set(this,{row_above:(r,n)=>{let o=n[n.length-1];this.dataManager.addSibling(o.start.row,"above")},row_below:(r,n)=>{let o=n[n.length-1];this.dataManager.addSibling(o.start.row,"below")}})}appendOptions(r){let n=[{key:"add_child",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{let r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),n=this.dataManager.getDataObject(r);this.dataManager.addChild(n)},disabled:()=>{let r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(et.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let r=this.hot.getSelectedLast(),n=this.dataManager.translateTrimmedRow(r[0]),o=this.dataManager.getRowParent(n);return!o||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,ea.q4)(0,r.items.length-1,o=>{if(0===o)return(0,b.Bk)(n,(n,l)=>{r.items.splice(o+l,0,n)}),!1}),this.modifyRowInsertingOptions(r)}modifyRowInsertingOptions(r){return(0,ea.q4)(0,r.items.length-1,n=>{let o=om.get(function(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:void 0;throw TypeError("Private element is not present on this object")}(om,this))[r.items[n].key];null!=o&&(r.items[n].callback=o)}),r}};function rowMoveController_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let RowMoveController=class RowMoveController{constructor(r){rowMoveController_defineProperty(this,"plugin",void 0),rowMoveController_defineProperty(this,"hot",void 0),rowMoveController_defineProperty(this,"dataManager",void 0),rowMoveController_defineProperty(this,"collapsingUI",void 0),this.plugin=r,this.hot=r.hot,this.dataManager=r.dataManager,this.collapsingUI=r.collapsingUI}onBeforeRowMove(r,n,o,l){let h=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:l});if(h)return!1;this.movedToCollapsed=!1;let d=o===this.hot.countRows(),w=d?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),y=!0,S=r.map(r=>{if(!y)return!1;let n=this.dataManager.translateTrimmedRow(r);return y=this.shouldAllowMoving(n,w),n}),b=-1===S.indexOf(w);if(!y||!b)return!1;let _=this.getBaseParent(S),R=this.getTargetParent(d,w),P=_===R;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(R),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(S,w,P),this.moveRows(S,w,R),this.dataManager.rewriteCache(),this.moveCellsMeta(S,w),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,l,l&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}displayAPICompatibilityWarning(r){let{rows:n,finalIndex:o,dropIndex:l,movePossible:h}=r,d=!1;return(0,_.o8)(l)&&((0,e2.ZK)(t_.e`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,o,l,h,!1),d=!0),d}shouldAllowMoving(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||0===n)}getBaseParent(r){return this.dataManager.getRowParent(r[0])}getTargetParent(r,n){let o=this.dataManager.getRowParent(r?n-1:n);return null==o&&(o=this.dataManager.getRowParent(n-1)),o}shiftCollapsibleParentsLocations(r,n,o){o||(Math.max(...r)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}moveRows(r,n,o){let l=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(()=>{r.forEach(r=>{this.dataManager.moveRow(r,n,this.movedToCollapsed,l)})})}moveCellsMeta(r,n){let o=[],l=Math.max(...r)<n;r.forEach(r=>{o.push(this.hot.getCellMetaAtRow(r))}),this.hot.spliceCellsMeta(r[0],r.length),this.hot.spliceCellsMeta(n-(l?o.length:0),0,...o)}selectCells(r,n){let o=r.length,l=0,h=0,d=null,w=null;if(this.movedToCollapsed){let d=null;d=r[o-1]<n?this.dataManager.translateTrimmedRow(n-o):this.dataManager.translateTrimmedRow(n);let w=this.dataManager.getRowParent(null===d?this.hot.countSourceRows()-1:d-1),y=this.dataManager.getRowIndex(w);h=l=this.dataManager.untranslateTrimmedRow(y)}else r[o-1]<n?l=(h=n-1)-o+1:h=(l=n)+o-1;d=this.hot.selection,w=this.hot.countCols()-1,d.setRangeStart(this.hot._createCellCoords(l,0)),d.setRangeEnd(this.hot._createCellCoords(h,w),!0)}isRowOrderChanged(r,n){return r.some((r,o)=>r-o!==n)}};function nestedRows_classPrivateFieldInitSpec(r,n,o){nestedRows_checkPrivateRedeclaration(r,n),n.set(r,o)}function nestedRows_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function nestedRows_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function nestedRows_classPrivateFieldGet(r,n){return r.get(nestedRows_assertClassBrand(r,n))}function nestedRows_classPrivateFieldSet(r,n,o){return r.set(nestedRows_assertClassBrand(r,n),o),o}function nestedRows_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let ov="nestedRows";var oC=new WeakMap,ow=new WeakMap,oy=new WeakSet;let NestedRows=class NestedRows extends BasePlugin{constructor(){super(...arguments),nestedRows_checkPrivateRedeclaration(this,oy),oy.add(this),nestedRows_defineProperty(this,"dataManager",null),nestedRows_defineProperty(this,"headersUI",null),nestedRows_defineProperty(this,"collapsedRowsMap",null),nestedRows_classPrivateFieldInitSpec(this,oC,!1),nestedRows_classPrivateFieldInitSpec(this,ow,!1)}static get PLUGIN_KEY(){return ov}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[ov]}enablePlugin(){var r=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new rj.n),this.dataManager=new ou(this,this.hot),this.collapsingUI=new of(this,this.hot),this.headersUI=new HeadersUI(this,this.hot),this.contextMenuUI=new op(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onAfterInit).call(r,...o)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,_onBeforeViewRender).call(r,...o)}),this.addHook("modifyRowData",function(){return r.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return r.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return r.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,_onFilterData).call(r,...o)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onAfterContextMenuDefaultOptions).call(r,...o)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onAfterGetRowHeader).call(r,...o)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onBeforeOnCellMouseDown).call(r,...o)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onBeforeRemoveRow).call(r,...o)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onAfterRemoveRow).call(r,...o)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,_onBeforeAddChild).call(r,...o)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,_onAfterAddChild).call(r,...o)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,_onBeforeDetachChild).call(r,...o)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onAfterDetachChild).call(r,...o)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,_onModifyRowHeaderWidth).call(r,...o)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,nestedRows_onAfterCreateRow).call(r,...o)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return nestedRows_assertClassBrand(oy,r,_onBeforeRowMove).call(r,...o)}),this.addHook("beforeLoadData",r=>nestedRows_assertClassBrand(oy,this,nestedRows_onBeforeLoadData).call(this,r)),this.addHook("beforeUpdateData",r=>nestedRows_assertClassBrand(oy,this,nestedRows_onBeforeLoadData).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();let r=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(r),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:r}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(r.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var r,n;let o=null===(r=this.hot.getSelectedRangeLast())||void 0===r?void 0:r.highlight;return o&&(null===(n=this.hot.getSelectedRangeLast())||void 0===n?void 0:n.isSingle())&&this.hot.selection.isCellVisible(o)&&-1===o.col&&o.row>=0},group:ov,relativeToGroup:y.I,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ov)}disableCoreAPIModifiers(){nestedRows_classPrivateFieldSet(ow,this,!0)}enableCoreAPIModifiers(){nestedRows_classPrivateFieldSet(ow,this,!1)}onModifyRowData(r){if(!nestedRows_classPrivateFieldGet(ow,this))return this.dataManager.getDataObject(r)}onModifySourceLength(){if(!nestedRows_classPrivateFieldGet(ow,this))return this.dataManager.countAllRows()}onBeforeDataSplice(r,n,o){return!!(nestedRows_classPrivateFieldGet(ow,this)||this.dataManager.isRowHighestLevel(r))||(this.dataManager.spliceData(r,n,o),!1)}destroy(){super.destroy()}};function _onBeforeRowMove(r,n,o,l){return this.rowMoveController.onBeforeRowMove(r,n,o,l)}function nestedRows_onBeforeOnCellMouseDown(r,n,o){this.collapsingUI.toggleState(r,n,o)}function _onFilterData(r,n,o){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],n),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*n),this.dataManager.filterData(r,n,o),nestedRows_classPrivateFieldSet(oC,this,!0),this.dataManager.getData().slice()}function nestedRows_onAfterContextMenuDefaultOptions(r){return this.contextMenuUI.appendOptions(r)}function nestedRows_onAfterGetRowHeader(r,n){this.headersUI.appendLevelIndicators(r,n)}function _onModifyRowHeaderWidth(r){return Math.max(this.headersUI.rowHeaderWidthCache,r)}function nestedRows_onAfterRemoveRow(r,n,o,l){l!==this.pluginName&&this.hot._registerTimeout(()=>{nestedRows_classPrivateFieldSet(oC,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function nestedRows_onBeforeRemoveRow(r,n,o){let l=Array.from(o.reduce((r,n)=>{if(this.dataManager.isParent(n)){let o=this.dataManager.getDataObject(n).__children;return r.add(n),Array.isArray(o)&&o.forEach(n=>r.add(this.dataManager.getRowIndex(n))),r}return r.add(n)},new Set));o.length=0,o.push(...l)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(r,n){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(n)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function nestedRows_onAfterDetachChild(r,n,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function nestedRows_onAfterCreateRow(){this.dataManager.rewriteCache()}function nestedRows_onAfterInit(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(r,n){nestedRows_classPrivateFieldGet(oC,this)&&(n.skipRender=!0)}function nestedRows_onBeforeLoadData(r){if(!(0,rT.Pj)(r)){(0,e2.vU)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[ov]=!1,this.disablePlugin();return}this.dataManager.setData(r),this.dataManager.rewriteCache()}function storage_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var oS=class{constructor(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;storage_defineProperty(this,"rootWindow",void 0),storage_defineProperty(this,"prefix",void 0),storage_defineProperty(this,"savedKeys",[]),this.rootWindow=n,this.prefix=r,this.loadSavedKeys()}saveValue(r,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${r}`,JSON.stringify(n)),-1===this.savedKeys.indexOf(r)&&(this.savedKeys.push(r),this.saveSavedKeys())}loadValue(r,n){let o=this.rootWindow.localStorage.getItem(`${this.prefix}_${void 0===r?n:r}`);return null===o?void 0:JSON.parse(o)}reset(r){this.rootWindow.localStorage.removeItem(`${this.prefix}_${r}`)}resetAll(){(0,b.Bk)(this.savedKeys,(r,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){let r=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n="string"==typeof r?JSON.parse(r):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};K.Z.getSingleton().register("persistentStateSave"),K.Z.getSingleton().register("persistentStateLoad"),K.Z.getSingleton().register("persistentStateReset");let ob="persistentState";let PersistentState=class PersistentState extends BasePlugin{constructor(){var r,n,o;super(...arguments),n=void 0,(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="storage","string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n}static get PLUGIN_KEY(){return ob}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[ob]}enablePlugin(){this.enabled||(this.storage||(this.storage=new oS(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(r,n)=>this.saveValue(r,n)),this.addHook("persistentStateLoad",(r,n)=>this.loadValue(r,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(r,n){n.value=this.storage.loadValue(r)}saveValue(r,n){this.storage.saveValue(r,n)}resetValue(r){void 0===r?this.storage.resetAll():this.storage.reset(r)}destroy(){super.destroy()}};function search_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function search_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}let o_="search",DEFAULT_CALLBACK=function(r,n,o,l,h){r.getCellMeta(n,o).isSearchResult=h},DEFAULT_QUERY_METHOD=function(r,n,o){return!((0,_.o8)(r)||null===r||!r.toLocaleLowerCase||0===r.length||(0,_.o8)(n)||null===n)&&-1!==n.toString().toLocaleLowerCase(o.locale).indexOf(r.toLocaleLowerCase(o.locale))};var oR=new WeakSet;let Search=class Search extends BasePlugin{constructor(){super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,oR),oR.add(this),search_defineProperty(this,"callback",DEFAULT_CALLBACK),search_defineProperty(this,"queryMethod",DEFAULT_QUERY_METHOD),search_defineProperty(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return o_}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[o_]}enablePlugin(){var r=this;if(this.enabled)return;let n=this.hot.getSettings()[o_];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return search_assertClassBrand(oR,r,_onBeforeRenderer).call(r,...o)}),super.enablePlugin()}disablePlugin(){var r=this;let beforeRendererCallback=function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return search_assertClassBrand(oR,r,_onBeforeRenderer).call(r,...o)};this.hot.addHook("beforeRenderer",beforeRendererCallback),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",beforeRendererCallback)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),h=this.hot.countCols(),d=[],w=this.hot;return(0,ea.q4)(0,l-1,l=>{(0,ea.q4)(0,h-1,h=>{let y=this.hot.getDataAtCell(l,h),S=this.hot.getCellMeta(l,h),b=S.search.callback||n,_=S.search.queryMethod||o,R=_(r,y,S);R&&d.push({row:l,col:h,data:y}),b&&b(w,l,h,y,R)})}),d}getCallback(){return this.callback}setCallback(r){this.callback=r}getQueryMethod(){return this.queryMethod}setQueryMethod(r){this.queryMethod=r}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(r){this.searchResultClass=r}updatePluginSettings(r){(0,w.Kn)(r)&&(r.searchResultClass&&this.setSearchResultClass(r.searchResultClass),r.queryMethod&&this.setQueryMethod(r.queryMethod),r.callback&&this.setCallback(r.callback))}destroy(){super.destroy()}};function _onBeforeRenderer(r,n,o,l,h,d){let w=d.className||[],y=[];"string"==typeof w?y=w.split(" "):y.push(...w),this.isEnabled()&&d.isSearchResult?y.includes(this.searchResultClass)||y.push(`${this.searchResultClass}`):y.includes(this.searchResultClass)&&y.splice(y.indexOf(this.searchResultClass),1),d.className=y.join(" ")}function touchScroll_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function touchScroll_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var oP=new WeakSet;let TouchScroll=class TouchScroll extends BasePlugin{constructor(){super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,oP),oP.add(this),touchScroll_defineProperty(this,"scrollbars",[]),touchScroll_defineProperty(this,"clones",[]),touchScroll_defineProperty(this,"lockedCollection",!1),touchScroll_defineProperty(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return(0,eI.JS)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>touchScroll_assertClassBrand(oP,this,_onAfterViewRender).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>touchScroll_assertClassBrand(oP,this,_onBeforeTouchScroll).call(this)),this.addHook("afterMomentumScroll",()=>touchScroll_assertClassBrand(oP,this,_onAfterMomentumScroll).call(this))}};function _onAfterViewRender(){if(this.lockedCollection)return;let{topOverlay:r,bottomOverlay:n,inlineStartOverlay:o,topInlineStartCornerOverlay:l,bottomInlineStartCornerOverlay:h}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(r),n.clone&&this.scrollbars.push(n),this.scrollbars.push(o),l&&this.scrollbars.push(l),h&&h.clone&&this.scrollbars.push(h),this.clones=[],r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),h&&h.clone&&this.clones.push(h.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,(0,b.Bk)(this.clones,r=>{(0,h.cn)(r,"hide-tween")})}function _onAfterMomentumScroll(){this.freezeOverlays=!1,(0,b.Bk)(this.clones,r=>{(0,h.IV)(r,"hide-tween"),(0,h.cn)(r,"show-tween")}),this.hot._registerTimeout(()=>{(0,b.Bk)(this.clones,r=>{(0,h.IV)(r,"show-tween")})},400),(0,b.Bk)(this.scrollbars,r=>{r.refresh(),r.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}let oE="trimRows";var oT=new WeakSet;let TrimRows=class TrimRows extends BasePlugin{constructor(){var r,n;super(...arguments),function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,oT),oT.add(this),(r="symbol"==typeof(n=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="trimmedRowsMap","string"))?n:n+"")in this?Object.defineProperty(this,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[r]=null}static get PLUGIN_KEY(){return oE}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[oE]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new rj.n),this.trimmedRowsMap.addLocalHook("init",()=>(function(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")})(oT,this,trimRows_onMapInit).call(this)),super.enablePlugin())}updatePlugin(){let r=this.hot.getSettings()[oE];Array.isArray(r)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,b.Bk)(r,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(r){let n=this.getTrimmedRows(),o=this.isValidConfig(r),l=n;o&&(l=Array.from(new Set(n.concat(r))));let h=this.hot.runHooks("beforeTrimRow",n,l,o);!1!==h&&(o&&this.hot.batchExecution(()=>{(0,b.Bk)(r,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),this.hot.runHooks("afterTrimRow",n,l,o,o&&l.length>n.length))}trimRow(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.trimRows(n)}untrimRows(r){let n=this.getTrimmedRows(),o=this.isValidConfig(r),l=n,h=this.trimmedRowsMap.getValues().slice(),d=r.length>0;o&&d&&((0,b.Bk)(r,r=>{h[r]=!1}),l=(0,b.k$)(h,(r,n,o)=>(n&&r.push(o),r),[]));let w=this.hot.runHooks("beforeUntrimRow",n,l,o&&d);!1!==w&&(o&&d&&this.trimmedRowsMap.setValues(h),this.hot.runHooks("afterUntrimRow",n,l,o&&d,o&&l.length<n.length))}untrimRow(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];this.untrimRows(n)}isTrimmed(r){return this.trimmedRowsMap.getValueAtIndex(r)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(r){let n=this.hot.countSourceRows();return r.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}};function trimRows_onMapInit(){let r=this.hot.getSettings()[oE];Array.isArray(r)&&this.hot.batchExecution(()=>{(0,b.Bk)(r,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0)}o(35214);let oM="undoRedo";function UndoRedo(r){let n=this;this.instance=r,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,r.addHook("afterChange",function(o,l){let h=o&&o.length;if(!h)return;let d=o.find(r=>{let[,,n,o]=r;return n!==o});d&&n.done(()=>{let n=o.reduce((r,n)=>(r.push([...n]),r),[]);(0,b.Bk)(n,n=>{n[1]=r.propToCol(n[1])});let l=h>1?this.getSelected():[[n[0][0],n[0][1]]];return new UndoRedo.ChangeAction(n,l)},l)}),r.addHook("afterCreateRow",(r,o,l)=>{n.done(()=>new UndoRedo.CreateRowAction(r,o),l)});let getCellMetas=(n,o,l,h)=>{let d=["visualRow","visualCol","row","col","prop"],w=d.length,y=[];return(0,ea.q4)(l,h,l=>{(0,ea.q4)(n,o,n=>{let o=r.getCellMeta(n,l);if(Object.keys(o).length!==w){let r=Object.fromEntries(Object.entries(o).filter(r=>{let[n]=r;return!1===d.includes(n)}));y.push([o.visualRow,o.visualCol,r])}})}),y};r.addHook("beforeRemoveRow",(o,l,h,d)=>{n.done(()=>{let h=r.toPhysicalRow(o),d=h+l-1,y=(0,w.I8)(n.instance.getSourceData(h,0,h+l-1,n.instance.countSourceCols()-1));return new UndoRedo.RemoveRowAction(h,y,r.getSettings().fixedRowsBottom,r.getSettings().fixedRowsTop,r.rowIndexMapper.getIndexesSequence(),getCellMetas(h,d,0,r.countCols()-1))},d)}),r.addHook("afterCreateCol",(r,o,l)=>{n.done(()=>new UndoRedo.CreateColumnAction(r,o),l)}),r.addHook("beforeRemoveCol",(o,l,h,d)=>{n.done(()=>{let h=n.instance.getSourceDataArray(),d=(n.instance.countCols()+o)%n.instance.countCols(),w=d+l-1,y=[],S=[],b=[];(0,ea.q4)(h.length-1,n=>{let o=[],l=h[n];(0,ea.q4)(d,w,n=>{o.push(l[r.toPhysicalColumn(n)])}),y.push(o)}),(0,ea.q4)(l-1,n=>{b.push(r.toPhysicalColumn(d+n))}),Array.isArray(r.getSettings().colHeaders)&&(0,ea.q4)(l-1,n=>{S.push(r.getSettings().colHeaders[r.toPhysicalColumn(d+n)]||null)});let _=r.columnIndexMapper.getIndexesSequence(),R=r.rowIndexMapper.getIndexesSequence();return new UndoRedo.RemoveColumnAction(d,b,y,S,_,R,r.getSettings().fixedColumnsStart,getCellMetas(0,r.countRows(),d,w))},d)}),r.addHook("beforeCellAlignment",(r,o,l,h)=>{n.done(()=>new UndoRedo.CellAlignmentAction(r,o,l,h))}),r.addHook("beforeFilter",(r,o)=>{n.done(()=>new UndoRedo.FiltersAction(r,o))}),r.addHook("beforeRowMove",(r,o)=>{!1!==r&&n.done(()=>new UndoRedo.RowMoveAction(r,o))}),r.addHook("beforeColumnMove",(r,o)=>{!1!==r&&n.done(()=>new UndoRedo.ColumnMoveAction(r,o))}),r.addHook("beforeMergeCells",(o,l)=>{l||n.done(()=>new UndoRedo.MergeCellsAction(r,o))}),r.addHook("afterUnmergeCells",(o,l)=>{l||n.done(()=>new UndoRedo.UnmergeCellsAction(r,o))}),r.addHook("beforeColumnSort",(r,o,l)=>{l&&n.done(()=>new UndoRedo.ColumnSortAction(r,o))}),r.addHook("afterInit",()=>{n.init()})}UndoRedo.prototype.done=function(r,n){if(this.ignoreNewActions)return;let o="UndoRedo.undo"===n||"UndoRedo.redo"===n||"auto"===n;if(o)return;let l=this.doneActions.slice(),h=this.instance.runHooks("beforeUndoStackChange",l,n);if(!1===h)return;let d=r(),w=this.undoneActions.slice();this.doneActions.push(d),this.instance.runHooks("afterUndoStackChange",l,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",w),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",w,this.undoneActions.slice())},UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){let r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r);let n=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice());let o=(0,w.I8)(n),l=this.instance.runHooks("beforeUndo",o);if(!1===l)return;this.ignoreNewActions=!0;let h=this,d=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",d),n.undo(this.instance,()=>{h.ignoreNewActions=!1,h.undoneActions.push(n)}),this.instance.runHooks("afterRedoStackChange",d,this.undoneActions.slice()),this.instance.runHooks("afterUndo",o)}},UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){let r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r);let n=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice());let o=(0,w.I8)(n),l=this.instance.runHooks("beforeRedo",o);if(!1===l)return;this.ignoreNewActions=!0;let h=this,d=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",d),n.redo(this.instance,()=>{h.ignoreNewActions=!1,h.doneActions.push(n)}),this.instance.runHooks("afterUndoStackChange",d,this.doneActions.slice()),this.instance.runHooks("afterRedo",o)}},UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},UndoRedo.prototype.isEnabled=function(){return this.enabled},UndoRedo.prototype.enable=function(){if(this.isEnabled())return;let r=this.instance;this.enabled=!0,r.undo=function(){return r.undoRedo.undo()},r.redo=function(){return r.undoRedo.redo()},r.isUndoAvailable=function(){return r.undoRedo.isUndoAvailable()},r.isRedoAvailable=function(){return r.undoRedo.isRedoAvailable()},r.clearUndo=function(){return r.undoRedo.clear()},this.registerShortcuts(),r.addHook("afterChange",onAfterChange)},UndoRedo.prototype.disable=function(){if(!this.isEnabled())return;let r=this.instance;this.enabled=!1,delete r.undo,delete r.redo,delete r.isUndoAvailable,delete r.isRedoAvailable,delete r.clearUndo,this.unregisterShortcuts(),r.removeHook("afterChange",onAfterChange)},UndoRedo.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},UndoRedo.Action=function(){},UndoRedo.Action.prototype.undo=function(){},UndoRedo.Action.prototype.redo=function(){},UndoRedo.ChangeAction=function(r,n){this.changes=r,this.selected=n,this.actionType="change"},(0,w.ED)(UndoRedo.ChangeAction,UndoRedo.Action),UndoRedo.ChangeAction.prototype.undo=function(r,n){let o=(0,w.I8)(this.changes),l=r.countEmptyRows(!0),h=r.countEmptyCols(!0);for(let r=0,n=o.length;r<n;r++)o[r].splice(3,1);r.addHookOnce("afterChange",n),r.setDataAtCell(o,null,null,"UndoRedo.undo");for(let n=0,d=o.length;n<d;n++){let[d,w]=o[n];r.getSettings().minSpareRows&&d+1+r.getSettings().minSpareRows===r.countRows()&&l===r.getSettings().minSpareRows&&(r.alter("remove_row",parseInt(d+1,10),r.getSettings().minSpareRows),r.undoRedo.doneActions.pop()),r.getSettings().minSpareCols&&w+1+r.getSettings().minSpareCols===r.countCols()&&h===r.getSettings().minSpareCols&&(r.alter("remove_col",parseInt(w+1,10),r.getSettings().minSpareCols),r.undoRedo.doneActions.pop())}let d=r.getSelectedLast();if(void 0!==d){let[n,l]=o[0],[h,w]=d,y=r.view.getFirstFullyVisibleRow(),S=r.view.getFirstFullyVisibleColumn(),b=n>=y,_=l>=S,R=h!==n||w!==l;if(!1===(b&&_)&&!0===R){let o={row:n,col:l};!1===b&&(o.verticalSnap="top"),!1===_&&(o.horizontalSnap="start"),r.scrollViewportTo(o)}}r.selectCells(this.selected,!1,!1)},UndoRedo.ChangeAction.prototype.redo=function(r,n){let o=(0,w.I8)(this.changes);for(let r=0,n=o.length;r<n;r++)o[r].splice(2,1);r.addHookOnce("afterChange",n),r.setDataAtCell(o,null,null,"UndoRedo.redo"),this.selected&&r.selectCells(this.selected,!1,!1)},UndoRedo.CreateRowAction=function(r,n){this.index=r,this.amount=n,this.actionType="insert_row"},(0,w.ED)(UndoRedo.CreateRowAction,UndoRedo.Action),UndoRedo.CreateRowAction.prototype.undo=function(r,n){let o=r.countRows(),l=r.getSettings().minSpareRows;this.index>=o&&this.index-l<o&&(this.index-=l),r.addHookOnce("afterRemoveRow",n),r.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateRowAction.prototype.redo=function(r,n){r.addHookOnce("afterCreateRow",n),r.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveRowAction=function(r,n,o,l,h,d){this.index=r,this.data=n,this.actionType="remove_row",this.fixedRowsBottom=o,this.fixedRowsTop=l,this.rowIndexesSequence=h,this.removedCellMetas=d},(0,w.ED)(UndoRedo.RemoveRowAction,UndoRedo.Action),UndoRedo.RemoveRowAction.prototype.undo=function(r,n){let o=r.getSettings(),l=[];o.fixedRowsBottom=this.fixedRowsBottom,o.fixedRowsTop=this.fixedRowsTop,this.data.forEach((r,n)=>{Object.keys(r).forEach(o=>{let h=parseInt(o,10);l.push([this.index+n,isNaN(h)?o:h,r[o]])})}),r.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(n=>{let[o,l,h]=n;r.setCellMetaObject(o,l,h)}),r.addHookOnce("afterViewRender",n),r.setSourceDataAtCell(l,null,null,"UndoRedo.undo"),r.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},UndoRedo.RemoveRowAction.prototype.redo=function(r,n){r.addHookOnce("afterRemoveRow",n),r.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},UndoRedo.CreateColumnAction=function(r,n){this.index=r,this.amount=n,this.actionType="insert_col"},(0,w.ED)(UndoRedo.CreateColumnAction,UndoRedo.Action),UndoRedo.CreateColumnAction.prototype.undo=function(r,n){r.addHookOnce("afterRemoveCol",n),r.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateColumnAction.prototype.redo=function(r,n){r.addHookOnce("afterCreateCol",n),r.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveColumnAction=function(r,n,o,l,h,d,w,y){this.index=r,this.indexes=n,this.data=o,this.amount=this.data[0].length,this.headers=l,this.columnPositions=h.slice(0),this.rowPositions=d.slice(0),this.actionType="remove_col",this.fixedColumnsStart=w,this.removedCellMetas=y},(0,w.ED)(UndoRedo.RemoveColumnAction,UndoRedo.Action),UndoRedo.RemoveColumnAction.prototype.undo=function(r,n){let o=r.getSettings();o.fixedColumnsStart=this.fixedColumnsStart;let l=this.indexes.slice(0).sort(),sortByIndexes=(r,n,o)=>o[this.indexes.indexOf(l[n])],h=this.data.length,d=[];for(let r=0;r<h;r++)d.push((0,b.Sc)(this.data[r],sortByIndexes));let w=(0,b.Sc)(this.headers,sortByIndexes),y=[];r.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),(0,b.Bk)(r.getSourceDataArray(),(r,n)=>{(0,b.Bk)(l,(o,l)=>{r[o]=d[n][l],y.push([n,o,r[o]])})}),r.setSourceDataAtCell(y,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&(0,b.Bk)(w,(n,o)=>{r.getSettings().colHeaders[l[o]]=n}),this.removedCellMetas.forEach(n=>{let[o,l,h]=n;r.setCellMetaObject(o,l,h)}),r.batchExecution(()=>{r.rowIndexMapper.setIndexesSequence(this.rowPositions),r.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),r.addHookOnce("afterViewRender",n),r.render()},UndoRedo.RemoveColumnAction.prototype.redo=function(r,n){r.addHookOnce("afterRemoveCol",n),r.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},UndoRedo.CellAlignmentAction=function(r,n,o,l){this.stateBefore=r,this.range=n,this.type=o,this.alignment=l},UndoRedo.CellAlignmentAction.prototype.undo=function(r,n){(0,b.Bk)(this.range,n=>{n.forAll((n,o)=>{n>=0&&o>=0&&r.setCellMeta(n,o,"className",this.stateBefore[n][o]||" htLeft")})}),r.addHookOnce("afterViewRender",n),r.render()},UndoRedo.CellAlignmentAction.prototype.redo=function(r,n){align(this.range,this.type,this.alignment,(n,o)=>r.getCellMeta(n,o),(n,o,l,h)=>r.setCellMeta(n,o,l,h)),r.addHookOnce("afterViewRender",n),r.render()},UndoRedo.FiltersAction=function(r,n){this.previousConditionsStack=n,this.conditionsStack=r,this.actionType="filter"},(0,w.ED)(UndoRedo.FiltersAction,UndoRedo.Action),UndoRedo.FiltersAction.prototype.undo=function(r,n){let o=r.getPlugin("filters");r.addHookOnce("afterViewRender",n),this.previousConditionsStack&&o.conditionCollection.importAllConditions(this.previousConditionsStack),o.filter()},UndoRedo.FiltersAction.prototype.redo=function(r,n){let o=r.getPlugin("filters");r.addHookOnce("afterViewRender",n),o.conditionCollection.importAllConditions(this.conditionsStack),o.filter()};let MergeCellsAction=class MergeCellsAction extends UndoRedo.Action{constructor(r,n){super(),this.cellRange=n;let o=this.cellRange.getTopStartCorner(),l=this.cellRange.getBottomEndCorner();this.rangeData=r.getData(o.row,o.col,l.row,l.col)}undo(r,n){let o=r.getPlugin("mergeCells");r.addHookOnce("afterViewRender",n),o.unmergeRange(this.cellRange,!0);let l=this.cellRange.getTopStartCorner();r.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}redo(r,n){let o=r.getPlugin("mergeCells");r.addHookOnce("afterViewRender",n),o.mergeRange(this.cellRange)}};UndoRedo.MergeCellsAction=MergeCellsAction;let UnmergeCellsAction=class UnmergeCellsAction extends UndoRedo.Action{constructor(r,n){super(),this.cellRange=n}undo(r,n){let o=r.getPlugin("mergeCells");r.addHookOnce("afterViewRender",n),o.mergeRange(this.cellRange,!0)}redo(r,n){let o=r.getPlugin("mergeCells");r.addHookOnce("afterViewRender",n),o.unmergeRange(this.cellRange,!0),r.render()}};function onAfterChange(r,n){if("loadData"===n)return this.undoRedo.clear()}UndoRedo.UnmergeCellsAction=UnmergeCellsAction,UndoRedo.RowMoveAction=function(r,n){this.rows=r.slice(),this.finalRowIndex=n,this.actionType="row_move"},(0,w.ED)(UndoRedo.RowMoveAction,UndoRedo.Action),UndoRedo.RowMoveAction.prototype.undo=function(r,n){let o=r.getPlugin("manualRowMove");r.addHookOnce("afterViewRender",n);let l=getMoves(this.rows,this.finalRowIndex,r.rowIndexMapper.getNumberOfIndexes());l.reverse().forEach(r=>{let{from:n,to:l}=r;n<l&&(l-=1),o.moveRow(l,n)}),r.render(),r.deselectCell(),r.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},UndoRedo.RowMoveAction.prototype.redo=function(r,n){let o=r.getPlugin("manualRowMove");r.addHookOnce("afterViewRender",n),o.moveRows(this.rows.slice(),this.finalRowIndex),r.render(),r.deselectCell(),r.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},UndoRedo.ColumnMoveAction=function(r,n){this.columns=r.slice(),this.finalColumnIndex=n,this.actionType="col_move"},(0,w.ED)(UndoRedo.ColumnMoveAction,UndoRedo.Action),UndoRedo.ColumnMoveAction.prototype.undo=function(r,n){let o=r.getPlugin("manualColumnMove");r.addHookOnce("afterViewRender",n);let l=getMoves(this.columns,this.finalColumnIndex,r.columnIndexMapper.getNumberOfIndexes());l.reverse().forEach(r=>{let{from:n,to:l}=r;n<l&&(l-=1),o.moveColumn(l,n)}),r.render(),r.deselectCell(),r.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},UndoRedo.ColumnMoveAction.prototype.redo=function(r,n){let o=r.getPlugin("manualColumnMove");r.addHookOnce("afterViewRender",n),o.moveColumns(this.columns.slice(),this.finalColumnIndex),r.render(),r.deselectCell(),r.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},UndoRedo.ColumnSortAction=function(r,n){this.previousSortState=r,this.nextSortState=n},(0,w.ED)(UndoRedo.ColumnSortAction,UndoRedo.Action),UndoRedo.ColumnSortAction.prototype.undo=function(r,n){let o=r.getPlugin("columnSorting"),l=r.getPlugin("multiColumnSorting"),h=l.isEnabled()?l:o;this.previousSortState.length?h.sort(this.previousSortState):h.clearSort(),n()},UndoRedo.ColumnSortAction.prototype.redo=function(r,n){let o=r.getPlugin("columnSorting"),l=r.getPlugin("multiColumnSorting"),h=l.isEnabled()?l:o;h.sort(this.nextSortState),n()},UndoRedo.prototype.init=function(){let r=this.instance.getSettings().undo;this.instance.undoRedo||(this.instance.undoRedo=this),void 0===r||r?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},UndoRedo.prototype.registerShortcuts=function(){let r=this.instance.getShortcutManager(),n=r.getContext("grid");n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:r=>!r.altKey,group:oM})},UndoRedo.prototype.unregisterShortcuts=function(){let r=this.instance.getShortcutManager(),n=r.getContext("grid");n.removeShortcutsByGroup(oM)};let oI=K.Z.getSingleton();function registerAllModules(){(0,J.qm)(N.Hf),(0,J.qm)(AutocompleteEditor),(0,J.qm)(CheckboxEditor),(0,J.qm)(DateEditor),(0,J.qm)(DropdownEditor),(0,J.qm)(HandsontableEditor),(0,J.qm)(NumericEditor),(0,J.qm)(PasswordEditor),(0,J.qm)(SelectEditor),(0,J.qm)(l.H),(0,J.qm)(TimeEditor),(0,eh.zn)(autocompleteRenderer),(0,eh.zn)(Q.Z),(0,eh.zn)(checkboxRenderer),(0,eh.zn)(dropdownRenderer),(0,eh.zn)(handsontableRenderer),(0,eh.zn)(htmlRenderer),(0,eh.zn)(numericRenderer),(0,eh.zn)(passwordRenderer),(0,eh.zn)(selectRenderer),(0,eh.zn)(I.V),(0,eh.zn)(timeRenderer),(0,ec.Ie)(autocompleteValidator),(0,ec.Ie)(dropdownValidator),(0,ec.Ie)(dateValidator),(0,ec.Ie)(numericValidator),(0,ec.Ie)(timeValidator),(0,eb.xN)(eu),(0,eb.xN)(eg),(0,eb.xN)(ef),(0,eb.xN)(em),(0,eb.xN)(ep),(0,eb.xN)(ev),(0,eb.xN)(eC),(0,eb.xN)(ew),(0,eb.xN)(ey.n),(0,eb.xN)(eS),(0,e_.fo)(AutoColumnSize),(0,e_.fo)(Autofill),(0,e_.fo)(AutoRowSize),(0,e_.fo)(BindRowsWithHeaders),(0,e_.fo)(CollapsibleColumns),(0,e_.fo)(ColumnSorting),(0,e_.fo)(ColumnSummary),(0,e_.fo)(Comments),(0,e_.fo)(ContextMenu),(0,e_.fo)(CopyPaste),(0,e_.fo)(CustomBorders),(0,e_.fo)(DragToScroll),(0,e_.fo)(DropdownMenu),(0,e_.fo)(ExportFile),(0,e_.fo)(Filters),(0,e_.fo)(Formulas),(0,e_.fo)(HiddenColumns),(0,e_.fo)(HiddenRows),(0,e_.fo)(ManualColumnFreeze),(0,e_.fo)(ManualColumnMove),(0,e_.fo)(ManualColumnResize),(0,e_.fo)(ManualRowMove),(0,e_.fo)(ManualRowResize),(0,e_.fo)(MergeCells),(0,e_.fo)(MultiColumnSorting),(0,e_.fo)(MultipleSelectionHandles),(0,e_.fo)(NestedHeaders),(0,e_.fo)(NestedRows),(0,e_.fo)(PersistentState),(0,e_.fo)(Search),(0,e_.fo)(TouchScroll),(0,e_.fo)(TrimRows),(0,e_.fo)(UndoRedo)}oI.add("afterUpdateSettings",function(){var r;null===(r=this.getPlugin("undoRedo"))||void 0===r||r.init()}),oI.register("beforeUndo"),oI.register("afterUndo"),oI.register("beforeRedo"),oI.register("afterRedo"),UndoRedo.PLUGIN_KEY="undoRedo",UndoRedo.SETTING_KEYS=!0},51774:function(r,n,o){"use strict";o.d(n,{Z:function(){return baseRenderer}}),o(58563);var l=o(5566),h=o(18200);function baseRenderer(r,n,o,d,w,y,S){let b=S.ariaTags,_=[],R=[],P=[],T=[];S.className&&(0,l.cn)(n,S.className),S.readOnly?(_.push(S.readOnlyCellClassName),b&&T.push((0,h.zR)())):b&&P.push((0,h.zR)()[0]),!1===S.valid&&S.invalidCellClassName?(_.push(S.invalidCellClassName),b&&T.push((0,h.w1)())):(R.push(S.invalidCellClassName),b&&P.push((0,h.w1)()[0])),!1===S.wordWrap&&S.noWordWrapClassName&&_.push(S.noWordWrapClassName),!y&&S.placeholder&&_.push(S.placeholderCellClassName),(0,l.IV)(n,R),(0,l.cn)(n,_),(0,l.d$)(n,P),(0,l.P$)(n,T)}baseRenderer.RENDERER_TYPE="base"},36903:function(r,n,o){"use strict";o.d(n,{Bp:function(){return _getItem},Y3:function(){return w},zn:function(){return _register}}),o(57855);var l=o(82656);let{register:h,getItem:d,hasItem:w,getNames:y,getValues:S}=(0,l.Z)("renderers");function _getItem(r){if("function"==typeof r)return r;if(!w(r))throw Error(`No registered renderer found under "${r}" name`);return d(r)}function _register(r,n){"string"!=typeof r&&(r=(n=r).RENDERER_TYPE),h(r,n)}},49532:function(r,n,o){"use strict";o.d(n,{V:function(){return textRenderer}});var l=o(51774),h=o(5566),d=o(2518);function textRenderer(r,n,o,w,y,S,b){l.Z.apply(this,[r,n,o,w,y,S,b]);let _=S;if(!_&&b.placeholder&&(_=b.placeholder),_=(0,d.Pz)(_),b.trimWhitespace&&(_=_.trim()),b.rendererTemplate){(0,h.cS)(n);let l=r.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=b.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=r.getSourceDataAtRow(o),n.appendChild(l)}else(0,h.tT)(n,_)}textRenderer.RENDERER_TYPE="text"},94198:function(r,n,o){"use strict";o.d(n,{Z:function(){return J}}),o(57855),o(58563),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var l=o(58352),h=o(69488),d=o(63437);let Selection=class Selection{constructor(r,n){this.settings=r,this.cellRange=n||null}isEmpty(){return null===this.cellRange}add(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}replace(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};(0,h.jB)(Selection,d.Z);var w=Selection,y=class extends w{constructor(r,n){var o,l;super(r,null),(o="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(o="visualCellRange","string"))?l:l+"")in this?Object.defineProperty(this,o,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[o]=null,this.visualCellRange=n||null,this.commit()}add(r){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(r):this.visualCellRange.expand(r),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(r){let{from:n,to:o}=r,l=this.getNearestNotHiddenCoords(n,1),h=this.getNearestNotHiddenCoords(o,-1);return null===l||null===h?null:((l.row>h.row||l.col>h.col)&&(l=n,h=o),this.settings.createCellRange(l,l,h))}getNearestNotHiddenCoords(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,r.row,n);if(null===l)return null;let h=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,r.col,o);return null===h?null:this.settings.createCellCoords(l,h)}getNearestNotHiddenIndex(r,n,o){return n<0?n:r.getNearestNotHiddenIndex(n,o)}commit(){if(null===this.visualCellRange)return this;let r=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===r?this.cellRange=null:this.cellRange=this.createRenderableCellRange(r.from,r.to),this}syncWith(r){let n=r.from.clone().normalize(),o="N-S"===r.getVerticalDirection()?1:-1,l="W-E"===r.getHorizontalDirection()?1:-1,h=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),d=null;if((null===h||null===h.col||null===h.row)&&(d=this.getNearestNotHiddenCoords(n,o,l)),null!==d&&r.overlaps(d)){let n=r.highlight.clone();if(n.row>=0&&(n.row=d.row),n.col>=0&&(n.col=d.col),null===this.cellRange){let r=this.settings.visualToRenderableCoords(n);this.cellRange=this.settings.createCellRange(r)}r.setHighlight(n)}return"focus"===this.settings.selectionType&&null!==h&&null===d&&r.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:r,to:n}=this.cellRange;return[Math.min(r.row,n.row),Math.min(r.col,n.col),Math.max(r.row,n.row),Math.max(r.col,n.col)]}getVisualCorners(){let r=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[r.row,r.col,n.row,n.col]}createRenderableCellRange(r,n){let o=this.settings.visualToRenderableCoords(r),l=this.settings.visualToRenderableCoords(n);return null===o.row||null===o.col||null===l.row||null===l.col?null:this.settings.createCellRange(o,o,l)}};function createHighlight(r){let{activeHeaderClassName:n,...o}=r;return new y({className:n,...o,selectionType:l.CD})}function areaLayered_createHighlight(r){let{areaCornerVisible:n,...o}=r;return new y({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:n},...o,selectionType:l.AI})}function area_createHighlight(r){let{...n}=r;return new y({className:"highlight",...n,selectionType:l.AI})}function column_createHighlight(r){let{columnClassName:n,...o}=r;return new y({className:n,...o,selectionType:l.BA})}var S=o(18200);function header_createHighlight(r){let{headerClassName:n,...o}=r;return new y({className:n,...o,selectionType:l.Nc})}function row_createHighlight(r){let{rowClassName:n,...o}=r;return new y({className:n,...o,selectionType:l.Os})}var b=o(99440);function highlight_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var _=new WeakSet;let Highlight=class Highlight{constructor(r){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,_),_.add(this),highlight_defineProperty(this,"options",void 0),highlight_defineProperty(this,"layerLevel",0),highlight_defineProperty(this,"focus",void 0),highlight_defineProperty(this,"fill",void 0),highlight_defineProperty(this,"layeredAreas",new Map),highlight_defineProperty(this,"areas",new Map),highlight_defineProperty(this,"rowHeaders",new Map),highlight_defineProperty(this,"columnHeaders",new Map),highlight_defineProperty(this,"activeRowHeaders",new Map),highlight_defineProperty(this,"activeColumnHeaders",new Map),highlight_defineProperty(this,"activeCornerHeaders",new Map),highlight_defineProperty(this,"rowHighlights",new Map),highlight_defineProperty(this,"columnHighlights",new Map),highlight_defineProperty(this,"customSelections",[]),this.options=r,this.focus=function(r){let{cellCornerVisible:n,...o}=r;return new y({className:"current",headerAttributes:[(0,S.Ak)()],border:{width:2,color:"#4b89ff",cornerVisible:n},...o,selectionType:l.t8})}(r),this.fill=function(r){let{...n}=r;return new y({className:"fill",border:{width:1,color:"#ff0000"},...n,selectionType:l.P$})}(r)}isEnabledFor(r,n){let o=r;r===l.t8&&(o="current");let h=this.options.disabledCellSelection(n.row,n.col);return"string"==typeof h&&(h=[h]),!1===h||Array.isArray(h)&&!h.includes(o)}useLayerLevel(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=r,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _assertClassBrand(_,this,_createHighlight).call(this,this.layeredAreas,areaLayered_createHighlight)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _assertClassBrand(_,this,_createHighlight).call(this,this.areas,area_createHighlight)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _assertClassBrand(_,this,_createHighlight).call(this,this.rowHeaders,header_createHighlight)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _assertClassBrand(_,this,_createHighlight).call(this,this.columnHeaders,header_createHighlight)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _assertClassBrand(_,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _assertClassBrand(_,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _assertClassBrand(_,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _assertClassBrand(_,this,_createHighlight).call(this,this.rowHighlights,row_createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _assertClassBrand(_,this,_createHighlight).call(this,this.columnHighlights,column_createHighlight)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(r){this.customSelections.push(function(r){let{border:n,visualCellRange:o,...h}=r;return new y({...n,...h,selectionType:l.$7},o)}({...this.options,...r}))}clear(){this.focus.clear(),this.fill.clear(),(0,b.Bk)(this.areas.values(),r=>void r.clear()),(0,b.Bk)(this.layeredAreas.values(),r=>void r.clear()),(0,b.Bk)(this.rowHeaders.values(),r=>void r.clear()),(0,b.Bk)(this.columnHeaders.values(),r=>void r.clear()),(0,b.Bk)(this.activeRowHeaders.values(),r=>void r.clear()),(0,b.Bk)(this.activeColumnHeaders.values(),r=>void r.clear()),(0,b.Bk)(this.activeCornerHeaders.values(),r=>void r.clear()),(0,b.Bk)(this.rowHighlights.values(),r=>void r.clear()),(0,b.Bk)(this.columnHighlights.values(),r=>void r.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function _createHighlight(r,n){let o=this.layerLevel;if(r.has(o))return r.get(o);let l=n({layerLevel:o,...this.options});return r.set(o,l),l}function range_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let SelectionRange=class SelectionRange{constructor(r){range_defineProperty(this,"ranges",[]),range_defineProperty(this,"createCellRange",void 0),this.createCellRange=r}isEmpty(){return 0===this.size()}set(r){return this.clear(),this.ranges.push(this.createCellRange(r)),this}add(r){return this.ranges.push(this.createCellRange(r)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(r){return this.ranges.some(n=>n.includes(r))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return n>=0&&n<this.size()&&(r=this.ranges[n]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}};var R=o(2518),P=o(67790);function _classPrivateFieldInitSpec(r,n,o){transformation_checkPrivateRedeclaration(r,n),n.set(r,o)}function transformation_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(r,n){return r.get(transformation_assertClassBrand(r,n))}function _classPrivateFieldSet(r,n,o){return r.set(transformation_assertClassBrand(r,n),o),o}function transformation_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var T=new WeakMap,I=new WeakMap,O=new WeakMap,k=new WeakSet;let Transformation=class Transformation{constructor(r,n){transformation_checkPrivateRedeclaration(this,k),k.add(this),_classPrivateFieldInitSpec(this,T,void 0),_classPrivateFieldInitSpec(this,I,void 0),_classPrivateFieldInitSpec(this,O,{x:0,y:0}),_classPrivateFieldSet(T,this,r),_classPrivateFieldSet(I,this,n)}transformStart(r,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=_classPrivateFieldGet(I,this).createCellCoords(r,n),d=_classPrivateFieldGet(T,this).current().highlight,w=_classPrivateFieldGet(I,this).visualToRenderableCoords(d),y=0,S=0;if(this.runLocalHooks("beforeTransformStart",l),null!==w.row&&null!==w.col){let{width:r,height:n}=transformation_assertClassBrand(k,this,_getTableSize).call(this),{row:w,col:b}=transformation_assertClassBrand(k,this,_visualToZeroBasedCoords).call(this,d),_=_classPrivateFieldGet(I,this).fixedRowsBottom(),R=_classPrivateFieldGet(I,this).minSpareRows(),P=_classPrivateFieldGet(I,this).minSpareCols(),T=_classPrivateFieldGet(I,this).autoWrapRow(),O=_classPrivateFieldGet(I,this).autoWrapCol(),N=_classPrivateFieldGet(I,this).createCellCoords(w+l.row,b+l.col);if(N.row>=n){let l=(0,h.sm)(o&&R>0&&0===_),d=N.col+1,w=_classPrivateFieldGet(I,this).createCellCoords(N.row-n,d>=r?d-r:d);this.runLocalHooks("beforeColumnWrap",l,transformation_assertClassBrand(k,this,_zeroBasedToVisualCoords).call(this,w),d>=r),l.value?this.runLocalHooks("insertRowRequire",_classPrivateFieldGet(I,this).countRenderableRows()):O&&N.assign(w)}else if(N.row<0){let o=(0,h.sm)(O),l=N.col-1,d=_classPrivateFieldGet(I,this).createCellCoords(n+N.row,l<0?r+l:l);this.runLocalHooks("beforeColumnWrap",o,transformation_assertClassBrand(k,this,_zeroBasedToVisualCoords).call(this,d),l<0),O&&N.assign(d)}if(N.col>=r){let l=(0,h.sm)(o&&P>0),d=N.row+1,w=_classPrivateFieldGet(I,this).createCellCoords(d>=n?d-n:d,N.col-r);this.runLocalHooks("beforeRowWrap",l,transformation_assertClassBrand(k,this,_zeroBasedToVisualCoords).call(this,w),d>=n),l.value?this.runLocalHooks("insertColRequire",_classPrivateFieldGet(I,this).countRenderableColumns()):T&&N.assign(w)}else if(N.col<0){let o=(0,h.sm)(T),l=N.row-1,d=_classPrivateFieldGet(I,this).createCellCoords(l<0?n+l:l,r+N.col);this.runLocalHooks("beforeRowWrap",o,transformation_assertClassBrand(k,this,_zeroBasedToVisualCoords).call(this,d),l<0),T&&N.assign(d)}let{rowDir:L,colDir:j}=transformation_assertClassBrand(k,this,_clampCoords).call(this,N);y=L,S=j,d=transformation_assertClassBrand(k,this,_zeroBasedToVisualCoords).call(this,N)}return this.runLocalHooks("afterTransformStart",d,y,S),d}transformEnd(r,n){let o=_classPrivateFieldGet(I,this).createCellCoords(r,n),l=_classPrivateFieldGet(T,this).current(),h=_classPrivateFieldGet(I,this).visualToRenderableCoords(l.highlight),d=transformation_assertClassBrand(k,this,_findFirstNonHiddenZeroBasedRow).call(this,l.to.row,l.from.row),w=transformation_assertClassBrand(k,this,_findFirstNonHiddenZeroBasedColumn).call(this,l.to.col,l.from.col),y=l.to.clone(),S=0,b=0;if(this.runLocalHooks("beforeTransformEnd",o),null!==h.row&&null!==h.col&&null!==d&&null!==w){let{row:r,col:n}=transformation_assertClassBrand(k,this,_visualToZeroBasedCoords).call(this,l.highlight),h=_classPrivateFieldGet(I,this).createCellCoords(d+o.row,w+o.col),_=l.getTopStartCorner(),R=l.getTopEndCorner(),P=l.getBottomEndCorner();if(o.col<0&&w>=n&&h.col<n){let r=h.col-n;h.col=transformation_assertClassBrand(k,this,_findFirstNonHiddenZeroBasedColumn).call(this,_.col,R.col)+r}else if(o.col>0&&w<=n&&h.col>n){let r=transformation_assertClassBrand(k,this,_findFirstNonHiddenZeroBasedColumn).call(this,R.col,_.col),n=Math.max(h.col-r,1);h.col=r+n}if(o.row<0&&d>=r&&h.row<r){let n=h.row-r;h.row=transformation_assertClassBrand(k,this,_findFirstNonHiddenZeroBasedRow).call(this,_.row,P.row)+n}else if(o.row>0&&d<=r&&h.row>r){let r=transformation_assertClassBrand(k,this,_findFirstNonHiddenZeroBasedRow).call(this,P.row,_.row),n=Math.max(h.row-r,1);h.row=r+n}let{rowDir:T,colDir:O}=transformation_assertClassBrand(k,this,_clampCoords).call(this,h);S=T,b=O;let N=transformation_assertClassBrand(k,this,_zeroBasedToVisualCoords).call(this,h);0===o.row&&0!==o.col?y.col=N.col:0!==o.row&&0===o.col?y.row=N.row:(y.row=N.row,y.col=N.col)}return this.runLocalHooks("afterTransformEnd",y,S,b),y}setOffsetSize(r){let{x:n,y:o}=r;_classPrivateFieldSet(O,this,{x:n,y:o})}resetOffsetSize(){_classPrivateFieldSet(O,this,{x:0,y:0})}};function _clampCoords(r){let{width:n,height:o}=transformation_assertClassBrand(k,this,_getTableSize).call(this),l=0,h=0;return r.row<0?(l=-1,r.row=0):r.row>0&&r.row>=o&&(l=1,r.row=o-1),r.col<0?(h=-1,r.col=0):r.col>0&&r.col>=n&&(h=1,r.col=n-1),{rowDir:l,colDir:h}}function _getTableSize(){return{width:_classPrivateFieldGet(O,this).x+_classPrivateFieldGet(I,this).countRenderableColumns(),height:_classPrivateFieldGet(O,this).y+_classPrivateFieldGet(I,this).countRenderableRows()}}function _findFirstNonHiddenZeroBasedRow(r,n){let o=_classPrivateFieldGet(I,this).findFirstNonHiddenRenderableRow(r,n);return null===o?null:_classPrivateFieldGet(O,this).y+o}function _findFirstNonHiddenZeroBasedColumn(r,n){let o=_classPrivateFieldGet(I,this).findFirstNonHiddenRenderableColumn(r,n);return null===o?null:_classPrivateFieldGet(O,this).x+o}function _visualToZeroBasedCoords(r){let{row:n,col:o}=_classPrivateFieldGet(I,this).visualToRenderableCoords(r);if(null===n||null===o)throw Error("Renderable coords are not visible.");return _classPrivateFieldGet(I,this).createCellCoords(_classPrivateFieldGet(O,this).y+n,_classPrivateFieldGet(O,this).x+o)}function _zeroBasedToVisualCoords(r){let n=r.clone();return n.col=r.col-_classPrivateFieldGet(O,this).x,n.row=r.row-_classPrivateFieldGet(O,this).y,_classPrivateFieldGet(I,this).renderableToVisualCoords(n)}(0,h.jB)(Transformation,d.Z);var N=o(30855),L=o(32836);function selection_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function selection_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function selection_classPrivateFieldGet(r,n){return r.get(selection_assertClassBrand(r,n))}function selection_classPrivateFieldSet(r,n,o){return r.set(selection_assertClassBrand(r,n),o),o}function selection_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var j=new WeakMap,U=new WeakMap,$=new WeakMap,K=new WeakMap,Y=new WeakMap,X=new WeakMap;let selection_Selection=class selection_Selection{constructor(r,n){var o=this;selection_defineProperty(this,"settings",void 0),selection_defineProperty(this,"tableProps",void 0),selection_defineProperty(this,"inProgress",!1),selection_defineProperty(this,"selectedRange",new SelectionRange((r,n,o)=>this.tableProps.createCellRange(r,n,o))),selection_defineProperty(this,"highlight",void 0),selection_classPrivateFieldInitSpec(this,j,void 0),selection_classPrivateFieldInitSpec(this,U,void 0),selection_defineProperty(this,"selectedByRowHeader",new Set),selection_defineProperty(this,"selectedByColumnHeader",new Set),selection_classPrivateFieldInitSpec(this,$,!1),selection_classPrivateFieldInitSpec(this,K,!1),selection_classPrivateFieldInitSpec(this,Y,"unknown"),selection_classPrivateFieldInitSpec(this,X,-1),this.settings=r,this.tableProps=n,this.highlight=new Highlight({headerClassName:r.currentHeaderClassName,activeHeaderClassName:r.activeHeaderClassName,rowClassName:r.currentRowClassName,columnClassName:r.currentColClassName,cellAttributes:[(0,S.Ak)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,n)=>this.tableProps.isDisabledCellSelection(r,n),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,n)=>this.tableProps.createCellCoords(r,n),createCellRange:(r,n,o)=>this.tableProps.createCellRange(r,n,o)}),selection_classPrivateFieldSet(j,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return o.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return o.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,n)=>this.tableProps.createCellCoords(r,n),fixedRowsBottom:()=>r.fixedRowsBottom,minSpareRows:()=>r.minSpareRows,minSpareCols:()=>r.minSpareCols,autoWrapRow:()=>r.autoWrapRow,autoWrapCol:()=>r.autoWrapCol})),selection_classPrivateFieldSet(U,this,new Transformation(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{let r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{let r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return o.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return o.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,n)=>this.tableProps.createCellCoords(r,n),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),selection_classPrivateFieldGet(j,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("beforeModifyTransformStart",...n)}),selection_classPrivateFieldGet(j,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("afterModifyTransformStart",...n)}),selection_classPrivateFieldGet(j,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("beforeModifyTransformEnd",...n)}),selection_classPrivateFieldGet(j,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("afterModifyTransformEnd",...n)}),selection_classPrivateFieldGet(j,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("insertRowRequire",...n)}),selection_classPrivateFieldGet(j,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("insertColRequire",...n)}),selection_classPrivateFieldGet(j,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("beforeRowWrap",...n)}),selection_classPrivateFieldGet(j,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("beforeColumnWrap",...n)}),selection_classPrivateFieldGet(U,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("beforeModifyTransformFocus",...n)}),selection_classPrivateFieldGet(U,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return o.runLocalHooks("afterModifyTransformFocus",...n)})}getSelectedRange(){return this.selectedRange}markSource(r){selection_classPrivateFieldSet(Y,this,r)}markEndSource(){selection_classPrivateFieldSet(Y,this,"unknown")}getSelectionSource(){return selection_classPrivateFieldGet(Y,this)}setExpectedLayers(r){selection_classPrivateFieldSet(X,this,r)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,selection_classPrivateFieldSet(X,this,-1)}isInProgress(){return this.inProgress}setRangeStart(r,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,h="multiple"===this.settings.selectionMode,d=(0,R.o8)(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,w=r.clone();selection_classPrivateFieldSet($,this,!1),this.runLocalHooks(`beforeSetRangeStart${o?"Only":""}`,w),(!h||h&&!d&&(0,R.o8)(n))&&this.selectedRange.clear(),this.selectedRange.add(w).current().setHighlight(l.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),o||this.setRangeEnd(r)}setRangeStartOnly(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;this.setRangeStart(r,n,!0,o)}setRangeEnd(r){if(this.selectedRange.isEmpty())return;let n=r.clone(),o=this.tableProps.countRows(),l=this.tableProps.countCols(),h=this.selectedRange.current().clone().setTo(r).isSingleHeader();if((o>0||l>0)&&(0===o&&n.col<0&&!h||0===l&&n.row<0&&!h))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();let d=this.selectedRange.current();if(this.settings.navigableHeaders||d.highlight.normalize(),"single"===this.settings.selectionMode)d.setFrom(d.highlight),d.setTo(d.highlight);else{let r=d.getHorizontalDirection(),o=d.getVerticalDirection(),l=this.isMultiple();d.setTo(n),l&&(r!==d.getHorizontalDirection()||1===d.getWidth()&&!d.includes(d.highlight))&&d.from.assign({col:d.highlight.col}),l&&(o!==d.getVerticalDirection()||1===d.getHeight()&&!d.includes(d.highlight))&&d.from.assign({row:d.highlight.row})}o>0&&l>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!d.isSingleHeader())&&d.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();let w=-1===selection_classPrivateFieldGet(X,this)||this.selectedRange.size()===selection_classPrivateFieldGet(X,this);this.runLocalHooks("afterSetRangeEnd",r,w)}applyAndCommit(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel(),o=this.tableProps.countRows(),h=this.tableProps.countCols();n<this.highlight.layerLevel&&((0,b.Bk)(this.highlight.getAreas(),r=>void r.clear()),(0,b.Bk)(this.highlight.getLayeredAreas(),r=>void r.clear()),(0,b.Bk)(this.highlight.getRowHeaders(),r=>void r.clear()),(0,b.Bk)(this.highlight.getColumnHeaders(),r=>void r.clear()),(0,b.Bk)(this.highlight.getActiveRowHeaders(),r=>void r.clear()),(0,b.Bk)(this.highlight.getActiveColumnHeaders(),r=>void r.clear()),(0,b.Bk)(this.highlight.getActiveCornerHeaders(),r=>void r.clear()),(0,b.Bk)(this.highlight.getRowHighlights(),r=>void r.clear()),(0,b.Bk)(this.highlight.getColumnHighlights(),r=>void r.clear())),this.highlight.useLayerLevel(n);let d=this.highlight.createArea(),w=this.highlight.createLayeredArea(),y=this.highlight.createRowHeader(),S=this.highlight.createColumnHeader(),_=this.highlight.createActiveRowHeader(),R=this.highlight.createActiveColumnHeader(),P=this.highlight.createActiveCornerHeader(),T=this.highlight.createRowHighlight(),I=this.highlight.createColumnHighlight();if(d.clear(),w.clear(),y.clear(),S.clear(),_.clear(),R.clear(),P.clear(),T.clear(),I.clear(),this.highlight.isEnabledFor(l.AI,r.highlight)&&(this.isMultiple()||n>=1)&&(d.add(r.from).add(r.to).commit(),w.add(r.from).add(r.to).commit(),1===n)){let r=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(r.from).commit().syncWith(r),this.highlight.createLayeredArea().add(r.from).commit().syncWith(r),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(l.Nc,r.highlight)){if(!r.isSingleHeader()){let n=this.tableProps.createCellCoords(Math.max(r.from.row,0),-1),o=this.tableProps.createCellCoords(r.to.row,-1),l=this.tableProps.createCellCoords(-1,Math.max(r.from.col,0)),h=this.tableProps.createCellCoords(-1,r.to.col);"single"===this.settings.selectionMode?(y.add(n).commit(),S.add(l).commit(),T.add(n).commit(),I.add(l).commit()):(y.add(n).add(o).commit(),S.add(l).add(h).commit(),T.add(n).add(o).commit(),I.add(l).add(h).commit())}let n=!selection_classPrivateFieldGet(K,this)&&this.isEntireRowSelected()&&(h>0&&h===r.getWidth()||0===h&&this.isSelectedByRowHeader()),l=!selection_classPrivateFieldGet(K,this)&&this.isEntireColumnSelected()&&(o>0&&o===r.getHeight()||0===o&&this.isSelectedByColumnHeader());n&&_.add(this.tableProps.createCellCoords(Math.max(r.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(r.to.row,0),-1)).commit(),l&&R.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(r.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(r.to.col,0))).commit(),n&&l&&P.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(r){if(this.selectedRange.isEmpty())return;let n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",r);let o=this.highlight.getFocus();o.clear(),n.setHighlight(r),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(l.t8,n.highlight)&&o.add(n.highlight).commit().syncWith(n),this.inProgress||(selection_classPrivateFieldSet($,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(r,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?selection_classPrivateFieldGet(j,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):selection_classPrivateFieldGet(j,this).resetOffsetSize(),this.setRangeStart(selection_classPrivateFieldGet(j,this).transformStart(r,n,o))}transformEnd(r,n){this.settings.navigableHeaders?selection_classPrivateFieldGet(j,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):selection_classPrivateFieldGet(j,this).resetOffsetSize(),this.setRangeEnd(selection_classPrivateFieldGet(j,this).transformEnd(r,n))}transformFocus(r,n){let o=this.selectedRange.current(),{row:l,col:h}=o.getOuterTopStartCorner(),d=this.tableProps.countRenderableColumnsInRange(0,h-1),w=this.tableProps.countRenderableRowsInRange(0,l-1);o.highlight.isHeader()?selection_classPrivateFieldGet(U,this).setOffsetSize({x:h<0?Math.abs(h):-d,y:l<0?Math.abs(l):-w}):selection_classPrivateFieldGet(U,this).setOffsetSize({x:h<0?0:-d,y:l<0?0:-w});let y=selection_classPrivateFieldGet(U,this).transformStart(r,n);this.setRangeFocus(y.normalize())}shiftRows(r,n){if(!this.isSelected())return;let o=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||o.getOuterTopStartCorner().row>=r){let{from:l,to:h,highlight:d}=o,w=this.tableProps.countRows(),y=this.isSelectedByRowHeader(),S=this.isSelectedByColumnHeader(),b=S?-1:0,_=S?0:n;this.getSelectedRange().pop();let R=this.tableProps.createCellCoords((0,P.uZ)(l.row+_,b,w-1),l.col),T=this.tableProps.createCellCoords((0,P.uZ)(h.row+n,b,w-1),h.col);this.markSource("shift"),d.row>=r?this.setRangeStartOnly(R,!0,this.tableProps.createCellCoords((0,P.uZ)(d.row+n,0,w-1),d.col)):this.setRangeStartOnly(R,!0),y&&this.selectedByRowHeader.add(this.getLayerLevel()),S&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.markEndSource()}}shiftColumns(r,n){if(!this.isSelected())return;let o=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||o.getOuterTopStartCorner().col>=r){let{from:l,to:h,highlight:d}=o,w=this.tableProps.countCols(),y=this.isSelectedByRowHeader(),S=this.isSelectedByColumnHeader(),b=y?-1:0,_=y?0:n;this.getSelectedRange().pop();let R=this.tableProps.createCellCoords(l.row,(0,P.uZ)(l.col+_,b,w-1)),T=this.tableProps.createCellCoords(h.row,(0,P.uZ)(h.col+n,b,w-1));this.markSource("shift"),d.col>=r?this.setRangeStartOnly(R,!0,this.tableProps.createCellCoords(d.row,(0,P.uZ)(d.col+n,0,w-1))):this.setRangeStartOnly(R,!0),y&&this.selectedByRowHeader.add(this.getLayerLevel()),S&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;let r=(0,h.sm)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&selection_classPrivateFieldGet($,this)}isSelectedByRowHeader(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&(-1===r?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r))}isEntireRowSelected(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),tester=r=>{let{col:n}=r.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(o>0&&n<0||0===o)&&r.getWidth()===l};if(-1===r)return Array.from(this.selectedRange).some(r=>tester(r));let n=this.selectedRange.peekByIndex(r);return!!n&&tester(n)}isSelectedByColumnHeader(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===r?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r))}isEntireColumnSelected(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),tester=r=>{let{row:n}=r.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(o>0&&n<0||0===o)&&r.getHeight()===l};if(-1===r)return Array.from(this.selectedRange).some(r=>tester(r));let n=this.selectedRange.peekByIndex(r);return!!n&&tester(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(r){return this.selectedRange.includes(r)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(r){let n=this.tableProps.visualToRenderableCoords(r);return null!==n.row&&null!==n.col}isAreaCornerVisible(r){return(!Number.isInteger(r)||r===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var r;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},h=this.tableProps.countRows(),d=this.tableProps.countCols(),w=this.tableProps.countRowHeaders(),y=this.tableProps.countColHeaders(),S=o?-y:0,b=n?-w:0;if(0===S&&0===b&&(0===h||0===d))return;let _=null===(r=this.getSelectedRange().current())||void 0===r?void 0:r.highlight,{focusPosition:R,disableHeadersHighlight:T}=l;selection_classPrivateFieldSet(K,this,T),R&&Number.isInteger(null==R?void 0:R.row)&&Number.isInteger(null==R?void 0:R.col)&&(_=this.tableProps.createCellCoords((0,P.uZ)(R.row,S,h-1),(0,P.uZ)(R.col,b,d-1)));let I=this.tableProps.createCellCoords(S,b),O=this.tableProps.createCellCoords(h-1,d-1);this.clear(),this.setRangeStartOnly(I,void 0,_),b<0&&this.selectedByRowHeader.add(this.getLayerLevel()),S<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(O),this.finish(),selection_classPrivateFieldSet(K,this,!1)}selectCells(r){var n=this;let o=(0,N.AV)(r);if(o===N.gk)return!1;if(o===N.Kk)throw Error(L.e`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let l=(0,N.S5)(o,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:r=>this.tableProps.propToCol(r),keepDirection:!0}),h=this.settings.navigableHeaders,d={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:h?this.tableProps.countRowHeaders():0,countColHeaders:h?this.tableProps.countColHeaders():0},w=!r.some(r=>{let n=l(r),o=n.isValid(d);return!(o&&!n.containsHeaders()||o&&n.containsHeaders()&&n.isSingleHeader())});return w&&(this.clear(),this.setExpectedLayers(r.length),(0,b.Bk)(r,r=>{let{from:n,to:o}=l(r);this.setRangeStartOnly(n.clone(),!1),this.setRangeEnd(o.clone())}),this.finish()),w}selectColumns(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l="string"==typeof r?this.tableProps.propToCol(r):r,h="string"==typeof n?this.tableProps.propToCol(n):n,d=this.tableProps.countRows(),w=this.tableProps.countCols(),y=this.tableProps.countColHeaders(),S=0===y?0:-y,b=this.tableProps.createCellCoords(S,l),_=this.tableProps.createCellCoords(d-1,h),R=this.tableProps.createCellRange(b,b,_).isValid({countRows:d,countCols:w,countRowHeaders:0,countColHeaders:y});if(R){let r=0,n=0;Number.isInteger(null==o?void 0:o.row)&&Number.isInteger(null==o?void 0:o.col)?(r=(0,P.uZ)(o.row,S,d-1),n=(0,P.uZ)(o.col,Math.min(l,h),Math.max(l,h))):(r=(0,P.uZ)(o,S,d-1),n=l);let w=this.tableProps.createCellCoords(r,n),b=0===y?0:(0,P.uZ)(w.row,S,-1),_=d-1,R=this.tableProps.createCellCoords(b,l),T=this.tableProps.createCellCoords(_,h);this.runLocalHooks("beforeSelectColumns",R,T,w),R.row=b,T.row=_,this.setRangeStartOnly(R,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",R,T,w),this.finish()}return R}selectRows(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=this.tableProps.countRows(),h=this.tableProps.countCols(),d=this.tableProps.countRowHeaders(),w=0===d?0:-d,y=this.tableProps.createCellCoords(r,w),S=this.tableProps.createCellCoords(n,h-1),b=this.tableProps.createCellRange(y,y,S).isValid({countRows:l,countCols:h,countRowHeaders:d,countColHeaders:0});if(b){let l=0,y=0;Number.isInteger(null==o?void 0:o.row)&&Number.isInteger(null==o?void 0:o.col)?(l=(0,P.uZ)(o.row,Math.min(r,n),Math.max(r,n)),y=(0,P.uZ)(o.col,w,h-1)):(l=r,y=(0,P.uZ)(o,w,h-1));let S=this.tableProps.createCellCoords(l,y),b=0===d?0:(0,P.uZ)(S.col,w,-1),_=h-1,R=this.tableProps.createCellCoords(r,b),T=this.tableProps.createCellCoords(n,_);this.runLocalHooks("beforeSelectRows",R,T,S),R.col=b,T.col=_,this.setRangeStartOnly(R,void 0,S),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",R,T,S),this.finish()}return b}refresh(){if(!this.isSelected())return;let r=this.tableProps.countRows(),n=this.tableProps.countCols();if(0===r||0===n){this.deselect();return}let o=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:l,to:h,highlight:d}=o;this.clear(),d.assign({row:(0,P.uZ)(d.row,-1/0,r-1),col:(0,P.uZ)(d.col,-1/0,n-1)}),l.assign({row:(0,P.uZ)(l.row,-1/0,r-1),col:(0,P.uZ)(l.col,-1/0,n-1)}),h.assign({row:(0,P.uZ)(h.row,0,r-1),col:(0,P.uZ)(h.col,0,n-1)}),this.selectedRange.ranges.push(o),this.highlight.getFocus().add(d).commit().syncWith(o),this.applyAndCommit(o)}commit(){let r=this.highlight.getCustomSelections();if(r.forEach(r=>{r.commit()}),!this.isSelected())return;let n=this.highlight.getFocus(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);let n=this.highlight.createArea(),o=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),S=this.highlight.createRowHighlight(),b=this.highlight.createColumnHighlight();n.commit(),o.commit(),l.commit(),h.commit(),d.commit(),w.commit(),y.commit(),S.commit(),b.commit()}this.highlight.useLayerLevel(o)}};(0,h.jB)(selection_Selection,d.Z);var J=selection_Selection},30855:function(r,n,o){"use strict";o.d(n,{AV:function(){return detectSelectionType},I8:function(){return transformSelectionToRowDistance},Kk:function(){return w},S5:function(){return normalizeSelectionFactory},X8:function(){return transformSelectionToColumnDistance},gk:function(){return y}}),o(57855),o(58563),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var l=o(51648),h=o(99440),d=o(2518);let w=0,y=1,S=[3,2],b=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],_=Symbol("root"),R=Symbol("child");function detectSelectionType(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;if(n!==_&&n!==R)throw Error("The second argument is used internally only and cannot be overwritten.");let o=Array.isArray(r),h=n===_,d=w;if(o){let n=r[0];if(0===r.length)d=y;else if(h&&n instanceof l.Z)d=3;else if(h&&Array.isArray(n))d=detectSelectionType(n,R);else if(r.length>=2&&r.length<=4){let n=!r.some((r,n)=>!b[n].includes(typeof r));n&&(d=2)}}return d}function normalizeSelectionFactory(r){let{createCellCoords:n,createCellRange:o,keepDirection:l=!1,propToCol:h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!S.includes(r))throw Error("Unsupported selection ranges schema type was provided.");return function(w){let y=3===r,S=y?w.from.row:w[0],b=y?w.from.col:w[1],_=y?w.to.row:w[2],R=y?w.to.col:w[3];if("function"==typeof h&&("string"==typeof b&&(b=h(b)),"string"==typeof R&&(R=h(R))),(0,d.o8)(_)&&(_=S),(0,d.o8)(R)&&(R=b),!l){let r=S,n=b,o=_,l=R;S=Math.min(r,o),b=Math.min(n,l),_=Math.max(r,o),R=Math.max(n,l)}let P=n(S,b),T=n(_,R);return o(P,P,T)}}function transformSelectionToColumnDistance(r){let n=detectSelectionType(r.getSelected());if(n===w||n===y)return[];let o=normalizeSelectionFactory(n,{createCellCoords:r._createCellCoords.bind(r),createCellRange:r._createCellRange.bind(r)}),l=new Set;(0,h.Bk)(r.getSelected(),r=>{let{from:n,to:d}=o(r),w=Math.max(n.col,0),y=d.col-w+1;(0,h.Bk)(Array.from(Array(y),(r,n)=>w+n),r=>{l.has(r)||l.add(r)})});let d=Array.from(l).sort((r,n)=>r-n),S=(0,h.k$)(d,(r,n,o,l)=>(0!==o&&n===l[o-1]+1?r[r.length-1][1]+=1:r.push([n,1]),r),[]);return S}function transformSelectionToRowDistance(r){let n=detectSelectionType(r.getSelected());if(n===w||n===y)return[];let o=normalizeSelectionFactory(n,{createCellCoords:r._createCellCoords.bind(r),createCellRange:r._createCellRange.bind(r)}),l=new Set;(0,h.Bk)(r.getSelected(),r=>{let{from:n,to:d}=o(r),w=Math.max(n.row,0),y=d.row-w+1;(0,h.Bk)(Array.from(Array(y),(r,n)=>w+n),r=>{l.has(r)||l.add(r)})});let d=Array.from(l).sort((r,n)=>r-n),S=(0,h.k$)(d,(r,n,o,l)=>(0!==o&&n===l[o-1]+1?r[r.length-1][1]+=1:r.push([n,1]),r),[]);return S}},82659:function(r,n,o){"use strict";o.d(n,{I:function(){return h},W:function(){return l}});let l="gridDefault",h="editorManager.handlingEditor"},28805:function(r,n,o){"use strict";o.d(n,{xg:function(){return registerAllShortcutContexts}});var l=o(82659),h=o(98422),d=o(27687);let w=[{name:"editorCloseAndSave",callback(r){let n=r._getEditorManager();n.closeEditorAndSaveChanges()}},{name:"editorCloseAndSaveByArrowKeys",callback(r,n,o){let l=r._getEditorManager(),d=l.getActiveEditor();d.isInFullEditMode()&&d.state===h.ed.EDITING||(l.closeEditorAndSaveChanges(),r.getSelected()&&(o.includes("arrowdown")?r.selection.transformStart(1,0):o.includes("arrowup")?r.selection.transformStart(-1,0):o.includes("arrowleft")?r.selection.transformStart(0,-1*r.getDirectionFactor()):o.includes("arrowright")&&r.selection.transformStart(0,r.getDirectionFactor())),n.preventDefault())}},{name:"editorCloseAndSaveByEnter",callback(r,n){let o=r._getEditorManager();o.closeEditorAndSaveChanges(n.ctrlKey||n.metaKey),o.moveSelectionAfterEnter(n)}},{name:"editorCloseWithoutSaving",callback(r){let n=r._getEditorManager();n.closeEditorAndRestoreOriginalValue(r.getShortcutManager().isCtrlPressed()),n.activeEditor.focus()}},{name:"editorFastOpen",callback(r,n){let{highlight:o}=r.getSelectedRangeLast();o.isHeader()||r._getEditorManager().openEditor(null,n,!0)}},{name:"editorOpen",callback(r,n,o){let l=r._getEditorManager(),h=r.getSelectedRangeLast(),{highlight:w}=h;if(r.selection.isMultiple()&&!h.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0){let l=r.getSettings(),h="function"==typeof l.enterMoves?l.enterMoves(n):l.enterMoves;o.includes("shift")?r.selection.transformFocus(-h.row,-h.col):r.selection.transformFocus(h.row,h.col);return}w.isHeader()||(r.getSettings().enterBeginsEditing?l.cellProperties.readOnly?l.moveSelectionAfterEnter(n):l.openEditor(null,n,!0):l.moveSelectionAfterEnter(n),(0,d.mM)(n))}},{name:"extendCellsSelectionDown",callback(r){let{highlight:n}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(r){let{to:n}=r.getSelectedRangeLast(),o=Math.min(n.row+r.countVisibleRows(),r.countRows()-1),l=r.rowIndexMapper.getNearestNotHiddenIndex(o,-1);if(null!==l){let o=r._createCellCoords(l,n.col),h=n.row-r.view.getFirstFullyVisibleRow(),d=Math.min(o.row-h,r.countRows()-1);r.selection.setRangeEnd(o),r.scrollViewportTo({row:d,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(r){let{highlight:n}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,-1*r.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(r){let{highlight:n}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,r.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(r){let{highlight:n,from:o,to:l}=r.getSelectedRangeLast();r.selection.isSelectedByRowHeader()?r.selection.selectAll(!0,!0):r.selectColumns(o.col,l.col,n)}},{name:"extendCellsSelectionToMostBottom",callback(r){let{selection:n,rowIndexMapper:o}=r,{highlight:l,from:h,to:d}=r.getSelectedRangeLast(),w=l.isHeader()&&r.selection.isSelectedByRowHeader();if(l.isCell()||w){let y=o.getNearestNotHiddenIndex(r.countRows()-1,-1),S=h.clone();S.row=l.row,n.setRangeStart(S,void 0,!1,l.clone()),w&&n.selectedByRowHeader.add(n.getLayerLevel()),n.setRangeEnd(r._createCellCoords(y,d.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(r){let{selection:n,columnIndexMapper:o}=r,{highlight:l,from:h,to:d}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&l.isCell()){let w=o.getNearestNotHiddenIndex(r.countCols()-1,-1),y=h.clone();y.col=l.col,n.setRangeStart(y,void 0,!1,l.clone()),n.setRangeEnd(r._createCellCoords(d.row,w))}}},{name:"extendCellsSelectionToMostInlineStart",callback(r){let{selection:n,columnIndexMapper:o}=r,{highlight:l,from:h,to:d}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&l.isCell()){let w=parseInt(r.getSettings().fixedColumnsStart,10),y=o.getNearestNotHiddenIndex(w,1),S=h.clone();S.col=l.col,n.setRangeStart(S,void 0,!1,l.clone()),n.setRangeEnd(r._createCellCoords(d.row,y))}}},{name:"extendCellsSelectionToMostLeft",callback(r){let{selection:n,columnIndexMapper:o}=r,{highlight:l,from:h,to:d}=r.getSelectedRangeLast(),w=l.isHeader()&&r.selection.isSelectedByColumnHeader();if(l.isCell()||w){let y=o.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]),S=h.clone();S.col=l.col,n.setRangeStart(S,void 0,!1,l.clone()),w&&n.selectedByColumnHeader.add(n.getLayerLevel()),n.setRangeEnd(r._createCellCoords(d.row,y))}}},{name:"extendCellsSelectionToMostRight",callback(r){let{selection:n,columnIndexMapper:o}=r,{highlight:l,from:h,to:d}=r.getSelectedRangeLast(),w=l.isHeader()&&r.selection.isSelectedByColumnHeader();if(l.isCell()||w){let y=o.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]),S=h.clone();S.col=l.col,n.setRangeStart(S,void 0,!1,l.clone()),w&&n.selectedByColumnHeader.add(n.getLayerLevel()),n.setRangeEnd(r._createCellCoords(d.row,y))}}},{name:"extendCellsSelectionToMostTop",callback(r){let{selection:n,rowIndexMapper:o}=r,{highlight:l,from:h,to:d}=r.getSelectedRangeLast(),w=l.isHeader()&&r.selection.isSelectedByRowHeader();if(l.isCell()||w){let y=o.getNearestNotHiddenIndex(0,1),S=h.clone();S.row=l.row,n.setRangeStart(S,void 0,!1,l.clone()),w&&n.selectedByRowHeader.add(n.getLayerLevel()),n.setRangeEnd(r._createCellCoords(y,d.col))}}},{name:"extendCellsSelectionToRows",callback(r){let{highlight:n,from:o,to:l}=r.getSelectedRangeLast();r.selection.isSelectedByColumnHeader()?r.selection.selectAll(!0,!0):r.selectRows(o.row,l.row,n)}},{name:"extendCellsSelectionUp",callback(r){let{highlight:n}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(r){let{to:n}=r.getSelectedRangeLast(),o=Math.max(n.row-r.countVisibleRows(),0),l=r.rowIndexMapper.getNearestNotHiddenIndex(o,1);if(null!==l){let o=r._createCellCoords(l,n.col),h=n.row-r.view.getFirstFullyVisibleRow(),d=Math.max(o.row-h,0);r.selection.setRangeEnd(o),r.scrollViewportTo({row:d,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(r){let{selection:n}=r;n.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(r){let{navigableHeaders:n}=r.getSettings(),o=n?r.countColHeaders():0,{row:l}=r.getSelectedRangeLast().highlight,h=r.countVisibleRows()+o;l===r.countRows()-1?h=1:l+h>r.countRows()&&(h=r.countRows()-l-1),r.selection.transformStart(h,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(r,n){let o=r.getSettings(),l=r.getSelectedRangeLast(),h="function"==typeof o.tabMoves?o.tabMoves(n):o.tabMoves;r.selection.isMultiple()&&!l.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(-h.row,-h.col):r.selection.transformStart(-h.row,-h.col)}},{name:"moveCellSelectionInlineStart",callback(r,n){let o=r.getSettings(),l=r.getSelectedRangeLast(),h="function"==typeof o.tabMoves?o.tabMoves(n):o.tabMoves;r.selection.isMultiple()&&!l.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(h.row,h.col):r.selection.transformStart(h.row,h.col)}},{name:"moveCellSelectionLeft",callback(r){r.selection.transformStart(0,-1*r.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(r){r.selection.transformStart(0,r.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(r){let{col:n}=r.getSelectedRangeLast().highlight,o=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1);null===o&&(o=-1),r.selection.setRangeStart(r._createCellCoords(o,n))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(r){let{selection:n,rowIndexMapper:o,columnIndexMapper:l}=r,h=parseInt(r.getSettings().fixedRowsBottom,10),d=o.getNearestNotHiddenIndex(r.countRows()-h-1,-1),w=l.getNearestNotHiddenIndex(r.countCols()-1,-1);n.setRangeStart(r._createCellCoords(d,w))}},{name:"moveCellSelectionToMostInlineEnd",callback(r){let{selection:n,columnIndexMapper:o}=r;n.setRangeStart(r._createCellCoords(r.getSelectedRangeLast().highlight.row,o.getNearestNotHiddenIndex(r.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(r){let{selection:n,columnIndexMapper:o}=r,l=parseInt(r.getSettings().fixedColumnsStart,10),h=r.getSelectedRangeLast().highlight.row,d=o.getNearestNotHiddenIndex(l,1);n.setRangeStart(r._createCellCoords(h,d))}},{name:"moveCellSelectionToMostLeft",callback(r){let{selection:n,columnIndexMapper:o}=r,l=r.getSelectedRangeLast().highlight.row,h=o.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);null===h&&(h=r.isRtl()?-1:-r.countRowHeaders()),n.setRangeStart(r._createCellCoords(l,h))}},{name:"moveCellSelectionToMostRight",callback(r){let{selection:n,columnIndexMapper:o}=r,{row:l}=r.getSelectedRangeLast().highlight,h=o.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);null===h&&(h=r.isRtl()?-r.countRowHeaders():-1),n.setRangeStart(r._createCellCoords(l,h))}},{name:"moveCellSelectionToMostTop",callback(r){let{col:n}=r.getSelectedRangeLast().highlight,o=r.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===o&&(o=-r.countColHeaders()),r.selection.setRangeStart(r._createCellCoords(o,n))}},{name:"moveCellSelectionToMostTopInlineStart",callback(r){let{selection:n,rowIndexMapper:o,columnIndexMapper:l}=r,h=parseInt(r.getSettings().fixedRowsTop,10),d=parseInt(r.getSettings().fixedColumnsStart,10),w=o.getNearestNotHiddenIndex(h,1),y=l.getNearestNotHiddenIndex(d,1);n.setRangeStart(r._createCellCoords(w,y))}},{name:"moveCellSelectionUp",callback(r){let{selection:n}=r;n.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(r){let{navigableHeaders:n}=r.getSettings(),o=n?r.countColHeaders():0,{row:l}=r.getSelectedRangeLast().highlight,h=-(r.countVisibleRows()+o);l===-o?h=-1:l+h<o&&(h=-(l+o)),r.selection.transformStart(h,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(r){r.emptySelectedCells(),r._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(r){let{highlight:n}=r.getSelectedRangeLast(),o=r.view.getFirstFullyVisibleRow()-1,l=r.view.getFirstFullyVisibleColumn()-1,h=r.view.getLastFullyVisibleRow()+1,d=r.view.getLastFullyVisibleColumn()+1,w=r._createCellCoords(o,l),y=r._createCellCoords(h,d),S=r._createCellRange(w,w,y);if(!S.includes(n)&&(n.row>=0||n.col>=0)){let o={};if(n.col>=0){let l=Math.floor(r.countVisibleCols()/2);o.col=Math.max(n.col-l,0)}if(n.row>=0){let l=Math.floor(r.countVisibleRows()/2);o.row=Math.max(n.row-l,0)}r.scrollViewportTo({...o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(r){let n=r.getSelectedRange(),{row:o,col:l}=n[n.length-1].highlight.normalize(),h=r.getDataAtCell(o,l),d=new Map;for(let w=0;w<n.length;w++)n[w].forAll((n,w)=>{if(n>=0&&w>=0&&(n!==o||w!==l)){let{readOnly:o}=r.getCellMeta(n,w);o||d.set(`${n}x${w}`,[n,w,h])}});r.setDataAtCell(Array.from(d.values()))}}];function createKeyboardShortcutCommandsPool(r){let n={};return w.forEach(o=>{let{name:l,callback:h}=o;n[l]=function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return h(r,...o)}}),n}function shortcutsEditorContext(r){let n=r.getShortcutManager().addContext("editor"),o=createKeyboardShortcutCommandsPool(r),h={group:l.I};n.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,n)=>o.editorCloseAndSaveByEnter(r,n)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,n)=>o.editorCloseAndSaveByEnter(r,n)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:r.getShortcutManager().getContext("grid"),callback:(r,n)=>o.editorCloseAndSave(r,n)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,n)=>o.editorCloseAndSaveByArrowKeys(r,n)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>o.editorCloseWithoutSaving()}],h)}var y=o(2518);function shortcutsGridContext(r){let n=r.getShortcutManager().addContext("grid"),o=createKeyboardShortcutCommandsPool(r),h={runOnlyIf:()=>{let{navigableHeaders:n}=r.getSettings();return(0,y.$K)(r.getSelected())&&(n||!n&&r.countRenderedRows()>0&&r.countRenderedCols()>0)},group:l.W};n.addShortcuts([{keys:[["F2"]],callback:r=>o.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,n)=>o.editorOpen(r,n)},{keys:[["Backspace"],["Delete"]],callback:()=>o.emptySelectedCells()}],{group:l.I,runOnlyIf:()=>(0,y.$K)(r.getSelected())}),n.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>o.selectAllCells(),runOnlyIf:()=>{var n;return!(null!==(n=r.getSelectedRangeLast())&&void 0!==n&&n.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var n;return null===(n=r.getSelectedRangeLast())||void 0===n?void 0:n.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>o.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>o.populateSelectedCellsData(),runOnlyIf:()=>{var n,o;return!(null!==(n=r.getSelectedRangeLast())&&void 0!==n&&n.highlight.isHeader())&&(null===(o=r.getSelectedRangeLast())||void 0===o?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>o.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>o.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>o.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>o.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>o.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>o.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>o.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>o.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>o.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>o.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>o.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>o.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>o.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>o.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>o.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>o.scrollToFocusedCell()}],h)}function registerAllShortcutContexts(r){[shortcutsGridContext,shortcutsEditorContext].forEach(n=>n(r))}},29949:function(r,n,o){"use strict";o.d(n,{U:function(){return createShortcutManager}}),o(57855);var l=o(2488),h=o(27687);o(58563);let d=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=r=>r.map(r=>{let n=r.toLowerCase();return d.has(n)?d.get(n):n}).sort().join("+"),getKeysList=r=>r.split("+"),w=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=r=>{let{which:n,key:o}=r;if(w.has(n))return w.get(n);let l=String.fromCharCode(n).toLowerCase();return/^[a-z0-9]$/.test(l)?l:o.toLowerCase()};var y=o(2518),S=o(98179),b=o(69488),_=o(32836);let R=Symbol("shortcut-context");function isContextObject(r){return(0,b.Kn)(r)&&r.__kindOf===R}let createContext=r=>{let n=(0,l.I)({errorIdExists:n=>`The "${n}" shortcut is already registered in the "${r}" context.`}),addShortcut=function(){let{keys:r,callback:o,group:l,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:w=!0,stopPropagation:b=!1,relativeToGroup:R,position:P,forwardToContext:T}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,y.o8)(l))throw Error("You need to define the shortcut's group.");if(!1===(0,S.mf)(o))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(r))throw Error(_.e`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let I={callback:o,group:l,runOnlyIf:h,captureCtrl:d,preventDefault:w,stopPropagation:b};(0,y.$K)(R)&&(I.relativeToGroup=R,I.position=P),isContextObject(T)&&(I.forwardToContext=T),r.forEach(r=>{let o=normalizeKeys(r),l=n.hasItem(o);if(l){let r=n.getItem(o),l=r.findIndex(r=>r.group===R);-1!==l?"before"===P?l-=1:l+=1:l=r.length,r.splice(l,0,I)}else n.addItem(o,[I])})},removeShortcutsByKeys=r=>{let o=normalizeKeys(r);n.removeItem(o)};return{__kindOf:R,addShortcut,addShortcuts:function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.forEach(r=>{(0,b._l)(n,(o,l)=>{!1===Object.prototype.hasOwnProperty.call(r,l)&&(r[l]=n[l])}),addShortcut(r)})},getShortcuts:r=>{let o=normalizeKeys(r),l=n.getItem(o);return(0,y.$K)(l)?l.slice():[]},hasShortcut:r=>{let o=normalizeKeys(r);return n.hasItem(o)},removeShortcutsByKeys,removeShortcutsByGroup:r=>{let o=n.getItems();o.forEach(n=>{let[o,l]=n,h=l.filter(n=>n.group!==r);0===h.length?removeShortcutsByKeys(getKeysList(o)):(l.length=0,l.push(...h))})}}};o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var P=o(5566),T=o(2228);let I=["meta","alt","shift","control"],O=function(){let r=new Set;return{press(n){r.add(n)},release(n){r.delete(n)},releaseAll(){r.clear()},isPressed:n=>r.has(n)}}(),k=[],N=0,createShortcutManager=r=>{let{ownerWindow:n,handleEvent:o,beforeKeyDown:d,afterKeyDown:w}=r,y=(0,l.I)({errorIdExists:r=>`The "${r}" context name is already registered.`}),S="grid",getActiveContextName=()=>S,getContext=r=>y.getItem(r),b=!1,recorderCallback=function(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:getActiveContextName(),l=isContextObject(o)?o:getContext(o),d=!1;if(!l.hasShortcut(n))return d;let w=l.getShortcuts(n);for(let o=0;o<w.length;o++){let{callback:l,runOnlyIf:y,preventDefault:S,stopPropagation:_,captureCtrl:R,forwardToContext:P}=w[o];if(!0===y(r)){if(b=R,d=!1===l(r,n),b=!1,S&&r.preventDefault(),_&&((0,h.mM)(r),r.stopPropagation()),d)break;P&&recorderCallback(r,n,P)}}return d},R=function(r,n,o,l,d){let isModifierKey=r=>I.includes(r),getPressedModifierKeys=function(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[];return r.altKey&&o.push("alt"),n&&(r.ctrlKey||r.metaKey)?o.push("control/meta"):(r.ctrlKey&&o.push("control"),r.metaKey&&o.push("meta")),r.shiftKey&&o.push("shift"),o},onkeydown=r=>{if(!1===n(r))return;let w=o(r);if(229===r.keyCode||!1===w||(0,h.Ty)(r))return;let y=normalizeEventKey(r),S=[];isModifierKey(y)||(S=getPressedModifierKeys(r));let b=[y].concat(S),_=d(r,b);!_&&((0,T.eE)()&&S.includes("meta")||!(0,T.eE)()&&S.includes("control"))&&d(r,[y].concat(getPressedModifierKeys(r,!0))),l(r)},onkeydownForModKeys=r=>{if(r.key){let n=normalizeEventKey(r);isModifierKey(n)&&O.press(n)}},onkeyupForModKeys=r=>{if(r.key){let n=normalizeEventKey(r);isModifierKey(n)&&O.release(n)}},onblur=()=>{O.releaseAll()};return{mount:()=>{let n=r;for(N+=1;n;)1===N&&(n.document.documentElement.addEventListener("keydown",onkeydownForModKeys),k.push({event:"keydown",listener:onkeydownForModKeys}),n.document.documentElement.addEventListener("keyup",onkeyupForModKeys),k.push({event:"keyup",listener:onkeyupForModKeys})),n.document.documentElement.addEventListener("keydown",onkeydown),n.document.documentElement.addEventListener("blur",onblur),n=(0,P.f5)(n)},unmount:()=>{let n=r;for(N-=1;n;){if(0===N){for(let r=0;r<k.length;r++){let{event:o,listener:l}=k[r];n.document.documentElement.removeEventListener(o,l)}k.length=0}n.document.documentElement.removeEventListener("keydown",onkeydown),n.document.documentElement.removeEventListener("blur",onblur),n=(0,P.f5)(n)}},isPressed:r=>O.isPressed(r),releasePressedKeys:()=>O.releaseAll()}}(n,o,d,w,recorderCallback);return R.mount(),{addContext:r=>{let n=createContext(r);return y.addItem(r,n),n},getActiveContextName,getContext,setActiveContextName:r=>{if(!y.hasItem(r))throw Error(_.e`You've tried to activate the "${r}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);S=r},isCtrlPressed:()=>!b&&(R.isPressed("control")||R.isPressed("meta")),releasePressedKeys:()=>R.releasePressedKeys(),destroy:()=>R.unmount()}}},70998:function(r,n,o){"use strict";o.d(n,{Z:function(){return e5}}),o(57855),o(58563);var l=o(5566),h=o(49773),d=o(27687),w=o(98179),y=o(60973),S=o(2228),b=o(2518);function _classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function _classPrivateFieldGet(r,n){return r.get(_assertClassBrand(r,n))}function _classPrivateFieldSet(r,n,o){return r.set(_assertClassBrand(r,n),o),o}function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var _=new WeakMap,R=new WeakMap,P=new WeakMap,T=new WeakMap,I=new WeakMap,O=new WeakMap,k=new WeakMap,N=new WeakMap,L=new WeakMap,j=new WeakMap,U=class{constructor(r,n,o,l,h,d){let w=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;_classPrivateFieldInitSpec(this,_,void 0),_classPrivateFieldInitSpec(this,R,void 0),_classPrivateFieldInitSpec(this,P,void 0),_classPrivateFieldInitSpec(this,T,void 0),_classPrivateFieldInitSpec(this,I,void 0),_classPrivateFieldInitSpec(this,O,void 0),_classPrivateFieldInitSpec(this,k,void 0),_classPrivateFieldInitSpec(this,N,void 0),_classPrivateFieldInitSpec(this,L,[null,null]),_classPrivateFieldInitSpec(this,j,[null,null]),_classPrivateFieldSet(_,this,o),_classPrivateFieldSet(R,this,n),_classPrivateFieldSet(P,this,h),_classPrivateFieldSet(T,this,d),_classPrivateFieldSet(I,this,w),_classPrivateFieldSet(O,this,l),_classPrivateFieldSet(k,this,r),this.registerEvents()}registerEvents(){_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).holder,"contextmenu",r=>this.onContextMenu(r)),_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).TABLE,"mouseover",r=>this.onMouseOver(r)),_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).TABLE,"mouseout",r=>this.onMouseOut(r));let initTouchEvents=()=>{_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).holder,"touchstart",r=>this.onTouchStart(r)),_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||_classPrivateFieldGet(_,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,_classPrivateFieldGet(_,this).getSetting("onAfterMomentumScroll"))},200)})};(0,S.K1)()?initTouchEvents():((0,y.JS)()&&initTouchEvents(),(()=>{_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).holder,"mouseup",r=>this.onMouseUp(r)),_classPrivateFieldGet(O,this).addEventListener(_classPrivateFieldGet(P,this).holder,"mousedown",r=>this.onMouseDown(r))})())}selectedCellWasTouched(r){let n=this.parentCell(r),o=n.coords;if(_classPrivateFieldGet(N,this)&&o){let[r,n]=[o.row,_classPrivateFieldGet(N,this).from.row],[l,h]=[o.col,_classPrivateFieldGet(N,this).from.col];return r===n&&l===h}return!1}parentCell(r){let n={},o=_classPrivateFieldGet(P,this).TABLE,h=(0,l.W6)(r,["TD","TH"],o);return h?(n.coords=_classPrivateFieldGet(P,this).getCoords(h),n.TD=h):(0,l.pv)(r,"wtBorder")&&(0,l.pv)(r,"current")?(n.coords=_classPrivateFieldGet(T,this).getFocusSelection().cellRange.highlight,n.TD=_classPrivateFieldGet(P,this).getCell(n.coords)):(0,l.pv)(r,"wtBorder")&&(0,l.pv)(r,"area")&&_classPrivateFieldGet(T,this).getAreaSelection().cellRange&&(n.coords=_classPrivateFieldGet(T,this).getAreaSelection().cellRange.to,n.TD=_classPrivateFieldGet(P,this).getCell(n.coords)),n}onMouseDown(r){let n=_classPrivateFieldGet(R,this).rootDocument.activeElement,o=(0,w.r$)(l.G_,r.target),h=r.target;if(!["TD","TH"].includes(n.nodeName)&&(h===n||o(0)===n||o(1)===n))return;let d=this.parentCell(h);(0,l.pv)(h,"corner")?_classPrivateFieldGet(_,this).getSetting("onCellCornerMouseDown",r,h):d.TD&&_classPrivateFieldGet(_,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,d.coords,d.TD),(0===r.button||this.touchApplied)&&d.TD&&(_classPrivateFieldGet(j,this)[0]=d.TD,clearTimeout(_classPrivateFieldGet(L,this)[0]),_classPrivateFieldGet(L,this)[0]=setTimeout(()=>{_classPrivateFieldGet(j,this)[0]=null},1e3))}onContextMenu(r){if(_classPrivateFieldGet(_,this).has("onCellContextMenu")){let n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}onMouseOver(r){if(!_classPrivateFieldGet(_,this).has("onCellMouseOver"))return;let n=_classPrivateFieldGet(P,this).TABLE,o=(0,l.W6)(r.target,["TD","TH"],n),h=_classPrivateFieldGet(I,this)||this;o&&o!==h.lastMouseOver&&(0,l.MO)(o,n)&&(h.lastMouseOver=o,this.callListener("onCellMouseOver",r,_classPrivateFieldGet(P,this).getCoords(o),o))}onMouseOut(r){if(!_classPrivateFieldGet(_,this).has("onCellMouseOut"))return;let n=_classPrivateFieldGet(P,this).TABLE,o=(0,l.W6)(r.target,["TD","TH"],n),h=(0,l.W6)(r.relatedTarget,["TD","TH"],n),d=_classPrivateFieldGet(I,this)||this;o&&o!==h&&(0,l.MO)(o,n)&&(this.callListener("onCellMouseOut",r,_classPrivateFieldGet(P,this).getCoords(o),o),null===h&&(d.lastMouseOver=null))}onMouseUp(r){let n=this.parentCell(r.target);n.TD&&_classPrivateFieldGet(_,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,n.coords,n.TD),(0===r.button||this.touchApplied)&&(n.TD===_classPrivateFieldGet(j,this)[0]&&n.TD===_classPrivateFieldGet(j,this)[1]?((0,l.pv)(r.target,"corner")?this.callListener("onCellCornerDblClick",r,n.coords,n.TD):this.callListener("onCellDblClick",r,n.coords,n.TD),_classPrivateFieldGet(j,this)[0]=null,_classPrivateFieldGet(j,this)[1]=null):n.TD===_classPrivateFieldGet(j,this)[0]&&(_classPrivateFieldGet(j,this)[1]=n.TD,clearTimeout(_classPrivateFieldGet(L,this)[1]),_classPrivateFieldGet(L,this)[1]=setTimeout(()=>{_classPrivateFieldGet(j,this)[1]=null},500)))}onTouchStart(r){_classPrivateFieldSet(N,this,_classPrivateFieldGet(T,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(r)}onTouchEnd(r){var n;let o=r.target,l=null===(n=this.parentCell(o))||void 0===n?void 0:n.coords,h=(0,b.$K)(l)&&l.row>=0&&l.col>=0,d=r.cancelable&&h&&_classPrivateFieldGet(_,this).getSetting("isDataViewInstance");d&&((0,S.gn)()&&((0,S.E6)()||(0,S.iF)())&&this.selectedCellWasTouched(o)&&!["A","BUTTON","INPUT"].includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()),this.onMouseUp(r),this.touchApplied=!1}callListener(r,n,o,l){let h=_classPrivateFieldGet(_,this).getSettingPure(r);h&&h(n,o,l,_classPrivateFieldGet(k,this).call(this))}destroy(){clearTimeout(_classPrivateFieldGet(L,this)[0]),clearTimeout(_classPrivateFieldGet(L,this)[1]),_classPrivateFieldGet(O,this).destroy()}},$=o(99440),K=o(66678),Y=o(24748);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var X=class{constructor(r,n,o){_defineProperty(this,"offset",void 0),_defineProperty(this,"total",void 0),_defineProperty(this,"countTH",void 0),this.offset=r,this.total=n,this.countTH=o}offsetted(r){return r+this.offset}unOffsetted(r){return r-this.offset}renderedToSource(r){return this.offsetted(r)}sourceToRendered(r){return this.unOffsetted(r)}offsettedTH(r){return r-this.countTH}unOffsettedTH(r){return r+this.countTH}visibleRowHeadedColumnToSourceColumn(r){return this.renderedToSource(this.offsettedTH(r))}sourceColumnToVisibleRowHeadedColumn(r){return this.unOffsettedTH(this.sourceToRendered(r))}};function row_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var J=class{constructor(r,n,o){row_defineProperty(this,"offset",void 0),row_defineProperty(this,"total",void 0),row_defineProperty(this,"countTH",void 0),this.offset=r,this.total=n,this.countTH=o}offsetted(r){return r+this.offset}unOffsetted(r){return r-this.offset}renderedToSource(r){return this.offsetted(r)}sourceToRendered(r){return this.unOffsetted(r)}offsettedTH(r){return r-this.countTH}unOffsettedTH(r){return r+this.countTH}visibleColHeadedRowToSourceRow(r){return this.renderedToSource(this.offsettedTH(r))}sourceRowToVisibleColHeadedRow(r){return this.unOffsettedTH(this.sourceToRendered(r))}};function viewSize_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let ViewSize=class ViewSize{constructor(){viewSize_defineProperty(this,"currentSize",0),viewSize_defineProperty(this,"nextSize",0),viewSize_defineProperty(this,"currentOffset",0),viewSize_defineProperty(this,"nextOffset",0)}setSize(r){this.currentSize=this.nextSize,this.nextSize=r}setOffset(r){this.currentOffset=this.nextOffset,this.nextOffset=r}};function viewSizeSet_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let ViewSizeSet=class ViewSizeSet{constructor(){viewSizeSet_defineProperty(this,"size",new ViewSize),viewSizeSet_defineProperty(this,"workingSpace",0),viewSizeSet_defineProperty(this,"sharedSize",null)}setSize(r){this.size.setSize(r)}setOffset(r){this.size.setOffset(r)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ViewSize}isPlaceOn(r){return this.workingSpace===r}append(r){this.workingSpace=1,r.workingSpace=2,this.sharedSize=r.getViewSize()}prepend(r){this.workingSpace=2,r.workingSpace=1,this.sharedSize=r.getViewSize()}};function view_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let OrderView=class OrderView{constructor(r,n,o){view_defineProperty(this,"rootNode",void 0),view_defineProperty(this,"nodesPool",void 0),view_defineProperty(this,"sizeSet",new ViewSizeSet),view_defineProperty(this,"childNodeType",void 0),view_defineProperty(this,"visualIndex",0),view_defineProperty(this,"collectedNodes",[]),this.rootNode=r,this.nodesPool=n,this.childNodeType=o.toUpperCase()}setSize(r){return this.sizeSet.setSize(r),this}setOffset(r){return this.sizeSet.setOffset(r),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}getCurrentNode(){let r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}getRenderedChildCount(){let{rootNode:r,sizeSet:n}=this,o=0;if(this.isSharedViewSet()){let l=r.firstElementChild;for(;l;){if(l.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(1))break;l=l.nextElementSibling}}else o=r.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:r,sizeSet:n}=this,o=this.isSharedViewSet(),{nextSize:l}=n.getViewSize(),h=this.getRenderedChildCount();for(;h<l;){let l=this.nodesPool();!o||o&&n.isPlaceOn(2)?r.appendChild(l):r.insertBefore(l,r.firstChild),h+=1}let d=o&&n.isPlaceOn(1);for(;h>l;)r.removeChild(d?r.firstChild:r.lastChild),h-=1}render(){let{rootNode:r,sizeSet:n}=this,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(2)&&(o+=n.sharedSize.nextSize);let l=r.childNodes[o];if(l.tagName!==this.childNodeType){let n=this.nodesPool();r.replaceChild(n,l),l=n}this.collectedNodes.push(l),this.visualIndex+=1}end(){}};let SharedOrderView=class SharedOrderView extends OrderView{prependView(r){return this.sizeSet.prepend(r.sizeSet),r.sizeSet.append(this.sizeSet),this}appendView(r){return this.sizeSet.append(r.sizeSet),r.sizeSet.prepend(this.sizeSet),this}};let NodesPool=class NodesPool{constructor(r){var n,o,l;o=void 0,(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n="nodeType","string"))?l:l+"")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this.nodeType=r.toUpperCase()}setRootDocument(r){this.rootDocument=r}obtain(){return this.rootDocument.createElement(this.nodeType)}};function _base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let BaseRenderer=class BaseRenderer{constructor(r,n){_base_defineProperty(this,"nodesPool",null),_base_defineProperty(this,"nodeType",void 0),_base_defineProperty(this,"rootNode",void 0),_base_defineProperty(this,"table",null),_base_defineProperty(this,"renderedNodes",0),this.nodesPool="string"==typeof r?new NodesPool(r):null,this.nodeType=r,this.rootNode=n}setTable(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}adjust(){}render(){}};var Q=o(18200);function rowHeaders_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let RowHeadersRenderer=class RowHeadersRenderer extends BaseRenderer{constructor(){super("TH"),rowHeaders_defineProperty(this,"orderViews",new WeakMap),rowHeaders_defineProperty(this,"sourceRowIndex",0)}obtainOrderView(r){let n;return this.orderViews.has(r)?n=this.orderViews.get(r):(n=new SharedOrderView(r,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(r,n)),n}render(){let{rowsToRender:r,rowHeaderFunctions:n,rowHeadersCount:o,rows:h,cells:d}=this.table;for(let w=0;w<r;w++){let r=this.table.renderedRowToSource(w),y=h.getRenderedNode(w);this.sourceRowIndex=r;let S=this.obtainOrderView(y),b=d.obtainOrderView(y);S.appendView(b).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<o;h++){S.render();let o=S.getCurrentNode();o.className="",o.removeAttribute("style"),(0,l.d$)(o,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,l.P$)(o,[(0,Q.iL)(),(0,Q.Pp)(),(0,Q.yz)(h+1),(0,Q.Qk)(-1)]),n[h](r,o,h)}S.end()}}};let ColumnHeadersRenderer=class ColumnHeadersRenderer extends BaseRenderer{constructor(r){super(null,r)}adjust(){let{columnHeadersCount:r,rowHeadersCount:n}=this.table,o=this.rootNode.firstChild;if(r){let{columnsToRender:l}=this.table,h=l+n;for(let n=0;n<r;n++){for((o=this.rootNode.childNodes[n])||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<h;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>h;)o.removeChild(o.lastChild),this.renderedNodes-=1}let d=this.rootNode.childNodes.length;if(d>r)for(let n=r;n<d;n++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&(0,l.cS)(o)}render(){let{columnHeadersCount:r}=this.table;this.table.isAriaEnabled()&&(0,l.P$)(this.rootNode,[(0,Q.Ct)()]);for(let n=0;n<r;n+=1){let{columnHeaderFunctions:r,columnsToRender:o,rowHeadersCount:h}=this.table,d=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&(0,l.P$)(d,[(0,Q.f3)(),(0,Q.d5)(n+1)]);for(let w=-1*h;w<o;w+=1){let o=this.table.renderedColumnToSource(w),y=d.childNodes[w+h];y.className="",y.removeAttribute("style"),(0,l.d$)(y,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,l.P$)(y,[(0,Q.yz)(w+1+this.table.rowHeadersCount),(0,Q.Qk)(-1),(0,Q.Ng)(),...w>=0?[(0,Q.iJ)()]:[(0,Q.f3)()]]),r[n](o,y,n)}}}};var ee=o(32836);let et=!1;let ColGroupRenderer=class ColGroupRenderer extends BaseRenderer{constructor(r){super(null,r)}adjust(){let{columnsToRender:r,rowHeadersCount:n}=this.table,o=r+n;for(;this.renderedNodes<o;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>o;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:r,rowHeadersCount:n}=this.table;!et&&r>1e3&&(et=!0,(0,Y.ZK)(ee.e`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){let n=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getHeaderWidth(n);this.rootNode.childNodes[r].style.width=`${o}px`}for(let o=0;o<r;o++){let r=this.table.renderedColumnToSource(o),l=this.table.columnUtils.getStretchedColumnWidth(r);this.rootNode.childNodes[o+n].style.width=`${l}px`}let o=this.rootNode.firstChild;o&&(0,l.cn)(o,"rowHeader")}};let ei={rowEven:"ht__row_even",rowOdd:"ht__row_odd"},er=!1;let RowsRenderer=class RowsRenderer extends BaseRenderer{constructor(r){var n,o,l;super("TR",r),o=void 0,(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n="orderView","string"))?l:l+"")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this.orderView=new OrderView(r,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(r){return this.orderView.getNode(r)}render(){let{rowsToRender:r}=this.table;!er&&r>1e3&&(er=!0,(0,Y.ZK)(ee.e`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,l.P$)(this.rootNode,[(0,Q.Ct)()]),this.orderView.setSize(r).setOffset(this.table.renderedRowToSource(0)).start();for(let h=0;h<r;h++){this.orderView.render();let r=this.orderView.getCurrentNode(),d=this.table.renderedRowToSource(h);if(this.table.isAriaEnabled()){var n,o;(0,l.P$)(r,[(0,Q.f3)(),(0,Q.d5)(d+(null!==(n=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.columnHeaders.length)&&void 0!==n?n:0)+1)])}(0,l.IV)(r,[ei.rowEven,ei.rowOdd]),(d+1)%2==0?(0,l.cn)(r,ei.rowEven):(0,l.cn)(r,ei.rowOdd)}this.orderView.end()}};function cells_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let CellsRenderer=class CellsRenderer extends BaseRenderer{constructor(){super("TD"),cells_defineProperty(this,"orderViews",new WeakMap),cells_defineProperty(this,"sourceRowIndex",0)}obtainOrderView(r){let n;return this.orderViews.has(r)?n=this.orderViews.get(r):(n=new SharedOrderView(r,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(r,n)),n}render(){let{rowsToRender:r,columnsToRender:n,rows:o,rowHeaders:h}=this.table;for(let y=0;y<r;y++){let r=this.table.renderedRowToSource(y),S=o.getRenderedNode(y);this.sourceRowIndex=r;let b=this.obtainOrderView(S),_=h.obtainOrderView(S);b.prependView(_).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<n;o++){b.render();let n=b.getCurrentNode(),h=this.table.renderedColumnToSource(o);if((0,l.pv)(n,"hide")||(n.className=""),n.removeAttribute("style"),n.removeAttribute("dir"),(0,l.d$)(n,[RegExp("aria-(.*)"),/role/]),this.table.cellRenderer(r,h,n),this.table.isAriaEnabled()){var d,w;(0,l.P$)(n,[...n.hasAttribute("role")?[]:[(0,Q.Qz)()],(0,Q.Qk)(-1),(0,Q.yz)(h+(null!==(d=null===(w=this.table.rowUtils)||void 0===w||null===(w=w.dataAccessObject)||void 0===w?void 0:w.rowHeaders.length)&&void 0!==d?d:0)+1)])}}b.end()}}};function table_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let TableRenderer=class TableRenderer{constructor(r){let{cellRenderer:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};table_defineProperty(this,"rootNode",void 0),table_defineProperty(this,"rootDocument",void 0),table_defineProperty(this,"rowHeaders",null),table_defineProperty(this,"columnHeaders",null),table_defineProperty(this,"colGroup",null),table_defineProperty(this,"rows",null),table_defineProperty(this,"cells",null),table_defineProperty(this,"rowFilter",null),table_defineProperty(this,"columnFilter",null),table_defineProperty(this,"rowUtils",null),table_defineProperty(this,"columnUtils",null),table_defineProperty(this,"rowsToRender",0),table_defineProperty(this,"columnsToRender",0),table_defineProperty(this,"rowHeaderFunctions",[]),table_defineProperty(this,"rowHeadersCount",0),table_defineProperty(this,"columnHeaderFunctions",[]),table_defineProperty(this,"columnHeadersCount",0),table_defineProperty(this,"cellRenderer",void 0),table_defineProperty(this,"activeOverlayName",void 0),this.rootNode=r,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setActiveOverlayName(r){this.activeOverlayName=r}setAxisUtils(r,n){this.rowUtils=r,this.columnUtils=n}setViewportSize(r,n){this.rowsToRender=r,this.columnsToRender=n}setFilters(r,n){this.rowFilter=r,this.columnFilter=n}setHeaderContentRenderers(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:r,columnHeaders:n,colGroup:o,rows:l,cells:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.setTable(this),n.setTable(this),o.setTable(this),l.setTable(this),h.setTable(this),this.rowHeaders=r,this.columnHeaders=n,this.colGroup=o,this.rows=l,this.cells=h}renderedRowToSource(r){return this.rowFilter.renderedToSource(r)}renderedColumnToSource(r){return this.columnFilter.renderedToSource(r)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:r,rows:n}=this;for(let o=0;o<r;o++){let r=n.getRenderedNode(o);if(r.firstChild){let n=this.renderedRowToSource(o),l=this.rowUtils.getHeightByOverlayName(n,this.activeOverlayName);l?r.firstChild.style.height=`${l-1}px`:r.firstChild.style.height=""}}}};let Renderer=class Renderer{constructor(){let{TABLE:r,THEAD:n,COLGROUP:o,TBODY:l,rowUtils:h,columnUtils:d,cellRenderer:w}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new TableRenderer(r,{cellRenderer:w}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(n),colGroup:new ColGroupRenderer(o),rows:new RowsRenderer(l),cells:new CellsRenderer}),this.renderer.setAxisUtils(h,d)}setActiveOverlayName(r){return this.renderer.setActiveOverlayName(r),this}setFilters(r,n){return this.renderer.setFilters(r,n),this}setViewportSize(r,n){return this.renderer.setViewportSize(r,n),this}setHeaderContentRenderers(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}};var en=o(27431);function columnStretching_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function columnStretching_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function columnStretching_classPrivateFieldGet(r,n){return r.get(columnStretching_assertClassBrand(r,n))}function columnStretching_classPrivateFieldSet(r,n,o){return r.set(columnStretching_assertClassBrand(r,n),o),o}function columnStretching_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var es=new WeakMap,eo=new WeakMap,el=new WeakMap,ea=new WeakMap,eh=new WeakMap;let ColumnStretching=class ColumnStretching{constructor(r){let{totalColumns:n,stretchMode:o,stretchingColumnWidthFn:l,columnWidthFn:h}=r;columnStretching_defineProperty(this,"stretchAllRatio",0),columnStretching_defineProperty(this,"stretchLastWidth",0),columnStretching_defineProperty(this,"stretchAllColumnsWidth",[]),columnStretching_classPrivateFieldInitSpec(this,es,0),columnStretching_defineProperty(this,"needVerifyLastColumnWidth",!0),columnStretching_classPrivateFieldInitSpec(this,eo,()=>0),columnStretching_classPrivateFieldInitSpec(this,el,r=>r),columnStretching_classPrivateFieldInitSpec(this,ea,r=>r),columnStretching_classPrivateFieldInitSpec(this,eh,()=>"none"),columnStretching_classPrivateFieldSet(eo,this,n),columnStretching_classPrivateFieldSet(eh,this,o),columnStretching_classPrivateFieldSet(el,this,null!=l?l:columnStretching_classPrivateFieldGet(el,this)),columnStretching_classPrivateFieldSet(ea,this,null!=h?h:columnStretching_classPrivateFieldGet(ea,this))}refreshStretching(r){if("none"===columnStretching_classPrivateFieldGet(eh,this).call(this))return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,columnStretching_classPrivateFieldSet(es,this,r);let n=0;for(let o=0;o<columnStretching_classPrivateFieldGet(eo,this).call(this);o++){let l=this._getColumnWidth(o),h=columnStretching_classPrivateFieldGet(el,this).call(this,void 0,o);"number"==typeof h?r-=h:n+=l}let o=r-n;if("all"===columnStretching_classPrivateFieldGet(eh,this).call(this)&&o>0)this.stretchAllRatio=r/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===columnStretching_classPrivateFieldGet(eh,this).call(this)&&r!==1/0){let r=this._getColumnWidth(columnStretching_classPrivateFieldGet(eo,this).call(this)-1),n=o+r;this.stretchLastWidth=n>=0?n:r}}getStretchedColumnWidth(r,n){let o=null;return"all"===columnStretching_classPrivateFieldGet(eh,this).call(this)&&0!==this.stretchAllRatio?o=this._getStretchedAllColumnWidth(r,n):"last"===columnStretching_classPrivateFieldGet(eh,this).call(this)&&0!==this.stretchLastWidth&&(o=this._getStretchedLastColumnWidth(r)),o}_getStretchedAllColumnWidth(r,n){let o=0;if(!this.stretchAllColumnsWidth[r]){let o=Math.round(n*this.stretchAllRatio),l=columnStretching_classPrivateFieldGet(el,this).call(this,o,r);void 0===l?this.stretchAllColumnsWidth[r]=o:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===columnStretching_classPrivateFieldGet(eo,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let r=0;r<this.stretchAllColumnsWidth.length;r++)o+=this.stretchAllColumnsWidth[r];o!==columnStretching_classPrivateFieldGet(es,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=columnStretching_classPrivateFieldGet(es,this)-o)}return this.stretchAllColumnsWidth[r]}_getStretchedLastColumnWidth(r){return r===columnStretching_classPrivateFieldGet(eo,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(r){let n=columnStretching_classPrivateFieldGet(ea,this).call(this,r);return isNaN(n)&&(n=en.$),n}};function column_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let ColumnUtils=class ColumnUtils{constructor(r,n){column_defineProperty(this,"dataAccessObject",void 0),column_defineProperty(this,"wtSettings",void 0),column_defineProperty(this,"headerWidths",new Map),column_defineProperty(this,"stretching",void 0),this.dataAccessObject=r,this.wtSettings=n,this.stretching=new ColumnStretching({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,n)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,n),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(r){let n=this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth");return n}getStretchedColumnWidth(r){let n=this.getWidth(r),o=this.stretching.getStretchedColumnWidth(r,n);return o&&(n=o),n}getHeaderHeight(r){let n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return void 0!==o&&(n=n?Math.max(n,o):o),n}getHeaderWidth(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}refreshStretching(){let{wtTable:r,wtViewport:n,cloneSource:o}=this.dataAccessObject,h=o?o.wtTable.holder:r.holder,d=h.offsetHeight<h.scrollHeight?(0,l.np)():0;this.stretching.refreshStretching(n.getViewportWidth()-d)}calculateWidths(){let{wtSettings:r}=this,n=r.getSetting("rowHeaderWidth");if(this.refreshStretching(),null!=(n=r.getSetting("onModifyRowHeaderWidth",n))){let o=r.getSetting("rowHeaders").length,l=r.getSetting("defaultColumnWidth");for(let r=0;r<o;r++){let o=Array.isArray(n)?n[r]:n;o=null==o?l:o,this.headerWidths.set(r,o)}}}};function utils_row_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let RowUtils=class RowUtils{constructor(r,n){utils_row_defineProperty(this,"dataAccessObject",void 0),utils_row_defineProperty(this,"wtSettings",void 0),this.dataAccessObject=r,this.wtSettings=n}getHeight(r){let n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return void 0!==o&&(n=void 0===n?o:Math.max(n,o)),n}getHeightByOverlayName(r,n){let o=this.wtSettings.getSetting("rowHeightByOverlayName",r,n),l=this.dataAccessObject.wtViewport.oversizedRows[r];return void 0!==l&&(o=void 0===o?l:Math.max(o,l)),o}};let ed="bottom",ec="inline_start",eu="top_inline_start_corner",eg="bottom_inline_start_corner",ef=["top",ed,ec,eu,eg],em=new Map([["top","ht_clone_top"],[ed,`ht_clone_${ed}`],[ec,`ht_clone_${ec} ht_clone_left`],[eu,`ht_clone_${eu} ht_clone_top_left_corner`],[eg,`ht_clone_${eg} ht_clone_bottom_left_corner`]]);function src_table_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}var ep=class{constructor(r,n,o,h,d){src_table_defineProperty(this,"wtSettings",null),src_table_defineProperty(this,"domBindings",void 0),src_table_defineProperty(this,"TBODY",null),src_table_defineProperty(this,"THEAD",null),src_table_defineProperty(this,"COLGROUP",null),src_table_defineProperty(this,"hasTableHeight",!0),src_table_defineProperty(this,"hasTableWidth",!0),src_table_defineProperty(this,"isTableVisible",!1),src_table_defineProperty(this,"tableOffset",0),src_table_defineProperty(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===d,this.name=d,this.dataAccessObject=r,this.facadeGetter=n,this.wtSettings=h,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,(0,l.Wu)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let w=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(w)),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(r){return this.name===r}fixTableDomTree(){let r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(r){let n;let o=r.parentNode;return o&&o.nodeType===Node.ELEMENT_NODE&&(0,l.pv)(o,"wtHolder")||((n=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",o&&o.insertBefore(n,r),n.appendChild(r)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,l.P$)(n,[(0,Q.Rn)()]),n}createHider(r){let n;let o=r.parentNode;return o&&o.nodeType===Node.ELEMENT_NODE&&(0,l.pv)(o,"wtHolder")||((n=this.domBindings.rootDocument.createElement("div")).className="wtHider",o&&o.insertBefore(n,r),n.appendChild(r)),this.wtSettings.getSetting("ariaTags")&&(0,l.P$)(n,[(0,Q.Rn)()]),n}createHolder(r){let n;let o=r.parentNode;return o&&o.nodeType===Node.ELEMENT_NODE&&(0,l.pv)(o,"wtHolder")||((n=this.domBindings.rootDocument.createElement("div")).style.position="relative",n.className="wtHolder",o&&o.insertBefore(n,r),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,l.P$)(n.parentNode,[(0,Q.Rn)()])),n.appendChild(r)),this.wtSettings.getSetting("ariaTags")&&(0,l.P$)(n,[(0,Q.Rn)()]),n}draw(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:n}=this,{wtOverlays:o,wtViewport:h}=this.dataAccessObject,d=n.getSetting("totalRows"),w=n.getSetting("totalColumns"),y=n.getSetting("rowHeaders"),S=y.length,b=n.getSetting("columnHeaders"),_=b.length,R=r;if(this.isMaster&&(o.beforeDraw(),this.holderOffset=(0,l.cv)(this.holder),R=h.createCalculators(R),S&&!n.getSetting("fixedColumnsStart"))){let r=o.inlineStartOverlay.getScrollPosition(),n=this.correctHeaderWidth;this.correctHeaderWidth=0!==r,n!==this.correctHeaderWidth&&(R=!1)}if(R)this.isMaster&&o.refresh(!0);else{this.isMaster?this.tableOffset=(0,l.cv)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let r=d>0?this.getFirstRenderedRow():0,n=w>0?this.getFirstRenderedColumn():0;this.rowFilter=new J(r,d,_),this.columnFilter=new X(n,w,S);let R=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let r={};this.wtSettings.getSetting("beforeDraw",!0,r),R=!0!==r.skipRender}if(R){let r;if(this.tableRenderer.setHeaderContentRenderers(y,b),(this.is(ed)||this.is(eg))&&this.tableRenderer.setHeaderContentRenderers(y,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(r=this.dataAccessObject.workspaceWidth,h.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ed))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||h.createVisibleCalculators(),o.refresh(!1),o.applyToDOM();let n=(0,l.iO)(this.hider),d=(0,l.iO)(this.TABLE);0!==n&&d!==n&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),r!==h.getWorkspaceWidth()&&(h.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ed)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let P=!1;return this.isMaster&&(P=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(P=o.bottomOverlay.resetFixedPosition()||P),P=o.inlineStartOverlay.resetFixedPosition()||P,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),P?(o.refreshAll(),o.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(R),this.isMaster&&o.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(r){let n,o,h;let d=this.columnFilter.renderedToSource(r),w=this.wtSettings.getSetting("columnHeaders").length,y=this.wtSettings.getSetting("defaultRowHeight"),S=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;w;)w-=1,n=this.getColumnHeaderHeight(w),(o=this.getColumnHeader(d,w))&&(h=(0,l.WS)(o),(!n&&y<h||n<h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[w]=h),Array.isArray(S)?null!==S[w]&&void 0!==S[w]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[w]=S[w]):isNaN(S)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[w]=S),this.dataAccessObject.wtViewport.oversizedColumnHeaders[w]<(S[w]||S)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[w]=S[w]||S))}adjustColumnHeaderHeights(){let{wtSettings:r}=this,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,l=r.getSetting("columnHeaders");for(let r=0,h=l.length;r<h;r++)if(o[r]){if(!n[r]||0===n[r].childNodes.length)return;n[r].childNodes[0].style.height=`${o[r]}px`}}resetOversizedRows(){let{wtSettings:r}=this,{wtViewport:n}=this.dataAccessObject;if((this.isMaster||this.is(ed))&&!r.getSetting("externalRowCalculator")){let r=this.getRenderedRowsCount();for(let o=0;o<r;o++){let r=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[r]&&(n.oversizedRows[r]=void 0)}}}getCell(r){let n=r.row,o=r.col,l=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(l&&Array.isArray(l)&&([n,o]=l),this.isRowBeforeRenderedRows(n))return -1;if(this.isRowAfterRenderedRows(n))return -2;if(this.isColumnBeforeRenderedColumns(o))return -3;if(this.isColumnAfterRenderedColumns(o))return -4;let h=this.getRow(n);if(!h&&n>=0)throw Error("TR was expected to be rendered but is not");let d=h.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!d&&o>=0)throw Error("TD or TH was expected to be rendered but is not");return d}getRow(r){var n,o;let l=null,h=null;return r<0?(l=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(r),h=this.THEAD):(l=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceToRendered(r),h=this.TBODY),void 0!==l&&void 0!==h&&!(h.childNodes.length<l+1)&&h.childNodes[l]}getColumnHeader(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.THEAD.childNodes[n];return null==o?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}getColumnHeaders(r){let n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(r=>{let l=r.childNodes[o];l&&n.push(l)}),n}getRowHeader(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.wtSettings.getSetting("rowHeaders").length;if(n>=o)return;let l=this.rowFilter.sourceToRendered(r),h=l<0?this.rowFilter.sourceRowToVisibleColHeadedRow(r):l,d=l<0?this.THEAD:this.TBODY,w=d.childNodes[h];return null==w?void 0:w.childNodes[n]}getRowHeaders(r){let n=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let l=0;l<o;l++){let o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],h=null==o?void 0:o.childNodes[l];h&&n.push(h)}return n}getCoords(r){let n=r;if("TD"!==n.nodeName&&"TH"!==n.nodeName&&(n=(0,l.oq)(n,["TD","TH"])),null===n)return null;let o=n.parentNode,h=o.parentNode,d=(0,l.Kz)(o),w=n.cellIndex;if((0,l.mK)(eu,n,this.wtRootElement)||(0,l.mK)("top",n,this.wtRootElement))"THEAD"===h.nodeName&&(d-=h.childNodes.length);else if((0,l.mK)(eg,n,this.wtRootElement)||(0,l.mK)(ed,n,this.wtRootElement)){let r=this.wtSettings.getSetting("totalRows");d=r-h.childNodes.length+d}else d=h===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(d):this.rowFilter.renderedToSource(d);return w=(0,l.mK)(eu,n,this.wtRootElement)||(0,l.mK)(ec,n,this.wtRootElement)||(0,l.mK)(eg,n,this.wtRootElement)?this.columnFilter.offsettedTH(w):this.columnFilter.visibleRowHeadedColumnToSourceColumn(w),this.wot.createCellCoords(d,w)}markOversizedRows(){let r,n,o,h,d;if(this.wtSettings.getSetting("externalRowCalculator"))return;let w=this.TBODY.childNodes.length,y=w*this.wtSettings.getSetting("defaultRowHeight"),S=(0,l.WS)(this.TBODY)-1;if(y!==S||this.wtSettings.getSetting("fixedRowsBottom"))for(;w;)w-=1,o=this.rowFilter.renderedToSource(w),r=this.getRowHeight(o),n=(d=(h=this.getTrForRow(o)).querySelector("th"))?(0,l.WS)(d):(0,l.WS)(h)-1,(!r&&this.wtSettings.getSetting("defaultRowHeight")<n||r<n)&&(n+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=n)}getTrForRow(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}isColumnHeaderRendered(r){if(r>=0)return!1;let n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}isRowHeaderRendered(r){if(r>=0)return!1;let n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}isRowBeforeRenderedRows(r){let n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}isRowAfterRenderedRows(r){return r>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(r){let n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}isColumnAfterRenderedColumns(r){return this.columnFilter&&r>this.getLastRenderedColumn()}isColumnAfterViewport(r){return this.columnFilter&&r>this.getLastVisibleColumn()}isRowAfterViewport(r){return this.rowFilter&&r>this.getLastVisibleRow()}isColumnBeforeViewport(r){return this.columnFilter&&0>this.columnFilter.sourceToRendered(r)&&r>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(r){return this.rowUtils.getHeight(r)}getColumnHeaderHeight(r){return this.columnUtils.getHeaderHeight(r)}getColumnWidth(r){return this.columnUtils.getWidth(r)}getStretchedColumnWidth(r){return this.columnUtils.getStretchedColumnWidth(r)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,l.iO)(this.TABLE)}getHeight(){return(0,l.Pb)(this.TABLE)}getTotalWidth(){let r=(0,l.iO)(this.hider);return 0!==r?r:this.getWidth()}getTotalHeight(){let r=(0,l.Pb)(this.hider);return 0!==r?r:this.getHeight()}isVisible(){return(0,l.pn)(this.TABLE)}_modifyRowHeaderWidth(r){let n=(0,w.mf)(r)?r():null;return Array.isArray(n)?(n=[...n])[n.length-1]=this._correctRowHeaderWidth(n[n.length-1]):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(r){let n=r;return"number"!=typeof r&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}},ev=o(69488);let eC={getFirstRenderedRow(){let r=this.wtSettings.getSetting("totalRows");return 0===r?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,ev.jW)(eC,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});let ew={getFirstRenderedColumn(){let r=this.dataAccessObject.startColumnRendered;return null===r?-1:r},getFirstVisibleColumn(){let r=this.dataAccessObject.startColumnVisible;return null===r?-1:r},getFirstPartiallyVisibleColumn(){let r=this.dataAccessObject.startColumnPartiallyVisible;return null===r?-1:r},getLastRenderedColumn(){let r=this.dataAccessObject.endColumnRendered;return null===r?-1:r},getLastVisibleColumn(){let r=this.dataAccessObject.endColumnVisible;return null===r?-1:r},getLastPartiallyVisibleColumn(){let r=this.dataAccessObject.endColumnPartiallyVisible;return null===r?-1:r},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,ev.jW)(ew,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});let TopOverlayTable=class TopOverlayTable extends ep{constructor(r,n,o,l){super(r,n,o,l,"top")}};(0,ev.jB)(TopOverlayTable,eC),(0,ev.jB)(TopOverlayTable,ew);var ey=o(66411);function scroll_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var eS=new WeakSet;function _getLastColumnIndex(r){let{wtSettings:n,inlineStartOverlay:o,wtTable:h,wtViewport:d,totalColumns:w,rootWindow:y}=this.dataAccessObject;if(o.mainTableScrollableElement===y){let S=n.getSetting("rtlMode"),b=null;if(S){let r=h.TABLE.getBoundingClientRect(),n=this.dataAccessObject.rootWindow.document,o=n.documentElement.offsetWidth;b=Math.abs(r.right-o)}else{let r=(0,l.cv)(h.wtRootElement);b=r.left}let _=Math.abs((0,l.vj)(y,y));if(b>_){let n=(0,l.x9)(y),h=d.getRowHeaderWidth();for(let l=1;l<=w;l++)if(b+(h+=o.sumCellSizes(l-1,l))-_>=n){r=l-2;break}}}return r}function _getLastRowIndex(r){let{topOverlay:n,wtTable:o,wtViewport:h,totalRows:d,rootWindow:w}=this.dataAccessObject;if(n.mainTableScrollableElement===w){let y=(0,l.cv)(o.wtRootElement),S=(0,l.cx)(w,w);if(y.top>S){let o=(0,l.WS)(w),b=h.getColumnHeaderHeight();for(let l=1;l<=d;l++)if(b+=n.sumCellSizes(l-1,l),y.top+b-S>=o){r=l-2;break}}}return r}var eb=class{constructor(r){var n,o,l;(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,eS),eS.add(this),o=void 0,(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n="dataAccessObject","string"))?l:l+"")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this.dataAccessObject=r}scrollViewport(r,n,o,l,h){let d=this.scrollViewportHorizontally(r.col,o,h),w=this.scrollViewportVertically(r.row,n,l);return d||w}scrollViewportHorizontally(r,n,o){let{drawn:l,totalColumns:h}=this.dataAccessObject;if(!l||!Number.isInteger(r)||r<0||r>h)return!1;let d=void 0===n&&void 0===o,{fixedColumnsStart:w,inlineStartOverlay:y}=this.dataAccessObject;if(d&&r<w||!Number.isInteger(r=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",r))||r<0||r>h)return!1;let S=this.getFirstVisibleColumn(),b=this.getLastVisibleColumn(),_=!1;return(d&&(r<S||r>b)||!d)&&(_=y.scrollTo(r,d?r>=this.getLastPartiallyVisibleColumn():n)),_}scrollViewportVertically(r,n,o){let{drawn:l,totalRows:h}=this.dataAccessObject;if(!l||!Number.isInteger(r)||r<0||r>h)return!1;let d=void 0===n&&void 0===o,{fixedRowsBottom:w,fixedRowsTop:y,topOverlay:S}=this.dataAccessObject;if(d&&(r<y||r>h-w-1)||!Number.isInteger(r=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",r))||r<0||r>h)return!1;let b=this.getFirstVisibleRow(),_=this.getLastVisibleRow(),R=!1;return(d&&(r<b||r>_)||!d)&&(R=S.scrollTo(r,d?r>=this.getLastPartiallyVisibleRow():o)),R}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return scroll_assertClassBrand(eS,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return scroll_assertClassBrand(eS,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return scroll_assertClassBrand(eS,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return scroll_assertClassBrand(eS,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}},e_=o(11070),eR=o(51648);function core_base_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let CoreAbstract=class CoreAbstract{get eventManager(){return new h.Z(this)}constructor(r,n){core_base_defineProperty(this,"wtTable",void 0),core_base_defineProperty(this,"wtScroll",void 0),core_base_defineProperty(this,"wtViewport",void 0),core_base_defineProperty(this,"wtOverlays",void 0),core_base_defineProperty(this,"selectionManager",void 0),core_base_defineProperty(this,"wtEvent",void 0),core_base_defineProperty(this,"guid",`wt_${(0,ey.O1)()}`),core_base_defineProperty(this,"drawInterrupted",!1),core_base_defineProperty(this,"drawn",!1),core_base_defineProperty(this,"domBindings",void 0),core_base_defineProperty(this,"wtSettings",void 0),this.domBindings={rootTable:r,rootDocument:r.ownerDocument,rootWindow:r.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new eb(this.createScrollDao())}findOriginalHeaders(){let r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,o){(0,l.tT)(o,r[n])}])}}createCellCoords(r,n){return new e_.Z(r,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(r,n,o){return new eR.Z(r,n,o,this.wtSettings.getSetting("rtlMode"))}draw(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(r):this.drawInterrupted=!0,this}getCell(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n)return this.wtTable.getCell(r);let o=this.wtSettings.getSetting("totalRows"),l=this.wtSettings.getSetting("fixedRowsTop"),h=this.wtSettings.getSetting("fixedRowsBottom"),d=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<l&&r.col<d)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<l)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<d&&r.row>=o-h){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else if(r.col<d)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);else if(r.row<o&&r.row>=o-h&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r);return this.wtTable.getCell(r)}scrollViewport(r,n,o,l,h){return!(r.col<0)&&!(r.row<0)&&this.wtScroll.scrollViewport(r,n,o,l,h)}scrollViewportHorizontally(r,n,o){return!(r<0)&&this.wtScroll.scrollViewportHorizontally(r,n,o)}scrollViewportVertically(r,n,o){return!(r<0)&&this.wtScroll.scrollViewportVertically(r,n,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selectionManager(){return r.selectionManager},get drawn(){return r.drawn},set drawn(v){r.drawn=v},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return r.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return r.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return r.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return r.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return r.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return r.wtSettings.getSetting("rowHeaders")}}}};function clone_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let Clone=class Clone extends CoreAbstract{constructor(r,n,o){super(r,n),clone_defineProperty(this,"cloneSource",void 0),clone_defineProperty(this,"cloneOverlay",void 0);let l=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),l,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selectionManager=o.selectionManager,this.wtEvent=new U(l,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,o.event),this.findOriginalHeaders()}};let Overlay=class Overlay{constructor(r,n,o,h,d){var w,y;(w="symbol"==typeof(y=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(w="wtSettings","string"))?y:y+"")in this?Object.defineProperty(this,w,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[w]=null,(0,ev.jW)(this,"wot",r,{writable:!1}),this.domBindings=d,this.facadeGetter=n,this.wtSettings=h;let{TABLE:S,hider:b,spreader:_,holder:R,wtRootElement:P}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=S,this.hider=b,this.spreader=_,this.holder=R,this.wtRootElement=P,this.trimmingContainer=(0,l.$g)(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(r){"before"===r&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==r||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,l.$g)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:r}=this.wot,{rootWindow:n}=this.domBindings;"hidden"===n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,l.dD)(r.TABLE)}getRelativeCellPosition(r,n,o){if(!1===this.clone.wtTable.holder.contains(r)){(0,Y.ZK)(`The provided element is not a child of the ${this.type} overlay`);return}let l=this.mainTableScrollableElement===this.domBindings.rootWindow,h=o<this.wtSettings.getSetting("fixedColumnsStart"),d=n<this.wtSettings.getSetting("fixedRowsTop"),w=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),y=this.clone.wtTable.spreader,S={start:this.getRelativeStartPosition(y),top:y.offsetTop},b={start:this.getRelativeStartPosition(r),top:r.offsetTop};return l?this.getRelativeCellPositionWithinWindow(d,h,b,S):this.getRelativeCellPositionWithinHolder(d,w,h,b,S)}getRelativeStartPosition(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}getRelativeCellPositionWithinWindow(r,n,o,h){let d=this.wot.wtTable.wtRootElement.getBoundingClientRect(),w=0,y=0;if(n){let r=d.left;this.isRtl()&&(r=this.domBindings.rootWindow.innerWidth-(d.left+d.width+(0,l.np)())),w=r<=0?-1*r:0}else w=h.start;if(r){let r=this.clone.wtTable.TABLE.getBoundingClientRect();y=r.top-d.top}else y=h.top;return{start:o.start+w,top:o.top+y}}getRelativeCellPositionWithinHolder(r,n,o,l,h){let d={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},w=0,y=0;if(o||(w=d.horizontal-h.start),n){let r=this.wot.wtTable.wtRootElement.getBoundingClientRect(),n=this.clone.wtTable.TABLE.getBoundingClientRect();y=-1*n.top+r.top}else r||(y=d.vertical-h.top);return{start:l.start-w,top:l.top-y}}makeClone(){if(-1===ef.indexOf(this.type))throw Error(`Clone type "${this.type}" is not supported.`);let{wtTable:r,wtSettings:n}=this.wot,{rootDocument:o,rootWindow:h}=this.domBindings,d=o.createElement("div"),w=o.createElement("table"),y=r.wtRootElement.parentNode;d.className=`${em.get(this.type)} handsontable`,d.setAttribute("dir",this.isRtl()?"rtl":"ltr"),d.style.position="absolute",d.style.top=0,d.style.overflow="visible",this.isRtl()?d.style.right=0:d.style.left=0,n.getSetting("ariaTags")&&(0,l.P$)(d,[(0,Q.Rn)()]),w.className=r.TABLE.className;let S=r.TABLE.getAttribute("role");S&&w.setAttribute("role",r.TABLE.getAttribute("role")),d.appendChild(w),y.appendChild(d);let b=this.wtSettings.getSetting("preventOverflow");return!0===b||"horizontal"===b&&"top"===this.type||"vertical"===b&&this.type===ec?this.mainTableScrollableElement=h:"hidden"===h.getComputedStyle(y).getPropertyValue("overflow")?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=(0,l.dD)(r.TABLE),new Clone(w,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.needFullRender&&this.clone.draw(r)}reset(){let r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,l=n.style,h=r.parentNode.style;[o,l,h].forEach(r=>{r.width="",r.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}};let eP=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});let TopOverlay=class TopOverlay extends Overlay{constructor(r,n,o,l){var h,d;super(r,n,"top",o,l),(h="symbol"==typeof(d=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(h="cachedFixedRowsTop","string"))?d:d+"")in this?Object.defineProperty(this,h,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[h]=-1,this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return new TopOverlayTable(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let r=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow"),h=0,d=!1;if(this.trimmingContainer!==n||o&&"vertical"===o)h=this.getScrollPosition(),(0,l.WH)(r);else{let{wtTable:n}=this.wot,o=n.hider.getBoundingClientRect(),w=Math.ceil(o.bottom),y=r.offsetHeight;d=w===y,h=this.getOverlayOffset(),(0,l.I2)(r,"0px",`${h}px`)}let w=this.adjustHeaderBordersPosition(h,d);return this.adjustElementsSize(),w}setScrollPosition(r){let n=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===n&&n.scrollY!==r?(n.scrollTo((0,l.DZ)(n),r),o=!0):this.mainTableScrollableElement.scrollTop!==r&&(this.mainTableScrollableElement.scrollTop=r,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(r,n){let o=this.wtSettings.getSetting("defaultRowHeight"),l=r,h=0;for(;l<n;){let r=this.wot.wtTable.getRowHeight(l);h+=void 0===r?o:r,l+=1}return h}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:r}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,h=(0,l.np)(n),d=this.clone.wtTable.holder.parentNode,w=d.style,y=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===y){let n=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(n-=h),n=Math.min(n,r.wtRootElement.scrollWidth),w.width=`${n}px`}else w.width="";this.clone.wtTable.holder.style.width=w.width;let S=(0,l.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(S=0),w.height=`${S}px`}adjustRootChildrenSize(){let{holder:r}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(eP.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,r.style.width=r.parentNode.style.width,r.style.height=`${parseInt(r.parentNode.style.height,10)+n}px`}applyToDOM(){let r=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===r)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let r=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?n.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[r]=""}scrollTo(r,n){let{wot:o,wtSettings:h}=this,d=o.cloneSource?o.cloneSource:o,w=d.wtTable.holder,y=h.getSetting("columnHeaders"),S=h.getSetting("fixedRowsTop"),b=0===S&&y.length>0&&!(0,l.pv)(w.parentNode,"innerBorderTop")?1:0,_=this.getTableParentOffset(),R=0;if(n){let o=this.wot.wtTable.getRowHeight(r),l=this.wot.wtViewport.getViewportHeight();o>l&&(n=!1)}if(n&&w.offsetHeight!==w.clientHeight&&(R=(0,l.np)(this.domBindings.rootDocument)),n){let n=h.getSetting("fixedRowsBottom"),l=h.getSetting("totalRows");_+=this.sumCellSizes(0,r+1),_-=o.wtViewport.getViewportHeight()-this.sumCellSizes(l-n,l),_+=1+b}else _+=this.sumCellSizes(h.getSetting("fixedRowsTop"),r);return _+=R,(0,l.fy)(this.mainTableScrollableElement)===_-b&&b>0&&this.wot.wtOverlays.expandHiderVerticallyBy(b),this.setScrollPosition(_)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,l.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===r&&(!n||"vertical"!==n)){let r=this.wot.wtTable.getTotalHeight(),n=this.clone.wtTable.getTotalHeight();(o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>r-n&&(o=0)}return o}adjustHeaderBordersPosition(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{wtSettings:o}=this,h=this.wot.wtTable.holder.parentNode,d=o.getSetting("totalColumns"),w="horizontal"===o.getSetting("preventOverflow");d?(0,l.IV)(h,"emptyColumns"):(0,l.cn)(h,"emptyColumns");let y=!1;if(!n&&!w){let n=o.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==n,w=o.getSetting("columnHeaders");if((d||0===n)&&w.length>0){let n=(0,l.pv)(h,"innerBorderTop");this.cachedFixedRowsTop=o.getSetting("fixedRowsTop"),r||0===o.getSetting("totalRows")?((0,l.cn)(h,"innerBorderTop"),y=!n):((0,l.IV)(h,"innerBorderTop"),y=n)}}return y}};let eE={getFirstRenderedRow(){let r=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=r-n;return 0===r||0===n?-1:o<0?0:o},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,ev.jW)(eE,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});let BottomOverlayTable=class BottomOverlayTable extends ep{constructor(r,n,o,l){super(r,n,o,l,ed)}};(0,ev.jB)(BottomOverlayTable,eE),(0,ev.jB)(BottomOverlayTable,ew);let BottomOverlay=class BottomOverlay extends Overlay{constructor(r,n,o,l){var h,d;super(r,n,ed,o,l),(h="symbol"==typeof(d=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(h="cachedFixedRowsBottom","string"))?d:d+"")in this?Object.defineProperty(this,h,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[h]=-1,this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return new BottomOverlayTable(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let o=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==r||l&&"vertical"===l?(o=this.getScrollPosition(),this.repositionOverlay()):(o=this.getOverlayOffset(),n.style.bottom=`${o}px`);let h=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),h}repositionOverlay(){let{wtTable:r,wtViewport:n}=this.wot,{rootDocument:o}=this.domBindings,h=this.clone.wtTable.holder.parentNode,d=0;n.hasVerticalScroll()||(d+=n.getWorkspaceHeight()-r.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(d+=(0,l.np)(o)),h.style.bottom=`${d}px`}setScrollPosition(r){let{rootWindow:n}=this.domBindings,o=!1;return this.mainTableScrollableElement===n?(n.scrollTo((0,l.DZ)(n),r),o=!0):this.mainTableScrollableElement.scrollTop!==r&&(this.mainTableScrollableElement.scrollTop=r,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(r,n){let{wtTable:o,wtSettings:l}=this.wot,h=l.getSetting("defaultRowHeight"),d=r,w=0;for(;d<n;){let r=o.getRowHeight(d);w+=void 0===r?h:r,d+=1}return w}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:r,wtViewport:n}=this.wot,{rootDocument:o,rootWindow:h}=this.domBindings,d=(0,l.np)(o),w=this.clone.wtTable.holder.parentNode,y=w.style,S=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==h||"horizontal"===S){let o=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(o-=d),o=Math.min(o,r.wtRootElement.scrollWidth),y.width=`${o}px`}else y.width="";this.clone.wtTable.holder.style.width=y.width;let b=(0,l.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(b=0),y.height=`${b}px`}adjustRootChildrenSize(){let{holder:r}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,r.style.width=r.parentNode.style.width,r.style.height=r.parentNode.style.height}applyToDOM(){let r=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===r)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let r=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?n.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[r]=""}scrollTo(r,n){let o=this.getTableParentOffset(),h=this.wot.cloneSource?this.wot.cloneSource:this.wot,d=h.wtTable.holder,w=0;n&&d.offsetHeight!==d.clientHeight&&(w=(0,l.np)(this.domBindings.rootDocument)),n?(o+=this.sumCellSizes(0,r+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),r),o+=w,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,l.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===r&&(!n||"vertical"!==n)){let r=this.wot.wtTable.getTotalHeight(),n=this.clone.wtTable.getTotalHeight(),l=this.domBindings.rootDocument.documentElement.clientHeight;(o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+r,0))>r-n&&(o=0)}return o}adjustHeaderBordersPosition(r){let n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==n,h=this.wtSettings.getSetting("columnHeaders"),d=!1;if((o||0===n)&&h.length>0){let n=this.wot.wtTable.holder.parentNode,o=(0,l.pv)(n,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),r||0===this.wtSettings.getSetting("totalRows")?((0,l.cn)(n,"innerBorderBottom"),d=!o):((0,l.IV)(n,"innerBorderBottom"),d=o)}return d}};let eT={getFirstRenderedRow(){let r=this.dataAccessObject.startRowRendered;return null===r?-1:r},getFirstVisibleRow(){let r=this.dataAccessObject.startRowVisible;return null===r?-1:r},getFirstPartiallyVisibleRow(){let r=this.dataAccessObject.startRowPartiallyVisible;return null===r?-1:r},getLastRenderedRow(){let r=this.dataAccessObject.endRowRendered;return null===r?-1:r},getLastVisibleRow(){let r=this.dataAccessObject.endRowVisible;return null===r?-1:r},getLastPartiallyVisibleRow(){let r=this.dataAccessObject.endRowPartiallyVisible;return null===r?-1:r},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,ev.jW)(eT,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});let eM={getFirstRenderedColumn(){let r=this.wtSettings.getSetting("totalColumns");return 0===r?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let r=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),r)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,ev.jW)(eM,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});let InlineStartOverlayTable=class InlineStartOverlayTable extends ep{constructor(r,n,o,l){super(r,n,o,l,ec)}};(0,ev.jB)(InlineStartOverlayTable,eT),(0,ev.jB)(InlineStartOverlayTable,eM);let InlineStartOverlay=class InlineStartOverlay extends Overlay{constructor(r,n,o,l){super(r,n,ec,o,l)}createTable(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return new InlineStartOverlayTable(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:r}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!r.holder.parentNode)return!1;let{rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode,h=this.wtSettings.getSetting("preventOverflow"),d=0;this.trimmingContainer!==n||h&&"horizontal"===h?(d=this.getScrollPosition(),(0,l.WH)(o)):(d=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,l.I2)(o,`${d}px`,"0px"));let w=this.adjustHeaderBordersPosition(d);return this.adjustElementsSize(),w}setScrollPosition(r){let{rootWindow:n}=this.domBindings,o=!1;return this.isRtl()&&(r=-r),this.mainTableScrollableElement===n&&n.scrollX!==r?(n.scrollTo(r,(0,l.AQ)(n)),o=!0):this.mainTableScrollableElement.scrollLeft!==r&&(this.mainTableScrollableElement.scrollLeft=r,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(r,n){let o=this.wtSettings.getSetting("defaultColumnWidth"),l=r,h=0;for(;l<n;)h+=this.wot.wtTable.getStretchedColumnWidth(l)||o,l+=1;return h}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:r}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,h=(0,l.np)(n),d=this.clone.wtTable.holder.parentNode,w=d.style,y=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===y){let n=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(n-=h),n=Math.min(n,r.wtRootElement.scrollHeight),w.height=`${n}px`}else w.height="";this.clone.wtTable.holder.style.height=w.height;let S=(0,l.iO)(this.clone.wtTable.TABLE);w.width=`${S}px`}adjustRootChildrenSize(){let{holder:r}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(eP.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,r.style.height=r.parentNode.style.height,r.style.width=`${parseInt(r.parentNode.style.width,10)+n}px`}applyToDOM(){let r=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(0===r)this.spreader.style[n]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(r,n){let{wtSettings:o}=this,h=o.getSetting("rowHeaders"),d=o.getSetting("fixedColumnsStart"),w=this.wot.cloneSource?this.wot.cloneSource:this.wot,y=w.wtTable.holder,S=0===d&&h.length>0&&!(0,l.pv)(y.parentNode,"innerBorderInlineStart")?1:0,b=this.getTableParentOffset(),_=0;if(n){let o=this.wot.wtTable.getColumnWidth(r),l=this.wot.wtViewport.getViewportWidth();o>l&&(n=!1)}return n&&y.offsetWidth!==y.clientWidth&&(_=(0,l.np)(this.domBindings.rootDocument)),n?(b+=this.sumCellSizes(0,r+1),b-=this.wot.wtViewport.getViewportWidth(),b+=S):b+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),r),b+=_,(0,l.Tb)(this.mainTableScrollableElement)===b-S&&S>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(S),this.setScrollPosition(b)}getTableParentOffset(){let r=this.wtSettings.getSetting("preventOverflow"),n=0;return r||this.trimmingContainer!==this.domBindings.rootWindow||(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs((0,l.vj)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===r&&(!n||"horizontal"!==n)){o=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let r=this.wot.wtTable.getTotalWidth(),n=this.clone.wtTable.getTotalWidth();o>r-n&&(o=0)}return o}adjustHeaderBordersPosition(r){let{wtSettings:n}=this,o=this.wot.wtTable.holder.parentNode,h=n.getSetting("rowHeaders"),d=n.getSetting("fixedColumnsStart"),w=n.getSetting("totalRows"),y="vertical"===n.getSetting("preventOverflow");w?(0,l.IV)(o,"emptyRows"):(0,l.cn)(o,"emptyRows");let S=!1;if(!y){if(d&&!h.length)(0,l.cn)(o,"innerBorderLeft innerBorderInlineStart");else if(!d&&h.length){let n=(0,l.pv)(o,"innerBorderInlineStart");r?((0,l.cn)(o,"innerBorderLeft innerBorderInlineStart"),S=!n):((0,l.IV)(o,"innerBorderLeft innerBorderInlineStart"),S=n)}}return S}};let TopInlineStartCornerOverlayTable=class TopInlineStartCornerOverlayTable extends ep{constructor(r,n,o,l){super(r,n,o,l,eu)}};function topInlineStartCorner_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}(0,ev.jB)(TopInlineStartCornerOverlayTable,eC),(0,ev.jB)(TopInlineStartCornerOverlayTable,eM);let TopInlineStartCornerOverlay=class TopInlineStartCornerOverlay extends Overlay{constructor(r,n,o,l,h,d){super(r,n,eu,o,l),topInlineStartCorner_defineProperty(this,"topOverlay",void 0),topInlineStartCorner_defineProperty(this,"inlineStartOverlay",void 0),this.topOverlay=h,this.inlineStartOverlay=d}createTable(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return new TopInlineStartCornerOverlayTable(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let r=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let n=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();(0,l.I2)(r,`${n}px`,`${o}px`)}else(0,l.WH)(r);let n=(0,l.Pb)(this.clone.wtTable.TABLE),o=(0,l.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${o}px`,!1}};let BottomInlineStartCornerOverlayTable=class BottomInlineStartCornerOverlayTable extends ep{constructor(r,n,o,l){super(r,n,o,l,eg)}};(0,ev.jB)(BottomInlineStartCornerOverlayTable,eE),(0,ev.jB)(BottomInlineStartCornerOverlayTable,eM);let BottomInlineStartCornerOverlay=class BottomInlineStartCornerOverlay extends Overlay{constructor(r,n,o,l,h,d){super(r,n,eg,o,l),this.bottomOverlay=h,this.inlineStartOverlay=d}createTable(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return new BottomInlineStartCornerOverlayTable(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:r}=this;if(this.updateTrimmingContainer(),!r.wtTable.holder.parentNode)return!1;let n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let r=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${r}px`,n.style.bottom=`${o}px`}else(0,l.WH)(n),this.repositionOverlay();let o=(0,l.Pb)(this.clone.wtTable.TABLE),h=(0,l.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),n.style.height=`${o}px`,n.style.width=`${h}px`,!1}repositionOverlay(){let{wtTable:r,wtViewport:n}=this.wot,{rootDocument:o}=this.domBindings,h=this.clone.wtTable.holder.parentNode,d=0;n.hasVerticalScroll()||(d+=n.getWorkspaceHeight()-r.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(d+=(0,l.np)(o)),h.style.bottom=`${d}px`}};function overlays_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function overlays_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function overlays_classPrivateFieldSet(r,n,o){return r.set(overlays_assertClassBrand(r,n),o),o}function overlays_classPrivateFieldGet(r,n){return r.get(overlays_assertClassBrand(r,n))}function overlays_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var eI=new WeakMap,eO=new WeakMap,ex=new WeakMap,eA=new WeakMap,eF=class{constructor(r,n,o,h,d,w){overlays_defineProperty(this,"wot",null),overlays_classPrivateFieldInitSpec(this,eI,[]),overlays_defineProperty(this,"topOverlay",null),overlays_defineProperty(this,"bottomOverlay",null),overlays_defineProperty(this,"inlineStartOverlay",null),overlays_defineProperty(this,"topInlineStartCornerOverlay",null),overlays_defineProperty(this,"bottomInlineStartCornerOverlay",null),overlays_defineProperty(this,"browserLineHeight",void 0),overlays_defineProperty(this,"wtSettings",null),overlays_classPrivateFieldInitSpec(this,eO,!1),overlays_classPrivateFieldInitSpec(this,ex,0),overlays_classPrivateFieldInitSpec(this,eA,null),overlays_defineProperty(this,"resizeObserver",new ResizeObserver(r=>{(0,y.U7)(()=>{Array.isArray(r)&&r.length&&(overlays_classPrivateFieldSet(ex,this,overlays_classPrivateFieldGet(ex,this)+1),100===overlays_classPrivateFieldGet(ex,this)&&((0,Y.ZK)("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==overlays_classPrivateFieldGet(eA,this)&&clearTimeout(overlays_classPrivateFieldGet(eA,this)),overlays_classPrivateFieldSet(eA,this,setTimeout(()=>{overlays_classPrivateFieldSet(ex,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=r,this.wtSettings=h,this.domBindings=o,this.facadeGetter=n,this.wtTable=w;let{rootDocument:S,rootWindow:b}=this.domBindings;this.instance=this.wot,this.eventManager=d,this.scrollbarSize=(0,l.np)(S);let _="hidden"===b.getComputedStyle(w.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=_?w.holder:(0,l.dD)(w.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=b.scrollX,this.lastScrollY=b.scrollY}getOverlays(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[...overlays_classPrivateFieldGet(eI,this)];return r&&n.push(this.wtTable),n}initBrowserLineHeight(){let{rootWindow:r,rootDocument:n}=this.domBindings,o=r.getComputedStyle(n.body),l=parseInt(o.lineHeight,10),h=1.2*parseInt(o.fontSize,10);this.browserLineHeight=l||h}initOverlays(){let r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...r),this.bottomOverlay=new BottomOverlay(...r),this.inlineStartOverlay=new InlineStartOverlay(...r),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...r,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...r,this.bottomOverlay,this.inlineStartOverlay),overlays_classPrivateFieldSet(eI,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){overlays_classPrivateFieldSet(eO,this,overlays_classPrivateFieldGet(eI,this).reduce((r,n)=>n.hasRenderingStateChanged()||r,!1)),overlays_classPrivateFieldGet(eI,this).forEach(r=>r.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),overlays_classPrivateFieldGet(eI,this).forEach(r=>{let n=r.hasRenderingStateChanged();r.updateStateOfRendering("after"),n&&!r.needFullRender&&r.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let r;let{rootDocument:n,rootWindow:o}=this.domBindings,{mainTableScrollableElement:l}=this.topOverlay,{mainTableScrollableElement:h}=this.inlineStartOverlay;this.eventManager.addEventListener(n.documentElement,"keydown",r=>this.onKeyDown(r)),this.eventManager.addEventListener(n.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(l,"scroll",r=>this.onTableScroll(r),{passive:!0}),l!==h&&this.eventManager.addEventListener(h,"scroll",r=>this.onTableScroll(r),{passive:!0});let d=o.devicePixelRatio&&o.devicePixelRatio>1,w=this.scrollableElement===o,y=this.wtSettings.getSetting("preventWheel"),b={passive:w};(y||d||!(0,S.i7)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",r=>this.onCloneWheel(r,y),b);let _=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];_.forEach(r=>{if(r&&r.needFullRender){let{holder:n}=r.clone.wtTable;this.eventManager.addEventListener(n,"wheel",r=>this.onCloneWheel(r,y),b)}}),this.eventManager.addEventListener(o,"resize",()=>{clearTimeout(r),r=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),overlays_classPrivateFieldSet(ex,this,0)},200)}),w||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(r){let n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,l=this.topOverlay.mainTableScrollableElement,h=r.target;(!this.keyPressed||(l===n||h===n||r.target.contains(l))&&(o===n||h===n||r.target.contains(o)))&&this.syncScrollPositions(r)}onCloneWheel(r,n){let{rootWindow:o}=this.domBindings,l=this.inlineStartOverlay.mainTableScrollableElement,h=this.topOverlay.mainTableScrollableElement,d=r.target,w=h!==o&&d!==o&&!d.contains(h),y=l!==o&&d!==o&&!d.contains(l);if(this.keyPressed&&(w||y)||this.scrollableElement===o)return;let S=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&S)&&r.preventDefault()}onKeyDown(r){this.keyPressed=(0,K.ot)(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(r){let n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;1===r.deltaMode&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);let l=this.scrollVertically(n),h=this.scrollHorizontally(o);return l||h}scrollVertically(r){let n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}scrollHorizontally(r){let n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:r}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[l,h]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==l||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==h||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=l;let r=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;r&&(r.scrollLeft=l)}this.verticalScrolling&&(o.scrollTop=h),this.refreshAll()}syncScrollWithMaster(){if(!overlays_classPrivateFieldGet(eO,this))return;let r=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:o}=r;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o),overlays_classPrivateFieldSet(eO,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:r}=this,{rootWindow:n}=this.domBindings;"hidden"===n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=r.holder:this.scrollableElement=(0,l.dD)(r.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}updateLastSpreaderSize(){let r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,l=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return l&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),l}adjustElementsSize(){let{wtViewport:r}=this.wot,{wtTable:n}=this,{rootWindow:o}=this.domBindings,l=this.scrollableElement===o,h=this.wtSettings.getSetting("totalColumns"),d=this.wtSettings.getSetting("totalRows"),w=r.getRowHeaderWidth(),y=r.getColumnHeaderHeight(),S=y+this.topOverlay.sumCellSizes(0,d)+1,b=w+this.inlineStartOverlay.sumCellSizes(0,h),_=n.hider,R=_.style,P=!l&&this.scrollableElement.scrollTop>Math.max(0,S-n.holder.clientHeight)?1:0,T=!l&&this.scrollableElement.scrollLeft>Math.max(0,b-n.holder.clientWidth)?1:0;if(R.width=`${b+T}px`,R.height=`${S+P}px`,this.scrollbarSize>0){let{scrollHeight:r,scrollWidth:o}=n.wtRootElement,{scrollHeight:l,scrollWidth:h}=n.holder;this.hasScrollbarRight=r<l,this.hasScrollbarBottom=o<h,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>o?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>r&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(r){let{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+r}px`}expandHiderHorizontallyBy(r){let{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+r}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(r){if(!r)return null;let n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return(0,$.Bk)(n,n=>{n&&n.clone&&n.clone.wtTable.TABLE.contains(r)&&(o=n.clone)}),o}syncOverlayTableClassNames(){let r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,$.Bk)(n,n=>{n&&(n.clone.wtTable.TABLE.className=r.className)})}};function settings_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let Settings=class Settings{constructor(r){settings_defineProperty(this,"settings",{}),settings_defineProperty(this,"defaults",Object.freeze(this.getDefaults())),(0,ev._l)(this.defaults,(n,o)=>{if(void 0!==r[o])this.settings[o]=r[o];else if(void 0===n)throw Error(`A required setting "${o}" was not provided`);else this.settings[o]=n})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(r,n,o)=>{let h=this.getSetting("data",r,n);(0,l.tT)(o,null==h?"":h)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:r=>r,onBeforeViewportScrollVertically:r=>r,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:r=>r,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:r=>r,onBeforeHighlightingColumnHeader:r=>r,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(r,n){return void 0===n?(0,ev._l)(r,(r,n)=>{this.settings[n]=r}):this.settings[r]=n,this}getSetting(r,n,o,l,h){return"function"==typeof this.settings[r]?this.settings[r](n,o,l,h):void 0!==n&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}getSettingPure(r){return this.settings[r]}has(r){return!!this.settings[r]}};let MasterTable=class MasterTable extends ep{constructor(r,n,o,l){super(r,n,o,l,"master")}alignOverlaysWithTrimmingContainer(){let r=(0,l.$g)(this.wtRootElement),{rootWindow:n}=this.domBindings;if(r===n){let r=this.wtSettings.getSetting("preventOverflow");r||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{let o=r.parentElement,h=(0,l.C2)(r,"height",n),d=(0,l.C2)(r,"overflow",n),w=this.holder.style,{scrollWidth:y,scrollHeight:S}=r,b=r.offsetWidth,_=r.offsetHeight;if(o&&["auto","hidden","scroll"].includes(d)){let h=r.cloneNode(!1);h.style.overflow="auto",h.style.position="absolute",r.nextElementSibling?o.insertBefore(h,r.nextElementSibling):o.appendChild(h);let d=parseInt((0,l.Dx)(h,n).height,10);o.removeChild(h),0===d&&(_=0)}_=Math.min(_,S),w.height="auto"===h?"auto":`${_}px`,b=Math.min(b,y),w.width=`${b}px`,w.overflow="",this.hasTableHeight="auto"===w.height||_>0,this.hasTableWidth=b>0}this.isTableVisible=(0,l.pn)(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:r}=this,{wtViewport:n}=this.dataAccessObject,o="master",l=r.getSetting("columnHeaders"),h=l.length;if(h&&!n.hasOversizedColumnHeadersMarked[o]){let l=r.getSetting("rowHeaders"),d=l.length,w=this.getRenderedColumnsCount();for(let r=0;r<h;r++)for(let r=-1*d;r<w;r++)this.markIfOversizedColumnHeader(r);n.hasOversizedColumnHeadersMarked[o]=!0}}};function renderedAllRows_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}(0,ev.jB)(MasterTable,eT),(0,ev.jB)(MasterTable,ew);let RenderedAllRowsCalculationType=class RenderedAllRowsCalculationType{constructor(){renderedAllRows_defineProperty(this,"count",0),renderedAllRows_defineProperty(this,"startRow",0),renderedAllRows_defineProperty(this,"endRow",0),renderedAllRows_defineProperty(this,"startPosition",0),renderedAllRows_defineProperty(this,"isVisibleInTrimmingContainer",!0)}initialize(r){let{totalRows:n}=r;this.count=n,this.endRow=this.count-1}process(){}finalize(){}};function partiallyVisibleRows_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}o(47933),o(4554);let PartiallyVisibleRowsCalculationType=class PartiallyVisibleRowsCalculationType{constructor(){partiallyVisibleRows_defineProperty(this,"count",0),partiallyVisibleRows_defineProperty(this,"startRow",null),partiallyVisibleRows_defineProperty(this,"endRow",null),partiallyVisibleRows_defineProperty(this,"startPosition",null),partiallyVisibleRows_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(r,n){let{totalCalculatedHeight:o,zeroBasedScrollOffset:l,innerViewportHeight:h}=n;o<=l&&(this.startRow=r),o>=l&&o<=h&&null===this.startRow&&(this.startRow=r),this.endRow=r}finalize(r){var n;let{scrollOffset:o,viewportHeight:l,horizontalScrollbarHeight:h,totalRows:d,needReverse:w,startPositions:y,rowHeight:S}=r;if(this.endRow===d-1&&w)for(this.startRow=this.endRow;this.startRow>0;){let r=y[this.endRow]+S-y[this.startRow-1];if(this.startRow-=1,r>=l-h)break}this.startPosition=null!==(n=y[this.startRow])&&void 0!==n?n:null,o+l-h<0||o>y.at(-1)+S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,d<this.endRow&&(this.endRow=d-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}};let RenderedRowsCalculationType=class RenderedRowsCalculationType extends PartiallyVisibleRowsCalculationType{finalize(r){var n;super.finalize(r);let{overrideFn:o,totalRows:l,startPositions:h}=r;null!==this.startRow&&"function"==typeof o&&o(this),this.startRow<0&&(this.startRow=0),this.startPosition=null!==(n=h[this.startRow])&&void 0!==n?n:null,l<this.endRow&&(this.endRow=l-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}};function fullyVisibleRows_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let FullyVisibleRowsCalculationType=class FullyVisibleRowsCalculationType{constructor(){fullyVisibleRows_defineProperty(this,"count",0),fullyVisibleRows_defineProperty(this,"startRow",null),fullyVisibleRows_defineProperty(this,"endRow",null),fullyVisibleRows_defineProperty(this,"startPosition",null),fullyVisibleRows_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(r,n){let{totalCalculatedHeight:o,zeroBasedScrollOffset:l,innerViewportHeight:h,rowHeight:d}=n;o>=l&&o+d<=h&&(null===this.startRow&&(this.startRow=r),this.endRow=r)}finalize(r){var n;let{scrollOffset:o,viewportHeight:l,horizontalScrollbarHeight:h,totalRows:d,needReverse:w,startPositions:y,rowHeight:S}=r;if(this.endRow===d-1&&w)for(this.startRow=this.endRow;this.startRow>0;){let r=y[this.endRow]+S-y[this.startRow-1];if(r<=l-h&&(this.startRow-=1),r>=l-h)break}this.startPosition=null!==(n=y[this.startRow])&&void 0!==n?n:null;let b=null===this.startRow?0:r.getRowHeight(this.startRow);o+l-h<b||o>y.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,d<this.endRow&&(this.endRow=d-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}};function renderedAllColumns_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let RenderedAllColumnsCalculationType=class RenderedAllColumnsCalculationType{constructor(){renderedAllColumns_defineProperty(this,"count",0),renderedAllColumns_defineProperty(this,"startColumn",0),renderedAllColumns_defineProperty(this,"endColumn",0),renderedAllColumns_defineProperty(this,"startPosition",0),renderedAllColumns_defineProperty(this,"isVisibleInTrimmingContainer",!0)}initialize(r){let{totalColumns:n}=r;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}};function partiallyVisibleColumns_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let PartiallyVisibleColumnsCalculationType=class PartiallyVisibleColumnsCalculationType{constructor(){partiallyVisibleColumns_defineProperty(this,"count",0),partiallyVisibleColumns_defineProperty(this,"startColumn",null),partiallyVisibleColumns_defineProperty(this,"endColumn",null),partiallyVisibleColumns_defineProperty(this,"startPosition",null),partiallyVisibleColumns_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(r,n){let{totalCalculatedWidth:o,zeroBasedScrollOffset:l,viewportWidth:h}=n;o<=l&&(this.startColumn=r),o>=l&&o<=l+(l>0?h+1:h)&&(null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=r),this.endColumn=r}finalize(r){var n;let{scrollOffset:o,viewportWidth:l,inlineStartOffset:h,zeroBasedScrollOffset:d,totalColumns:w,needReverse:y,startPositions:S,columnWidth:b}=r;if(this.endColumn===w-1&&y)for(this.startColumn=this.endColumn;this.startColumn>0;){let r=S[this.endColumn]+b-S[this.startColumn-1];if(this.startColumn-=1,r>l)break}this.startPosition=null!==(n=S[this.startColumn])&&void 0!==n?n:null,o+l-(d>0?l+1:l)<-1*h||o>S.at(-1)+b||-1*o-l>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,w<this.endColumn&&(this.endColumn=w-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}};let RenderedColumnsCalculationType=class RenderedColumnsCalculationType extends PartiallyVisibleColumnsCalculationType{finalize(r){var n;super.finalize(r);let{overrideFn:o,totalColumns:l,startPositions:h}=r;null!==this.startColumn&&"function"==typeof o&&o(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(n=h[this.startColumn])&&void 0!==n?n:null,l<this.endColumn&&(this.endColumn=l-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}};function fullyVisibleColumns_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let FullyVisibleColumnsCalculationType=class FullyVisibleColumnsCalculationType{constructor(){fullyVisibleColumns_defineProperty(this,"count",0),fullyVisibleColumns_defineProperty(this,"startColumn",null),fullyVisibleColumns_defineProperty(this,"endColumn",null),fullyVisibleColumns_defineProperty(this,"startPosition",null),fullyVisibleColumns_defineProperty(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(r,n){let{totalCalculatedWidth:o,zeroBasedScrollOffset:l,viewportWidth:h,columnWidth:d}=n;o>=l&&o+d<=l+(l>0?h+1:h)&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=r),this.endColumn=r)}finalize(r){var n;let{scrollOffset:o,viewportWidth:l,inlineStartOffset:h,zeroBasedScrollOffset:d,totalColumns:w,needReverse:y,startPositions:S,columnWidth:b}=r;if(this.endColumn===w-1&&y)for(this.startColumn=this.endColumn;this.startColumn>0;){let r=S[this.endColumn]+b-S[this.startColumn-1];if(r<=l&&(this.startColumn-=1),r>=l)break}this.startPosition=null!==(n=S[this.startColumn])&&void 0!==n?n:null;let _=null===this.startColumn?0:r.getColumnWidth(this.startColumn);o+l-(d>0?l+1:l)<-1*h||o>S.at(-1)||-1*o-l>-1*_?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,w<this.endColumn&&(this.endColumn=w-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}};var ek=o(3391),eH=class{constructor(r,n,o,l,h){this.dataAccessObject=r,this.wot=r.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=o,this.wtTable=h,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=l,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{let r=(0,l.Pb)(n);o=r>0&&n.clientHeight>0?n.clientHeight:1/0}return o}getWorkspaceWidth(){let r,n;let{wtSettings:o}=this,{rootDocument:h,rootWindow:d}=this.domBindings,w=this.dataAccessObject.inlineStartOverlayTrimmingContainer,y=h.documentElement.offsetWidth,S=o.getSetting("totalColumns"),b=o.getSetting("preventOverflow"),_=o.getSetting("rtlMode"),R=this.wtTable.TABLE.getBoundingClientRect(),P=_?R.right-y:R.left,T=y-P;if(b)return(0,l.iO)(this.wtTable.wtRootElement);if(r=o.getSetting("freezeOverlays")?Math.min(T,y):Math.min(this.getContainerFillWidth(),T,y),w===d&&S>0&&this.sumColumnWidths(0,S-1)>r)return h.documentElement.clientWidth;if(w!==d&&("scroll"===(n=(0,l.C2)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",d))||"hidden"===n||"auto"===n))return Math.max(r,w.clientWidth);let I=o.getSetting("stretchH");return"none"!==I&&I?r:Math.max(r,(0,l.iO)(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(r,n){let o=0,l=r;for(;l<n;)o+=this.wtTable.getColumnWidth(l),l+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);let o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}getWorkspaceOffset(){return(0,l.cv)(this.wtTable.TABLE)}getColumnHeaderHeight(){let r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,l.Pb)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let r=this.getWorkspaceHeight();if(r===1/0)return r;let n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}getRowHeaderWidth(){let r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(let o=0,l=n.length;o<l;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth)){if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,h=n.length;o<h;o++)r?(this.rowHeaderWidth+=(0,l.iO)(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let r=this.getWorkspaceWidth();if(r===1/0)return r;let n=this.getRowHeaderWidth();return n>0?r-n:r}createRowsCalculator(){let r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:h,wtTable:d}=this,w=this.getViewportHeight();this.rowHeaderWidth=NaN;let y=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,S=h.getSetting("fixedRowsTop"),b=h.getSetting("fixedRowsBottom"),_=h.getSetting("totalRows");return S&&y>=0&&(y+=n=this.dataAccessObject.topOverlay.sumCellSizes(0,S),w-=n),b&&this.dataAccessObject.bottomOverlay.clone&&(w-=n=this.dataAccessObject.bottomOverlay.sumCellSizes(_-b,_)),r=d.holder.clientHeight===d.holder.offsetHeight?0:(0,l.np)(this.domBindings.rootDocument),new ek.U({calculationTypes:o.map(r=>[r,this.rowsCalculatorTypes.get(r)()]),viewportHeight:w,scrollOffset:y,totalRows:h.getSetting("totalRows"),rowHeightFn:r=>d.getRowHeight(r),overrideFn:h.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:r})}createColumnsCalculator(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:n,wtTable:o}=this,h=this.getViewportWidth(),d=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let w=n.getSetting("fixedColumnsStart");if(w&&d>=0){let r=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,w);d+=r,h-=r}return o.holder.clientWidth!==o.holder.offsetWidth&&(h-=(0,l.np)(this.domBindings.rootDocument)),new en.E({calculationTypes:r.map(r=>[r,this.columnsCalculatorTypes.get(r)()]),viewportWidth:h,scrollOffset:d,totalColumns:n.getSetting("totalColumns"),columnWidthFn:r=>o.getColumnWidth(r),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:n}=this,o=this.createRowsCalculator(),l=this.createColumnsCalculator();if(r&&!n.getSetting("renderAllRows")){let n=o.getResultsFor("fullyVisible");r=this.areAllProposedVisibleRowsAlreadyRendered(n)}if(r&&!n.getSetting("renderAllColumns")){let n=l.getResultsFor("fullyVisible");r=this.areAllProposedVisibleColumnsAlreadyRendered(n)}return r||(this.rowsRenderCalculator=o.getResultsFor("rendered"),this.columnsRenderCalculator=l.getResultsFor("rendered")),this.rowsVisibleCalculator=o.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=l.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=o.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=l.getResultsFor("partiallyVisible"),r}createVisibleCalculators(){let r=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:o}=r;if(null===n&&null===o){if(!r.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,o=this.rowsPartiallyVisibleCalculator.endRow}let{startRow:l,endRow:h}=this.rowsRenderCalculator;return!(n<l)&&(n!==l||!(n>0))&&!(o>h||o===h&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:o}=r;if(null===n&&null===o){if(!r.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,o=this.columnsPartiallyVisibleCalculator.endColumn}let{startColumn:l,endColumn:h}=this.columnsRenderCalculator;return!(n<l)&&(n!==l||!(n>0))&&!(o>h||o===h&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){(0,ev._l)(this.hasOversizedColumnHeadersMarked,(r,n,o)=>{o[n]=void 0})}};function scanner_classPrivateFieldInitSpec(r,n,o){scanner_checkPrivateRedeclaration(r,n),n.set(r,o)}function scanner_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function scanner_classPrivateFieldGet(r,n){return r.get(scanner_assertClassBrand(r,n))}function scanner_classPrivateFieldSet(r,n,o){return r.set(scanner_assertClassBrand(r,n),o),o}function scanner_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}o(21767),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var eN=new WeakMap,eD=new WeakMap,eB=new WeakSet;let SelectionScanner=class SelectionScanner{constructor(){scanner_checkPrivateRedeclaration(this,eB),eB.add(this),scanner_classPrivateFieldInitSpec(this,eN,void 0),scanner_classPrivateFieldInitSpec(this,eD,void 0)}setActiveOverlay(r){return scanner_classPrivateFieldSet(eD,this,r),this}setActiveSelection(r){return scanner_classPrivateFieldSet(eN,this,r),this}scan(){let r=scanner_classPrivateFieldGet(eN,this).settings.selectionType,n=new Set;return"active-header"===r?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):"area"===r?this.scanCellsRange(r=>n.add(r)):"focus"===r?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):"fill"===r?this.scanCellsRange(r=>n.add(r)):"header"===r?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):"row"===r?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):"column"===r&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(r){let[n,o,l,h]=scanner_classPrivateFieldGet(eN,this).getCorners(),{wtTable:d}=scanner_classPrivateFieldGet(eD,this),w=d.getRenderedColumnsCount(),y=d.getColumnHeadersCount(),S=0;for(let b=-d.getRowHeadersCount();b<w;b++){let w=d.columnFilter.renderedToSource(b);if(!(w<o)&&!(w>h)){for(let b=-y;b<0;b++){if(b<n||b>l)continue;let _=b+y,R=d.getColumnHeader(w,_),P=scanner_classPrivateFieldGet(eD,this).getSetting("onBeforeHighlightingColumnHeader",w,_,{selectionType:scanner_classPrivateFieldGet(eN,this).settings.selectionType,columnCursor:S,selectionWidth:h-o+1});null!==P&&(P!==w&&(R=d.getColumnHeader(P,_)),r(R))}S+=1}}}scanRowsInHeadersRange(r){let[n,o,l,h]=scanner_classPrivateFieldGet(eN,this).getCorners(),{wtTable:d}=scanner_classPrivateFieldGet(eD,this),w=d.getRenderedRowsCount(),y=d.getRowHeadersCount(),S=0;for(let b=-d.getColumnHeadersCount();b<w;b++){let w=d.rowFilter.renderedToSource(b);if(!(w<n)&&!(w>l)){for(let b=-y;b<0;b++){if(b<o||b>h)continue;let _=b+y,R=d.getRowHeader(w,_),P=scanner_classPrivateFieldGet(eD,this).getSetting("onBeforeHighlightingRowHeader",w,_,{selectionType:scanner_classPrivateFieldGet(eN,this).settings.selectionType,rowCursor:S,selectionHeight:l-n+1});null!==P&&(P!==w&&(R=d.getRowHeader(P,_)),r(R))}S+=1}}}scanCellsRange(r){let[n,o,h,d]=scanner_classPrivateFieldGet(eN,this).getCorners(),{wtTable:w}=scanner_classPrivateFieldGet(eD,this);scanner_assertClassBrand(eB,this,_scanCellsRange).call(this,(y,S)=>{if(y>=n&&y<=h&&S>=o&&S<=d){let n=w.getCell(scanner_classPrivateFieldGet(eD,this).createCellCoords(y,S)),o=scanner_classPrivateFieldGet(eD,this).getSetting("onAfterDrawSelection",y,S,scanner_classPrivateFieldGet(eN,this).settings.layerLevel);"string"==typeof o&&(0,l.cn)(n,o),r(n)}})}scanRowsInCellsRange(r){let[n,,o]=scanner_classPrivateFieldGet(eN,this).getCorners(),{wtTable:l}=scanner_classPrivateFieldGet(eD,this);scanner_assertClassBrand(eB,this,_scanCellsRange).call(this,(h,d)=>{if(h>=n&&h<=o){let n=l.getCell(scanner_classPrivateFieldGet(eD,this).createCellCoords(h,d));r(n)}})}scanColumnsInCellsRange(r){let[,n,,o]=scanner_classPrivateFieldGet(eN,this).getCorners(),{wtTable:l}=scanner_classPrivateFieldGet(eD,this);scanner_assertClassBrand(eB,this,_scanCellsRange).call(this,(h,d)=>{if(d>=n&&d<=o){let n=l.getCell(scanner_classPrivateFieldGet(eD,this).createCellCoords(h,d));r(n)}})}};function _scanCellsRange(r){let{wtTable:n}=scanner_classPrivateFieldGet(eD,this),o=n.getRenderedRowsCount(),l=n.getRenderedColumnsCount();for(let h=0;h<o;h+=1){let o=n.rowFilter.renderedToSource(h);for(let h=0;h<l;h+=1)r(o,n.columnFilter.renderedToSource(h))}}var eL=class{constructor(r,n){if(!n)return;this.eventManager=r.eventManager,this.instance=r,this.wot=r,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=eP,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners()}registerListeners(){let r=this.wot.rootDocument.body;this.eventManager.addEventListener(r,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(r,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){let n=this.main.childNodes[r];this.eventManager.addEventListener(n,"mouseenter",n=>this.onMouseEnter(n,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),(0,d.mM)(r);let o=this,l=this.wot.rootDocument.body,h=n.getBoundingClientRect();n.style.display="none",this.eventManager.addEventListener(l,"mousemove",function handler(r){(function(r){if(r.clientY<Math.floor(h.top)||r.clientY>Math.ceil(h.top+h.height)||r.clientX<Math.floor(h.left)||r.clientX>Math.ceil(h.left+h.width))return!0})(r)&&(o.eventManager.removeEventListener(l,"mousemove",handler),n.style.display="block")})}createBorders(r){let{rootDocument:n}=this.wot;this.main=n.createElement("div");let o=["top","start","bottom","end","corner"],l=this.main.style;l.position="absolute",l.top=0,l.left=0;for(let h=0;h<5;h++){let d=o[h],w=n.createElement("div");w.className=`wtBorder ${this.settings.className||""}`,this.settings[d]&&this.settings[d].hide&&(w.className+=" hidden"),(l=w.style).backgroundColor=this.settings[d]&&this.settings[d].color?this.settings[d].color:r.border.color,l.height=this.settings[d]&&this.settings[d].width?`${this.settings[d].width}px`:`${r.border.width}px`,l.width=this.settings[d]&&this.settings[d].width?`${this.settings[d].width}px`:`${r.border.width}px`,this.main.appendChild(w)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,S.K1)()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:h}=this.wot,d=h.bordersHolder;d||((d=n.createElement("div")).className="htBorders",h.bordersHolder=d,h.spreader.appendChild(d)),d.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:r}=this.wot;this.selectionHandles={top:r.createElement("DIV"),topHitArea:r.createElement("DIV"),bottom:r.createElement("DIV"),bottomHitArea:r.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let n={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,ev._l)(n,(r,n)=>{this.selectionHandles.styles.bottomHitArea[n]=r,this.selectionHandles.styles.topHitArea[n]=r});let o={position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};(0,ev._l)(o,(r,n)=>{this.selectionHandles.styles.bottom[n]=r,this.selectionHandles.styles.top[n]=r}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(r,n){let o=this.wot.selectionManager.getAreaSelection();return!!o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col)}updateMultipleSelectionHandlesPosition(r,n,o,l,h,d){let w=this.wot.wtSettings.getSetting("rtlMode"),y=w?"right":"left",{top:S,topHitArea:b,bottom:_,bottomHitArea:R}=this.selectionHandles.styles,P=parseInt(S.borderWidth,10),T=parseInt(S.width,10),I=parseInt(b.width,10),O=this.wot.wtTable.getWidth(),k=this.wot.wtTable.getHeight();S.top=`${parseInt(o-T-1,10)}px`,S[y]=`${parseInt(l-T-1,10)}px`,b.top=`${parseInt(o-I/4*3,10)}px`,b[y]=`${parseInt(l-I/4*3,10)}px`;let N=Math.min(parseInt(l+h,10),O-T-2*P),L=Math.min(parseInt(l+h-I/4,10),O-I-2*P);_[y]=`${N}px`,R[y]=`${L}px`;let j=Math.min(parseInt(o+d,10),k-T-2*P),U=Math.min(parseInt(o+d-I/4,10),k-I-2*P);_.top=`${j}px`,R.top=`${U}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(S.display="block",b.display="block",this.isPartRange(r,n)?(_.display="none",R.display="none"):(_.display="block",R.display="block")):(S.display="none",_.display="none",b.display="none",R.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(S.zIndex="9999",b.zIndex="9999"):(S.zIndex="",b.zIndex="")}appear(r){let n,o,h,d,w,y;if(this.disabled)return;let{wtTable:b,rootDocument:_,rootWindow:R}=this.wot,P=b.getRenderedRowsCount();for(let o=0;o<P;o+=1){let l=b.rowFilter.renderedToSource(o);if(l>=r[0]&&l<=r[2]){n=l,w=r[0];break}}for(let n=P-1;n>=0;n-=1){let l=b.rowFilter.renderedToSource(n);if(l>=r[0]&&l<=r[2]){o=l;break}}let T=b.getRenderedColumnsCount();for(let n=0;n<T;n+=1){let o=b.columnFilter.renderedToSource(n);if(o>=r[1]&&o<=r[3]){h=o,y=r[1];break}}for(let n=T-1;n>=0;n-=1){let o=b.columnFilter.renderedToSource(n);if(o>=r[1]&&o<=r[3]){d=o;break}}if(void 0===n||void 0===h){this.disappear();return}let I=b.getCell(this.wot.createCellCoords(n,h)),O=n!==o||h!==d,k=O?b.getCell(this.wot.createCellCoords(o,d)):I,N=(0,l.cv)(I),L=O?(0,l.cv)(k):N,j=(0,l.cv)(b.TABLE),U=(0,l.iO)(b.TABLE),$=N.top,K=N.left,Y=this.wot.wtSettings.getSetting("rtlMode"),X=0,J=0;if(Y){let r=(0,l.iO)(I),n=R.innerWidth-j.left-U;J=K+r-L.left,X=R.innerWidth-K-r-n-1}else J=L.left+(0,l.iO)(k)-K,X=K-j.left-1;if(this.isEntireColumnSelected(n,o)){let r=this.getDimensionsFromHeader("columns",h,d,w,j),n=null;r&&([n,X,J]=r),n&&(I=n)}let Q=$-j.top-1,ee=L.top+(0,l.Pb)(k)-$;if(this.isEntireRowSelected(h,d)){let r=this.getDimensionsFromHeader("rows",n,o,y,j),l=null;r&&([l,Q,ee]=r),l&&(I=l)}let et=(0,l.Dx)(I,R);parseInt(et.borderTopWidth,10)>0&&(Q+=1,ee=ee>0?ee-1:0),parseInt(et[Y?"borderRightWidth":"borderLeftWidth"],10)>0&&(X+=1,J=J>0?J-1:0);let ei=Y?"right":"left";this.topStyle.top=`${Q}px`,this.topStyle[ei]=`${X}px`,this.topStyle.width=`${J}px`,this.topStyle.display="block",this.startStyle.top=`${Q}px`,this.startStyle[ei]=`${X}px`,this.startStyle.height=`${ee}px`,this.startStyle.display="block";let er=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Q+ee-er}px`,this.bottomStyle[ei]=`${X}px`,this.bottomStyle.width=`${J}px`,this.bottomStyle.display="block",this.endStyle.top=`${Q}px`,this.endStyle[ei]=`${X+J-er}px`,this.endStyle.height=`${ee+1}px`,this.endStyle.display="block";let en=this.settings.border.cornerVisible;en="function"==typeof en?en(this.settings.layerLevel):en;let es=this.wot.getSetting("onModifyGetCellCoords",o,d),[eo,el]=[o,d];if(es&&Array.isArray(es)&&([,,eo,el]=es),(0,S.K1)()||!en||this.isPartRange(eo,el))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Q+ee+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ei]=`${X+J+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let r=(0,l.$g)(b.TABLE),n=r===R;n&&(r=_.documentElement);let h=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(d===this.wot.getSetting("totalColumns")-1){let o=n?k.getBoundingClientRect().left:k.offsetLeft;(Y?o-parseInt(this.cornerDefaultStyle.width,10)/2<0:o+(0,l.iO)(k)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,l.x9)(r))&&(this.cornerStyle[ei]=`${Math.floor(X+J+this.cornerCenterPointOffset-h)}px`,this.cornerStyle[Y?"borderLeftWidth":"borderRightWidth"]=0)}if(o===this.wot.getSetting("totalRows")-1){let o=n?k.getBoundingClientRect().top:k.offsetTop,h=o+(0,l.Pb)(k)+parseInt(this.cornerDefaultStyle.height,10)/2,d=h>=(0,l.WS)(r);d&&(this.cornerStyle.top=`${Math.floor(Q+ee+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}(0,S.K1)()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,d,Q,X,J,ee)}isEntireColumnSelected(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(r,n,o,h,d){let{wtTable:w}=this.wot,y=w.wtRootElement.parentNode,S=null,b=null,_=null,R=null,P=null,T=null,I=null,O=null;switch(r){case"rows":S=function(){return w.getRowHeader(...arguments)},b=function(){return(0,l.Pb)(...arguments)},_="ht__selection--rows",T="top";break;case"columns":S=function(){return w.getColumnHeader(...arguments)},b=function(){return(0,l.iO)(...arguments)},_="ht__selection--columns",T="left"}if(y.classList.contains(_)){let r=this.wot.getSetting("columnHeaders").length;if(I=S(n,r-h),O=S(o,r-h),!I||!O)return!1;let w=(0,l.cv)(I),y=(0,l.cv)(O);return I&&O&&(R=w[T]-d[T]-1,P=y[T]+b(O)-w[T]),[I,R,P]}return!1}changeBorderStyle(r,n){let o=this[r].style,h=n[r];!h||h.hide?(0,l.cn)(this[r],"hidden"):((0,l.pv)(this[r],"hidden")&&(0,l.IV)(this[r],"hidden"),o.backgroundColor=h.color,("top"===r||"bottom"===r)&&(o.height=`${h.width}px`),("start"===r||"end"===r)&&(o.width=`${h.width}px`))}changeBorderToDefaultStyle(r){let n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width=`${n.width}px`,o.height=`${n.width}px`}toggleHiddenClass(r,n){this.changeBorderToDefaultStyle(r),n?(0,l.cn)(this[r],"hidden"):(0,l.IV)(this[r],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,S.K1)()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function manager_classPrivateFieldInitSpec(r,n,o){manager_checkPrivateRedeclaration(r,n),n.set(r,o)}function manager_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function manager_classPrivateFieldGet(r,n){return r.get(manager_assertClassBrand(r,n))}function manager_classPrivateFieldSet(r,n,o){return r.set(manager_assertClassBrand(r,n),o),o}function manager_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var eV=new WeakMap,eG=new WeakMap,eW=new WeakMap,ez=new WeakMap,ej=new WeakMap,eU=new WeakMap,e$=new WeakSet;let SelectionManager=class SelectionManager{constructor(r){manager_checkPrivateRedeclaration(this,e$),e$.add(this),manager_classPrivateFieldInitSpec(this,eV,void 0),manager_classPrivateFieldInitSpec(this,eG,void 0),manager_classPrivateFieldInitSpec(this,eW,new SelectionScanner),manager_classPrivateFieldInitSpec(this,ez,new WeakMap),manager_classPrivateFieldInitSpec(this,ej,new WeakSet),manager_classPrivateFieldInitSpec(this,eU,new Map),manager_classPrivateFieldSet(eG,this,r)}setActiveOverlay(r){return manager_classPrivateFieldSet(eV,this,r),manager_classPrivateFieldGet(eW,this).setActiveOverlay(manager_classPrivateFieldGet(eV,this)),manager_classPrivateFieldGet(ez,this).has(manager_classPrivateFieldGet(eV,this))||manager_classPrivateFieldGet(ez,this).set(manager_classPrivateFieldGet(eV,this),new Set),this}getFocusSelection(){return null!==manager_classPrivateFieldGet(eG,this)?manager_classPrivateFieldGet(eG,this).getFocus():null}getAreaSelection(){return null!==manager_classPrivateFieldGet(eG,this)?manager_classPrivateFieldGet(eG,this).createLayeredArea():null}getBorderInstance(r){if(!r.settings.border)return null;if(manager_classPrivateFieldGet(eU,this).has(r)){let n=manager_classPrivateFieldGet(eU,this).get(r);if(n.has(manager_classPrivateFieldGet(eV,this)))return n.get(manager_classPrivateFieldGet(eV,this));let o=new eL(manager_classPrivateFieldGet(eV,this),r.settings);return n.set(manager_classPrivateFieldGet(eV,this),o),o}let n=new eL(manager_classPrivateFieldGet(eV,this),r.settings);return manager_classPrivateFieldGet(eU,this).set(r,new Map([[manager_classPrivateFieldGet(eV,this),n]])),n}getBorderInstances(r){var n,o;return Array.from(null!==(n=null===(o=manager_classPrivateFieldGet(eU,this).get(r))||void 0===o?void 0:o.values())&&void 0!==n?n:[])}destroyBorders(r){manager_classPrivateFieldGet(eU,this).get(r).forEach(r=>r.destroy()),manager_classPrivateFieldGet(eU,this).delete(r)}render(r){if(null===manager_classPrivateFieldGet(eG,this))return;r&&manager_assertClassBrand(e$,this,_resetCells).call(this);let n=Array.from(manager_classPrivateFieldGet(eG,this)),o=new Map,h=new Map;for(let r=0;r<n.length;r++){let l=n[r],{className:d,headerAttributes:w,createLayers:y,selectionType:S}=l.settings;manager_classPrivateFieldGet(ej,this).has(l)||(manager_classPrivateFieldGet(ej,this).add(l),l.addLocalHook("destroy",()=>this.destroyBorders(l)));let b=this.getBorderInstance(l);if(l.isEmpty()){null==b||b.disappear();continue}if(d){let r=manager_classPrivateFieldGet(eW,this).setActiveSelection(l).scan();r.forEach(r=>{if(o.has(r)){let n=o.get(r);n.has(d)&&!0===y?n.set(d,n.get(d)+1):n.set(d,1)}else o.set(r,new Map([[d,1]]));w&&(h.has(r)||h.set(r,[]),"TH"===r.nodeName&&h.get(r).push(...w))})}let _=l.getCorners();manager_classPrivateFieldGet(eV,this).getSetting("onBeforeDrawBorders",_,S),null==b||b.appear(_)}o.forEach((r,n)=>{var o;let h=Array.from(r).map(r=>{let[n,o]=r;return 1===o?n:[n,...Array.from({length:o-1},(r,o)=>`${n}-${o+1}`)]}).flat();h.forEach(r=>manager_classPrivateFieldGet(ez,this).get(manager_classPrivateFieldGet(eV,this)).add(r)),(0,l.cn)(n,h),"TD"===n.nodeName&&Array.isArray(null===(o=manager_classPrivateFieldGet(eG,this).options)||void 0===o?void 0:o.cellAttributes)&&(0,l.P$)(n,manager_classPrivateFieldGet(eG,this).options.cellAttributes)}),Array.from(h.keys()).forEach(r=>{(0,l.P$)(r,[...h.get(r)])})}};function _resetCells(){let r=manager_classPrivateFieldGet(ez,this).get(manager_classPrivateFieldGet(eV,this)),n=manager_classPrivateFieldGet(eV,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(n))for(let o=0;o<n.length;o++)r.add(n[o]);r.forEach(r=>{var n,o;let h=manager_classPrivateFieldGet(eV,this).wtTable.TABLE.querySelectorAll(`.${r}`),d=[];Array.isArray(null===(n=manager_classPrivateFieldGet(eG,this).options)||void 0===n?void 0:n.cellAttributes)&&(d=manager_classPrivateFieldGet(eG,this).options.cellAttributes.map(r=>r[0])),Array.isArray(null===(o=manager_classPrivateFieldGet(eG,this).options)||void 0===o?void 0:o.headerAttributes)&&(d=[...d,...manager_classPrivateFieldGet(eG,this).options.headerAttributes.map(r=>r[0])]);for(let n=0,o=h.length;n<o;n++)(0,l.IV)(h[n],r),(0,l.d$)(h[n],d)}),r.clear()}let Walkontable=class Walkontable extends CoreAbstract{constructor(r,n){super(r,new Settings(n));let o=this.wtSettings.getSetting("facade",this);this.wtTable=new MasterTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new eH(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new U(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new eF(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let r=[],n=[];(0,ev._l)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(o,l)=>{this.wtSettings.getSetting(l).length&&n.push(o),r.push(o)}),(0,l.IV)(this.wtTable.wtRootElement.parentNode,r),(0,l.cn)(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(r){var n;if(!ef.includes(r))return null;let o=r.replace(/_([a-z])/g,r=>r[1].toUpperCase());return null!==(n=this.wtOverlays[`${o}Overlay`])&&void 0!==n?n:null}getViewportDao(){let r=this;return{get wot(){return r},get topOverlayTrimmingContainer(){return r.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return r.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return r.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return r.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return r.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return r.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get bottomOverlay(){return r.wtOverlays.bottomOverlay}}}};let WalkontableFacade=class WalkontableFacade{constructor(r){r instanceof CoreAbstract?this._wot=r:this._initFromSettings(r)}_initFromSettings(r){r.facade=r=>{let n=new WalkontableFacade(r);return()=>n},this._wot=new Walkontable(r.table,r)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(r){this._wot.drawn=r}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(r){this._wot.drawInterrupted=r}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(r){this._wot.lastMouseOver=r}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(r){this._wot.momentumScrolling=r}get touchApplied(){return this._wot.touchApplied}set touchApplied(r){this._wot.touchApplied=r}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(r){this._wot.eventListeners=r}get eventManager(){return this._wot.eventManager}createCellCoords(r,n){return this._wot.createCellCoords(r,n)}createCellRange(r,n,o){return this._wot.createCellRange(r,n,o)}draw(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(r),this}getCell(r){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(r,n)}scrollViewport(r,n,o,l,h){return this._wot.scrollViewport(r,n,o,l,h)}scrollViewportHorizontally(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}scrollViewportVertically(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(r){return this._wot.getOverlayByName(r)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(r,n){return this._wot.wtSettings.update(r,n),this}getSetting(r,n,o,l,h){return this._wot.wtSettings.getSetting(r,n,o,l,h)}hasSetting(r){return this._wot.wtSettings.hasSetting(r)}destroy(){this._wot.destroy()}};function mouseDown(r){let{isShiftKey:n,isLeftClick:o,isRightClick:l,coords:h,selection:d,controller:w,cellCoordsFactory:y}=r,S=d.isSelected()?d.getSelectedRange().current():null,b=d.isSelectedByCorner(),_=d.isSelectedByRowHeader();if(d.markSource("mouse"),n&&S)h.row>=0&&h.col>=0&&!w.cell?d.setRangeEnd(h):(b||_)&&h.row>=0&&h.col>=0&&!w.cell?d.setRangeEnd(y(h.row,h.col)):b&&h.row<0&&!w.column?d.setRangeEnd(y(S.to.row,h.col)):_&&h.col<0&&!w.row?d.setRangeEnd(y(h.row,S.to.col)):(!b&&!_&&h.col<0||b&&h.col<0)&&!w.row?d.selectRows(Math.max(S.from.row,0),h.row,h.col):(!b&&!_&&h.row<0||_&&h.row<0)&&!w.column&&d.selectColumns(Math.max(S.from.col,0),h.col,h.row);else{let r=!d.inInSelection(h),n=o||l&&r;h.row<0&&h.col>=0&&!w.column?n&&d.selectColumns(h.col,h.col,h.row):h.col<0&&h.row>=0&&!w.row?n&&d.selectRows(h.row,h.row,h.col):h.col>=0&&h.row>=0&&!w.cell?n&&d.setRangeStart(h):h.col<0&&h.row<0&&d.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}d.markEndSource()}let eK=new Map([["mousedown",mouseDown],["mouseover",function(r){let{isLeftClick:n,coords:o,selection:l,controller:h,cellCoordsFactory:d}=r;if(!n)return;let w=l.isSelectedByRowHeader(),y=l.isSelectedByColumnHeader(),S=l.tableProps.countCols(),b=l.tableProps.countRows();l.markSource("mouse"),y&&!h.column?l.setRangeEnd(d(b-1,o.col)):w&&!h.row?l.setRangeEnd(d(o.row,S-1)):h.cell||l.setRangeEnd(o),l.markEndSource()}],["touchstart",mouseDown]]);function handleMouseEvent(r,n){let{coords:o,selection:l,controller:h,cellCoordsFactory:w}=n;eK.get(r.type)({coords:o,selection:l,controller:h,cellCoordsFactory:w,isShiftKey:r.shiftKey,isLeftClick:(0,d.pW)(r)||"touchstart"===r.type,isRightClick:(0,d.dO)(r)})}var eY=o(3732);function tableView_classPrivateFieldInitSpec(r,n,o){tableView_checkPrivateRedeclaration(r,n),n.set(r,o)}function tableView_checkPrivateRedeclaration(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")}function tableView_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}function tableView_classPrivateFieldGet(r,n){return r.get(tableView_assertClassBrand(r,n))}function tableView_classPrivateFieldSet(r,n,o){return r.set(tableView_assertClassBrand(r,n),o),o}function tableView_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var eX=new WeakMap,eq=new WeakMap,eZ=new WeakMap,eJ=new WeakMap,eQ=new WeakMap,e0=new WeakMap,e1=new WeakMap,e2=new WeakSet;function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute((0,Q.Wv)()[0]),10)}function _updateAriaColcount(r){let n=tableView_assertClassBrand(e2,this,_getAriaColcount).call(this)+r;(0,l.P$)(this.hot.rootElement,...(0,Q.Wv)(n))}var e5=class{constructor(r){tableView_checkPrivateRedeclaration(this,e2),e2.add(this),tableView_defineProperty(this,"hot",void 0),tableView_defineProperty(this,"eventManager",void 0),tableView_defineProperty(this,"settings",void 0),tableView_defineProperty(this,"THEAD",void 0),tableView_defineProperty(this,"TBODY",void 0),tableView_defineProperty(this,"_wt",void 0),tableView_defineProperty(this,"activeWt",void 0),tableView_classPrivateFieldInitSpec(this,eX,0),tableView_classPrivateFieldInitSpec(this,eq,0),tableView_defineProperty(this,"postponedAdjustElementsSize",!1),tableView_classPrivateFieldInitSpec(this,eZ,!1),tableView_classPrivateFieldInitSpec(this,eJ,void 0),tableView_classPrivateFieldInitSpec(this,eQ,void 0),tableView_classPrivateFieldInitSpec(this,e0,0),tableView_classPrivateFieldInitSpec(this,e1,0),this.hot=r,this.eventManager=new h.Z(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(r,n){let o=this._wt.getCell(r,n);return o<0?null:o}scrollViewport(r,n,o,l,h){return this._wt.scrollViewport(r,n,o,l,h)}scrollViewportHorizontally(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}scrollViewportVertically(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}createElements(){let{rootElement:r,rootDocument:n}=this.hot,o=r.getAttribute("style");o&&r.setAttribute("data-originalstyle",o),(0,l.cn)(r,"handsontable"),tableView_classPrivateFieldSet(eQ,this,n.createElement("TABLE")),(0,l.cn)(tableView_classPrivateFieldGet(eQ,this),"htCore"),this.hot.getSettings().tableClassName&&(0,l.cn)(tableView_classPrivateFieldGet(eQ,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,l.P$)(tableView_classPrivateFieldGet(eQ,this),[(0,Q.Rn)()]),(0,l.P$)(r,[(0,Q.nO)(),(0,Q.a2)(-1),(0,Q.Wv)(this.hot.countCols()),(0,Q.qt)()])),this.THEAD=n.createElement("THEAD"),tableView_classPrivateFieldGet(eQ,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),tableView_classPrivateFieldGet(eQ,this).appendChild(this.TBODY),this.hot.table=tableView_classPrivateFieldGet(eQ,this),this.hot.container.insertBefore(tableView_classPrivateFieldGet(eQ,this),this.hot.container.firstChild)}registerEvents(){let{rootElement:r,rootDocument:n,selection:o,rootWindow:h}=this.hot,w=n.documentElement;this.eventManager.addEventListener(r,"mousedown",r=>{tableView_classPrivateFieldSet(eZ,this,!0),this.isTextSelectionAllowed(r.target)||((0,l.a7)(h),r.preventDefault(),h.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{tableView_classPrivateFieldSet(eZ,this,!1)}),this.eventManager.addEventListener(r,"mousemove",r=>{tableView_classPrivateFieldGet(eZ,this)&&!this.isTextSelectionAllowed(r.target)&&(this.settings.fragmentSelection&&(0,l.a7)(h),r.preventDefault())}),this.eventManager.addEventListener(w,"keyup",r=>{o.isInProgress()&&!r.shiftKey&&o.finish()}),this.eventManager.addEventListener(w,"mouseup",h=>{o.isInProgress()&&(0,d.pW)(h)&&o.finish(),tableView_classPrivateFieldSet(eJ,this,!1);let w=(0,l.pV)(n.activeElement);(!(0,l.u7)(n.activeElement)||w)&&(!w&&(o.isSelected()||o.isSelectedByAnyHeader()||r.contains(h.target)||(0,d.dO)(h))||this.hot.unlisten())}),this.eventManager.addEventListener(w,"contextmenu",r=>{o.isInProgress()&&(0,d.dO)(r)&&(o.finish(),tableView_classPrivateFieldSet(eJ,this,!1))}),this.eventManager.addEventListener(w,"touchend",()=>{o.isInProgress()&&o.finish(),tableView_classPrivateFieldSet(eJ,this,!1)}),this.eventManager.addEventListener(w,"mousedown",o=>{let h=o.target,d=o.x||o.clientX,y=o.y||o.clientY,S=o.target;if(tableView_classPrivateFieldGet(eJ,this)||!r||!this.hot.view)return;let{holder:b}=this._wt.wtTable;if(S===b){let r=(0,l.np)(n);if(n.elementFromPoint(d+r,y)!==b||n.elementFromPoint(d,y+r)!==b)return}else for(;S!==w;){if(null===S){if(o.isTargetWebComponent)break;return}if(S===r)return;S=S.parentNode}let _="function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(h):this.settings.outsideClickDeselects;_?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let y=(0,l.f5)(h);for(;null!==y;)this.eventManager.addEventListener(y.document.documentElement,"click",()=>{this.hot.unlisten()}),y=(0,l.f5)(y);this.eventManager.addEventListener(tableView_classPrivateFieldGet(eQ,this),"selectstart",r=>{this.settings.fragmentSelection||(0,l.u7)(r.target)||r.preventDefault()})}translateFromRenderableToVisualCoords(r){let{row:n,col:o}=r;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,o))}translateFromRenderableToVisualIndex(r,n){let o=r>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(r):r,l=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return null===o&&(o=r),null===l&&(l=n),[o,l]}countRenderableIndexes(r,n){let o=Math.min(r.getNotTrimmedIndexesLength(),n),l=r.getNearestNotHiddenIndex(o-1,-1);return null===l?0:r.getRenderableFromVisualIndex(l)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(r,n){return this.countNotHiddenIndexes(r,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(r,n){return this.countNotHiddenIndexes(r,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(r,n,o,l){if(isNaN(r)||r<0)return 0;let h=o.getNearestNotHiddenIndex(r,n),d=o.getRenderableFromVisualIndex(h);if(!Number.isInteger(d))return 0;let w=0;return n<0?w=d+1:n>0&&(w=l-d),w}countNotHiddenFixedColumnsStart(){let r=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){let r=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){let r=this.hot.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(r,n){let o=0;for(let l=r;l<=n;l++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(l)&&(o+=1);return o}countRenderableRowsInRange(r,n){let o=0;for(let l=r;l<=n;l++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(l)&&(o+=1);return o}isMainTableNotFullyCoveredByOverlays(){let r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>r&&this.hot.countRenderedCols()>n}initializeWalkontable(){let r={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:tableView_classPrivateFieldGet(eQ,this),isDataViewInstance:()=>(0,eY._v)(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(r,n)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(r,n)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||r.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||r.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let r=[];return this.hot.hasRowHeaders()&&r.push((r,n)=>{let o=r>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(r):r;this.appendRowHeader(o,n)}),this.hot.runHooks("afterGetRowHeaderRenderers",r),tableView_classPrivateFieldSet(eq,this,r.length),this.hot.getSettings().ariaTags&&tableView_assertClassBrand(e2,this,_getAriaColcount).call(this)===this.hot.countCols()&&tableView_assertClassBrand(e2,this,_updateAriaColcount).call(this,tableView_classPrivateFieldGet(eq,this)),r},columnHeaders:()=>{let r=[];return this.hot.hasColHeaders()&&r.push((r,n)=>{let o=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;this.appendColHeader(o,n)}),this.hot.runHooks("afterGetColumnHeaderRenderers",r),tableView_classPrivateFieldSet(eX,this,r.length),r},columnWidth:r=>{let n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r);return this.hot.getColWidth(null===n?r:n)},rowHeight:r=>{let n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r);return this.hot.getRowHeight(null===n?r:n)},rowHeightByOverlayName:(r,n)=>{let o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),l=null===o?r:o;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,n)},cellRenderer:(r,n,o)=>{let[l,h]=this.translateFromRenderableToVisualIndex(r,n),d=this.hot.runHooks("modifyGetCellCoords",l,h),w=l,y=h;Array.isArray(d)&&([w,y]=d);let S=this.hot.getCellMeta(w,y),b=this.hot.colToProp(y),_=this.hot.getDataAtRowProp(w,b);this.hot.hasHook("beforeValueRender")&&(_=this.hot.runHooks("beforeValueRender",_,S)),this.hot.runHooks("beforeRenderer",o,l,h,b,_,S),this.hot.getCellRenderer(S)(this.hot,o,l,h,b,_,S),this.hot.runHooks("afterRenderer",o,l,h,b,_,S)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,l.pn)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(r,n,o,l)=>{let h=this.translateFromRenderableToVisualCoords(n),w={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,tableView_classPrivateFieldSet(eJ,this,!0),this.hot.runHooks("beforeOnCellMouseDown",r,h,o,w),(0,d.Ty)(r)||(handleMouseEvent(r,{coords:h,selection:this.hot.selection,controller:w,cellCoordsFactory:(r,n)=>this.hot._createCellCoords(r,n)}),this.hot.runHooks("afterOnCellMouseDown",r,h,o),this.activeWt=this._wt)},onCellContextMenu:(r,n,o,l)=>{let h=this.translateFromRenderableToVisualCoords(n);this.activeWt=l,tableView_classPrivateFieldSet(eJ,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",r,h,o),(0,d.Ty)(r)||(this.hot.runHooks("afterOnCellContextMenu",r,h,o),this.activeWt=this._wt)},onCellMouseOut:(r,n,o,l)=>{let h=this.translateFromRenderableToVisualCoords(n);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",r,h,o),(0,d.Ty)(r)||(this.hot.runHooks("afterOnCellMouseOut",r,h,o),this.activeWt=this._wt)},onCellMouseOver:(r,n,o,l)=>{let h=this.translateFromRenderableToVisualCoords(n),w={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",r,h,o,w),(0,d.Ty)(r)||(tableView_classPrivateFieldGet(eJ,this)&&handleMouseEvent(r,{coords:h,selection:this.hot.selection,controller:w,cellCoordsFactory:(r,n)=>this.hot._createCellCoords(r,n)}),this.hot.runHooks("afterOnCellMouseOver",r,h,o),this.activeWt=this._wt)},onCellMouseUp:(r,n,o,l)=>{let h=this.translateFromRenderableToVisualCoords(n);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",r,h,o),(0,d.Ty)(r)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",r,h,o),this.activeWt=this._wt)},onCellCornerMouseDown:r=>{r.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",r)},onCellCornerDblClick:r=>{r.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",r)},beforeDraw:(r,n)=>this.beforeRender(r,n),onDraw:r=>this.afterRender(r),onBeforeViewportScrollVertically:r=>{let n=this.hot.rowIndexMapper,o=r<0,l=r;return o||null!==(l=n.getVisualFromRenderableIndex(r))?(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),o)?l:n.getRenderableFromVisualIndex(l):r},onBeforeViewportScrollHorizontally:r=>{let n=this.hot.columnIndexMapper,o=r<0,l=r;return o||null!==(l=n.getVisualFromRenderableIndex(r))?(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),o)?l:n.getRenderableFromVisualIndex(l):r},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(r,n,o)=>{let l=this.hot.rowIndexMapper,h=r<0,d=r;h||(d=l.getVisualFromRenderableIndex(r));let w=this.hot.runHooks("beforeHighlightingRowHeader",d,n,o);return h?w:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,1))},onBeforeHighlightingColumnHeader:(r,n,o)=>{let l=this.hot.columnIndexMapper,h=r<0,d=r;h||(d=l.getVisualFromRenderableIndex(r));let w=this.hot.runHooks("beforeHighlightingColumnHeader",d,n,o);return h?w:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,1))},onAfterDrawSelection:(r,n,o)=>{let l;let[h,d]=this.translateFromRenderableToVisualIndex(r,n),w=this.hot.selection.getSelectedRange(),y=w.size();if(y>0){let r=w.peekByIndex(null!=o?o:0);l=[r.from.row,r.from.col,r.to.row,r.to.col]}return this.hot.runHooks("afterDrawSelection",h,d,l,o)},onBeforeDrawBorders:(r,n)=>{let[o,l,h,d]=r,w=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(h),this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.hot.runHooks("beforeDrawBorders",w,n)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(r,n)=>{let o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n);return this.hot.runHooks("beforeStretchingColumnWidth",r,o)},onModifyRowHeaderWidth:r=>this.hot.runHooks("modifyRowHeaderWidth",r),onModifyGetCellCoords:(r,n,o)=>{let l=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=n>=0?h.getVisualFromRenderableIndex(n):n,w=r>=0?l.getVisualFromRenderableIndex(r):r,y=this.hot.runHooks("modifyGetCellCoords",w,d,o);if(Array.isArray(y)){let[r,n,o,d]=y;return[r>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(r,1)):r,n>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(n,1)):n,o>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(o,-1)):o,d>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:r=>{let n=this.settings.viewportRowRenderingOffset;if("auto"===n&&this.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){let o=this.countRenderableRows(),l=r.startRow,h=r.endRow;if("number"==typeof n)r.startRow=Math.max(l-n,0),r.endRow=Math.min(h+n,o-1);else if("auto"===n){let n=Math.ceil(h/o*12);r.startRow=Math.max(l-n,0),r.endRow=Math.min(h+n,o-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",r)},viewportColumnCalculatorOverride:r=>{let n=this.settings.viewportColumnRenderingOffset;if("auto"===n&&this.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){let o=this.countRenderableColumns(),l=r.startColumn,h=r.endColumn;if("number"==typeof n&&(r.startColumn=Math.max(l-n,0),r.endColumn=Math.min(h+n,o-1)),"auto"===n){let n=Math.ceil(h/o*6);r.startColumn=Math.max(l-n,0),r.endColumn=Math.min(h+n,o-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",r)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let r=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||r}};this.hot.runHooks("beforeInitWalkontable",r),this._wt=new WalkontableFacade(r),this.activeWt=this._wt;let n=this._wt.wtTable.spreader,{width:o,height:h}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(o,h),this.eventManager.addEventListener(n,"mousedown",r=>{r.target===n&&3===r.which&&r.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",r=>{r.target===n&&3===r.which&&r.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(r){if((0,l.u7)(r))return!0;let n=(0,l.MO)(r,this._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&n||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return tableView_classPrivateFieldGet(eJ,this)}isSelectedOnlyCell(){var r,n;return null!==(r=null===(n=this.hot.getSelectedRangeLast())||void 0===n?void 0:n.isSingleCell())&&void 0!==r&&r}isCellEdited(){let r=this.hot.getActiveEditor();return r&&r.isOpened()}beforeRender(r,n){r&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(r){r&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(r,n){if(n.firstChild){let o=n.firstChild;if(!(0,l.pv)(o,"relative")){(0,l.cS)(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.hot.getRowHeader)}else{let{rootDocument:o,getRowHeader:l}=this.hot,h=o.createElement("div"),d=o.createElement("span");h.className="relative",d.className="rowHeader",this.updateCellHeader(d,r,l),h.appendChild(d),n.appendChild(h)}this.hot.runHooks("afterGetRowHeader",r,n)}appendColHeader(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,getColumnHeaderClassNames=()=>{let n=r>=0?this.hot.getColumnMeta(r).headerClassName:null;return n?n.split(" "):[]};if(n.firstChild){let d=n.firstChild;(0,l.pv)(d,"relative")?(this.updateCellHeader(d.querySelector(".colHeader"),r,o,h),d.className="",(0,l.cn)(d,["relative",...getColumnHeaderClassNames()])):((0,l.cS)(n),this.appendColHeader(r,n,o,h))}else{let{rootDocument:d}=this.hot,w=d.createElement("div"),y=d.createElement("span"),S=getColumnHeaderClassNames();w.classList.add("relative",...S),y.className="colHeader",this.settings.ariaTags&&((0,l.P$)(w,...(0,Q.Rn)()),(0,l.P$)(y,...(0,Q.Rn)())),this.updateCellHeader(y,r,o,h),w.appendChild(y),n.appendChild(w)}this.hot.runHooks("afterGetColHeader",r,n,h)}updateCellHeader(r,n,o){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,d=n,w=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&((0,l.pv)(r,"colHeader")?d=w.wtTable.columnFilter.sourceToRendered(n):(0,l.pv)(r,"rowHeader")&&(d=w.wtTable.rowFilter.sourceToRendered(n))),d>-1?(0,l.uS)(r,o(n,h)):((0,l.tT)(r,String.fromCharCode(160)),(0,l.cn)(r,"cornerHeader"))}maximumVisibleElementWidth(r){let n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}maximumVisibleElementHeight(r){let n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}setLastSize(r,n){tableView_classPrivateFieldSet(e0,this,r),tableView_classPrivateFieldSet(e1,this,n)}getLastSize(){return{width:tableView_classPrivateFieldGet(e0,this),height:tableView_classPrivateFieldGet(e1,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return tableView_classPrivateFieldGet(eX,this)}getRowHeadersCount(){return tableView_classPrivateFieldGet(eq,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(r){var n;return(null!==(n=this._wt.wtOverlays.getParentOverlay(r))&&void 0!==n?n:this._wt).wtTable.name}getOverlayByName(r){return this._wt.getOverlayByName(r)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}},26769:function(r,n,o){"use strict";o.d(n,{d:function(){return IndexMapper}}),o(57855),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652);var l=o(99440),h=o(42457),d=o(27392),w=o(16301),y=o(537),S=o(45843),b=o(96592);let _=new Map([["hiding",d.o],["index",w.n],["linkedPhysicalIndexToValue",y.A],["physicalIndexToValue",S.L],["trimming",b.n]]);var R=o(97362);o(58563);var P=o(2518),T=o(69488),I=o(63437);let O=0;let MapCollection=class MapCollection{constructor(){var r,n,o;r="collection",n=new Map,(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r,"string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n}register(r,n){!1===this.collection.has(r)&&(this.collection.set(r,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),O+=1)}unregister(r){let n=this.collection.get(r);(0,P.$K)(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),O-=1)}unregisterAll(){this.collection.forEach((r,n)=>this.unregister(n)),this.collection.clear()}get(r){return(0,P.o8)(r)?Array.from(this.collection.values()):this.collection.get(r)}getLength(){return this.collection.size}removeFromEvery(r){this.collection.forEach(n=>{n.remove(r)})}insertToEvery(r,n){this.collection.forEach(o=>{o.insert(r,n)})}initEvery(r){this.collection.forEach(n=>{n.init(r)})}};function aggregatedCollection_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}(0,T.jB)(MapCollection,I.Z);let AggregatedCollection=class AggregatedCollection extends MapCollection{constructor(r,n){super(),aggregatedCollection_defineProperty(this,"mergedValuesCache",[]),aggregatedCollection_defineProperty(this,"aggregationFunction",void 0),aggregatedCollection_defineProperty(this,"fallbackValue",void 0),this.aggregationFunction=r,this.fallbackValue=n}getMergedValues(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===r)return this.mergedValuesCache;if(0===this.getLength())return[];let n=(0,l.Sc)(this.get(),r=>r.getValues()),o=[],h=(0,P.$K)(n[0])&&n[0].length||0;for(let r=0;r<h;r+=1){let l=[];for(let o=0;o<this.getLength();o+=1)l.push(n[o][r]);o.push(l)}return(0,l.Sc)(o,this.aggregationFunction)}getMergedValueAtIndex(r,n){let o=this.getMergedValues(n)[r];return(0,P.$K)(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}};function _assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}var k=new WeakMap;let ChangesObserver=class ChangesObserver{constructor(){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,k),k.set(this,[])}subscribe(r){return this.addLocalHook("change",r),this._write(k.get(_assertClassBrand(k,this))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(r){return r.length>0&&this.runLocalHooks("change",r),this}_writeInitialChanges(r){k.set(_assertClassBrand(k,this),r)}};function arrayDiff(r,n){let o=[],l=0,h=0;for(;l<r.length&&h<n.length;l++,h++)r[l]!==n[h]&&o.push({op:"replace",index:h,oldValue:r[l],newValue:n[h]});for(;l<n.length;l++)o.push({op:"insert",index:l,oldValue:void 0,newValue:n[l]});for(;h<r.length;h++)o.push({op:"remove",index:h,oldValue:r[h],newValue:void 0});return o}function observable_classPrivateFieldInitSpec(r,n,o){(function(r,n){if(n.has(r))throw TypeError("Cannot initialize the same private elements twice on an object")})(r,n),n.set(r,o)}function observable_classPrivateFieldGet(r,n){return r.get(observable_assertClassBrand(r,n))}function observable_classPrivateFieldSet(r,n,o){return r.set(observable_assertClassBrand(r,n),o),o}function observable_assertClassBrand(r,n,o){if("function"==typeof r?r===n:r.has(n))return arguments.length<3?n:o;throw TypeError("Private element is not present on this object")}(0,T.jB)(ChangesObserver,I.Z);var N=new WeakMap,L=new WeakMap,j=new WeakMap,U=new WeakMap,$=new WeakMap;let ChangesObservable=class ChangesObservable{constructor(){let{initialIndexValue:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};observable_classPrivateFieldInitSpec(this,N,new Set),observable_classPrivateFieldInitSpec(this,L,[]),observable_classPrivateFieldInitSpec(this,j,[]),observable_classPrivateFieldInitSpec(this,U,!1),observable_classPrivateFieldInitSpec(this,$,!1),observable_classPrivateFieldSet($,this,null!=r&&r)}createObserver(){let r=new ChangesObserver;return observable_classPrivateFieldGet(N,this).add(r),r.addLocalHook("unsubscribe",()=>{observable_classPrivateFieldGet(N,this).delete(r)}),r._writeInitialChanges(arrayDiff(observable_classPrivateFieldGet(L,this),observable_classPrivateFieldGet(j,this))),r}emit(r){let n=observable_classPrivateFieldGet(j,this);observable_classPrivateFieldGet(U,this)&&observable_classPrivateFieldGet(L,this).length===r.length||(0===r.length?r=Array(n.length).fill(observable_classPrivateFieldGet($,this)):observable_classPrivateFieldSet(L,this,Array(r.length).fill(observable_classPrivateFieldGet($,this))),observable_classPrivateFieldGet(U,this)||(observable_classPrivateFieldSet(U,this,!0),n=observable_classPrivateFieldGet(L,this)));let o=arrayDiff(n,r);observable_classPrivateFieldGet(N,this).forEach(r=>r._write(o)),observable_classPrivateFieldSet(j,this,r)}};function indexMapper_defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let IndexMapper=class IndexMapper{constructor(){indexMapper_defineProperty(this,"indexesSequence",new h.b),indexMapper_defineProperty(this,"trimmingMapsCollection",new AggregatedCollection(r=>r.some(r=>!0===r),!1)),indexMapper_defineProperty(this,"hidingMapsCollection",new AggregatedCollection(r=>r.some(r=>!0===r),!1)),indexMapper_defineProperty(this,"variousMapsCollection",new MapCollection),indexMapper_defineProperty(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),indexMapper_defineProperty(this,"notTrimmedIndexesCache",[]),indexMapper_defineProperty(this,"notHiddenIndexesCache",[]),indexMapper_defineProperty(this,"isBatched",!1),indexMapper_defineProperty(this,"indexesSequenceChanged",!1),indexMapper_defineProperty(this,"indexesChangeSource",void 0),indexMapper_defineProperty(this,"trimmedIndexesChanged",!1),indexMapper_defineProperty(this,"hiddenIndexesChanged",!1),indexMapper_defineProperty(this,"renderablePhysicalIndexesCache",[]),indexMapper_defineProperty(this,"fromPhysicalToVisualIndexesCache",new Map),indexMapper_defineProperty(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",r=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",r,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",r=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",r,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",r=>{this.runLocalHooks("change",r,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(r){if("hiding"!==r)throw Error(`Unsupported index map type "${r}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(r,n,o){return this.registerMap(r,function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!_.has(r))throw Error(`The provided map type ("${r}") does not exist.`);return new(_.get(r))(n)}(n,o))}registerMap(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error(`Map with name "${r}" has been already registered.`);n instanceof b.n?this.trimmingMapsCollection.register(r,n):n instanceof d.o?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);let o=this.getNumberOfIndexes();return o>0&&n.init(o),n}unregisterMap(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(r){let n=this.notTrimmedIndexesCache[r];return(0,P.$K)(n)?n:null}getPhysicalFromRenderableIndex(r){let n=this.renderablePhysicalIndexesCache[r];return(0,P.$K)(n)?n:null}getVisualFromPhysicalIndex(r){let n=this.fromPhysicalToVisualIndexesCache.get(r);return(0,P.$K)(n)?n:null}getVisualFromRenderableIndex(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}getRenderableFromVisualIndex(r){let n=this.fromVisualToRenderableIndexesCache.get(r);return(0,P.$K)(n)?n:null}getNearestNotHiddenIndex(r,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=this.getPhysicalFromVisualIndex(r);if(null===l)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;let h=Array.from(this.fromVisualToRenderableIndexesCache.keys()),d=-1;return -1===(d=n>0?h.findIndex(n=>n>r):h.reverse().findIndex(n=>n<r))?o?this.getNearestNotHiddenIndex(r,-n,!1):null:h[d]}initToLength(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...Array(r).keys()],this.notHiddenIndexesCache=[...Array(r).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(r){let n=this.getNumberOfIndexes();if(r<n){let n=[...Array(this.getNumberOfIndexes()-r).keys()].map(n=>n+r);this.removeIndexes(n)}else this.insertIndexes(n,r-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(r){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===r)return this.notTrimmedIndexesCache;let n=this.getIndexesSequence();return n.filter(r=>!1===this.isTrimmed(r))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===r)return this.notHiddenIndexesCache;let n=this.getIndexesSequence();return n.filter(r=>!1===this.isHidden(r))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===r)return this.renderablePhysicalIndexesCache;let n=this.getNotTrimmedIndexes();return n.filter(r=>!1===this.isHidden(r))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(r,n){"number"==typeof r&&(r=[r]);let o=(0,l.Sc)(r,r=>this.getPhysicalFromVisualIndex(r)),h=this.getNotTrimmedIndexesLength(),d=r.length,w=(0,R.t)(this.getIndexesSequence(),o),y=w.filter(r=>!1===this.isTrimmed(r)),S=w.indexOf(y[y.length-1])+1;if(n+d<h){let r=y[n];S=w.indexOf(r)}this.indexesChangeSource="move",this.setIndexesSequence((0,R.S)(w,S,o)),this.indexesChangeSource=void 0}isTrimmed(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}isHidden(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}insertIndexes(r,n){let o=this.getNotTrimmedIndexes()[r],h=(0,P.$K)(o)?o:this.getNumberOfIndexes(),d=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),w=(0,l.Sc)(Array(n).fill(h),(r,n)=>r+n);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(d,w),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(d,w),this.hidingMapsCollection.insertToEvery(d,w),this.variousMapsCollection.insertToEvery(d,w),this.resumeOperations()}removeIndexes(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}updateCache(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===r||!1===this.isBatched&&!0===n)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<r;n+=1){let r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){let r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<r;n+=1){let r=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(o,n)}}};(0,T.jB)(IndexMapper,I.Z)},27392:function(r,n,o){"use strict";o.d(n,{o:function(){return HidingMap}}),o(58563);var l=o(45843),h=o(99440);let HidingMap=class HidingMap extends l.L{constructor(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(r)}getHiddenIndexes(){return(0,h.k$)(this.getValues(),(r,n,o)=>(n&&r.push(o),r),[])}}},16301:function(r,n,o){"use strict";o.d(n,{n:function(){return IndexMap}}),o(57855),o(58563);var l=o(67790),h=o(69488),d=o(98179),w=o(63437);function _defineProperty(r,n,o){var l;return(n="symbol"==typeof(l=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(n,"string"))?l:l+"")in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r}let IndexMap=class IndexMap{constructor(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_defineProperty(this,"indexedValues",[]),_defineProperty(this,"initValueOrFn",void 0),this.initValueOrFn=r}getValues(){return this.indexedValues}getValueAtIndex(r){let n=this.indexedValues;if(r<n.length)return n[r]}setValues(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}setValueAtIndex(r,n){return r<this.indexedValues.length&&(this.indexedValues[r]=n,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,d.mf)(this.initValueOrFn)?(0,l.q4)(r-1,r=>this.indexedValues.push(this.initValueOrFn(r))):(0,l.q4)(r-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};(0,h.jB)(IndexMap,w.Z)},42457:function(r,n,o){"use strict";o.d(n,{b:function(){return IndexesSequence}});var l=o(16301),h=o(97362),d=o(65724);let IndexesSequence=class IndexesSequence extends l.n{constructor(){super(r=>r)}insert(r,n){let o=(0,d.X)(this.indexedValues,n);this.indexedValues=(0,h.S)(o,r,n),super.insert(r,n)}remove(r){let n=(0,h.t)(this.indexedValues,r);this.indexedValues=(0,d.i)(n,r),super.remove(r)}}},537:function(r,n,o){"use strict";o.d(n,{A:function(){return LinkedPhysicalIndexToValueMap}}),o(57855);var l=o(16301),h=o(5354),d=o(97362),w=o(65724),y=o(98179);let LinkedPhysicalIndexToValueMap=class LinkedPhysicalIndexToValueMap extends l.n{constructor(){var r,n,o;super(...arguments),n=[],(r="symbol"==typeof(o=function(r,n){if("object"!=typeof r||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var l=o.call(r,n||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(r)}(r="orderOfIndexes","string"))?o:o+"")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n}getValues(){return this.orderOfIndexes.map(r=>this.indexedValues[r])}setValues(r){this.orderOfIndexes=[...Array(r.length).keys()],super.setValues(r)}setValueAtIndex(r,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return r<this.indexedValues.length&&(this.indexedValues[r]=n,!1===this.orderOfIndexes.includes(r)&&this.orderOfIndexes.splice(o,0,r),this.runLocalHooks("change"),!0)}clearValue(r){this.orderOfIndexes=(0,d.t)(this.orderOfIndexes,[r]),(0,y.mf)(this.initValueOrFn)?super.setValueAtIndex(r,this.initValueOrFn(r)):super.setValueAtIndex(r,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(r)}insert(r,n){this.indexedValues=(0,h.S)(this.indexedValues,r,n,this.initValueOrFn),this.orderOfIndexes=(0,w.X)(this.orderOfIndexes,n),super.insert(r,n)}remove(r){this.indexedValues=(0,h.t)(this.indexedValues,r),this.orderOfIndexes=(0,d.t)(this.orderOfIndexes,r),this.orderOfIndexes=(0,w.i)(this.orderOfIndexes,r),super.remove(r)}getEntries(){return this.orderOfIndexes.map(r=>[r,this.getValueAtIndex(r)])}}},45843:function(r,n,o){"use strict";o.d(n,{L:function(){return PhysicalIndexToValueMap}});var l=o(16301),h=o(5354);let PhysicalIndexToValueMap=class PhysicalIndexToValueMap extends l.n{insert(r,n){this.indexedValues=(0,h.S)(this.indexedValues,r,n,this.initValueOrFn),super.insert(r,n)}remove(r){this.indexedValues=(0,h.t)(this.indexedValues,r),super.remove(r)}}},96592:function(r,n,o){"use strict";o.d(n,{n:function(){return TrimmingMap}}),o(58563);var l=o(45843),h=o(99440);let TrimmingMap=class TrimmingMap extends l.L{constructor(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(r)}getTrimmedIndexes(){return(0,h.k$)(this.getValues(),(r,n,o)=>(n&&r.push(o),r),[])}}},65724:function(r,n,o){"use strict";o.d(n,{X:function(){return getIncreasedIndexes},i:function(){return getDecreasedIndexes}});var l=o(99440);function getDecreasedIndexes(r,n){return(0,l.Sc)(r,r=>r-n.filter(n=>n<r).length)}function getIncreasedIndexes(r,n){let o=n[0],h=n.length;return(0,l.Sc)(r,r=>r>=o?r+h:r)}},97362:function(r,n,o){"use strict";o.d(n,{S:function(){return getListWithInsertedItems},t:function(){return getListWithRemovedItems}});var l=o(99440);function getListWithInsertedItems(r,n,o){return[...r.slice(0,n),...o,...r.slice(n)]}function getListWithRemovedItems(r,n){return(0,l.w7)(r,r=>!1===n.includes(r))}},5354:function(r,n,o){"use strict";o.d(n,{S:function(){return getListWithInsertedItems},t:function(){return getListWithRemovedItems}});var l=o(98179),h=o(99440);function getListWithInsertedItems(r,n,o,h){let d=o.length?o[0]:void 0;return[...r.slice(0,d),...o.map((r,n)=>(0,l.mf)(h)?h(r,n):h),...void 0===d?[]:r.slice(d)]}function getListWithRemovedItems(r,n){return(0,h.w7)(r,(r,o)=>!1===n.includes(o))}},2488:function(r,n,o){"use strict";o.d(n,{I:function(){return createUniqueMap}}),o(57855);var l=o(98179);let DEFAULT_ERROR_ID_EXISTS=r=>`The id '${r}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new Map;function getItems(){return[...n]}function hasItem(r){return n.has(r)}return r=(0,l.mf)(r)?r:DEFAULT_ERROR_ID_EXISTS,{addItem:function(o,l){if(hasItem(o))throw Error(r(o));n.set(o,l)},clear:function(){n.clear()},getId:function(r){let[n]=getItems().find(n=>{let[o,l]=n;return r===l&&o})||[null];return n},getItem:function(r){return n.get(r)},getItems,hasItem,removeItem:function(r){return n.delete(r)}}}},84350:function(r,n,o){"use strict";o.d(n,{BU:function(){return htmlToGridSettings},bt:function(){return _dataToHTML},vo:function(){return instanceToHTML}}),o(58563),o(43510);var l=o(2518);let h={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},d=RegExp(Object.keys(h).map(r=>`(${r})`).join("|"),"gi");function instanceToHTML(r){let n=r.hasColHeaders(),o=r.hasRowHeaders(),h=[n?-1:0,o?-1:0,r.countRows()-1,r.countCols()-1],d=r.getData(...h),w=d.length,y=w>0?d[0].length:0,S=["<table>","</table>"],b=n?["<thead>","</thead>"]:[],_=["<tbody>","</tbody>"],R=o?1:0,P=n?1:0;for(let h=0;h<w;h+=1){let w=n&&0===h,S=[];for(let n=0;n<y;n+=1){let y=!w&&o&&0===n,b="";if(w)b=`<th>${r.getColHeader(n-R)}</th>`;else if(y)b=`<th>${r.getRowHeader(h-P)}</th>`;else{let o=d[h][n],{hidden:w,rowspan:y,colspan:S}=r.getCellMeta(h-P,n-R);if(!w){let r=[];if(y&&r.push(`rowspan="${y}"`),S&&r.push(`colspan="${S}"`),(0,l.xb)(o))b=`<td ${r.join(" ")}></td>`;else{let n=o.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${r.join(" ")}>${n}</td>`}}}S.push(b)}let T=["<tr>",...S,"</tr>"].join("");w?b.splice(1,0,T):_.splice(-1,0,T)}return S.splice(1,0,b.join(""),_.join("")),S.join("")}function _dataToHTML(r){let n=r.length,o=["<table>"];for(let h=0;h<n;h+=1){let d=r[h],w=d.length,y=[];0===h&&o.push("<tbody>");for(let r=0;r<w;r+=1){let n=d[r],o=(0,l.xb)(n)?"":n.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,r=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(r.length-1)} </span>`).replace(/\t/gi,"&#9;");y.push(`<td>${o}</td>`)}o.push("<tr>",...y,"</tr>"),h+1===n&&o.push("</tbody>")}return o.push("</table>"),o.join("")}function htmlToGridSettings(r){var n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,l={},w=o.createDocumentFragment(),y=o.createElement("div");w.appendChild(y);let S=r;if("string"==typeof S){let r=S.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,r=>{let n=r.match(/<td\b[^>]*?>/g)[0],o=r.substring(n.length,r.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${n}${o}</td>`});y.insertAdjacentHTML("afterbegin",`${r}`),S=y.querySelector("table")}if(!S||"TABLE"!==((n=S)&&n.nodeName||""))return;let b=y.querySelector('meta[name$="enerator"]'),_=null!==S.querySelector("tbody th"),R=S.querySelector("tr"),P=R?Array.from(R.cells).reduce((r,n)=>r+n.colSpan,0)-(_?1:0):0,T=S.tFoot&&Array.from(S.tFoot.rows)||[],I=[],O=!1,k=0,N=0;if(S.tHead){let r=Array.from(S.tHead.rows).filter(r=>{let n=null!==r.querySelector("td");return n&&I.push(r),!n});O=(k=r.length)>0,k>1?l.nestedHeaders=Array.from(r).reduce((r,n)=>{let o=Array.from(n.cells).reduce((r,n,o)=>{if(_&&0===o)return r;let{colSpan:l,innerHTML:h}=n,d=l>1?{label:h,colspan:l}:h;return r.push(d),r},[]);return r.push(o),r},[]):O&&(l.colHeaders=Array.from(r[0].children).reduce((r,n,o)=>(_&&0===o||r.push(n.innerHTML),r),[]))}I.length&&(l.fixedRowsTop=I.length),T.length&&(l.fixedRowsBottom=T.length);let L=[...I,...Array.from(S.tBodies).reduce((r,n)=>(r.push(...Array.from(n.rows)),r),[]),...T];N=L.length;let j=Array(N);for(let r=0;r<N;r++)j[r]=Array(P);let U=[],$=[];for(let r=0;r<N;r++){let n=L[r],o=Array.from(n.cells),l=o.length;for(let n=0;n<l;n++){let l=o[n],{nodeName:w,innerHTML:y,rowSpan:S,colSpan:_}=l,R=j[r].findIndex(r=>void 0===r);if("TD"===w){if(S>1||_>1){for(let n=r;n<r+S;n++)if(n<N)for(let r=R;r<R+_;r++)j[n][r]=null;let n=l.getAttribute("style"),o=n&&n.includes("mso-ignore:colspan");o||U.push({col:R,row:r,rowspan:S,colspan:_})}let n="";n=b&&/excel/gi.test(b.content)?y.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):y.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),j[r][R]=n.replace(d,r=>h[r])}else $.push(y)}}return U.length&&(l.mergeCells=U),$.length&&(l.rowHeaders=$),j.length&&(l.data=j),l}},3732:function(r,n,o){"use strict";o.d(n,{IU:function(){return registerAsRootInstance},_v:function(){return isRootInstance},dU:function(){return hasValidParameter},mc:function(){return h}});let l=new WeakMap,h=Symbol("rootInstance");function registerAsRootInstance(r){l.set(r,!0)}function hasValidParameter(r){return r===h}function isRootInstance(r){return l.has(r)}},82656:function(r,n,o){"use strict";o.d(n,{Z:function(){return staticRegister}});let l=new Map;function staticRegister(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";l.has(r)||l.set(r,new Map);let n=l.get(r);return{register:function(r,o){n.set(r,o)},getItem:function(r){return n.get(r)},hasItem:function(r){return n.has(r)},getNames:function(){return[...n.keys()]},getValues:function(){return[...n.values()]}}}},92740:function(r,n,o){"use strict";o.d(n,{Ie:function(){return _register},Te:function(){return _getItem},oh:function(){return w}}),o(57855);var l=o(82656);let{register:h,getItem:d,hasItem:w,getNames:y,getValues:S}=(0,l.Z)("validators");function _getItem(r){if("function"==typeof r)return r;if(!w(r))throw Error(`No registered validator found under "${r}" name`);return d(r)}function _register(r,n){"string"!=typeof r&&(r=(n=r).VALIDATOR_TYPE),h(r,n)}}}]);