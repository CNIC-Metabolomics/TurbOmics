"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330],{65897:function(e,t,l){l.d(t,{E:function(){return MySection},c:function(){return MySectionContainer}});var a=l(57437),i=l(39227);function MySection(e){let{children:t,sx:l}=e;return(0,a.jsx)(i.Z,{sx:{...l},style:{scrollSnapAlign:"center",border:"0px solid yellow"},children:t})}function MySectionContainer(e){let{children:t,height:l}=e;return(0,a.jsx)(i.Z,{sx:{height:{height:l},scrollSnapType:"y mandatory",overflow:"auto",border:"0px solid red"},children:t})}l(2265)},20626:function(e,t,l){l.d(t,{$Y:function(){return MyScatter2D},Mz:function(){return ShowLabels},T3:function(){return MyScatter}});var a=l(57437),i=l(81797),s=l(39227),n=l(14172),o=l(88444),r=l(85269),c=l(68448),d=l(2265),u=l(41125),x=l(16573),h=l(24235),p=l(33343),m=l(50039),g=l(86812),j=l(87586),f=l(561),y=l(79857),b=l(96350),Z=l(53146);function MyScatter(e){let t,{omic:l,scatterData:n,mdataCol:o,PCA:r,expVar:y}=e,[v,C]=(0,d.useState)(!1),{OMIC2NAME:w}=(0,b.S)(),M=(0,d.useRef)(),S=(0,i.tc)().mdataType[o].type;return"categorical"==S&&(t="category"),"numeric"==S&&(t="number"),(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(s.Z,{sx:{},children:(0,a.jsx)(Z.LA,{scatterRef:M,name:"PCA-1D-".concat(w[l])})}),(0,a.jsxs)(u.G,{width:600,height:550,ref:M,margin:{top:20,right:20,bottom:20,left:20},children:[(0,a.jsx)(x.q,{}),(0,a.jsx)(h.K,{type:t,dataKey:"mdataValue",name:o,allowDuplicatedCategory:!1,style:{fontFamily:"Calibri"},children:(0,a.jsx)(p._,{value:o,offset:-10,position:"insideBottom",style:{fontFamily:"Calibri"}})}),(0,a.jsx)(m.B,{type:"number",dataKey:"projection",name:"PCA ".concat(r),style:{fontFamily:"Calibri"},children:(0,a.jsx)(p._,{value:"PCA ".concat(r," (").concat(y[r-1],"%)"),offset:20,position:"insideLeft",angle:-90,style:{fontFamily:"Calibri"}})}),(0,a.jsx)(g.u,{cursor:{strokeDasharray:"3 3"},content:(0,a.jsx)(CustomTooltip,{})}),(0,a.jsx)(j.b,{data:n,fill:c.s[0],isAnimationActive:!1,children:v&&(0,a.jsx)(f.e,{dataKey:"element",position:"right",style:{fontFamily:"Calibri"}})})]}),(0,a.jsx)(ShowLabels,{showLabels:v,setShowLabels:C})]})}function MyScatter2D(e){let{omic:t,scatterData:l,selectedPlot2D:i,expVar:n}=e,{OMIC2NAME:o}=(0,b.S)(),r=(0,d.useRef)(),[v,C]=(0,d.useState)(!1);return(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(s.Z,{children:(0,a.jsx)(Z.LA,{scatterRef:r,name:"PCA-2D-".concat(o[t])})}),(0,a.jsxs)(u.G,{ref:r,width:600,height:550,margin:{top:20,right:20,bottom:20,left:20},children:[(0,a.jsx)(x.q,{}),(0,a.jsx)(h.K,{type:"number",dataKey:"x",name:"PCA ".concat(i.x),style:{fontFamily:"Calibri"},children:(0,a.jsx)(p._,{value:"PCA ".concat(i.x," (").concat(n[i.x-1],"%)"),offset:-10,position:"insideBottom",style:{fontFamily:"Calibri"}})}),(0,a.jsx)(m.B,{type:"number",dataKey:"y",name:"PCA ".concat(i.y),style:{fontFamily:"Calibri"},children:(0,a.jsx)(p._,{value:"PCA ".concat(i.y," (").concat(n[i.y-1],"%)"),offset:20,position:"insideLeft",angle:-90,style:{fontFamily:"Calibri"}})}),(0,a.jsx)(g.u,{cursor:{strokeDasharray:"3 3"},content:(0,a.jsx)(CustomTooltip,{})}),Object.keys(l).length>1&&(0,a.jsx)(y.D,{verticalAlign:"top"}),Object.keys(l).map((e,t)=>(0,a.jsx)(j.b,{data:l[e],fill:c.s[t%c.s.length],name:e,isAnimationActive:!1,children:v&&(0,a.jsx)(f.e,{dataKey:"element",position:"top",style:{fontFamily:"Calibri"}})},e))]}),(0,a.jsx)(s.Z,{sx:{mt:1},children:(0,a.jsx)(ShowLabels,{showLabels:v,setShowLabels:C})})]})}let ShowLabels=e=>{let{showLabels:t,setShowLabels:l}=e;return(0,a.jsx)(s.Z,{sx:{mt:0,display:"flex",justifyContent:"center"},children:(0,a.jsxs)(s.Z,{sx:{width:100,textAlign:"center",position:"relative",left:30,border:"0px solid red"},children:[(0,a.jsx)(n.Z,{component:"legend",sx:{pt:0},children:"Show Labels"}),(0,a.jsx)(o.Z,{sx:{position:"relative",top:-10,border:"0px solid red"},checked:t,onChange:e=>{l(e=>!e)},inputProps:{"aria-label":"controlled"}})]})})},CustomTooltip=e=>{let{active:t,payload:l}=e;return t&&l&&l.length?(0,a.jsxs)(s.Z,{className:"custom-tooltip",sx:{backgroundColor:"rgba(5,5,5,0.8)",color:"rgba(250,250,250,0.8)",border:"1px solid rgba(50, 50, 50, 0.8)",padding:1,borderRadius:1},children:[(0,a.jsx)(r.Z,{variant:"h8",sx:{display:"block"},children:"".concat(l[0].payload.element)}),(0,a.jsx)(r.Z,{variant:"h9",sx:{display:"block"},children:"".concat(l[0].name,": ").concat("string"==typeof l[0].value?l[0].value:l[0].value.toFixed(3))}),(0,a.jsx)(r.Z,{variant:"h9",sx:{display:"block"},children:"".concat(l[1].name,": ").concat(l[1].value.toFixed(3))})]}):null}},81330:function(e,t,l){l.r(t),l.d(t,{default:function(){return MOFA_MOFA}});var a=l(57437),i=l(39227),s=l(54986),n=l(49600),o=l(65498),r=l(47042),c=l(85269),d=l(24094),u=l(2265),x=l(29818),h=l(96350),p=l(81797),m=l(46776),g=l(38939),j=l(23503),f=l(75897),y=l(53514),b=l(77370),Z=l(80470),v=l(57842),C=l(62254),w=l(55183),M=l(35843),S=l(22079),F=l(91797),A=l(52151),P=l(91928),k=l(33533),D=l(80565),L=l(37682),O=l(666);let H=(0,M.ZP)(S.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function HelpSection(){let[e,t]=u.useState(!1),handleClose=()=>{t(!1)};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,a.jsx)(O.Z,{fontSize:"inherit"})}),(0,a.jsxs)(H,{onClose:handleClose,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,a.jsx)(F.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA)"}),(0,a.jsx)(m.Z,{"aria-label":"close",onClick:handleClose,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,a.jsx)(k.default,{})}),(0,a.jsxs)(A.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,a.jsx)(c.Z,{gutterBottom:!0,children:"This section presents the results of the Multi-Omics Factor Analysis (MOFA) [1], a multivariate statistical technique that decomposes your omics data into latent factors. These factors capture the major sources of variation across different data modalities, allowing for the identification of continuous molecular gradients or discrete subgroups of samples. MOFA operates in an unsupervised manner and runs with default parameters."}),(0,a.jsxs)(c.Z,{gutterBottom:!0,children:["At the top of this section you can find a ",(0,a.jsx)("strong",{children:"Summary Table of Latent Factor"})," with the following information:"]}),(0,a.jsx)(i.Z,{sx:{pl:3},children:(0,a.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Variability Explained"}),": For each latent factor, the table summarizes the percentage of variability explained in each omic dataset. This information helps users understand the contribution of each factor to the overall variability within each omic type."]}),(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Metadata Associations"}),": The table also includes additional rows corresponding to the variables in the uploaded Experimental Metadata table. For each metadata variable, the table displays the p-value of the linear regression between the variable and the sample projections on each latent factor. These p-values indicate the significance of the association between the factors and the experimental conditions or other metadata, helping to identify potentially meaningful biological or technical influences."]})]})})]}),(0,a.jsx)(P.Z,{children:(0,a.jsx)(i.Z,{sx:{textAlign:"justify",p:2},children:(0,a.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}let _="rgba(200,200,200,0.5)",useStyles=e=>({cell:{transition:"background-color 0.3s, border-color 0.3s",border:"1px solid ".concat(_),cursor:"1D"==e?"pointer":"",padding:.5,fontSize:15,textAlign:"center",userSelect:"none","&:hover":{border:"1D"==e?"1px solid rgba(50,50,50,1)":"1px solid ".concat(_)}},selectedCell:{border:"1D"==e?"1px solid rgba(50,50,50,1)":"1px solid ".concat(_)}}),z={textAlign:"center",padding:.5,border:"1px solid ".concat(_),borderRight:"1px solid rgba(10,10,10,1)",fontSize:15,whiteSpace:"nowrap",userSelect:"none"},calculateBackgroundColor=e=>({backgroundColor:e<.1?"rgba(".concat(2550*e,",").concat(200+550*e,",").concat(2550*e,", 0.5)"):"rgba(255,255,255,0.5)"}),calculateBackgroundColorExpVar=e=>({backgroundColor:"rgba(".concat(255,",").concat(255-255*e/100,",").concat(255-255*e/100,", 0.8)")});function TablePvalues(e){let{anova:t,explained_variance:l,setSelectedPlot:s,selectedCell:n,setSelectedCell:o,scatterMode:r,factorNames:c,colNames:d,rowNames:x}=e,{OMIC2NAME:M}=(0,h.S)(),{omics:S}=(0,p.tc)(),F=useStyles(r),A=(0,u.useMemo)(()=>x.map(e=>c.map(l=>t[l][e].pvalue)),[t,x,c]),P=(0,u.useMemo)(()=>S.reduce((e,t)=>({...e,[t]:c.map(e=>l[t][e].Explained_Variance)}),{}),[l,c,S]),handleCellClick=(e,t)=>{"2D"!=r&&(o({rowIndex:e,colIndex:t}),s({mdataCol:x[e],Factor:c[t]}),console.log("Plot scatter: MOFA ".concat(c[t]," vs ").concat(x[e])))},k=(0,u.useMemo)(()=>{let e=[];e.push(["Factor / Cond.",...d]),S.map(t=>e.push(["%Var (".concat(t.toUpperCase(),")"),...P[t]]));let t=A.map((e,t)=>[x[t],...e]);return e=[...e,...t]},[d,A,x,S,P]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{sx:{height:0,width:50,zIndex:5e3,display:"flex",paddingLeft:.5},children:(0,a.jsx)(m.Z,{"aria-label":"download",size:"small",sx:{opacity:.5,position:"relative",top:-21},children:(0,a.jsx)(w.CSVLink,{data:k,filename:"MOFA_Anova_pvalues.csv",separator:",",children:(0,a.jsx)(C.Z,{})})})}),(0,a.jsxs)(g.ZP,{container:!0,children:[(0,a.jsx)(g.ZP,{item:!0,xs:2,children:(0,a.jsx)(j.Z,{sx:{margin:"auto"},children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(y.Z,{children:(0,a.jsx)(b.Z,{children:(0,a.jsx)(Z.Z,{sx:{padding:0,textAlign:"center"},children:"Factor / Cond."})})}),(0,a.jsxs)(v.Z,{children:[S.map((e,t)=>(0,a.jsx)(b.Z,{children:(0,a.jsx)(Z.Z,{sx:{padding:0,border:0},children:(0,a.jsxs)(i.Z,{sx:{...z,borderBottom:t==S.length-1&&"1px solid rgba(10,10,10,1)"},children:["%Var (",M[e].slice(0,4),".)"]})})},e)),x.map((e,t)=>(0,a.jsx)(b.Z,{children:(0,a.jsx)(Z.Z,{sx:{padding:0,border:0},children:(0,a.jsxs)(i.Z,{sx:z,children:["p-value [ ",(0,a.jsx)("strong",{children:e})," ]"]})})},t))]})]})})}),(0,a.jsx)(g.ZP,{item:!0,xs:10,children:(0,a.jsx)(j.Z,{sx:{margin:"auto"},children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(y.Z,{children:(0,a.jsx)(b.Z,{children:d.map((e,t)=>(0,a.jsx)(Z.Z,{sx:{padding:0,textAlign:"center",userSelect:"none"},children:e},t))})}),(0,a.jsxs)(v.Z,{children:[S.map(e=>P[e]).map((e,t)=>(0,a.jsx)(b.Z,{children:e.map((e,l)=>(0,a.jsx)(Z.Z,{sx:{padding:0,border:0},children:(0,a.jsx)(i.Z,{sx:{padding:.5,border:"1px solid ".concat(_),borderBottom:t==S.length-1&&"1px solid rgba(10,10,10,1)",fontSize:15,textAlign:"center",backgroundColor:calculateBackgroundColorExpVar(e),userSelect:"none"},children:e.toFixed(2)})},l))},t)),A.map((e,t)=>(0,a.jsx)(b.Z,{children:e.map((e,l)=>(0,a.jsx)(Z.Z,{sx:{padding:0,border:0},onClick:()=>handleCellClick(t,l),style:{minWidth:100},children:(0,a.jsx)(i.Z,{sx:n&&n.rowIndex===t&&n.colIndex===l?{...F.cell,...F.selectedCell,...calculateBackgroundColor(e)}:{...F.cell,...calculateBackgroundColor(e)},children:e<.001?e.toExponential(3):e.toFixed(3)})},l))},t))]})]})})})]})]})}var T=l(32428);function SelectorFactor2D(e){let{factorNames:t,rowNames:l,selectedPlot2D:s,setSelectedPlot2D:n}=e,o=(0,x.mX)(),{mdataType:r}=(0,p.tc)();return(0,a.jsxs)(i.Z,{sx:{height:75,display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)(i.Z,{sx:{width:"25%"},children:(0,a.jsx)(T.$S,{options:t.map(e=>({label:e,value:e})),onChange:e=>{n(t=>({...t,x:e.value})),o({type:"set-selected-plot-2d-mofa",mode:{...s,x:e.value}})},value:{label:"".concat(s.x),value:s.x},label:"X axis"})}),(0,a.jsx)(i.Z,{sx:{width:"25%"},children:(0,a.jsx)(T.$S,{options:t.map(e=>({label:e,value:e})),onChange:e=>{n(t=>({...t,y:e.value})),o({type:"set-selected-plot-2d-mofa",mode:{...s,y:e.value}})},value:{label:"".concat(s.y),value:s.y},label:"Y axis"})}),(0,a.jsx)(i.Z,{sx:{width:"40%"},children:(0,a.jsx)(T.$S,{options:[{label:"No color",value:"No color"},...l.filter(e=>"categorical"==r[e].type).map(e=>({label:e,value:e}))],onChange:e=>{n(t=>({...t,g:e.value})),o({type:"set-selected-plot-2d-mofa",mode:{...s,g:e.value}})},value:{label:s.g,value:s.g},label:"Color by"})})]})}function SelectorFactor(e){let{factorNames:t,rowNames:l,selectedPlot:s,setSelectedPlot:n,setSelectedCell:o}=e;(0,x.mX)();let{mdataType:r}=(0,p.tc)();return(0,a.jsxs)(i.Z,{sx:{height:75,display:"flex",justifyContent:"space-around"},children:[(0,a.jsx)(i.Z,{sx:{width:"25%"},children:(0,a.jsx)(T.$S,{options:t.map(e=>({label:e,value:e})),onChange:e=>{n(t=>({...t,Factor:e.value})),o(l=>({...l,colIndex:t.map((e,t)=>[e,t]).filter(t=>t[0]==e.value)[0][1]}))},value:{label:"".concat(s.Factor),value:s.Factor},label:"Factor"})}),(0,a.jsx)(i.Z,{sx:{width:"40%"},children:(0,a.jsx)(T.$S,{options:l.filter(e=>"categorical"==r[e].type).map(e=>({label:e,value:e})),onChange:e=>{n(t=>({...t,mdataCol:e.value})),o(t=>({...t,rowIndex:l.map((e,t)=>[e,t]).filter(t=>t[0]==e.value)[0][1]}))},value:{label:s.mdataCol,value:s.mdataCol},label:"Group by"})})]})}var B=l(14132),I=l(73117),ScatterPlot_ScatterModeSelector=function(e){let{scatterMode:t,setScatterMode:l,disable2D:s}=e,n=(0,x.mX)();return(0,a.jsx)(i.Z,{sx:{textAlign:"center"},children:(0,a.jsx)(i.Z,{sx:{mb:2},children:(0,a.jsxs)(B.Z,{color:"primary",value:t,exclusive:!0,onChange:(e,t)=>{l(e.target.value),n({type:"set-scatter-mode-mofa",mode:e.target.value})},"aria-label":"Platform",children:[(0,a.jsx)(I.Z,{value:"1D",children:"1D"}),(0,a.jsx)(I.Z,{value:"2D",disabled:s,children:"2D"})]})})})},R=l(68448),N=l(45253),E=l(41125),V=l(16573),K=l(24235),q=l(33343),W=l(50039),X=l(86812),J=l(87586),G=l(561),Y=l(79857),$=l(53146),U=l(20626);let CustomTooltip=e=>{let{active:t,payload:l}=e;return t&&l&&l.length?(0,a.jsxs)(i.Z,{className:"custom-tooltip",sx:{backgroundColor:"rgba(5,5,5,0.8)",color:"rgba(250,250,250,0.8)",border:"1px solid rgba(50, 50, 50, 0.8)",padding:1,borderRadius:1},children:[(0,a.jsx)(c.Z,{variant:"h8",sx:{display:"block"},children:"".concat(l[0].payload.element)}),(0,a.jsx)(c.Z,{variant:"h9",sx:{display:"block"},children:"".concat(l[0].name,": ").concat("string"==typeof l[0].value?l[0].value:l[0].value.toFixed(3))}),(0,a.jsx)(c.Z,{variant:"h9",sx:{display:"block"},children:"".concat(l[1].name,": ").concat(l[1].value.toFixed(3))})]}):null};function MyScatter_MyScatter(e){let t,{scatterData:l,mdataCol:s,Factor:n}=e,[o,r]=(0,u.useState)(!1),c=(0,u.useRef)(),d=(0,p.tc)().mdataType[s].type;return"categorical"==d&&(t="category"),"numeric"==d&&(t="number"),(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(U.Mz,{showLabels:o,setShowLabels:r}),(0,a.jsx)($.LA,{scatterRef:c,name:"MOFA_1D"}),(0,a.jsx)(N.h,{width:"100%",height:400,children:(0,a.jsxs)(E.G,{ref:c,margin:{top:5,right:20,bottom:20,left:20},children:[(0,a.jsx)(V.q,{}),(0,a.jsx)(K.K,{type:t,dataKey:"mdataValue",name:s,allowDuplicatedCategory:!1,style:{fontFamily:"Calibri"},children:(0,a.jsx)(q._,{value:s,offset:-10,position:"insideBottom",style:{fontFamily:"Calibri"}})}),(0,a.jsx)(W.B,{type:"number",dataKey:"projection",name:"".concat(n),style:{fontFamily:"Calibri"},children:(0,a.jsx)(q._,{value:"".concat(n),offset:20,position:"insideLeft",angle:-90,style:{fontFamily:"Calibri"}})}),(0,a.jsx)(X.u,{cursor:{strokeDasharray:"3 3"},content:(0,a.jsx)(CustomTooltip,{})}),(0,a.jsx)(J.b,{data:l,fill:R.s[0],children:o&&(0,a.jsx)(G.e,{dataKey:"element",position:"right",style:{fontFamily:"Calibri"}})})]})})]})}function MyScatter2D(e){let{scatterData:t,selectedPlot2D:l}=e,[s,n]=(0,u.useState)(!1),o=(0,u.useRef)();return(0,a.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,a.jsxs)(i.Z,{sx:{width:600},children:[(0,a.jsx)(U.Mz,{showLabels:s,setShowLabels:n}),(0,a.jsx)($.LA,{scatterRef:o,name:"MOFA_2D"}),(0,a.jsxs)(E.G,{ref:o,width:600,height:500,margin:{top:5,right:20,bottom:20,left:20},children:[(0,a.jsx)(V.q,{}),(0,a.jsx)(K.K,{type:"number",dataKey:"x",name:"".concat(l.x),style:{fontFamily:"Calibri"},children:(0,a.jsx)(q._,{value:"".concat(l.x),offset:-10,position:"insideBottom",style:{fontFamily:"Calibri"}})}),(0,a.jsx)(W.B,{type:"number",dataKey:"y",name:"".concat(l.y),style:{fontFamily:"Calibri"},children:(0,a.jsx)(q._,{value:"".concat(l.y),offset:20,position:"insideLeft",angle:-90,style:{fontFamily:"Calibri"}})}),(0,a.jsx)(X.u,{cursor:{strokeDasharray:"3 3"},content:(0,a.jsx)(CustomTooltip,{})}),Object.keys(t).length>1&&(0,a.jsx)(Y.D,{verticalAlign:"top"}),Object.keys(t).map((e,l)=>(0,a.jsx)(J.b,{data:t[e],fill:R.s[l%R.s.length],name:e,children:s&&(0,a.jsx)(G.e,{dataKey:"element",position:"top",style:{fontFamily:"Calibri"}})},e))]})]})})}let Q=(0,M.ZP)(S.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function HelpSection_HelpSection(){let[e,t]=u.useState(!1),handleClose=()=>{t(!1)};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,a.jsx)(O.Z,{fontSize:"inherit"})}),(0,a.jsxs)(Q,{onClose:handleClose,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,a.jsx)(F.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA) - Loading Plot"}),(0,a.jsx)(m.Z,{"aria-label":"close",onClick:handleClose,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,a.jsx)(k.default,{})}),(0,a.jsxs)(A.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,a.jsx)(c.Z,{gutterBottom:!0,children:"This subsection allows you to visualize the projection of your samples onto the latent factors calculated by MOFA, providing insights into how these factors capture variability across your multi-omics data. The scatter plot can be viewed in two modes:"}),(0,a.jsx)(i.Z,{sx:{pl:3},children:(0,a.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"1D Mode (Default)"}),(0,a.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,a.jsx)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:"In this mode, the Y axis represents the projection of samples on a single selected factor, while the X axis displays the different sample groups. This view is particularly useful for comparing how different groups of samples project onto the selected factor."}),(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Further Exploration:"})," When using the 1D mode, you can explore the selected factor in greater detail using additional sections below, which include further analyses or visualizations related to the factor."]})]})]}),(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"2D Mode"}),(0,a.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,a.jsx)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:"This mode allows you to visualize the relationship between two factors simultaneously. You can select one factor to be displayed on the X axis and another on the Y axis."}),(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Color-Coding by Group"}),": The data points representing samples can be color-coded based on different grouping criteria, such as experimental conditions or metadata categories. This helps in identifying patterns, subgroups, or gradients within the data."]})]})]})]})})]}),(0,a.jsx)(P.Z,{children:(0,a.jsx)(i.Z,{sx:{textAlign:"justify",p:2},children:(0,a.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}let getScatterData=(e,t,l,a,i,s)=>{let n=null;if(l&&"1D"==t){n=[];let t=i.column(l.mdataCol),a={};t.index.map((e,l)=>{a[e]=t.values[l]}),Object.keys(e).map(t=>{n.push({element:t,mdataValue:a[t],projection:e[t][l.Factor]})}),"categorical"==s[l.mdataCol].type&&n.sort((e,t)=>s[l.mdataCol].levels.indexOf(e.mdataValue)-s[l.mdataCol].levels.indexOf(t.mdataValue))}else"2D"==t&&(n={},Object.keys(s).includes(a.g)?s[a.g].levels.map(t=>{n[t]=[...s[a.g].level2id[t].map(t=>Object.keys(e).includes(t)?{element:t,x:e[t][a.x],y:e[t][a.y]}:null).filter(e=>null!=e)]}):n[a.g]=Object.keys(e).map(t=>({element:t,x:e[t][a.x],y:e[t][a.y]})));return n};var ScatterPlot_ScatterPlotContainer=function(e){let{scatterMode:t,setScatterMode:l,selectedPlot:s,setSelectedPlot:n,setSelectedCell:o,selectedPlot2D:r,setSelectedPlot2D:c,factorNames:d,rowNames:x,projections:h}=e,{mdata:m}=(0,p.tc)().user,{mdataType:g}=(0,p.tc)(),j=(0,u.useMemo)(()=>getScatterData(h,t,s,r,m,g),[h,t,s,r,m,g]);return(0,a.jsxs)(i.Z,{sx:{},children:[(0,a.jsx)(i.Z,{sx:{height:0},children:(0,a.jsx)(HelpSection_HelpSection,{})}),(0,a.jsxs)(i.Z,{sx:{pt:2},children:[(0,a.jsx)(ScatterPlot_ScatterModeSelector,{scatterMode:t,setScatterMode:l,disable2D:Object.keys(Object.values(h)[0]).length<2}),(0,a.jsx)(i.Z,{sx:{px:3,pb:2,textAlign:"center",width:600,margin:"auto"},children:"1D"==t?(0,a.jsx)(SelectorFactor,{factorNames:d,rowNames:x,selectedPlot:s,setSelectedPlot:n,setSelectedCell:o}):(0,a.jsx)(SelectorFactor2D,{factorNames:d,rowNames:x,selectedPlot2D:r,setSelectedPlot2D:c})})]}),(0,a.jsx)(i.Z,{sx:{pb:2},children:j&&(0,a.jsx)(i.Z,{sx:{width:750,margin:"auto"},children:"1D"==t?(0,a.jsx)(MyScatter_MyScatter,{scatterData:j,mdataCol:s.mdataCol,Factor:s.Factor}):(0,a.jsx)(MyScatter2D,{scatterData:j,selectedPlot2D:r})})})]})},ee=l(65897),et=l(94576),el=l(67248),ea=l(38227),ei=l(20003),es=l(27978),en=l(19223),eo=l(45134);function valuetext(e){return"".concat(e)}var LoadingPlot_LoadingPlot=function(e){let{omic:t,fLVec:l,nFeatRef:s,thrLRef:n,plotHeatMap:o}=e,[r,d]=(0,u.useState)({down:0,up:0}),[x,h]=(0,u.useState)({down:0,up:0});(0,u.useEffect)(()=>{let e={down:Math.floor(.01*l.length),up:Math.floor(.01*l.length)};h(e),s.current[t]=e;let a={down:l[e.down][1],up:l[l.length-e.up-1][1]};d(a),n.current[t]=a},[l,s,t,n]),(0,u.useEffect)(()=>{let e=setTimeout(o,100);return()=>clearInterval(e)},[x,o]);let p=(0,u.useMemo)(()=>{let e=Math.min(200,l.length),t=Math.floor(l.length/e);return l.map(e=>({f:e[0],loading:Math.floor(1e4*e[1])/1e4,quantile:e[2]})).filter((e,a)=>a%t==0||a==l.length-1).map(e=>e.loading>r.down&&e.loading<r.up?{...e,qNS:e.quantile}:{...e,qS:e.quantile})},[l,r]),handleSlider=e=>{let[a,i]=e,o={down:Math.min(a,0),up:Math.max(i,0)};d(o),n.current[t]=o;let r={down:l.filter(e=>e[1]<o.down).length,up:l.filter(e=>e[1]>o.up).length};h(r),s.current[t]=r},handleClick=e=>{if(e<0){d(t=>({...t,down:e})),n.current[t].down=e;let a=l.filter(t=>t[1]<e).length;h(e=>({...e,down:a})),s.current[t].down=a}else{d(t=>({...t,up:e})),n.current[t].up=e;let a=l.filter(t=>t[1]>e).length;h(e=>({...e,up:a})),s.current[t].up=a}},handleNumber=(e,a)=>{let i=parseInt(e);if(isNaN(i)){h(e=>({...e,[a]:0}));return}if("down"==a){let e=l.filter(e=>e[1]<0);i>=0&&i<e.length?(h(e=>({...e,down:i})),s.current[t].down=i,d(t=>({...t,down:e[i][1]})),n.current[t].down=e[i][1]):i>=e.length&&(h(t=>({...t,down:e.length})),s.current[t].down=e.length,d(e=>({...e,down:0})),n.current[t].down=0)}if("up"==a){let e=l.filter(e=>e[1]>0);i>=0&&i<e.length?(h(e=>({...e,up:i})),s.current[t].up=i,d(t=>({...t,up:e[e.length-i-1][1]})),n.current[t].up=e[e.length-i-1][1]):i<0?(h(e=>({...e,up:0})),s.current[t].up=0,d(t=>({...t,up:e[e.length-1][1]})),n.current[t].up=e[e.length-1][1]):i>=e.length&&(h(t=>({...t,up:e.length})),s.current[t].up=e.length,d(e=>({...e,up:0})),n.current[t].up=0)}},m=Math.ceil(1e3*Math.max(Math.abs(l[0][1]),Math.abs(l[l.length-1][1])))/1e3;return(0,a.jsx)(i.Z,{sx:{overflow:"auto"},children:(0,a.jsxs)(i.Z,{sx:{mt:1,display:"block",m:"auto",width:400},children:[(0,a.jsx)(i.Z,{sx:{width:400,position:"relative"},children:(0,a.jsxs)(ea.w,{data:p,margin:{top:5,right:30,left:20,bottom:20},width:400,height:200,onClick:e=>null!=e&&handleClick(e.activeLabel),children:[(0,a.jsx)(V.q,{strokeDasharray:"3 3"}),(0,a.jsx)(K.K,{dataKey:"loading",type:"number",name:"Loadings",domain:[-m,m],label:{value:"Loading",position:"insideBottom",offset:-10},ticks:(0,eo.jI)(-m,m,6)}),(0,a.jsx)(W.B,{type:"number",label:{value:"Quantile",position:"insideLeft",angle:-90,dy:30,offset:-5}}),(0,a.jsx)(ei.z,{x1:r.down,x2:r.up,y1:0,y2:1}),(0,a.jsx)(es.d,{x:0,stroke:"#333333",strokeDasharray:"3 3"}),(0,a.jsx)(en.x,{type:"monotone",dataKey:"quantile",stroke:"#aaaaaa",dot:!1,strokeWidth:1}),(0,a.jsx)(en.x,{type:"monotone",dataKey:"qS",stroke:"#8884d8",dot:!1,strokeWidth:3})]})}),(0,a.jsx)(i.Z,{sx:{width:290,position:"relative",left:80},children:(0,a.jsx)(et.ZP,{track:"inverted",value:[Math.floor(1e3*r.down)/1e3,Math.ceil(1e3*r.up)/1e3],getAriaValueText:valuetext,valueLabelDisplay:"auto",step:.001,min:-m,max:m,onChange:e=>handleSlider(e.target.value)})}),(0,a.jsxs)(i.Z,{sx:{width:290,position:"relative",left:80,display:"flex",textAlign:"center",justifyContent:"space-around"},children:[(0,a.jsxs)(i.Z,{sx:{width:"33%"},children:[(0,a.jsx)(c.Z,{variant:"body2",children:"Negatively Associated"}),(0,a.jsx)(el.Z,{size:"small",value:x.down,inputProps:{min:0,style:{textAlign:"center",width:45,height:12}},onChange:e=>handleNumber(e.target.value,"down")})]}),(0,a.jsxs)(i.Z,{sx:{width:"33%"},children:[(0,a.jsx)(c.Z,{variant:"body2",children:"Positively Associated"}),(0,a.jsx)(el.Z,{size:"small",value:x.up,inputProps:{min:0,style:{textAlign:"center",width:45,height:12}},onChange:e=>handleNumber(e.target.value,"up")})]})]})]})})};let er=(0,M.ZP)(S.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function LoadingPlot_HelpSection_HelpSection(){let[e,t]=u.useState(!1),handleClose=()=>{t(!1)};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,a.jsx)(O.Z,{fontSize:"inherit"})}),(0,a.jsxs)(er,{onClose:handleClose,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,a.jsx)(F.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA) - Loading Plot"}),(0,a.jsx)(m.Z,{"aria-label":"close",onClick:handleClose,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,a.jsx)(k.default,{})}),(0,a.jsxs)(A.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,a.jsxs)(c.Z,{gutterBottom:!0,children:["This subsection provides insights into how individual biomolecules contribute to each latent factor calculated by MOFA. For each omic, users can visualize the",(0,a.jsx)("strong",{children:"loading distribution"})," of biomolecules, which represents the strength and direction (positive or negative) of their association within the selected factor."]}),(0,a.jsxs)(c.Z,{gutterBottom:!0,children:["Users can ",(0,a.jsx)("strong",{children:"select the top most positively and negatively associated"})," biomolecules for the chosen factor within each omic. This selection is crucial for deeper analysis as these biomolecules are the key drivers of the factor’s influence. The selected biomolecules are used to generate a heatmap, allowing for visual exploration of their expression patterns across samples."]}),(0,a.jsxs)(c.Z,{gutterBottom:!0,children:["At the bottom of the page, a button directs users to a ",(0,a.jsx)("strong",{children:"detailed exploratory subsection"})," where the selected biomolecules can be further analyzed, helping to reveal more about their roles and significance within the dataset."]})]}),(0,a.jsx)(P.Z,{children:(0,a.jsx)(i.Z,{sx:{textAlign:"justify",p:2},children:(0,a.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}var LoadingPlot_LoadingPlotContainer=function(e){let{fLVec:t,nFeatRef:l,thrLRef:s,plotHeatMap:n}=e,{omics:o}=(0,p.tc)(),{OMIC2NAME:r}=(0,h.S)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{sx:{height:0},children:(0,a.jsx)(LoadingPlot_HelpSection_HelpSection,{})}),(0,a.jsx)(i.Z,{sx:{my:3,display:"flex",justifyContent:"space-evenly"},children:o.map((e,o)=>(0,a.jsxs)(i.Z,{sx:{width:"31%"},children:[(0,a.jsx)(c.Z,{variant:"h6",sx:{textAlign:"center"},children:r[e]}),(0,a.jsx)(LoadingPlot_LoadingPlot,{omic:e,fLVec:t[e],nFeatRef:l,thrLRef:s,plotHeatMap:n})]},o))})]})},ec=l(38083);function MyHeatMap(e){let{omic:t,myIndex:l,myFeat:s,mdataCol:n,zLegend:o}=e,r=2*(0,p.tc)().omics.length,c=(0,p.tc)().norm["x".concat(t)],d=(0,p.tc)().mdataType[n],x=(0,u.useMemo)(()=>getHmData(l,s,c,d),[l,s,c,d]);return(0,a.jsx)(i.Z,{sx:{height:510,width:1160/r,marginRight:.5,border:"2px solid #444444"},children:(0,a.jsx)(ec.Tu,{data:x,margin:{top:0,right:0,bottom:0,left:0},axisTop:{tickSize:0,tickPadding:0,tickRotation:0,legend:"",legendOffset:0},colors:{type:"diverging",scheme:"red_blue",minValue:-o.max,maxValue:-o.min},emptyColor:"#555555",isInteractive:!1,animate:!1,enableLabels:!1})})}let HeatMapIndex=e=>{let{myIndex:t,mdataCol:l,showBorder:i,showLevel:s}=e,n=(0,p.tc)().mdataType[l],o=(0,u.useMemo)(()=>getHmData(t,[],null,n),[t,n]),r=[];r=s?o.map(e=>e.id.split("##")).map(e=>e[e.length-1]):o.map(e=>e.id.split("##")).map(e=>e.slice(0,-1).join("##"));let c={};r.forEach(e=>{c[e]=(c[e]||0)+1});let d=[...new Set(r)];return(0,a.jsx)(a.Fragment,{children:d.length<=24&&(0,a.jsx)("table",{children:(0,a.jsx)("tbody",{children:d.map((e,t)=>(0,a.jsx)("tr",{style:{pading:0,height:500*c[e]/r.length,borderTop:i&&"2px solid #444444",borderBottom:i&&"2px solid #444444"},children:(0,a.jsx)("td",{style:{paddingRight:5,fontSize:Math.min(10*Math.pow(c[e],1/4),14)},children:e})},t))})})})},getHmData=(e,t,l,a)=>{let i={};return e.map(e=>{i[e]=[]}),t.map(t=>{let a=l.column(t);a.index.map((e,t)=>[e,a.values[t]]).filter(t=>e.includes(t[0])).map(e=>{i[e[0]].push({x:t,y:-e[1]})})}),"categorical"==a.type?i=a.levels.map(t=>a.level2id[t].filter(t=>e.includes(t)).map(e=>({id:"".concat(e,"##").concat(t),data:i[e]}))).flat():"numeric"==a.type&&(i=e.map(e=>({id:e,data:i[e]}))),i};var HeatMap_HeatMapHeader=function(e){let{nFeatRef:t}=e,{OMIC2NAME:l}=(0,h.S)(),s=(0,p.tc)().omics;return(0,a.jsxs)(i.Z,{sx:{mt:1,display:"flex",justifyContent:"center",textAlign:"center"},children:[(0,a.jsx)(i.Z,{sx:{width:"5%"}}),s.map(e=>(0,a.jsx)(i.Z,{children:(t.current[e].up>0||t.current[e].down>0)&&(0,a.jsxs)(i.Z,{sx:{marginRight:.5},children:[(0,a.jsx)(i.Z,{children:(0,a.jsx)(c.Z,{variant:"h6",children:l[e]})}),(0,a.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"space-around"},children:[t.current[e].down>0&&(0,a.jsx)(i.Z,{sx:{width:1160/(2*s.length),marginRight:.5},children:(0,a.jsx)(i.Z,{children:"Negatively Associated"})}),t.current[e].up>0&&(0,a.jsx)(i.Z,{sx:{width:1160/(2*s.length)},children:(0,a.jsx)(i.Z,{children:"Positively Associated"})})]})]},e)},e)),(0,a.jsx)(i.Z,{sx:{width:"5%"}})]})};let HeatMapLegend_Legend=e=>{let{a:t,b:l,updateZLegend:i,omic:s,plotHeatMap:n}=e,[o,r]=(0,u.useState)({min:t,max:l}),c=(0,x.mX)(),handleInput=(e,t)=>{let l=Number(t);r(l=>({...l,[e]:t})),"number"!=typeof l||isNaN(l)||(i(t=>{t[s][e]=l}),c({type:"update-zlegend",omic:s,minmax:e,numValue:l}),n())};return(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:"10px",background:"linear-gradient(to right, #053061 0%, #296fad 12%, #7cb6d6 24%, #97c6df 36%, #ffffff 50%, #f7bca1 62%, #f3ab8d 74%, #cf5349 86%, #67001f 100%)",color:"#fff",height:"15px"},children:[(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",style:{width:30,height:20,textAlign:"center"},value:o.min,onChange:e=>handleInput("min",e.target.value)})}),(0,a.jsx)("div",{style:{color:"black"},children:((t+l)/2).toFixed(0)}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",style:{width:30,height:20,textAlign:"center"},value:o.max,onChange:e=>handleInput("max",e.target.value)})})]})};var HeatMap_HeatMapLegend=e=>{let{nFeatRef:t,zLegend:l,updateZLegend:s,plotHeatMap:n}=e,o=(0,p.tc)().omics;return(0,a.jsxs)(i.Z,{sx:{mt:1,display:"flex",justifyContent:"center",textAlign:"center"},children:[(0,a.jsx)(i.Z,{sx:{width:"5%"}}),o.map(e=>(0,a.jsx)(i.Z,{sx:{mr:.7},children:(t.current[e].up>0||t.current[e].down>0)&&(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(HeatMapLegend_Legend,{a:l[e].min,b:l[e].max,updateZLegend:s,omic:e,plotHeatMap:n}),(0,a.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"space-around"},children:[t.current[e].down>0&&(0,a.jsx)(i.Z,{sx:{width:1160/(2*o.length)}}),t.current[e].up>0&&(0,a.jsx)(i.Z,{sx:{width:1160/(2*o.length)}})]})]})},e)),(0,a.jsx)(i.Z,{sx:{width:"5%"}})]})},ed=l(36970);let eu=(0,M.ZP)(S.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function HeatMap_HelpSection_HelpSection(){let[e,t]=u.useState(!1),handleClose=()=>{t(!1)};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,a.jsx)(O.Z,{fontSize:"inherit"})}),(0,a.jsxs)(eu,{onClose:handleClose,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,a.jsx)(F.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA) - Heatmap"}),(0,a.jsx)(m.Z,{"aria-label":"close",onClick:handleClose,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,a.jsx)(k.default,{})}),(0,a.jsxs)(A.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,a.jsx)(c.Z,{gutterBottom:!0,children:"This subsection visualizes the quantitative values of the biomolecules selected in the Loading Plot Distribution section, providing a comprehensive overview of their expression patterns across samples."}),(0,a.jsxs)(i.Z,{sx:{pl:3},children:[(0,a.jsx)(c.Z,{gutterBottom:!0,children:(0,a.jsx)("strong",{children:"Heatmap Representation:"})}),(0,a.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Columns"}),": Each column represents a biomolecule from the selected omics, showcasing their quantitative values."]}),(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Rows"}),": Each row corresponds to a sample, grouped according to the metadata variable selected at the top of the section."]}),(0,a.jsxs)(L.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,a.jsx)("strong",{children:"Color Range Customization"}),": The heatmap’s color range can be adjusted using the legend at the bottom."]})]}),(0,a.jsx)(c.Z,{gutterBottom:!0,children:"Located at the bottom of the section, the Explore Features button allows for an in-depth exploration of the biomolecules displayed in the heatmap. Clicking it will take you to a detailed analysis section, where you can further investigate the selected biomolecules and delve into their biological significance."})]})]}),(0,a.jsx)(P.Z,{children:(0,a.jsx)(i.Z,{sx:{textAlign:"justify",p:2},children:(0,a.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}var HeatMap_HeatMapContainer=function(e){let{nFeatRef:t,fLVec:l,mdataCol:s,plotHeatMap:n}=e,{omics:o}=(0,p.tc)();(0,p.tc)().user.mdata.columns[0];let r=(0,x.a0)().MOFA.displayOpts.zLegend,[d,h]=(0,ed.x)(o.reduce((e,t)=>({...e,[t]:{min:r[t].min,max:r[t].max}}),{})),m=(0,p.tc)().norm,g=(0,u.useMemo)(()=>o.map(e=>m["x".concat(e)].index).reduce((e,t)=>e.filter(e=>t.includes(e))),[o,m]),j=(0,u.useMemo)(()=>{let e={};return o.map(a=>{e[a]={down:l[a].filter((e,l)=>l<t.current[a].down).map(e=>e[0]),up:l[a].filter((e,i)=>i>=l[a].length-t.current[a].up).map(e=>e[0])}}),e},[o,t,l]),f=o.some(e=>j[e].down.length>0||j[e].up.length>0);return f?(0,a.jsxs)(i.Z,{sx:{overflowX:"auto"},children:[(0,a.jsx)(i.Z,{sx:{height:0},children:(0,a.jsx)(HeatMap_HelpSection_HelpSection,{})}),(0,a.jsx)(i.Z,{sx:{position:"relative",top:7,left:60,width:0,zIndex:0},children:(0,a.jsx)($.Z2,{name:"MOFA"})}),(0,a.jsxs)(i.Z,{className:"printable",sx:{width:1400,margin:"auto",overflowY:"hidden"},children:[(0,a.jsx)(HeatMap_HeatMapHeader,{nFeatRef:t}),(0,a.jsxs)(i.Z,{sx:{mt:1,display:"flex",justifyContent:"center"},children:[(0,a.jsx)(i.Z,{sx:{width:"5%",display:"flex",justifyContent:"flex-end"},children:(0,a.jsx)(HeatMapIndex,{myIndex:g,mdataCol:s,showBorder:!0,showLevel:!0})}),o.map(e=>(0,a.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"center"},children:[t.current[e].down>0&&(0,a.jsx)(MyHeatMap,{omic:e,myIndex:g,myFeat:j[e].down,mdataCol:s,zLegend:d[e]}),t.current[e].up>0&&(0,a.jsx)(MyHeatMap,{omic:e,myIndex:g,myFeat:j[e].up,mdataCol:s,zLegend:d[e]})]},e)),(0,a.jsx)(i.Z,{sx:{width:"5%",display:"flex",justifyContent:"flex-start"},children:(0,a.jsx)(HeatMapIndex,{myIndex:g,mdataCol:s,showBorder:!1,showLevel:!1})})]}),(0,a.jsx)(HeatMap_HeatMapLegend,{nFeatRef:t,zLegend:d,updateZLegend:h,plotHeatMap:n})]})]}):(0,a.jsx)(i.Z,{sx:{textAlign:"center",mt:5},children:(0,a.jsx)(c.Z,{variant:"h6",color:"text.secondary",children:"Please select a cell from the 'Factor/Condition' table to display the heatmap and feature plots."})})},ex=l(28811),eh=l.n(ex);let ep=eh()(()=>Promise.all([l.e(813),l.e(261),l.e(374),l.e(224),l.e(794),l.e(956)]).then(l.bind(l,61410)),{loadableGenerated:{webpack:()=>[61410]}}),getFactorNames=e=>{if(null==e)return[null,null];let t=Object.keys(e.anova),l=Object.keys(e.explained_variance);t=t.map(t=>({f:t,var:l.reduce((l,a)=>l+e.explained_variance[a][t].Explained_Variance,0)})).filter(e=>e.var>1.5).map(e=>e.f);let a=t.map((e,t)=>t+1);return[a,t]},getRowNames=(e,t)=>null==e?null:Object.keys(e.anova[t[0]]).map(l=>[l,t.map(t=>0==Object.keys(e.anova[t][l]).length).every(e=>e)]).filter(e=>!e[1]).map(e=>e[0]),getFLVec=(e,t,l)=>{if(null==e||null==t)return null;let a=l.reduce((e,t)=>({...e,[t]:[]}),{});return Object.keys(a).map(l=>{a[l]=Object.keys(e.loadings[l][t.Factor]).map(a=>[a,e.loadings[l][t.Factor][a]]),a[l].sort((e,t)=>e[1]-t[1]),a[l]=a[l].map((e,t)=>[...e,(t+1)/a[l].length])}),a};var MOFA_MOFA=function(){let e=(0,x.mX)(),{API_URL:t}=(0,h.S)(),{jobID:l}=(0,p.tc)(),m=(0,x.a0)().MOFA.data,[g,j]=(0,u.useState)(m),f=(0,x.a0)().MOFA.displayOpts.scatterMode,[y,b]=(0,u.useState)(f),Z=(0,x.a0)().MOFA.displayOpts.selectedPlot,[v,C]=(0,u.useState)(Z),w=(0,x.a0)().MOFA.displayOpts.selectedCell,[M,S]=(0,u.useState)(w),F=(0,x.a0)().MOFA.displayOpts.selectedPlot2D,[A,P]=(0,u.useState)(F),k=(0,u.useCallback)(async()=>{if(console.log("Fetching MOFA data"),null==m){let a=await fetch("".concat(t,"/get_mofa/").concat(l)),i=await a.json();j(i.dataMOFA),e({type:"set-mofa-data",data:i.dataMOFA})}},[m,t,e,l]);(0,u.useEffect)(()=>{let e=setTimeout(k,100);return()=>clearTimeout(e)},[k]);let[D,L]=(0,u.useMemo)(()=>getFactorNames(g),[g]),O=(0,u.useMemo)(()=>getRowNames(g,L),[g,L]);null!=L&&null!=O&&null==v&&(C({mdataCol:O[0],Factor:L[0]}),S({rowIndex:0,colIndex:0})),(0,u.useEffect)(()=>{if(null!=L&&null!=O&&null==A){let t={x:L[0],y:L.length>1?L[1]:L[0],g:"No color"};P(t),e({type:"set-selected-plot-2d-mofa",mode:t})}},[L,O,A,e]);let[H,_]=(0,u.useState)(!1),z=(0,u.useCallback)(()=>{_(e=>!e)},[_]);(0,u.useEffect)(()=>{let e=setTimeout(z,1e3);return()=>clearTimeout(e)},[_,z]),(0,u.useEffect)(()=>{null!=v&&null!=M&&(z(),e({type:"set-selected-plot-cell-mofa",rowIndex:M.rowIndex,colIndex:M.colIndex,mdataCol:v.mdataCol,Factor:v.Factor}))},[v,M,e,z]);let{omics:T}=(0,p.tc)(),B=(0,u.useRef)(T.reduce((e,t)=>({...e,[t]:{down:0,up:0}}),{})),I=(0,u.useRef)(T.reduce((e,t)=>({...e,[t]:{down:0,up:0}}),{})),R=(0,u.useMemo)(()=>getFLVec(g,v,T),[g,v,T]),[N,E]=(0,u.useState)(!1),[V,K]=(0,u.useState)(!1);return(0,a.jsx)(i.Z,{children:(0,a.jsx)(ee.c,{height:"80vh",children:null!=g&&null!=v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ee.E,{children:[(0,a.jsx)(i.Z,{sx:{height:3},children:(0,a.jsx)(HelpSection,{})}),(0,a.jsx)(i.Z,{sx:{p:5},children:(0,a.jsx)(TablePvalues,{anova:g.anova,explained_variance:g.explained_variance,setSelectedPlot:C,selectedCell:M,setSelectedCell:S,scatterMode:y,rowNames:O,colNames:D,factorNames:L})})]}),(0,a.jsxs)(ee.E,{children:[(0,a.jsx)(s.Z,{children:"Projections"}),(0,a.jsx)(i.Z,{sx:{mt:2},children:(0,a.jsx)(ScatterPlot_ScatterPlotContainer,{scatterMode:y,setScatterMode:b,selectedPlot:v,setSelectedPlot:C,setSelectedCell:S,selectedPlot2D:A,setSelectedPlot2D:P,rowNames:O,factorNames:L,projections:g.projections})})]}),"1D"==y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ee.E,{sx:{mt:1},children:[(0,a.jsxs)(s.Z,{variant:"h6",sx:{textAlign:"center"},children:["Feature Loading Analysis: ",v.Factor]}),(0,a.jsx)(LoadingPlot_LoadingPlotContainer,{fLVec:R,nFeatRef:B,thrLRef:I,plotHeatMap:z})]}),(0,a.jsxs)(ee.E,{children:[(0,a.jsx)(s.Z,{children:"HeatMap"}),(0,a.jsx)(HeatMap_HeatMapContainer,{nFeatRef:B,fLVec:R,mdataCol:v.mdataCol,plotHM:H,plotHeatMap:z})]}),(0,a.jsxs)(ee.E,{children:[(0,a.jsx)(i.Z,{sx:{textAlign:"center",mt:2},children:(0,a.jsx)(n.Z,{color:"primary",variant:"outlined",endIcon:(0,a.jsx)(d.Z,{}),onClick:()=>{K(!0),E(!0)},children:"Explore Features"})}),(0,a.jsx)(o.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:V,children:(0,a.jsxs)(i.Z,{sx:{textAlign:"center"},children:[(0,a.jsx)(r.Z,{color:"inherit"}),(0,a.jsx)(i.Z,{sx:{pt:2},children:(0,a.jsx)(c.Z,{children:"Loading features..."})})]})}),N&&(0,a.jsx)(ep,{exploreF:N,setExploreF:E,Factor:v.Factor,mdataCol:v.mdataCol,thrLRef:I.current,setEFLoading:K})]})]})]})})})}}}]);