"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[66],{73553:function(e,t,o){o.d(t,{Z:function(){return Core}}),o(57855),o(58563),o(88901),o(11297),o(84213),o(21511),o(7519),o(49573),o(53652),o(22548);var r=o(5566),n=o(98179),l=o(2518),i=o(2228),s=o(24692),a=o(49773),u=o(69488),c=o(18407),d=o(99440),h=o(84350),f=o(55915),g=o(36903),m=o(57416),p=o(92740),w=o(66411),C=o(67790),y=o(70998),v=o(63891),R=o(77628),b=o(26769),S=o(3732),I=o(27431),H=o(54317),x=o(78444),M=o(31870),A=o(94198),E=o(82230),k=o(90243),_=o(60045),T=o(39620),V=o(53996),D=o(18435),F=o(2488),L=o(29949),P=o(28805);let N=null,O=new Map;function Core(e,t){let o,j,Q,B,K,$;var Z,z=this;let W=arguments.length>2&&void 0!==arguments[2]&&arguments[2],U=this,q=new a.Z(U),G=!0;(0,S.dU)(W)&&(0,S.IU)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let Y=null!==(Z=null==t?void 0:t.layoutDirection)&&void 0!==Z?Z:"inherit",J=["rtl","ltr"].includes(Y)?Y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",J),this.isRtl=function(){return"rtl"===J},this.isLtr=function(){return!U.isRtl()},this.getDirectionFactor=function(){return U.isLtr()?1:-1},t.language=(0,x.gr)(t.language);let X=new E.Z(U,t,[k.$,_._]),ee=X.getTableMeta(),et=X.getGlobalMeta(),eo=(0,F.I)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,S._v)(this)&&(0,l.ge)(t.licenseKey,e),this.guid=`ht_${(0,w.O1)()}`,O.set(this.guid,this),this.columnIndexMapper=new b.d,this.rowIndexMapper=new b.d,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{U.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{U.runHooks("afterRowSequenceChange",e)}),j=new v.Z(U),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let er=new A.Z(ee,{rowIndexMapper:U.rowIndexMapper,columnIndexMapper:U.columnIndexMapper,countCols:()=>U.countCols(),countRows:()=>U.countRows(),propToCol:e=>o.propToCol(e),isEditorOpened:()=>!!U.getActiveEditor()&&U.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return z.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return z.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>U.getShortcutManager(),createCellCoords:(e,t)=>U._createCellCoords(e,t),createCellRange:(e,t,o)=>U._createCellRange(e,t,o),visualToRenderableCoords:e=>{let{row:t,col:o}=e;return U._createCellCoords(t>=0?U.rowIndexMapper.getRenderableFromVisualIndex(t):t,o>=0?U.columnIndexMapper.getRenderableFromVisualIndex(o):o)},renderableToVisualCoords:e=>{let{row:t,col:o}=e;return U._createCellCoords(t>=0?U.rowIndexMapper.getVisualFromRenderableIndex(t):t,o>=0?U.columnIndexMapper.getVisualFromRenderableIndex(o):o)},findFirstNonHiddenRenderableRow:(e,t)=>{let o=t>e?1:-1,r=Math.min(e,t),n=Math.max(e,t),l=U.rowIndexMapper.getNearestNotHiddenIndex(e,o);return null===l||1===o&&l>n||-1===o&&l<r?null:l>=0?U.rowIndexMapper.getRenderableFromVisualIndex(l):l},findFirstNonHiddenRenderableColumn:(e,t)=>{let o=t>e?1:-1,r=Math.min(e,t),n=Math.max(e,t),l=U.columnIndexMapper.getNearestNotHiddenIndex(e,o);return null===l||1===o&&l>n||-1===o&&l<r?null:l>=0?U.columnIndexMapper.getRenderableFromVisualIndex(l):l},isDisabledCellSelection:(e,t)=>e<0||t<0?U.getSettings().disableVisualSelection:U.getCellMeta(e,t).disableVisualSelection});this.selection=er;let onIndexMapperCacheUpdate=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.commit()};function setClassName(e,t){let o="className"===e?U.rootElement:U.table;if(G)(0,r.cn)(o,t);else{let n=[],l=[];et[e]&&(n=Array.isArray(et[e])?et[e]:(0,d.W7)(et[e])),t&&(l=Array.isArray(t)?t:(0,d.W7)(t));let i=(0,d.o0)(n,l),s=(0,d.o0)(l,n);i.length&&(0,r.IV)(o,i),s.length&&(0,r.cn)(o,s)}et[e]=t}function ValidatorsQueue(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function validateChanges(e,t,r){if(!e.length){r();return}let n=U.getActiveEditor(),l=new ValidatorsQueue,i=!0;l.onQueueEmpty=()=>{n&&i&&n.cancelChanges(),r()};for(let r=e.length-1;r>=0;r--){let n;let[s,a,,u]=e[r],c=o.propToCol(a);"numeric"===(n=Number.isInteger(c)?U.getCellMeta(s,c):{...Object.getPrototypeOf(ee),...ee}).type&&"string"==typeof u&&(0,C.TR)(u)&&(e[r][3]=function(e){let t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}(u)),U.getCellValidator(n)&&(l.addValidatorToQueue(),U.validateCell(e[r][3],n,function(t,o){return function(r){if("boolean"!=typeof r)throw Error("Validation error: result is not boolean");!1===r&&!1===o.allowInvalid&&(i=!1,e.splice(t,1),o.valid=!0),l.removeValidatorFormQueue()}}(r,n),t))}l.checkIfQueueIsEmpty()}function applyChanges(e,t){for(let r=e.length-1;r>=0;r--){let n=!1;if(null===e[r]){e.splice(r,1);continue}if(null!==e[r][2]&&void 0!==e[r][2]||null!==e[r][3]&&void 0!==e[r][3]){if(ee.allowInsertRow)for(;e[r][0]>U.countRows()-1;){let{delta:e}=o.createRow(void 0,void 0,{source:t});if(0===e){n=!0;break}}if("array"===U.dataType&&(!ee.columns||0===ee.columns.length)&&ee.allowInsertColumn)for(;o.propToCol(e[r][1])>U.countCols()-1;){let{delta:e}=o.createCol(void 0,void 0,{source:t});if(0===e){n=!0;break}}n||o.set(e[r][0],e[r][1],e[r][3])}}let r=e.length>0;if(U.forceFullRender=!0,r){Q.adjustRowsAndCols(),U.runHooks("beforeChangeRender",e,t),B.closeEditor(),U.view.render(),B.prepareEditor(),U.view.adjustElementsSize(),U.runHooks("afterChange",e,t||"edit");let o=U.getActiveEditor();o&&(0,l.$K)(o.refreshValue)&&o.refreshValue()}else U.view.render()}function setDataInputToArray(e,t,o){return Array.isArray(e)?e:[[e,t,o]]}function processChanges(e,t){let o=U.getActiveEditor(),r=U.runHooks("beforeChange",e,t||"edit"),n=e.filter(e=>null!==e);return!1===r||0===n.length?(o&&o.cancelChanges(),[]):n}this.columnIndexMapper.addLocalHook("cacheUpdated",onIndexMapperCacheUpdate),this.rowIndexMapper.addLocalHook("cacheUpdated",onIndexMapperCacheUpdate),this.selection.addLocalHook("afterSetRangeEnd",(e,t)=>{let o=(0,u.sm)(!1),n=this.selection.getSelectedRange(),{from:l,to:i}=n.current(),s=n.size()-1;this.runHooks("afterSelection",l.row,l.col,i.row,i.col,o,s),this.runHooks("afterSelectionByProp",l.row,U.colToProp(l.col),i.row,U.colToProp(i.col),o,s),t&&(!o.isTouched()||o.isTouched()&&!o.value)&&$.scrollTo(e);let a=er.isSelectedByRowHeader(),c=er.isSelectedByColumnHeader();a&&c?(0,r.cn)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):a?((0,r.IV)(this.rootElement,"ht__selection--columns"),(0,r.cn)(this.rootElement,"ht__selection--rows")):c?((0,r.IV)(this.rootElement,"ht__selection--rows"),(0,r.cn)(this.rootElement,"ht__selection--columns")):(0,r.IV)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==er.getSelectionSource()&&B.closeEditor(null),U.view.render(),B.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)}),this.selection.addLocalHook("afterSetFocus",e=>{let t=(0,u.sm)(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&$.scrollTo(e),B.closeEditor(),U.view.render(),B.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",e=>{let t=e.length-1,{from:o,to:r}=e[t];this.runHooks("afterSelectionEnd",o.row,o.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",o.row,U.colToProp(o.col),r.row,U.colToProp(r.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{let t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("afterDeselect",()=>{B.closeEditor(),U.view.render(),(0,r.IV)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("beforeSetRangeStart",...t)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("beforeSetRangeStartOnly",...t)}).addLocalHook("beforeSetRangeEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("beforeSetRangeEnd",...t)}).addLocalHook("beforeSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("beforeSelectColumns",...t)}).addLocalHook("afterSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("afterSelectColumns",...t)}).addLocalHook("beforeSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("beforeSelectRows",...t)}).addLocalHook("afterSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("afterSelectRows",...t)}).addLocalHook("beforeModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("modifyTransformStart",...t)}).addLocalHook("afterModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("afterModifyTransformStart",...t)}).addLocalHook("beforeModifyTransformFocus",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("modifyTransformFocus",...t)}).addLocalHook("afterModifyTransformFocus",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("afterModifyTransformFocus",...t)}).addLocalHook("beforeModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("modifyTransformEnd",...t)}).addLocalHook("afterModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("afterModifyTransformEnd",...t)}).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("beforeRowWrap",...t)}).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return z.runHooks("beforeColumnWrap",...t)}).addLocalHook("insertRowRequire",e=>this.alter("insert_row_above",e,1,"auto")).addLocalHook("insertColRequire",e=>this.alter("insert_col_start",e,1,"auto")),Q={alter(e,t){var r,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,normalizeIndexesGroup=e=>{if(0===e.length)return[];let t=[...e];t.sort((e,t)=>{let[o]=e,[r]=t;return o===r?0:o>r?1:-1});let o=(0,d.k$)(t,(e,t)=>{let[o,r]=t,n=e[e.length-1],[l,i]=n,s=l+i;if(o<=s){let e=Math.max(r-(s-o),0);n[1]+=e}else e.push([o,r]);return e},[t[0]]);return o};switch(e){case"insert_row_below":case"insert_row_above":let u=U.countSourceRows();if(ee.maxRows===u)return;let c="insert_row_below"===e?"below":"above";t=null!==(r=t)&&void 0!==r?r:"below"===c?u:0;let{delta:h,startPhysicalIndex:f}=o.createRow(t,i,{source:s,mode:c});er.shiftRows(U.toVisualRow(f),h);break;case"insert_col_start":case"insert_col_end":let g="insert_col_end"===e?"end":"start";t=null!==(n=t)&&void 0!==n?n:"end"===g?U.countSourceCols():0;let{delta:m,startPhysicalIndex:p}=o.createCol(t,i,{source:s,mode:g});if(m){if(Array.isArray(ee.colHeaders)){let e=[U.toVisualColumn(p),0];e.length+=m,Array.prototype.splice.apply(ee.colHeaders,e)}er.shiftColumns(U.toVisualColumn(p),m)}break;case"remove_row":let removeRow=e=>{let t=0;(0,d.Bk)(e,e=>{let[r,n]=e,i=(0,l.xb)(r)?U.countRows()-1:Math.max(r-t,0);Number.isInteger(r)&&(r=Math.max(r-t,0));let a=o.removeRow(r,n,s);if(!a)return;if(er.isSelected()){let{row:e}=U.getSelectedRangeLast().highlight;e>=r&&e<=r+n-1&&B.closeEditor(!0)}let u=U.countRows();0===u?er.deselect():"ContextMenu.removeRow"===s?er.refresh():er.shiftRows(r,-n);let c=ee.fixedRowsTop;c>=i+1&&(ee.fixedRowsTop-=Math.min(n,c-i));let d=ee.fixedRowsBottom;d&&i>=u-d&&(ee.fixedRowsBottom-=Math.min(n,d)),t+=n})};Array.isArray(t)?removeRow(normalizeIndexesGroup(t)):removeRow([[t,i]]);break;case"remove_col":let removeCol=e=>{let t=0;(0,d.Bk)(e,e=>{let[r,n]=e,i=(0,l.xb)(r)?U.countCols()-1:Math.max(r-t,0),a=U.toPhysicalColumn(i);Number.isInteger(r)&&(r=Math.max(r-t,0));let u=o.removeCol(r,n,s);if(!u)return;if(er.isSelected()){let{col:e}=U.getSelectedRangeLast().highlight;e>=r&&e<=r+n-1&&B.closeEditor(!0)}let c=U.countCols();0===c?er.deselect():"ContextMenu.removeColumn"===s?er.refresh():er.shiftColumns(r,-n);let d=ee.fixedColumnsStart;d>=i+1&&(ee.fixedColumnsStart-=Math.min(n,d-i)),Array.isArray(ee.colHeaders)&&(void 0===a&&(a=-1),ee.colHeaders.splice(a,n)),t+=n})};Array.isArray(t)?removeCol(normalizeIndexesGroup(t)):removeCol([[t,i]]);break;default:throw Error(`There is no such action "${e}"`)}U.view.render(),a||Q.adjustRowsAndCols()},adjustRowsAndCols(){let e=ee.minRows,t=ee.minSpareRows,r=ee.minCols,n=ee.minSpareCols;if(e){let t=U.countRows();t<e&&o.createRow(t,e-t,{source:"auto"})}if(t){let e=U.countEmptyRows(!0);if(e<t){let r=Math.min(t-e,ee.maxRows-U.countSourceRows());o.createRow(U.countRows(),r,{source:"auto"})}}{let e;(r||n)&&(e=U.countEmptyCols(!0));let t=U.countCols();if(r&&!ee.columns&&t<r){let n=r-t;e+=n,o.createCol(t,n,{source:"auto"})}if(n&&!ee.columns&&"array"===U.dataType&&e<n){t=U.countCols();let r=n-e,l=Math.min(r,ee.maxCols-t);o.createCol(t,l,{source:"auto"})}}U.view&&U.view.adjustElementsSize()},populateFromArray(e,t,o,r,n){let l,i,s,a,c;let h=[],f={},g=[],m=e.row,p=e.col;if(0===(i=t.length))return!1;let w=0,C=0;switch((0,u.Kn)(o)&&(w=o.col-p+1,C=o.row-m+1),n){case"shift_down":let y=(0,d.jz)(t),v=y.length,R=Math.max(v,w),b=U.getData().slice(m),S=(0,d.jz)(b).slice(p,p+R);for(s=0;s<R;s+=1)if(s<v){for(l=0,i=y[s].length;l<C-i;l+=1)y[s].push(y[s][l%i]);s<S.length?g.push(y[s].concat(S[s])):g.push(y[s].concat(Array(b.length).fill(null)))}else g.push(y[s%v].concat(S[s]));U.populateFromArray(m,p,(0,d.jz)(g));break;case"shift_right":let I=t.length,H=Math.max(I,C),x=U.getData().slice(m).map(e=>e.slice(p));for(l=0;l<H;l+=1)if(l<I){for(s=0,a=t[l].length;s<w-a;s+=1)t[l].push(t[l][s%a]);if(l<x.length)for(let e=0;e<x[l].length;e+=1)t[l].push(x[l][e]);else t[l].push(...Array(x[0].length).fill(null))}else t.push(t[l%i].slice(0,H).concat(x[l]));U.populateFromArray(m,p,t);break;default:f.row=e.row,f.col=e.col;let M=0,A=0,E=!0,getInputValue=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==o?r[o%r.length]:r},k=t.length,_=o?o.row-e.row+1:0;for(l=0,i=o?_:Math.max(k,_);l<i&&!(o&&f.row>o.row&&_>k||!ee.allowInsertRow&&f.row>U.countRows()-1)&&!(f.row>=ee.maxRows);l++){let t=l-M,n=getInputValue(t).length,d=o?o.col-e.col+1:0;if(a=o?d:Math.max(n,d),f.col=e.col,c=U.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipRowOnPaste){M+=1,f.row+=1,i+=1;continue}for(s=0,A=0;s<a&&!(o&&f.col>o.col&&d>n||!ee.allowInsertColumn&&f.col>U.countCols()-1)&&!(f.col>=ee.maxCols);s++){if(c=U.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipColumnOnPaste){A+=1,f.col+=1,a+=1;continue}if(c.readOnly&&"UndoRedo.undo"!==r){f.col+=1;continue}let e=s-A,o=getInputValue(t,e),n=U.getDataAtCell(f.row,f.col);if(null!==o&&"object"==typeof o){if(Array.isArray(o)&&null===n&&(n=[]),null===n||"object"!=typeof n)E=!1;else{let e=(0,u.ie)(Array.isArray(n)?n:n[0]||n),t=(0,u.ie)(Array.isArray(o)?o:o[0]||o);(0,u.Z1)(e,t)||Array.isArray(e)&&Array.isArray(t)?o=(0,u.I8)(o):E=!1}}else null!==n&&"object"==typeof n&&(E=!1);E&&h.push([f.row,f.col,o]),E=!0,f.col+=1}f.row+=1}U.setDataAtCell(h,null,null,r||"populateFromArray")}}},this.init=function(){j.setData(ee.data),U.runHooks("beforeInit"),((0,i.K1)()||(0,i.L)())&&(0,r.cn)(U.rootElement,"mobile"),this.updateSettings(ee,!0),this.view=new y.Z(this),B=s.Z.getInstance(U,ee,er),$=(0,V.t)(U),K=new c.I(U),(0,S._v)(this)&&(0,D.o)(U),U.runHooks("init"),this.forceFullRender=!0,this.view.render(),G&&null===U.rootElement.offsetParent&&(0,r.TT)(U.rootElement,()=>{U.view._wt.wtOverlays.updateLastSpreaderSize(),U.render(),U.view.adjustElementsSize()}),"object"==typeof G&&(U.runHooks("afterChange",G[0],G[1]),G=!1),U.runHooks("afterInit")},this._createCellCoords=function(e,t){return U.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,o){return U.view._wt.createCellRange(e,t,o)},this.validateCell=function(e,t,o,r){let i=U.getCellValidator(t);function done(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!r||!0===t.hidden){o(e);return}let n=t.visualCol,l=t.visualRow,i=U.getCell(l,n,!0);if(i&&"TH"!==i.nodeName){let e=U.rowIndexMapper.getRenderableFromVisualIndex(l),t=U.columnIndexMapper.getRenderableFromVisualIndex(n);U.view._wt.getSetting("cellRenderer",e,t,i)}o(e)}if((0,l.Kj)(i)){var s;s=i,i=function(e,t){t(s.test(e))}}(0,n.mf)(i)?(e=U.runHooks("beforeValidate",e,t.visualRow,t.prop,r),U._registerImmediate(()=>{i.call(t,e,o=>{U&&(o=U.runHooks("afterValidate",o,e,t.visualRow,t.prop,r),t.valid=o,done(o),U.runHooks("postAfterValidate",o,e,t.visualRow,t.prop,r))})})):U._registerImmediate(()=>{t.valid=!0,done(t.valid,!1)})},this.setDataAtCell=function(e,t,r,n){let l,i,s;let a=setDataInputToArray(e,t,r),u=[],c=n;for(l=0,i=a.length;l<i;l++){if("object"!=typeof a[l])throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof a[l][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=a[l][1]>=this.countCols()?a[l][1]:o.colToProp(a[l][1]),u.push([a[l][0],s,j.getAtCell(this.toPhysicalRow(a[l][0]),a[l][1]),a[l][2]])}c||"object"!=typeof e||(c=t);let d=processChanges(u,n);U.runHooks("afterSetDataAtCell",d,c),validateChanges(d,c,()=>{applyChanges(d,c)})},this.setDataAtRowProp=function(e,t,o,r){let n,l;let i=setDataInputToArray(e,t,o),s=[],a=r;for(n=0,l=i.length;n<l;n++)s.push([i[n][0],i[n][1],j.getAtCell(this.toPhysicalRow(i[n][0]),i[n][1]),i[n][2]]);a||"object"!=typeof e||(a=t);let u=processChanges(s,r);U.runHooks("afterSetDataAtRowProp",u,a),validateChanges(u,a,()=>{applyChanges(u,a)})},this.listen=function(){U&&!U.isListening()&&(O.forEach(e=>{U!==e&&e.unlisten()}),N=U.guid,U.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(N=null,U.runHooks("afterUnlisten"))},this.isListening=function(){return N===U.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];B.closeEditor(e),U.view.render(),t&&er.isSelected()&&B.prepareEditor()},this.populateFromArray=function(e,t,o,r,n,l,i){if(!("object"==typeof o&&"object"==typeof o[0]))throw Error("populateFromArray parameter `input` must be an array of arrays");let s="number"==typeof r?U._createCellCoords(r,n):null;return Q.populateFromArray(U._createCellCoords(e,t),o,s,l,i)},this.spliceCol=function(e,t,r){for(var n=arguments.length,l=Array(n>3?n-3:0),i=3;i<n;i++)l[i-3]=arguments[i];return o.spliceCol(e,t,r,...l)},this.spliceRow=function(e,t,r){for(var n=arguments.length,l=Array(n>3?n-3:0),i=3;i<n;i++)l[i-3]=arguments[i];return o.spliceRow(e,t,r,...l)},this.getSelected=function(){if(er.isSelected())return(0,d.Sc)(er.getSelectedRange(),e=>{let{from:t,to:o}=e;return[t.row,t.col,o.row,o.col]})},this.getSelectedLast=function(){let e;let t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(er.isSelected())return Array.from(er.getSelectedRange())},this.getSelectedRangeLast=function(){let e;let t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){if(!er.isSelected()||0===this.countRows()||0===this.countCols())return;let t=[];(0,d.Bk)(er.getSelectedRange(),e=>{if(e.isSingleHeader())return;let o=e.getTopStartCorner(),r=e.getBottomEndCorner();(0,C.q4)(o.row,r.row,e=>{(0,C.q4)(o.col,r.col,o=>{this.getCellMeta(e,o).readOnly||t.push([e,o,null])})})}),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():U.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||U.view.render())},this.batchRender=function(e){this.suspendRender();let t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();let o=e();return this.resumeExecution(t),o},this.batch=function(e){this.suspendRender(),this.suspendExecution();let t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!U.view)return;let{width:e,height:t}=U.view.getLastSize(),{width:o,height:r}=U.rootElement.getBoundingClientRect(),n=o!==e||r!==t,l=!1===U.runHooks("beforeRefreshDimensions",{width:e,height:t},{width:o,height:r},n);l||((n||U.view._wt.wtOverlays.scrollableElement===U.rootWindow)&&(U.view.setLastSize(o,r),U.render()),U.runHooks("afterRefreshDimensions",{width:e,height:t},{width:o,height:r},n))},this.updateData=function(e,t){(0,T.o)(e,e=>{o=e},e=>{o=e,U.columnIndexMapper.fitToLength(this.getInitialColumnCount()),U.rowIndexMapper.fitToLength(this.countSourceRows()),Q.adjustRowsAndCols(),er.refresh()},{hotInstance:U,dataMap:o,dataSource:j,internalSource:"updateData",source:t,metaManager:X,firstRun:G})},this.loadData=function(e,t){(0,T.o)(e,e=>{o=e},()=>{X.clearCellsCache(),U.initIndexMappers(),Q.adjustRowsAndCols(),er.refresh(),G&&(G=[null,"loadData"])},{hotInstance:U,dataMap:o,dataSource:j,internalSource:"loadData",source:t,metaManager:X,firstRun:G})},this.getInitialColumnCount=function(){let e=ee.columns,t=0;if(Array.isArray(e))t=e.length;else if((0,n.mf)(e)){if("array"===U.dataType){let o=this.countSourceCols();for(let r=0;r<o;r+=1)e(r)&&(t+=1)}else("object"===U.dataType||"function"===U.dataType)&&(t=o.colToPropCache.length)}else if((0,l.$K)(ee.dataSchema)){let e=o.getSchema();t=Array.isArray(e)?e.length:(0,u.Q8)(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return(0,l.o8)(e)?o.getAll():o.getRange(U._createCellCoords(e,t),U._createCellCoords(r,n),o.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return o.getCopyableText(U._createCellCoords(e,t),U._createCellCoords(r,n))},this.getCopyableData=function(e,t){return o.getCopyable(e,o.colToProp(t))},this.getSchema=function(){return o.getSchema()},this.updateSettings=function(e){let t,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=(G?U.loadData:U.updateData).bind(this),a=!1;if((0,l.$K)(e.rows))throw Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,l.$K)(e.cols))throw Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,l.$K)(e.ganttChart))throw Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?function(e){let t=(0,M.TH)(e);(0,x.RY)(t)?(U.runHooks("beforeLanguageChange",t),et.language=t,U.runHooks("afterLanguageChange",t)):(0,M.Vn)(e)}(e.language):"className"===t?setClassName("className",e.className):"tableClassName"===t&&U.table?(setClassName("tableClassName",e.tableClassName),U.view._wt.wtOverlays.syncOverlayTableClassNames()):H.Z.getSingleton().isRegistered(t)||H.Z.getSingleton().isDeprecated(t)?((0,n.mf)(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,U.addHook(t,e[t])):!i&&(0,u.nr)(e,t)&&(et[t]=e[t]));void 0===e.data&&void 0===ee.data?s(null,"updateSettings"):void 0!==e.data?s(e.data,"updateSettings"):void 0!==e.columns&&(o.createMap(),U.initIndexMappers());let c=U.countCols(),d=ee.columns;if(d&&(0,n.mf)(d)&&(a=!0),(void 0!==e.cell||void 0!==e.cells||void 0!==e.columns)&&X.clearCache(),c>0)for(t=0,r=0;t<c;t++){if(d){let e=a?d(t):d[r];e&&X.updateColumnMeta(r,e)}r+=1}(0,l.$K)(e.cell)&&(0,u._l)(e.cell,e=>{U.setCellMetaObject(e.row,e.col,e)}),U.runHooks("afterCellMetaReset");let h=U.rootElement.style.height;""!==h&&(h=parseInt(U.rootElement.style.height,10));let f=e.height;if((0,n.mf)(f)&&(f=f()),i){let e=U.rootElement.getAttribute("style");e&&U.rootElement.setAttribute("data-initialstyle",U.rootElement.getAttribute("style"))}if(null===f){let e=U.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?U.rootElement.setAttribute("style",e):(U.rootElement.style.height="",U.rootElement.style.overflow="")}else void 0!==f&&(U.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,U.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;(0,n.mf)(t)&&(t=t()),U.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}i||(U.view&&(U.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),U.view._wt.exportSettingsAsClassNames()),U.runHooks("afterUpdateSettings",e)),Q.adjustRowsAndCols(),U.view&&!G&&(U.forceFullRender=!0,U.view.render(),U.view._wt.wtOverlays.adjustElementsSize()),!i&&U.view&&(""===h||""===f||void 0===f)&&h!==f&&U.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let e=U.getSelectedLast();if(ee.getValue){if((0,n.mf)(ee.getValue))return ee.getValue.call(U);if(e)return U.getData()[e[0][0]][ee.getValue]}else if(e)return U.getDataAtCell(e[0],e[1])},this.getSettings=function(){return ee},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,o,r,n){Q.alter(e,t,o,r,n)},this.getCell=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,n=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;n=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===n||null===r||void 0===n||void 0===r?null:U.view.getCellAtCoords(U._createCellCoords(n,r),o)},this.getCoords=function(e){let t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;let{row:o,col:r}=t,n=o,l=r;return o>=0&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(o)),r>=0&&(l=this.columnIndexMapper.getVisualFromRenderableIndex(r)),U._createCellCoords(n,l)},this.colToProp=function(e){return o.colToProp(e)},this.propToCol=function(e){return o.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return o.get(e,o.colToProp(t))},this.getDataAtRowProp=function(e,t){return o.get(e,t)},this.getDataAtCol=function(e){let t=[],r=o.getRange(U._createCellCoords(0,e),U._createCellCoords(ee.data.length-1,e),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getDataAtProp=function(e){let t=[],r=o.getRange(U._createCellCoords(0,o.propToCol(e)),U._createCellCoords(ee.data.length-1,o.propToCol(e)),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getSourceData=function(e,t,o,r){return void 0===e?j.getData():j.getByRange(U._createCellCoords(e,t),U._createCellCoords(o,r))},this.getSourceDataArray=function(e,t,o,r){return void 0===e?j.getData(!0):j.getByRange(U._createCellCoords(e,t),U._createCellCoords(o,r),!0)},this.getSourceDataAtCol=function(e){return j.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,o,r){let n=setDataInputToArray(e,t,o),i=this.hasHook("afterSetSourceDataAtCell"),s=[];i&&(0,d.Bk)(n,e=>{let[t,o,r]=e;s.push([t,o,j.getAtCell(t,o),r])}),(0,d.Bk)(n,e=>{let[t,o,r]=e;j.setAtCell(t,o,r)}),i&&this.runHooks("afterSetSourceDataAtCell",s,r),this.render();let a=U.getActiveEditor();a&&(0,l.$K)(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(e){return j.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return j.getAtCell(e,t)},this.getDataAtRow=function(e){let t=o.getRange(U._createCellCoords(e,0),U._createCellCoords(e,this.countCols()-1),o.DESTINATION_RENDERER);return t[0]||[]},this.getDataType=function(e,t,o,r){let n=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,o,r],[l,i]=n,[,,s,a]=n,u=null,c=null;void 0===s&&(s=l),void 0===a&&(a=i);let d="mixed";return(0,C.q4)(Math.max(Math.min(l,s),0),Math.max(l,s),e=>{let t=!0;return(0,C.q4)(Math.max(Math.min(i,a),0),Math.max(i,a),o=>{let r=this.getCellMeta(e,o);return c=r.type,u?t=u===c:u=c,t}),d=t?c:"mixed",t}),d},this.removeCellMeta=function(e,t,o){let[r,n]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],l=X.getCellMetaKeyValue(r,n,o),i=U.runHooks("beforeRemoveCellMeta",e,t,o,l);!1!==i&&(X.removeCellMeta(r,n,o),U.runHooks("afterRemoveCellMeta",e,t,o,l))},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,r=Array(o>2?o-2:0),n=2;n<o;n++)r[n-2]=arguments[n];if(r.length>0&&!Array.isArray(r[0]))throw Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&X.removeRow(this.toPhysicalRow(e),t),r.length>0&&(0,d.Bk)(r.reverse(),t=>{X.createRow(this.toPhysicalRow(e)),(0,d.Bk)(t,(t,o)=>this.setCellMetaObject(e,o,t))}),U.render()},this.setCellMetaObject=function(e,t,o){"object"==typeof o&&(0,u._l)(o,(o,r)=>{this.setCellMeta(e,t,r,o)})},this.setCellMeta=function(e,t,o,r){let n=U.runHooks("beforeSetCellMeta",e,t,o,r);if(!1===n)return;let l=e,i=t;e<this.countRows()&&(l=this.toPhysicalRow(e)),t<this.countCols()&&(i=this.toPhysicalColumn(t)),X.setCellMeta(l,i,o,r),U.runHooks("afterSetCellMeta",e,t,o,r)},this.getCellsMeta=function(){return X.getCellsMeta()},this.getCellMeta=function(e,t){let o=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===o&&(o=e),null===r&&(r=t),X.getCellMeta(o,r,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return X.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return X.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===U.dataType||ee.columns)},this.getCellRenderer=function(e,t){let o="number"==typeof e?U.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof o?(0,g.Bp)(o):(0,l.o8)(o)?(0,g.Bp)("text"):o},this.getCellEditor=function(e,t){let o="number"==typeof e?U.getCellMeta(e,t).editor:e.editor;return"string"==typeof o?(0,m.y$)(o):(0,l.o8)(o)?(0,m.y$)("text"):o},this.getCellValidator=function(e,t){let o="number"==typeof e?U.getCellMeta(e,t).validator:e.validator;return"string"==typeof o?(0,p.Te)(o):o},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,o){let r=new ValidatorsQueue;e&&(r.onQueueEmpty=e);let n=U.countRows()-1;for(;n>=0;){if(void 0!==t&&-1===t.indexOf(n)){n-=1;continue}let e=U.countCols()-1;for(;e>=0;){if(void 0!==o&&-1===o.indexOf(e)){e-=1;continue}r.addValidatorToQueue(),U.validateCell(U.getDataAtCell(n,e),U.getCellMeta(n,e),e=>{if("boolean"!=typeof e)throw Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),e-=1}n-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=ee.rowHeaders,o=e;return void 0!==o&&(o=U.runHooks("modifyRowHeader",o)),void 0===o?(t=[],(0,C.q4)(U.countRows()-1,e=>{t.push(U.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[o]?t=t[o]:(0,n.mf)(t)?t=t(o):t&&"string"!=typeof t&&"number"!=typeof t&&(t=o+1),t},this.hasRowHeaders=function(){return!!ee.rowHeaders},this.hasColHeaders=function(){if(void 0!==ee.colHeaders&&null!==ee.colHeaders)return!!ee.colHeaders;for(let e=0,t=U.countCols();e<t;e++)if(U.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=U.runHooks("modifyColHeader",e);if(void 0===o){let e=[],t=U.countCols();for(let o=0;o<t;o++)e.push(U.getColHeader(o));return e}let r=ee.colHeaders,l=U.toPhysicalColumn(o),i=function(e){let t=[],o=U.countCols(),r=0;for(;r<o;r++)(0,n.mf)(ee.columns)&&ee.columns(r)&&t.push(r);return t[e]}(l);return!1===ee.colHeaders?r=null:ee.columns&&(0,n.mf)(ee.columns)&&ee.columns(i)&&ee.columns(i).title?r=ee.columns(i).title:ee.columns&&ee.columns[l]&&ee.columns[l].title?r=ee.columns[l].title:Array.isArray(ee.colHeaders)&&void 0!==ee.colHeaders[l]?r=ee.colHeaders[l]:(0,n.mf)(ee.colHeaders)?r=ee.colHeaders(l):ee.colHeaders&&"string"!=typeof ee.colHeaders&&"number"!=typeof ee.colHeaders&&(r=(0,R.Yl)(o)),r=U.runHooks("modifyColumnHeaderValue",r,e,t)},this._getColWidthFromSettings=function(e){let t;if(e>=0){let o=U.getCellMeta(0,e);t=o.width}if((void 0===t||t===ee.width)&&(t=ee.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){let t=U._getColWidthFromSettings(e);return void 0===(t=U.runHooks("modifyColWidth",t,e))&&(t=I.$),t},this._getRowHeightFromSettings=function(e){let t=ee.rowHeights;if(null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){let t=U._getRowHeightFromSettings(e);return U.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return j.countRows()},this.countSourceCols=function(){return j.countFirstRowKeys()},this.countRows=function(){return o.getLength()},this.countCols=function(){let e=ee.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return U.view._wt.drawn?U.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return U.view._wt.drawn?U.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return U.view._wt.drawn?U.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return U.view._wt.drawn?U.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.yh)(U.countRows()-1,o=>{if(U.isEmptyRow(o))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.yh)(U.countCols()-1,o=>{if(U.isEmptyCol(o))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return ee.isEmptyRow.call(U,e)},this.isEmptyCol=function(e){return ee.isEmptyCol.call(U,e)},this.selectCell=function(e,t,o,r){let n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=!(arguments.length>5)||void 0===arguments[5]||arguments[5];return!((0,l.o8)(e)||(0,l.o8)(t))&&this.selectCells([[e,t,o,r]],n,i)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===t&&$.suspend();let r=er.selectCells(e);return r&&o&&U.listen(),$.resume(),r},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return er.selectColumns(e,t,o)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return er.selectRows(e,t,o)},this.deselectCell=function(){er.deselect()},this.selectAll=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;$.skipNextScrollCycle(),er.selectAll(e,t,o)};let getIndexToScroll=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var t,o;let r,n,l,i;"number"==typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(o=arguments[4])||void 0===o||o});let{row:s,col:a,verticalSnap:u,horizontalSnap:c,considerHiddenIndexes:d}=null!==(t=e)&&void 0!==t?t:{};void 0!==u&&(n=!(r="top"===u)),void 0!==c&&(i=!(l="start"===c));let h=s,f=a;if(void 0===d||d){let e=Number.isInteger(s)&&s>=0,t=Number.isInteger(a)&&a>=0,o=e?getIndexToScroll(this.rowIndexMapper,s):void 0,r=t?getIndexToScroll(this.columnIndexMapper,a):void 0;if(null===o||null===r)return!1;h=e?U.rowIndexMapper.getRenderableFromVisualIndex(o):s,f=t?U.columnIndexMapper.getRenderableFromVisualIndex(r):a}let g=Number.isInteger(h),m=Number.isInteger(f);return g&&h>=0&&m&&f>=0?U.view.scrollViewport(U._createCellCoords(h,f),r,i,n,l):g&&h>=0&&(m&&f<0||!m)?U.view.scrollViewportVertically(h,r,n):!!m&&f>=0&&(!!g&&h<0||!g)&&U.view.scrollViewportHorizontally(f,i,l)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);let{highlight:t}=this.getSelectedRangeLast(),o=this.scrollViewportTo(t.toObject());o?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate(()=>e()))},this.destroy=function(){if(U._clearTimeouts(),U._clearImmediates(),U.view&&U.view.destroy(),j&&j.destroy(),j=null,this.getShortcutManager().destroy(),X.clearCache(),O.delete(this.guid),(0,S._v)(U)){let e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,r.cS)(U.rootElement),q.destroy(),B&&B.destroy(),U.batchExecution(()=>{U.rowIndexMapper.unregisterAll(),U.columnIndexMapper.unregisterAll(),eo.getItems().forEach(e=>{let[,t]=e;t.destroy()}),eo.clear(),U.runHooks("afterDestroy")},!0),H.Z.getSingleton().destroy(U),(0,u._l)(U,(e,t,o)=>{(0,n.mf)(e)?o[t]=()=>{throw Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}:"guid"!==t&&(o[t]=null)}),U.isDestroyed=!0,o&&o.destroy(),o=null,Q=null,er=null,B=null,U=null},this.getActiveEditor=function(){return B.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return U.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return U.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return U.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return U.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return U.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return U.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return U.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return U.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return U.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return U.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return U.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return U.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){let t=(0,w.ct)(e);return"UndoRedo"===t?this.undoRedo:eo.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:eo.getId(e)},this.getInstance=function(){return U},this.addHook=function(e,t,o){H.Z.getSingleton().add(e,t,U,o)},this.hasHook=function(e){return H.Z.getSingleton().has(e,U)||H.Z.getSingleton().has(e)},this.addHookOnce=function(e,t,o){H.Z.getSingleton().once(e,t,U,o)},this.removeHook=function(e,t){H.Z.getSingleton().remove(e,t,U)},this.runHooks=function(e,t,o,r,n,l,i){return H.Z.getSingleton().run(U,e,t,o,r,n,l,i)},this.getTranslatedPhrase=function(e,t){return(0,x.vk)(ee.language,e,t)},this.toHTML=()=>(0,h.vo)(this),this.toTableElement=()=>{let e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,h.vo)(this)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e;"function"==typeof o&&(o=setTimeout(o,t)),this.timeouts.push(o)},this._clearTimeouts=function(){(0,d.Bk)(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,d.Bk)(this.immediates,e=>{clearImmediate(e)})},this._getEditorManager=function(){return B},this.isRtl=function(){return"rtl"===U.rootWindow.getComputedStyle(U.rootElement).direction},this.isLtr=function(){return!U.isRtl()},this.getDirectionFactor=function(){return U.isLtr()?1:-1};let en=(0,L.U)({handleEvent:()=>U.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||U.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&en.releasePressedKeys()}),this.getShortcutManager=function(){return en},this.getFocusManager=function(){return K},(0,f.a9)().forEach(e=>{let t=(0,f.s3)(e);eo.addItem(e,new t(this))}),(0,P.xg)(U),en.setActiveContextName("grid"),H.Z.getSingleton().run(U,"construct")}}}]);