"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[548],{21548:function(e,t,i){i.r(t);var l=i(57437),n=i(39227),s=i(2265),a=i(81797),d=i(52931),r=i(54755),u=i(96350),c=i(28811),o=i.n(c);let p=o()(()=>i.e(809).then(i.bind(i,86809)),{loadableGenerated:{webpack:()=>[86809]}}),h=o()(()=>i.e(188).then(i.bind(i,77188)),{loadableGenerated:{webpack:()=>[77188]}}),m=[{label:"KEGG",id:"KEGG"},{label:"ChEBI",id:"ChEBI"},{label:"PubChem (CID)",id:"PubChem"},{label:"HMDB",id:"HMDB"}];t.default=function(e){let{fRef:t,f2MeanL:i,colFid:c,setColFid:o,setM2cat:x,MetaboID:f}=e,{jobID:b}=(0,a.tc)(),{API_URL:j}=(0,u.S)(),{m2i:y}=(0,a.tc)().user,C=(0,a.tc)().f2x.m,{OS:g}=(0,a.tc)(),Z=(0,s.useMemo)(()=>y.columns.map(e=>({label:e,id:e})),[y]),[S,E]=(0,s.useState)(m[0]),w=(0,s.useMemo)(()=>["ChEBI","PubChem"].includes(S.id),[S]),[G,I]=(0,s.useState)([]),{midTargetArr:v,midArr:M,midIndex:_,db2usr:k}=(0,s.useMemo)(()=>{let e,i,l;let n={};return c&&(e=t.map(e=>e[c.id]).filter(e=>e),i=y.column(c.id).values.filter((e,t)=>e&&C[t]),w?(e=e.map(e=>Number(e).toString()),i=i.map(e=>{let t=Number(e).toString();return n[t]=e,t})):i.map(e=>n[e]=e),l=(i=i.map(t=>({id:t,target:e.includes(t)}))).map(e=>f[S.id].indexOf(e.id))),{midTargetArr:e,midArr:i,midIndex:l,db2usr:n}},[c,S,w,t,y,C,f]);(0,s.useEffect)(()=>{if(null===c)return;let e={};if(_.every(e=>-1==e)){console.log("No index found"),I([]);return}["KEGG","ChEBI"].map(t=>{e[t]=_.map((e,i)=>({id:f[t][e],target:M[i].target})).filter(e=>e.id)}),fetch("".concat(j,"/run_ora/").concat(b,"/").concat(g.scientific_name),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{e.KEGG=e.KEGG.map(e=>({...e,name:e.name.split(" - ").slice(0,-1).join(" - ")}));let t=[];Object.keys(e).map(i=>{e[i].map(e=>t.push({...e,pvalue:Math.round(1e3*e.pvalue)/1e3,db:i}))}),I(t.filter(e=>e.N_pathway_sig>0))})},[_,M,c,j,g,b,f]);let[F,N]=(0,s.useState)(null),[O,B]=(0,s.useState)([]);(0,s.useEffect)(()=>{if(console.log("setM2Cat"),!c)return;let e={};v.map(t=>e[k[t]]=[]),G.filter(e=>O.includes(e.id)).map(t=>{t.pathway_sig.map(i=>{let l=f[S.id][f[t.db].indexOf(i)];l&&v.includes(l)&&e[k[l]].push({native:t.id,name:t.name})})}),x(e)},[O,v,G,S,c,k,x,f]);let[D,K]=(0,s.useState)(!0);return(0,l.jsxs)(n.Z,{sx:{},children:[(0,l.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"center",pb:4},children:[(0,l.jsx)(d.Z,{options:Z,selectedField:c,setSelectedField:e=>o(e),children:"Select Column Containing ID"}),(0,l.jsx)(n.Z,{sx:{width:10}}),(0,l.jsx)(d.Z,{options:m,selectedField:S,setSelectedField:e=>E(e),children:"Select ID Type"})]}),c&&(0,l.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[(0,l.jsx)(n.Z,{sx:{width:"65%"},children:(0,l.jsx)(p,{myData:G,setCategory:N,myUsrFilt:O,setMyUsrFilt:B})}),(0,l.jsx)(n.Z,{sx:{width:"30%",display:"flex",justifyContent:"center",border:"0px solid blue"},children:F&&(0,l.jsxs)(l.Fragment,{children:[D&&(0,l.jsxs)(n.Z,{sx:{border:"0px solid red",alignSelf:"center",width:"80%"},children:[(0,l.jsx)(n.Z,{children:"Loading Metabolites..."}),(0,l.jsx)(n.Z,{sx:{p:4},children:(0,l.jsx)(r.Z,{})})]}),(0,l.jsx)(h,{mCat:F,idType:S,setShowLoading:K})]})})]})]})}},52931:function(e,t,i){var l=i(57437),n=i(2265),s=i(39227),a=i(85269),d=i(70812),r=i(67248);t.Z=e=>{let{options:t,selectedField:i,setSelectedField:u,children:c}=e,handleInput=(e,i)=>{i?u(i):u(t[0])};return(0,l.jsxs)(s.Z,{children:[(0,l.jsx)(a.Z,{variant:"h6",children:c}),(0,l.jsx)(d.Z,{id:"feature-id-field",sx:{width:300,margin:"auto",mt:2},disableListWrap:!0,value:i,onChange:(e,t)=>handleInput(e,t),options:t,renderInput:e=>(0,l.jsx)(r.Z,{...e,label:"Field"}),renderOption:(e,t)=>(0,n.createElement)("li",{...e,key:t.label},t.label),isOptionEqualToValue:(e,t)=>e.id===t.id})]})}}}]);